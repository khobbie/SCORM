(function(){var g=function(f,b){return function(){return f.apply(b,arguments)}},r=function(f,b){function a(){this.constructor=f}for(var c in b)y.call(b,c)&&(f[c]=b[c]);a.prototype=b.prototype;f.prototype=new a;f.__super__=b.prototype;return f},y={}.hasOwnProperty,x=[].indexOf||function(f){for(var b=0,a=this.length;b<a;b++)if(b in this&&this[b]===f)return b;return-1};window.D2LAdventureEngine.ResourceManager=function(){function f(){this.preDetermineSpriteDimentions=g(this.preDetermineSpriteDimentions,
this);this.preDetermineImageDimentions=g(this.preDetermineImageDimentions,this);this.getData=g(this.getData,this);this.get=g(this.get,this);this._SpritesManager=new D2LAdventureEngine.rm_sprites;this._BitmapsManager=new D2LAdventureEngine.rm_bitmaps;this._DataManager=new D2LAdventureEngine.rm_data}f.prototype._SpritesManager=void 0;f.prototype._BitmapsManager=void 0;f.prototype._DataManager=void 0;f.prototype.get=function(b,a){switch(a){case "button":return this._SpritesManager.get(b);case "sprite":return this._SpritesManager.get(b);
case "bitmap":return this._BitmapsManager.get(b);case "toggle":return this._SpritesManager.get(b);case "data":return this._DataManager.get(b);default:return alert("Error! "+a+" not found in ResourceManager")}};f.prototype.getData=function(b,a){switch(a){case "button":return this._SpritesManager.getData(b);case "sprite":return this._SpritesManager.getData(b);case "bitmap":return this._BitmapsManager.getData(b);case "toggle":return this._SpritesManager.getData(b);case "data":return this._DataManager.getData(b);
default:return alert("Error! "+a+" not found in ResourceManager")}};f.prototype.preDetermineImageDimentions=function(b,a,c){var d;if(void 0!==b){if(c||-1!==b.indexOf("data:image/"))return d=new Image,d.src=b,d.complete?a({width:d.width,height:d.height}):d.onload=function(b){return function(){return a({width:d.width,height:d.height})}}(this);d=this._BitmapsManager.get(b);return a?a({width:d.width,height:d.height}):{width:d.width,height:d.height}}D2LAdventureEngine.gu_debugManager.log("Error preDetermineImageDimentions called without a name param");
return a?a({width:0,height:0}):{width:0,height:0}};f.prototype.preDetermineSpriteDimentions=function(b){var a,c,d;if(void 0!==b){if(a=this._SpritesManager.getData(b)){b=this._SpritesManager.getData(b).spriteFrameData;a=0;d=[];for(c=[];a<b.length;)d.push(b[a][2]),c.push(b[a][3]),a++;return{width:Math.max.apply(Math,d),height:Math.max.apply(Math,c)}}return!1}D2LAdventureEngine.gu_debugManager.log("Error preDetermineSpriteDimentions called without a name param");return!1};return f}();window.D2LAdventureEngine.rm_sprites=
function(){return function(){this.get=function(f){return function(b){var a,c;for(a=0;a<D2LAdventureEngine.gu_SpriteAssets.length;){if(D2LAdventureEngine.gu_SpriteAssets[a]._name===b){b=0;if(c=D2LAdventureEngine.gu_SpriteAssets[a]._data)for(c=Object.keys(c);b<c.length;)D2LAdventureEngine.gu_SpriteAssets[a]._data[c[b]].speed=D2LAdventureEngine.gu_JsonOps.parseConverstionRules(D2LAdventureEngine.gu_SpriteAssets[a]._data[c[b]].speed),b++;else D2LAdventureEngine.gu_debugManager.log("warning sprite data was missing."),
D2LAdventureEngine.gu_debugManager.log(D2LAdventureEngine.gu_SpriteAssets[a]);a=D2LAdventureEngine.gu_SpriteAssets[a];a._framesVaildated||a.VailidateFrames();return new createjs.Sprite(a)}a++}return D2LAdventureEngine.gu_debugManager.log("warning, "+b+" was not found in rm_sprites attempting reload")}}(this);this.getData=function(f){return function(b){var a;for(a=0;a<D2LAdventureEngine.gu_SpriteAssets.length;){if(D2LAdventureEngine.gu_SpriteAssets[a]._name===b)return b=D2LAdventureEngine.gu_SpriteAssets[a],
b._framesVaildated||b.VailidateFrames(),b.data;a++}return D2LAdventureEngine.gu_debugManager.log("Error!! - "+b+" not found in rm_sprites getData")}}(this)}}();window.D2LAdventureEngine.rm_data=function(){return function(){this.get=function(f){return function(b){var a;for(a=0;a<window.D2LAdventureEngine.gu_DataAssets.length;){if(window.D2LAdventureEngine.gu_DataAssets[a].id===b)return window.D2LAdventureEngine.gu_DataAssets[a].data;a++}return alert("Error!! - "+b+" not found in rm_data")}}(this);
this.getData=function(f){return function(b){var a;for(a=0;a<D2LAdventureEngine.gu_DataAssets.length;){if(D2LAdventureEngine.gu_DataAssets[a].id===b)return D2LAdventureEngine.gu_DataAssets[a];a++}return D2LAdventureEngine.gu_debugManager.log("Error!! - "+b+" not found in rm_bitmaps getData")}}(this)}}();window.D2LAdventureEngine.rm_bitmaps=function(){function f(){this.getData=g(this.getData,this);this.get=g(this.get,this);this.HandleLoadedResources=g(this.HandleLoadedResources,this);this._imageAssetsList=
[]}f.prototype._imageAssetsList=void 0;f.prototype.HandleLoadedResources=function(b){var a;a=b.item;a.image=b.result;this._imageAssetsList.push(a);b.callback&&b.callback(b)};f.prototype.get=function(b){var a,c;c=new createjs.Bitmap;for(a=0;a<this._imageAssetsList.length;){if(this._imageAssetsList[a].id===b)return-1===this._imageAssetsList[a].src.indexOf("data:image/png;base64")?(c.name=b,c.image=this._imageAssetsList[a].image):(c.name=b,c.image=document.createElement("img"),c.image.setAttribute("src",
this._imageAssetsList[a].src)),c.width=c.image.width,c.height=c.image.height,c;a++}D2LAdventureEngine.gu_debugManager.log("Error!! - "+b+" not found in rm_bitmaps");if("errorImage"!==b)return this.get("errorImage")};f.prototype.getData=function(b){var a;for(a=0;a<this._imageAssetsList.length;){if(this._imageAssetsList[a].id===b)return b={AssetID:this._imageAssetsList[a].id,AssetLocation:this._imageAssetsList[a].src};a++}D2LAdventureEngine.gu_debugManager.log("Error!! - "+b+" not found in rm_bitmaps getData")};
return f}();window.D2LAdventureEngine.BaseView=function(f){function b(a,c,d){this.ID=a;this.assoiatedStateID=null!=c?c:"none";this._options=null!=d?d:{initX:null,initY:null,initWidth:null,initHeight:null,initCompData:null,BackgroundBitmap:void 0,BackgroundBitmapCrossOrigin:void 0,ShowRulers:!1,onInitOveride:void 0,onInitOverideParam:void 0,onUpdate:void 0,onUpdateData:void 0};b.__super__.constructor.call(this);this.initialize();eval("this.addOutside ="+this.addChild.toString());eval("this.removeOutside ="+
this.removeChild.toString());eval("this.addChildAtOutside ="+this.addChildAt.toString());eval("this.getChildAtOutside ="+this.getChildAt.toString());eval("this.numChildrenOutside = "+this.getNumChildren.toString());eval("this.getChildIndexOutside = "+this.getChildIndex.toString());eval("this.setChildIndexOutside = "+this.setChildIndex.toString());this._prevACpos={};this._initialized=!1;this._locationData={state:this.assoiatedStateID,scene:this.ID};this.VeiwContainer=new createjs.Container;this.preInit=
function(a){return function(){var b;a.x=void 0===a._options.initX||null===a._options.initX?0:a._options.initX;a.y=void 0===a._options.initY||null===a._options.initY?0:a._options.initY;a.width=void 0===a._options.initWidth||null===a._options.initWidth?D2LAdventureEngine.gu_canDi.width:D2LAdventureEngine.gu_JsonOps.parseAllRules(a._options.initWidth);a.height=void 0===a._options.initHeight||null===a._options.initHeight?D2LAdventureEngine.gu_canDi.height:D2LAdventureEngine.gu_JsonOps.parseAllRules(a._options.initHeight);
b={ID:a.ID+"_backgroundIMG",Type:"Bitmap",AssetID:"sceneGrid_bg",useCursor:"default"};a._options.BackgroundBitmapCrossOrigin&&(b.crossOrigin=a._options.BackgroundBitmapCrossOrigin);!0!==a._options.retainBackgroundSize&&"[%true]"!==a._options.retainBackgroundSize&&(b.scaleToSizeWithRatio=!0,b.initWidth=a.width,b.initHeight=a.height);"none"!==a._options.BackgroundBitmap?a._options.BackgroundBitmap.constructor===String?(b.AssetID=a._options.BackgroundBitmap,a._bgIMG=D2LAdventureEngine.gu_ComponentManager.BuildComponent(b,
a._locationData)):a._bgIMG=a._options.BackgroundBitmap.constructor===D2LAdventureEngine.comp_Bitmap?a._options.BackgroundBitmap:a._options.BackgroundBitmap.constructor===Object?D2LAdventureEngine.gu_ComponentManager.BuildComponent(a._options.BackgroundBitmap,a._locationData):D2LAdventureEngine.gu_ComponentManager.BuildComponent(b,a._locationData):a._bgIMG=void 0;b=new createjs.Graphics;b.beginFill(createjs.Graphics.getRGB(0,0,0));b.rect(0,0,a.width,a.height);b.endFill();a.ViewMask=new createjs.Shape(b);
a.ViewMask.x=0;a.ViewMask.y=0;a.ViewMask.width=a.width;a.ViewMask.height=a.height;a.VeiwContainer.mask=a.ViewMask;a.addOutside(a.VeiwContainer);a.VeiwContainer.x=0;a.VeiwContainer.y=0;"none"!==a._options.BackgroundBitmap?(a.VeiwContainer.addChild(a._bgIMG),a._bgIMG.Update(),a.VeiwContainer.width=a._bgIMG.width,a.VeiwContainer.height=a._bgIMG.height,b=new createjs.Graphics,b.beginFill("#FF0000"),b.rect(a.VeiwContainer.x,a.VeiwContainer.y,a.ViewMask.width,a.ViewMask.height),a.mask=new createjs.Shape(b)):
(a.VeiwContainer.width=D2LAdventureEngine.gu_canDi.width,a.VeiwContainer.height=D2LAdventureEngine.gu_canDi.height);void 0!==a._options.initCompData&&null!==a._options.initCompData&&a.buildInitComponets(a._options.initCompData);void 0!==a.Init&&a.Init();return a._initialized=!0}}(this);this.addChild=function(a){return function(b){return a.VeiwContainer.addChild(b)}}(this);this.removeChild=function(a){return function(b){return a.VeiwContainer.removeChild(b)}}(this);this.addChildAt=function(a){return function(b,
c){return a.VeiwContainer.addChildAt(b,c)}}(this);this.getChildIndex=function(a){return function(b){return a.VeiwContainer.getChildIndex(b)}}(this);this.setChildIndex=function(a){return function(b,c){return a.VeiwContainer.setChildIndex(b,c)}}(this);this.getChildAt=function(a){return function(b){return a.VeiwContainer.getChildAt(b)}}(this);this.getNumChildren=function(a){return function(){return a.VeiwContainer.numChildren}}(this);this.getComponetById=function(a){return function(b){var c,d;for(c=
0;c<a.getNumChildren();){d=a.getChildAt(c);if(d._id===b&&!d._destroyed||d.getComponetById&&(d=d.getComponetById(b),!1!==d))return d;c++}return!1}}(this);this.getComponetsByPosition=function(a){return function(b){var c,d;d=[];for(c=0;c<a.getNumChildren();)void 0!==a.getChildAt(c)&&void 0!==a.getChildAt(c).isUnderCheck&&a.getChildAt(c).isUnderCheck(b)&&(void 0!==a.getChildAt(c).getComponetsByPosition&&d.concat(a.getChildAt(c).getComponetsByPosition(b)),d.push(a.getChildAt(c))),c++;return d}}(this);
this.getCompsByType=function(a){return function(b){var c,d,f;f=[];for(c=0;c<a.getNumChildren();)d=a.getChildAt(c),void 0!==d._options&&(d._options.Type===b&&f.push(d),void 0!==d.getCompsByType&&(d=d.getCompsByType(b))&&(f=f.concat(d))),c++;return 0!==f.length?f:!1}}(this);this.HandleShutdownReq=function(a){return function(){var b,c;void 0!==a._options.BackgroundBitmap.Destroy&&a._options.BackgroundBitmap.Destroy();for(b=0;b<a.getNumChildren();)c=a.getChildAt(b),void 0!==c.Destroy&&c.Destroy(),b++;
return!0}}(this);this.HandleDimentionChange=function(a){return function(b,c){var d;a.ViewMask?a.TransformContainer(a.ViewMask.x,a.ViewMask.y,b,c):(a.width=b,a.height=c);a.VeiwContainer.width=b;a.VeiwContainer.height=c;a.ViewMask?(d=new createjs.Graphics,d.beginFill("#FF0000"),d.rect(a.VeiwContainer.x,a.VeiwContainer.y,a.ViewMask.width,a.ViewMask.height)):(d=new createjs.Graphics,d.beginFill("#FF0000"),d.rect(a.VeiwContainer.x,a.VeiwContainer.y,a.VeiwContainer.width,a.VeiwContainer.height));return a.mask=
new createjs.Shape(d)}}(this);this.TransformContainer=function(a){return function(b,c,d,f){var g;null==c&&(c=void 0);null==d&&(d=void 0);null==f&&(f=void 0);"object"===typeof b?(void 0!==b.x&&b.x.constructor===Number&&(a.ViewMask.x=b.x),void 0!==b.y&&b.y.constructor===Number&&(a.ViewMask.y=b.y),void 0!==b.width&&b.width.constructor===Number&&(a.ViewMask.width=b.width),void 0!==b.height&&b.height.constructor===Number&&(a.ViewMask.height=b.height)):(b.constructor===Number&&(a.ViewMask.x=b),c.constructor===
Number&&(a.ViewMask.y=c),d.constructor===Number&&(a.ViewMask.width=d),f.constructor===Number&&(a.ViewMask.height=f));b=a.ViewMask.x;c=a.ViewMask.y;d=a.ViewMask.width;f=a.ViewMask.height;g=new createjs.Graphics;g.beginFill(createjs.Graphics.getRGB(0,0,0));g.rect(b,c,d,f);g.endFill();a.ViewMask=new createjs.Shape(g);a.ViewMask.x=b;a.ViewMask.y=c;a.ViewMask.width=d;a.ViewMask.height=f;a.width=d;a.height=f;return a.VeiwContainer.mask=a.ViewMask}}(this);this.buildInitComponets=function(a){return function(b){var c,
d,f;if(void 0!==b){a.constructor!==D2LAdventureEngine.SplashView?(c=D2LAdventureEngine.gu_StateManager.GetCurrStateRef())&&(f=c.CurrentScene||c._initScene):f=a;c=0;for(d=[];c<b.length;)a.constructor===D2LAdventureEngine.SplashView?(a[b[c].ID]=a.getResource(b[c],b[c].Type),a.addChild(a[b[c].ID])):(a.constructor===D2LAdventureEngine.UI_Manager&&(b[c].uiComp=!0),void 0!==f&&"Text"===b[c].Type?(a[b[c].ID]=D2LAdventureEngine.gu_ComponentManager.BuildComponent(b[c],a._locationData,a),f.ID!==a.ID&&a.constructor!==
D2LAdventureEngine.UI_Manager||a.addChild(a[b[c].ID])):(a[b[c].ID]=D2LAdventureEngine.gu_ComponentManager.BuildComponent(b[c],a._locationData,a),a.addChild(a[b[c].ID]))),d.push(c++);return d}}}(this);this.AssignZIndex=function(a){return function(b,c,d){var f,g,l;null==d&&(d=void 0);if(void 0!==d)for(f=0;f<Object.keys(a).length;)Object.keys(a)[f]===d&&(g=Object.keys(a)[f]),f++;f=a.getChildIndex(b);d=a.getChildIndex(a._bgIMG)+1;l=a.getChildIndex(a[g]);switch(c){case "top":return a.setChildIndex(b,a.getNumChildren()-
1);case "bottom":return a.setChildIndex(b,d),a.setChildIndex(b,d);case "up":return a.setChildIndex(b,f+1);case "down":if(f>d)return a.setChildIndex(a.getChildAt(f-1),f);break;case "above":if(void 0!==g){if(f<l)return a.setChildIndex(b,l),a.setChildIndex(b,l);a.setChildIndex(b,l+1);return a.setChildIndex(b,l+1)}return D2LAdventureEngine.gu_debugManager.log("ERROR!: AssignZIndex calling 'above' with no set Reference");case "below":if(void 0!==g){if(f>l)return a.setChildIndex(b,l),a.setChildIndex(b,
l);a.setChildIndex(b,l-1);return a.setChildIndex(b,l-1)}return D2LAdventureEngine.gu_debugManager.log("ERROR!: AssignZIndex calling 'below' with no set Reference");default:return D2LAdventureEngine.gu_debugManager.log("ERROR!: AssignZIndex call effect "+c+" not recognized")}}}(this);this.preHandleResizeEvent=function(a){return function(b){var c;for(c=0;c<a.getNumChildren();)void 0!==a.getChildAt(c)&&void 0!==a.getChildAt(c).HandleResizeEvent&&a.getChildAt(c).HandleResizeEvent(b),c++}}(this);this.preHandleWinScrollEvent=
function(a){return function(b){var c;for(c=0;c<a.getNumChildren();)void 0!==a.getChildAt(c)&&void 0!==a.getChildAt(c).HandleWinScrollEvent&&a.getChildAt(c).HandleWinScrollEvent(b),c++}}(this);this.preHandleMouseMove=function(a){return function(b){var c;for(c=0;c<a.getNumChildren();)void 0!==a.getChildAt(c)&&void 0!==a.getChildAt(c).HandleMouseMove&&a.getChildAt(c).HandleMouseMove(b),c++}}(this);this.preHandleMouseMoveOver=function(a){return function(b){return a.HandleMouseTriggering(b,"HandleMouseMoveOver",
b.mPos)}}(this);this.preHandleMouseOut=function(a){return function(b){var c;for(c=0;c<a.getNumChildren();)void 0!==a.getChildAt(c)&&void 0!==a.getChildAt(c).CheckMouseOut&&a.getChildAt(c).CheckMouseOut(b),c++}}(this);this.preHandleMouseOver=function(a){return function(b){return a.HandleMouseTriggering(b,"HandleMouseOver")}}(this);this.preHandleMouseDown=function(a){return function(b){return a.HandleMouseTriggering(b,"HandlePress")}}(this);this.preHandleDoubleClick=function(a){return function(b){return a.HandleMouseTriggering(b,
"HandleDoubleClick")}}(this);this.preHandleMouseWheel=function(a){return function(b){return a.HandleMouseTriggering(b,"HandleMouseWheel")}}(this);this.preHandleMouseUp=function(a){return function(b){var c;for(c=0;c<a.getNumChildren();)void 0!==a.getChildAt(c)&&void 0!==a.getChildAt(c).HandleMouseUp&&a.getChildAt(c).HandleMouseUp(b),c++}}(this);this.preHandleMouseUpOver=function(a){return function(b){a.HandleMouseTriggering(b,"HandleMouseUpOver")}}(this);this.HandleMouseTriggering=function(a){return function(b,
c,d){var f,g,l,q;for(g=0;g<b.targets.length;){if(void 0!==b.targets[g])for(f=0;f<a.getNumChildren();){if(void 0!==a.getChildAt(f)&&void 0!==a.getChildAt(f)[c]&&(l=b.targets[g],q=l._id,void 0===q&&void 0!==l.parent&&null!==l.parent&&(l=l.parent,q=void 0===l._id&&void 0!==l.ID?l.ID:l._id),void 0===q&&void 0!==l.parent&&null!==l.parent&&void 0!==l.parent.parent&&null!==l.parent.parent&&(l=l.parent.parent,q=l._id),void 0!==q))if(void 0!==a.getChildAt(f)._options&&a.getChildAt(f)instanceof D2LAdventureEngine.comp_Group&&
!1!==a.getChildAt(f).getComponetById(q)){if(l[c]&&!l[c](b,d))return!0}else if(a.getChildAt(f)._id===q&&a.getChildAt(f)[c]&&!a.getChildAt(f)[c](b,d))return!0;f++}g++}return!1}}(this);this.preUpdate=function(a){return function(b){var c;if(a._initialized){window.D2LAdventureEngine.gu_AccessCursorDisabled||(c=D2LAdventureEngine.gu_GUIManager.AccessCur,a._prevACpos!==a.globalToLocal(c.x,c.y)&&c.visible&&(c=a.globalToLocal(c.x,c.y),c.origEvnt=c,a._prevACpos=c));void 0!==a.Update&&a.Update(b);for(c=0;c<
a.getNumChildren();)void 0!==a.getChildAt(c)&&void 0!==a.getChildAt(c).Update&&a.getChildAt(c).Update(b),c++;b={compRef:a,interactionType:"onUpdate",data:a._options.onUpdateData};if(void 0!==a._options.onUpdate){if(a._options.onUpdate.constructor===Function)return a._options.onUpdate(b);if(a._options.onUpdate.constructor===String)return b.interactionType="Update",b.data=a._options.onUpdateData,D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(a._options.onUpdate,b)}}else if(void 0!==a.parent&&
null!==a.parent)return a.preInit()}}(this);this.setBitmapZpos=function(a){return function(b){var c;if(void 0!==b.zPos){if(b.zPos.constructor===Number)return c=b.zPos,1>=c?a.AssignZIndex(b,"bottom"):a.setChildIndex(b,b.zPos);if(b.zPos.constructor===String){if("bottom"===b.zPos||"top"===b.zPos)return a.AssignZIndex(b,b.zPos);if(-1!==b.zPos.indexOf("above "))return c=b.zPos.slice(6,b.zPos.length),a.AssignZIndex(b,"above",c);if(-1!==b.zPos.indexOf("below "))return c=b.zPos.slice(6,b.zPos.length),a.AssignZIndex(b,
"below",c)}return D2LAdventureEngine.gu_debugManager.log("Warning requested zPos for "+b.ID+" not recognized")}}}(this);this.setTextReadOrder=function(a){return function(){var b,c,d,f,g;if(D2LAdventureEngine.gu_AccessMode&&(b=document.getElementById("AE_sceneSection"),d=[],b)){for(c=0;c<D2LAdventureEngine.gu_ActiveTextCompObjects.length;)D2LAdventureEngine.gu_ActiveTextCompObjects[c].assoiatedSceneID===a.ID&&d.push(D2LAdventureEngine.gu_ActiveTextCompObjects[c]),c++;d.sort(function(a,b){return a._options.InitReadOrder-
b._options.InitReadOrder});for(c=0;c<d.length;){if(g=document.getElementById(d[c]._id+"_Wrapper"))d[c]._readOrderPos=c,d[c]._AriaFlowTo=void 0,b.appendChild(g);c++}c=0;for(b=[];c<d.length;)d[c+1]&&(f=d[c+1]._id+"_Wrapper",d[c]._AriaFlowTo=f,(g=document.getElementById(d[c]._id+"_Wrapper"))&&g.setAttribute("aria-flowto",f)),b.push(c++);return b}}}(this)}r(b,f);return b}(createjs.Container);window.D2LAdventureEngine.State=function(f){function b(a,c,d){this.ID=a;this.Adventure=c;this.initData=null!=d?
d:void 0;b.__super__.constructor.call(this);this.initialize();this.initialized=this.Active=!1;this.DisabledAssciotedText=[];this.DisabledAssciotedButtons=[];this.AvailibleScenes=[];this.CurrentScene=void 0;this.CustomFunctions=[];this.CustomWindows=[];this._initScene=this.QuizWindow=this.CurrentActiveWindow=void 0;this.Activate=function(a){return function(){a.Active=!0;if(!a.initialized)return a.preInit()}}(this);this.Deactivate=function(a){return function(){return a.Active=!1}}(this);this.HandleShutdownReq=
function(a){return function(){var b,c;a.Deactivate();void 0!==a.QuizWindow&&void 0!==a.QuizWindow.Destroy&&a.QuizWindow.Destroy();void 0!==a.CurrentActiveWindow&&void 0!==a.CurrentActiveWindow.Destroy&&a.CurrentActiveWindow.Destroy();c=0;for(b=[];c<a.AvailibleScenes.length;)void 0!==a.AvailibleScenes[c].HandleShutdownReq&&a.AvailibleScenes[c].HandleShutdownReq(),b.push(c++);return b}}(this);this.preInit=function(a){return function(){void 0!==a.initData&&a.BuildStateData();void 0!==a.Init&&a.Init();
return a.initialized=!0}}(this);this.AddNewScene=function(a){return function(b){var c,d;c=!1;for(d=0;d<a.AvailibleScenes.length;)a.AvailibleScenes[d]._id===b.ID&&(c=!0,window.D2LAdventureEngine.gu_debugManager.log("warning: a duplicate scene id:"+b.ID+" was ignored by AddNewScene")),d++;if(!c)return a.AvailibleScenes.push(b)}}(this);this.GetScene=function(a){return function(b){var c;for(c=0;c<a.AvailibleScenes.length;){if(a.AvailibleScenes[c]._id===b)return a.AvailibleScenes[c];c++}return!1}}(this);
this.GetCurrentScene=function(a){return function(){return a.CurrentScene}}(this);this.ChangeScene=function(a){return function(b){var c;for(c=0;c<a.AvailibleScenes.length;){if(a.AvailibleScenes[c]._id===b){a.RemoveBaseTextObjs(a.CurrentScene);a.removeChild(a.CurrentScene);a.CurrentScene=a.AvailibleScenes[c];D2LAdventureEngine.gu_AccessCursorDisabled||D2LAdventureEngine.gu_GUIManager.AccessCur.refreshCB();a.RenewBaseTextObjs();a.addChild(a.AvailibleScenes[c]);a.AvailibleScenes[c].preUpdate();D2LAdventureEngine.gu_ScreenReaderHelper.setSceneDesc(a.AvailibleScenes[c]);
if(void 0!==a.AvailibleScenes[c]._options.onEnter)if(b={compRef:a.AvailibleScenes[c],interactionType:"onEnter",data:a.AvailibleScenes[c]._options.onEnterData},a.AvailibleScenes[c]._options.onEnter.constructor===Function)a.AvailibleScenes[c]._options.onEnter(b);else a.AvailibleScenes[c]._options.onEnter.constructor===String&&D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(a.AvailibleScenes[c]._options.onEnter,b);return!0}c++}return!1}}(this);this.RemoveBaseTextObjs=function(a){return function(b){var c,
d,f,g,l,q;l=[];for(c=0;c<D2LAdventureEngine.gu_ActiveTextCompObjects.length;)D2LAdventureEngine.gu_ActiveTextCompObjects[c].assoiatedSceneID===b.ID&&l.push(D2LAdventureEngine.gu_ActiveTextCompObjects[c]),c++;for(c=0;c<l.length;){f=!1;for(d=0;d<b.DisabledAssciotedText.length;){if(b.DisabledAssciotedText[d]===l[c].compRef){f=!0;break}d++}if(!f){q=l[c].topGroup?l[c].topGroup._id:{state:a.ID,scene:a.CurrentScene.ID};g=l[c].getLocalPosistion();f=!1;for(d=0;d<b.DisabledAssciotedText.length;){if(b.DisabledAssciotedText[d].compRef.ID===
l[c]._id){f=!0;b.DisabledAssciotedText[d]={compRef:l[c].clone({initX:g.x,initY:g.y},!0),useParent:q};break}d++}f||b.DisabledAssciotedText.push({compRef:l[c].clone({initX:g.x,initY:g.y},!0),useParent:q})}l[c].Destroy(a);c++}}}(this);this.RenewBaseTextObjs=function(a){return function(){var b,c,d,f;c=0;for(d=[];c<a.CurrentScene.DisabledAssciotedText.length;)f=a.CurrentScene.DisabledAssciotedText[c],(b=D2LAdventureEngine.gu_ComponentManager.FindExistingComp(f.useParent))&&b.addComponet?b.addComponet(f.compRef):
f.useParent.scene&&(b=D2LAdventureEngine.gu_ComponentManager.BuildComponent(f.compRef,f.useParent),a.CurrentScene.addChild(b)),d.push(c++);return d}}(this);this.findComponent=function(a){return function(b){var c;for(c=0;c<a.AvailibleScenes.length;){if(!1!==a.AvailibleScenes[c].getComponetById(b))return a.AvailibleScenes[c].getComponetById(b);c++}return!1}}(this);this.getComponetsByPosition=function(a){return function(b){var c,d;c=[];for(d=0;d<a.AvailibleScenes.length;)a.AvailibleScenes[d].getComponetsByPosition&&
c.concat(a.AvailibleScenes[d].getComponetsByPosition(b)),d++;return c}}(this);this.BuildStateData=function(a){return function(){var b,c,d;c=0;for(b=[];c<a.initData.scenes.length;)D2LAdventureEngine.gu_JsonOps.parseAllRules(a.initData.scenes[c].initial)&&(a._InitOldOnRdy=a.initData.scenes[c].onReady,a.initData.scenes[c].onReady=function(b){a.CurrentScene=a._initScene;void 0!==a._InitOldOnRdy&&(a._InitOldOnRdy.constructor===Function?a._InitOldOnRdy():a._InitOldOnRdy.constructor===String&&(b.type="onReady",
D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(a._InitOldOnRdy,b)));D2LAdventureEngine.gu_ScreenReaderHelper.setSceneDesc(a.CurrentScene);a.CurrentScene.preUpdate();if(void 0!==a.CurrentScene._options.onEnter){b={compRef:a.CurrentScene,interactionType:"onEnter",data:a.CurrentScene._options.onEnterData};if(a.CurrentScene._options.onEnter.constructor===Function)return a.CurrentScene._options.onEnter(b);if(a.CurrentScene._options.onEnter.constructor===String)return D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(a.CurrentScene._options.onEnter,
b)}}),d=new window.D2LAdventureEngine.Scene(a.initData.scenes[c].ID,a.ID,a.initData.scenes[c]),D2LAdventureEngine.gu_JsonOps.parseAllRules(a.initData.scenes[c].initial)&&(a._initScene=d,a.addChild(a._initScene)),a.AddNewScene(d),b.push(c++);return b}}(this);this.HandleDimentionChange=function(a){return function(b,c){var d,f;a.height=c;a.width=b;f=0;for(d=[];f<a.AvailibleScenes.length;)void 0!==a.AvailibleScenes[f].HandleDimentionChange&&a.AvailibleScenes[f].HandleDimentionChange(b,c),d.push(f++);
return d}}(this);this.preUpdate=function(a){return function(b){var c;if(a.CurrentScene)a.CurrentScene.preUpdate(b);else for(c=0;c<a.AvailibleScenes.length;)void 0!==a.AvailibleScenes[c].preUpdate&&a.AvailibleScenes[c].preUpdate(b),c++;for(c=0;c<a.CustomWindows.length;)a.CustomWindows[c].Update(b),c++;if(void 0!==a.QuizWindow)return a.QuizWindow.Update(b)}}(this);this.preHandleResizeEvent=function(a){return function(b){if(void 0!==a.CurrentScene)return a.CurrentScene.preHandleResizeEvent(b)}}(this);
this.preHandleWinScrollEvent=function(a){return function(){if(void 0!==a.CurrentScene)return a.CurrentScene.preHandleWinScrollEvent()}}(this);this.preHandleMouseOut=function(a){return function(b){if(void 0!==a.CurrentScene)return a.CurrentScene.preHandleMouseOut(b)}}(this);this.preHandleMouseMove=function(a){return function(b){if(void 0!==a.CurrentScene)return a.CurrentScene.preHandleMouseMove(b)}}(this);this.preHandleMouseMoveOver=function(a){return function(b){if(void 0!==a.CurrentScene)return a.CurrentScene.preHandleMouseMoveOver(b)}}(this);
this.preHandleMouseOver=function(a){return function(b){if(void 0!==a.CurrentScene)return a.CurrentScene.preHandleMouseOver(b)}}(this);this.preHandleMouseWheel=function(a){return function(b){if(void 0!==a.CurrentScene)return a.CurrentScene.preHandleMouseWheel(b)}}(this);this.HandleSceneKeyUpReq=function(a){return function(b){if(void 0!==a.CurrentScene)return a.CurrentScene.HandleKeyUpReq(b)}}(this);this.HandleSceneKeyDownReq=function(a){return function(b){if(void 0!==a.CurrentScene)return a.CurrentScene.HandleKeyDownReq(b)}}(this);
this.preHandleMouseUp=function(a){return function(b){if(void 0!==a.CurrentScene)return a.CurrentScene.preHandleMouseUp(b)}}(this);this.preHandleMouseUpOver=function(a){return function(b){if(void 0!==a.CurrentScene)return a.CurrentScene.preHandleMouseUp(b)}}(this);this.preHandleMouseDown=function(a){return function(b){if(void 0!==a.CurrentScene)return a.CurrentScene.preHandleMouseDown(b)}}(this);this.preHandleDoubleClick=function(a){return function(b){if(void 0!==a.CurrentScene)return a.CurrentScene.preHandleDoubleClick(b)}}(this)}
r(b,f);return b}(createjs.Container);window.D2LAdventureEngine.SplashView=function(f){function b(a,c){var d;this.ID=a;this.SS_options=c;this.getResource=g(this.getResource,this);this.CallTween=g(this.CallTween,this);this.SetCustomTweens=g(this.SetCustomTweens,this);this.callCustomFunction=g(this.callCustomFunction,this);this.SetCustomFunctions=g(this.SetCustomFunctions,this);this.play=g(this.play,this);this.callEnd=g(this.callEnd,this);this.handleClickEvent=g(this.handleClickEvent,this);this.Init=
g(this.Init,this);this.GetScene=g(this.GetScene,this);this.getDefaultData=g(this.getDefaultData,this);void 0===this.ID&&(this.ID="SplashScreen");void 0===this.SS_options&&(this.SS_options={});(d=this.getDefaultData())&&void 0===this.SS_options.useTextOptions&&(this.SS_options.useTextOptions=d.SS_options.useTextOptions);this.closeFunc=void 0;this._clickCallMade=this._allowClick=!1;this._requestedBG=void 0;this.CurrentScene=this;this._CustomFunctions=[];this._CustomTweens=[];this.SS_options.initOnStageAdd=
!1;this.SS_options.onInitOveride=this.InitOveride;this.SS_options.initCompData=this.SS_options.components;this._requestedBG=this.SS_options.BackgroundBitmap;this.SS_options.BackgroundBitmap="none";b.__super__.constructor.call(this,this.ID,"none",this.SS_options)}r(b,f);b.prototype.ID=void 0;b.prototype.SS_options=void 0;b.prototype.completeCall=void 0;b.prototype.getDefaultData=function(){var a,b;a=D2LAdventureEngine.venture.AvaililbleSplash;for(b=0;b<a.length;){if("defaultD2LSpash"===a[b].ID)return a[b];
b++}return!1};b.prototype.GetScene=function(){return this};b.prototype.Init=function(){void 0!==this._requestedBG&&(this._requestedBG=this.getResource(this._requestedBG,"Bitmap"),this.addChildAt(this._requestedBG,0));this.SS_options.customFunctions&&this.SetCustomFunctions(this.SS_options.customFunctions);this.SS_options.Tweens&&this.SetCustomTweens(this.SS_options.Tweens);if(this.SS_options.onEnter)if(this.SS_options.onEnter.constructor===Function)this.SS_options.onEnter();else this.SS_options.onEnter.constructor===
String&&this.callCustomFunction(this.SS_options.onEnter);return this.addEventListener("click",this.handleClickEvent)};b.prototype.handleClickEvent=function(){if(this._allowClick&&void 0!==this.closeFunc)return this._clickCallMade=!0,this.callEnd()};b.prototype.callEnd=function(){this.removeAllEventListeners("click");this._allowClick=!0;window.D2LAdventureEngine.gu_InWinButtonLock=!1;void 0!==this.closeFunc&&this.closeFunc();if(void 0!==this.completeCall)return this.completeCall()};b.prototype.play=
function(a){this.completeCall=a;for(a=0;a<this.numChildren;)void 0!==this.getChildAt(a)&&void 0!==this.getChildAt(a).Update&&this.getChildAt(a).Update(),a++;if(void 0!==this.SS_options.onPlay){window.D2LAdventureEngine.gu_InWinButtonLock=!0;if(this.SS_options.onPlay.constructor===Function)return this.SS_options.onPlay();if(this.SS_options.onPlay.constructor===String)return this.callCustomFunction(this.SS_options.onPlay)}else if(!1===this.SS_options.endOnClick)return this.callEnd()};b.prototype.SetCustomFunctions=
function(a){var b,d,m,h;b=0;for(m=[];b<a.length;){a[b].TargState="SplashScreen";a[b].TargScene=this.ID;this._CustomFunctions.push({ID:a[b].ID,params:[]});for(d=0;d<a[b].Effects.length;){for(h=0;h<a[b].Effects[d].params.length;)this._CustomFunctions[this._CustomFunctions.length-1].params.push(a[b].Effects[d].params[h]),h++;D2LAdventureEngine.gu_CustomFunctionsManager.DefineFunction(this._CustomFunctions[this._CustomFunctions.length-1],a[b].Effects[d],a[b].TargState,a[b].TargScene,a[b].Effects[d].Target);
d++}m.push(b++)}return m};b.prototype.callCustomFunction=function(a,b){var d,m,h,f;d=!1;for(m=0;m<this._CustomFunctions.length;){if(this._CustomFunctions[m].ID===a)for(h=0;h<Object.keys(this._CustomFunctions[m]).length;)f=this._CustomFunctions[m][Object.keys(this._CustomFunctions[m])[h]],f.constructor===Function&&(f(b),d=!0),h++;m++}d||D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(a)||D2LAdventureEngine.gu_debugManager.log("Custom Function ID "+a+" was not found as custom, or global, and will be ignored");
return d};b.prototype.SetCustomTweens=function(a){var b,d;if(void 0!==a&&null!==a){b=0;for(d=[];b<a.length;)null===a[b]||void 0===a[b]?D2LAdventureEngine.gu_debugManager.log("Custom Tween ID "+a[b]+" has no data and will be ignored"):(null!==a[b].effects&&void 0!==a[b].effects&&(a[b].effects=D2LAdventureEngine.gu_JsonOps.parseConverstionRules(a[b].effects)),this._CustomTweens.push(a[b])),d.push(b++);return d}};b.prototype.CallTween=function(a,b){var d,m,h,f;for(m=0;m<this._CustomTweens.length;)this._CustomTweens[m].ID===
a&&(d=D2LAdventureEngine.gu_JsonOps.parseAllRules(this._CustomTweens[m]),f=createjs.Tween.get(b),void 0!==d.wait&&null!==d.wait&&f.wait(d.wait),void 0!==d.effects&&null!==d.effects&&void 0!==d.tempo&&null!==d.tempo&&(h=D2LAdventureEngine.gu_JsonOps.parseReferanceRules(d.effects,b),void 0!==d.ease&&null!==d.ease?void 0===d.easeParams?f.to(h,d.tempo,createjs.Ease[d.ease]):f.to(h,d.tempo,createjs.Ease[d.ease](d.easeParams[0],d.easeParams[1])):f.to(h,d.tempo)),void 0!==d.onComplete&&null!==d.onComplete&&
(d=function(a){return function(b){return a.callCustomFunction(a._CustomTweens[b].onComplete)}}(this),f.call(d,[m]))),m++};b.prototype.getResource=function(a,b,d){var m,h,f;a=D2LAdventureEngine.gu_JsonOps.parseAllRules(a);a.constructor===String?(m=a,a={}):m=a.ID;if("Bitmap"===b){void 0===a.AssetID&&(a.AssetID=m);for(d=0;d<D2LAdventureEngine.gu_PreloadAssets.length;)D2LAdventureEngine.gu_PreloadAssets[d].AssetID===a.AssetID&&(m=D2LAdventureEngine.gu_JsonOps.parseAllRules(D2LAdventureEngine.gu_PreloadAssets[d].AssetLocation),
a.crossOrigin?(m=D2LAdventureEngine.gu_EngineLoc+"/"+m,h=new createjs.LoadQueue,m=(new createjs.LoadItem).set({src:m,crossOrigin:a.crossOrigin}),h.loadFile(m)):f=new createjs.Bitmap(D2LAdventureEngine.gu_EngineLoc+"/"+m)),d++;d=function(m){return function(m){var d;m.item?(b=m.item.type,b===createjs.LoadQueue.IMAGE&&(d=m.result),f=-1!==d.src.indexOf("http")?new createjs.Bitmap(d.src):new createjs.Bitmap(D2LAdventureEngine.gu_EngineLoc+"/"+d.src)):f=m;f._id=a.ID;void 0===a.initX&&(a.initX=0);void 0===
a.initY&&(a.initY=0);f.x=a.initX;f.y=a.initY;f.width=a.naturalWidth;f.height=a.naturalHeight;f.regX=void 0===a.initRegX||null===a.initRegX?0:a.initRegX;f.regY=void 0===a.initRegY||null===a.initRegY?0:a.initRegY;return f}}(this);return h?h.on("fileload",d,null,!0):d(f)}if(0===b.indexOf("Shape"))return h=D2LAdventureEngine.gu_ComponentManager.BuildComponent(a,{state:"SPLASH",scene:"SPLASH"},this),h.Update(),d&&d(h),h;if("Static Text"===b)return void 0===a.font&&(a.font="12px "+D2LAdventureEngine.gu_CSSManager._globalDefaultFont),
void 0===a.color&&(a.color="#000000"),void 0===a.initWidth&&(a.initWidth=200),void 0===a.initX&&(a.initX=0),void 0===a.initY&&(a.initY=0),void 0===a.align&&(a.align="center"),h=new createjs.Text(a.InitText,a.font,a.color),h.textAlign=a.align,h.lineWidth=a.initWidth,"center"===a.align&&(h.regX=-a.initWidth/2),h.x=a.initX,h.y=a.initY,h._id=a.ID,h;if("Sprite"===b){void 0===a.AssetID&&(a.AssetID=m);for(d=0;d<D2LAdventureEngine.gu_PreloadAssets.length;){h=D2LAdventureEngine.gu_PreloadAssets[d];if(h.AssetID===
a.AssetID){h={images:[D2LAdventureEngine.gu_EngineLoc+"/"+h.AssetLocation],frames:h.spriteFrameData,animations:h.animationsData};h=new createjs.Sprite(new createjs.SpriteSheet(h));h._id=a.ID;void 0===a.initX&&(a.initX=0);void 0===a.initY&&(a.initY=0);h.x=a.initX;h.y=a.initY;h.width=a.naturalWidth;h.height=a.naturalHeight;h.regX=void 0===a.initRegX||null===a.initRegX?0:a.initRegX;h.regY=void 0===a.initRegY||null===a.initRegY?0:a.initRegY;void 0!==a.initAnimation&&h.play(a.initAnimation);if(void 0!==
a.animationend)if(a.animationend.constructor===Function)h.animationend=a.animationend;else h.on("animationend",function(b){return function(c){return b.callCustomFunction(a.animationend)}}(this));return h}d++}return alert("Preloader getResource could not find "+m+" check preloaderAssets in AssetData to ensure the AssetID matches")}return"createjsObject"===b?(h=0===a.object.indexOf("[%js]")?D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(a.object):D2LAdventureEngine.gu_JsonOps.parseConverstionRules(a.object),
h._id=a.ID,h):alert("ERROR!! Preloader getResource only supports bitmaps, sprites and shapes at this time ")};return b}(window.D2LAdventureEngine.BaseView);window.D2LAdventureEngine.Scene=function(f){function b(a,c,d){this._id=null!=a?a:"unamedScene";this.assoiatedStateID=null!=c?c:"none";this._options=null!=d?d:{initX:null,initY:null,initWidth:null,initHeight:null,initCompData:null,initWindowData:null,ShowRulers:!1,BackgroundBitmap:void 0,SceneDescription:void 0,PanStyle:"none",initial:!1,FollowTarget:void 0,
FollowOffsetX:0,FollowOffsetY:0,disableZoom:!1,MouseWheelZoom:!1,keyPanOveride:void 0,keyPanSpeed:void 0,keyPanShiftSpeed:void 0,keyZoomSpeed:void 0,keyZoomShiftSpeed:void 0,clickToCenter:!1,onReady:void 0,onReadyData:void 0,onEnter:void 0,onEnterData:void 0};this._options.initCompData=this._options.components;this.DisabledAssciotedText=[];this.followTargMem={};b.__super__.constructor.call(this,this._id,this.assoiatedStateID,this._options);this._BitmapLayersSet=!1;this._options.SceneDescription=void 0===
this._options.SceneDescription?"Current Scene Description: "+this.ID:"Current Scene Description: "+this._options.SceneDescription;void 0===this._options.PanStyle&&(this._options.PanStyle="none");void 0===this._options.FollowOffsetX&&(this._options.FollowOffsetX=0);void 0===this._options.FollowOffsetY&&(this._options.FollowOffsetY=0);void 0===this._options.disableZoom&&(this._options.disableZoom=!1);void 0===this._options.keyPanOveride&&(this._options.keyPanOveride="none"===this._options.PanStyle?
!0:!1);this.Init=function(a){return function(){var b;void 0===a._options.PanStyle&&(a._options.PanStyle="none");a._autoHorizontalSpeed=10;a._autoVerticalSpeed=0;a._keyPanSpeed=void 0!==a._options.keyPanSpeed?a._options.keyPanSpeed:15;a._SftKeyPanSpeed=void 0!==a._options.keyPanShiftSpeed?a._options.keyPanShiftSpeed:5;a._keyZoomSpeed=void 0!==a._options.keyZoomSpeed?a._options.keyZoomSpeed:.08;a._SftKeyZoomSpeed=void 0!==a._options.keyZoomShiftSpeed?a._options.keyZoomShiftSpeed:.04;a._MouseSpeed=15;
a._MouseEdgeSense=30;a._MovingHDir="none";a._MovingVDir="none";a._ZoomingDir="none";a._ZoomInLimit=2;a._ZoomOutLimit=.5;a._choicePanSpeed=5;a._choiceZoomSpeed=.8;a._MouseWheelZoomSpeed=.05;"none"!==a._options.BackgroundBitmap&&a._bgIMG.addEventListener("click",function(){if(!window.D2LAdventureEngine.gu_InWinButtonLock&&a._options.clickToCenter)return a.VeiwContainer.x+=-(a.stage.mouseX-window.D2LAdventureEngine.gu_canDi.width/2),a.VeiwContainer.y+=-(a.stage.mouseY-window.D2LAdventureEngine.gu_canDi.height/
2)});a._initialized=!0;b={compRef:a,interactionType:"onReady",data:a._options.onReadyData};if(void 0!==a._options.onReady){if(a._options.onReady.constructor===Function)return a._options.onReady(b);if(a._options.onReady.constructor===String)return D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(a._options.onReady,b)}}}(this);this.NudgeScene=function(a){return function(b,c,d){if(!a._options.keyPanOveride||!d){if("left"===b||"right"===b||"up"===b||"down"===b)a._choicePanSpeed="fast"===c?
a._SftKeyPanSpeed:a._keyPanSpeed;else if("in"===b||"out"===b)a._choiceZoomSpeed="fast"===c?a._SftKeyZoomSpeed:a._keyZoomSpeed;return"left"===b||"right"===b?"stop"===c?a._MovingHDir="none":a._MovingHDir=b:"up"===b||"down"===b?"stop"===c?a._MovingVDir="none":a._MovingVDir=b:"in"===b||"out"===b?"stop"===c?a._ZoomingDir="none":a._ZoomingDir=b:window.D2LAdventureEngine.gu_debugManager.log("ERROR!: dir "+b+" not recongized as a SCENE direction")}}}(this);this.HandleMouseMove=function(a){return function(b){if("mouseEdge"===
a._options.PanStyle&&a._initialized&&b.y>a.y&&b.y<a.y+a.ViewMask.height&&b.x>a.x&&b.x<a.x+a.ViewMask.width)return b.x<a._MouseEdgeSense+a.x?(a._MovingHDir="left",a._choicePanSpeed=a._MouseSpeed):b.x>a.x+a.ViewMask.width-a._MouseEdgeSense?(a._MovingHDir="right",a._choicePanSpeed=a._MouseSpeed):a._MovingHDir="none",b.y<a._MouseEdgeSense+a.y?(a._MovingVDir="up",a._choicePanSpeed=a._MouseSpeed):b.y>a.y+a.ViewMask.height-a._MouseEdgeSense?(a._MovingVDir="down",a._choicePanSpeed=a._MouseSpeed):a._MovingVDir=
"none"}}(this);this.HandleMouseWheel=function(a){return function(b){var c;if(a._options.MouseWheelZoom&&!window.D2LAdventureEngine.gu_InWinButtonLock&&a._initialized&&(0>b.wheelDelta&&a.scaleX>a._ZoomOutLimit?(a.scaleX-=a._MouseWheelZoomSpeed,a.scaleY-=a._MouseWheelZoomSpeed,c=!0):0<b.wheelDelta&&a.scaleX<a._ZoomInLimit&&(a.scaleX+=a._MouseWheelZoomSpeed,a.scaleY+=a._MouseWheelZoomSpeed,c=!0),c&&"none"!==a._options.BackgroundBitmap))return a.width=a._bgIMG.width*a.scaleX,a.height=a._bgIMG.height*
a.scaleY}}(this);this.CenterToPoint=function(a){return function(b,c){a.VeiwContainer.x=-b+D2LAdventureEngine.gu_canDi.width/2;a.VeiwContainer.y=-c+D2LAdventureEngine.gu_canDi.height/2;0<a.VeiwContainer.x?a.VeiwContainer.x=0:a.VeiwContainer.x<-(a.VeiwContainer.width-a.ViewMask.width)&&(a.VeiwContainer.x=-(a.VeiwContainer.width-a.ViewMask.width));if(0<a.VeiwContainer.y)return a.VeiwContainer.y=0;if(a.VeiwContainer.y<-(a.VeiwContainer.height-a.ViewMask.height))return a.VeiwContainer.y=-(a.VeiwContainer.height-
a.ViewMask.height)}}(this);this.Update=function(a){return function(b){var c;if(!window.D2LAdventureEngine.gu_InWinButtonLock&&(a._BitmapLayersSet=!0,null!==a.stage)){if("mouseEdge"===a._options.PanStyle&&a.stage.mouseInBounds||"keyOnly"===a._options.PanStyle)"left"===a._MovingHDir?a.VeiwContainer.x+=a._choicePanSpeed:"right"===a._MovingHDir&&(a.VeiwContainer.x-=a._choicePanSpeed),0<a.VeiwContainer.x?a.VeiwContainer.x=0:a.VeiwContainer.x<-(a.VeiwContainer.width-a.ViewMask.width)&&(a.VeiwContainer.x=
-(a.VeiwContainer.width-a.ViewMask.width)),"up"===a._MovingVDir?a.VeiwContainer.y+=a._choicePanSpeed:"down"===a._MovingVDir&&(a.VeiwContainer.y-=a._choicePanSpeed),0<a.VeiwContainer.y?a.VeiwContainer.y=0:a.VeiwContainer.y<-(a.VeiwContainer.height-a.ViewMask.height)&&(a.VeiwContainer.y=-(a.VeiwContainer.height-a.ViewMask.height)),"in"===a._ZoomingDir&&a.VeiwContainer.scaleX>a._ZoomOutLimit&&(a.VeiwContainer.scaleX-=a._choiceZoomSpeed,a.VeiwContainer.scaleY-=a._choiceZoomSpeed),"out"===a._ZoomingDir&&
a.VeiwContainer.scaleX<a._ZoomInLimit&&(a.VeiwContainer.scaleX+=a._choiceZoomSpeed,a.VeiwContainer.scaleY+=a._choiceZoomSpeed);"auto"!==a._options.PanStyle||window.D2LAdventureEngine.gu_InWinButtonLock||(a.VeiwContainer.x-=a._autoHorizontalSpeed,a.VeiwContainer.y-=a._autoVerticalSpeed);"none"!==a._options.BackgroundBitmap&&void 0!==a._bgIMG&&a._bgIMG.constructor===D2LAdventureEngine.comp_bitmap&&null!==a._bgIMG._image.sourceRect&&(a._bgIMG._image.sourceRect.x!==a.VeiwContainer.x*a.VeiwContainer.scaleX&&
(a._bgIMG._image.x=-a.VeiwContainer.x/a.VeiwContainer.scaleX,a._bgIMG._image.sourceRect.x=a.VeiwContainer.x/a.VeiwContainer.scaleX),a._bgIMG._image.sourceRect.y!==a.VeiwContainer.y*a.VeiwContainer.scaleY&&(a._bgIMG._image.y=-a.VeiwContainer.y/a.VeiwContainer.scaleY,a._bgIMG._image.sourceRect.y=a.VeiwContainer.y/a.VeiwContainer.scaleY),a._bgIMG._image.sourceRect.width!==a.ViewMask.width/a.VeiwContainer.scaleX&&(a._bgIMG._image.sourceRect.width=a.ViewMask.width/a.VeiwContainer.scaleX),a._bgIMG._image.sourceRect.height!==
a.ViewMask.height/a.VeiwContainer.scaleY&&(a._bgIMG._image.sourceRect.height=a.ViewMask.height/a.VeiwContainer.scaleY));if("follow"===a._options.PanStyle&&!window.D2LAdventureEngine.gu_InWinButtonLock&&a._initialized)if(void 0!==a._options.FollowTarget){if(c=a.getComponetById(a._options.FollowTarget),b={x:c.x,y:c.y},!1!==c&&(a.followTargMem.x!==b.x||a.followTargMem.y!==b.y))return a.followTargMem=b,a.CenterToPoint(c.x+a._options.FollowOffsetX,c.y+a._options.FollowOffsetY)}else return D2LAdventureEngine.gu_debugManager.log("Warning!! "+
a.ID+" PanStyle is 'follow' but FollowTarget is undefined")}}}(this)}r(b,f);return b}(window.D2LAdventureEngine.BaseView);window.D2LAdventureEngine.Quiz=function(f){function b(a,c,d){this._name=null!=a?a:"unamedQuiz";this._completionFucntion=c;this._DomRect=d;b.__super__.constructor.call(this);this.initialize();this._setQuiz=this.useFade=void 0;this._questionData=[];this._CurrentQuestionNumber=1;this._initialized=!1;this._answerCluster=void 0;this._prevOn=this._scrollWarningFadeCall=!1;this._UserAnswerData=
[];this._questionSlideSet=!1;this._scorePercent=this._scorePosible=this._score=0;this._failed=this._passed=this._completed=!1;this._timeTaken=0;this._scoresOnCompletion=[];this.checkBoxData=this.radioButtonData=void 0;this._togImgUrlDefault=D2LAdventureEngine.gu_EngineLoc+"/lib/Default/Sprites/QuizToggles.png";this.Init=function(a){return function(){a.setQuizData();void 0!==a._setQuiz.useFade&&!1===a._setQuiz.useFade&&(a.parent.removeChild(a.parent._screen),a.parent._options.usefade=!1);a.convertToggleData();
a.ConstructBaseDom();a.SetQuestionSlide();a.setButtons();return a._initialized=!0}}(this);this.paseJSONRules=function(a){return function(a){return D2LAdventureEngine.gu_JsonOps.parseConverstionRules(a)}}(this);this.setQuizData=function(a){return function(){var b,c;for(c=0;c<D2LAdventureEngine.gu_QuizInitData.length;){if(D2LAdventureEngine.gu_QuizInitData[c].ID===a._name)for(a._setQuiz=a.paseJSONRules(D2LAdventureEngine.gu_QuizInitData[c]),a.allowPrevious=!0===D2LAdventureEngine.gu_QuizInitData[c].allowPrev?
!0:!1,b=0;b<D2LAdventureEngine.gu_QuizInitData[c].Questions.length;)a._questionData.push(a._setQuiz.Questions[b]),b++;c++}if(void 0===a._setQuiz)return D2LAdventureEngine.gu_debugManager.log("ERROR! Quiz "+a._name+" not found in QuizData")}}(this);this.ConstructBaseDom=function(a){return function(){if(!a._setQuiz.HideTitle)return a.TitleText=new D2LAdventureEngine.comp_Text("quizTitle",void 0,"<h2 class='AE_QuizTitle'>"+a._name+"</h2>",{initX:a._DomRect.x+10,initY:a._DomRect.y-15,initWidth:a._DomRect.width-
40,overflow:"hidden"}),a.addChild(a.TitleText)}}(this);this.SetQuestionSlide=function(a){return function(){a._questionSlideSet?(a._setQuiz.HideQuestionNumber||a.currQuestionText.ChangeText(a._CurrentQuestionNumber+" "+D2LAdventureEngine.gu_QuizOptions.langOf+" "+a._questionData.length),a.questionText.ChangeText(a._questionData[a._CurrentQuestionNumber-1].questionText)):(a._setQuiz.HideTitle?(a._setQuiz.HideQuestionNumber||(a.currQuestionText=new D2LAdventureEngine.comp_Text("quizCurrQuestionText",
void 0,D2LAdventureEngine.gu_QuizOptions.langQuestion+": "+a._CurrentQuestionNumber+" "+D2LAdventureEngine.gu_QuizOptions.langOf+" "+a._questionData.length,{initX:a._DomRect.x+10,initY:a._DomRect.y+5,initWidth:a._DomRect.width-40}),a.addChild(a.currQuestionText)),a.questionText=new D2LAdventureEngine.comp_Text("quizQuestionText",void 0,"<span class='AE_QuizQuestionText'>"+a._questionData[a._CurrentQuestionNumber-1].questionText+"</span>",{initX:a._DomRect.x+10,initY:a._DomRect.y+25,initWidth:a._DomRect.width+
20,initHeight:.9*a._DomRect.height,tabEnabled:!0,overflow:"y-auto"})):(a._setQuiz.HideQuestionNumber||(a.currQuestionText=new D2LAdventureEngine.comp_Text("quizCurrQuestionText",void 0,D2LAdventureEngine.gu_QuizOptions.langQuestion+": "+a._CurrentQuestionNumber+" "+D2LAdventureEngine.gu_QuizOptions.langOf+" "+a._questionData.length,{initX:a._DomRect.x+10,initY:a._DomRect.y+40,initWidth:a._DomRect.width-40}),a.addChild(a.currQuestionText)),a.questionText=new D2LAdventureEngine.comp_Text("quizQuestionText",
void 0,"<span class='AE_QuizQuestionText'>"+a._questionData[a._CurrentQuestionNumber-1].questionText+"</span>",{initX:a._DomRect.x+10,initY:a._DomRect.y+70,initWidth:a._DomRect.width+20,initHeight:.75*a._DomRect.height,tabEnabled:!0,overflow:"y-auto"})),a.addChild(a.questionText));a._setQuiz.HideQuestionNumber||a.currQuestionText.Update();a.questionText.Update();a.SetQuestionText();return a._questionSlideSet=!0}}(this);this.SetQuestionText=function(a){return function(){var b,c;a._UserAnswerData[a._CurrentQuestionNumber-
1]={choosenAnswerIndices:[],choosenAnswerText:[]};a.questionText.AppendText('<table cellpadding="0" class=\'AE_QuizTable\' style="width:85%; border-cellspacing:1; border-collapse:collapse; margin-left:auto; margin-top:4em; margin-right:auto;" border="'+2*window.D2LAdventureEngine.gu_canDi.scaleFactor+'px, #000000, solid">');for(b=0;b<a._questionData[a._CurrentQuestionNumber-1].Answers.length;)a.questionText.AppendText(" <tr tabindex='"+(b+1)+"', id=\""+a._name+"_Button_"+b+'", onclick ="window.D2LAdventureEngine.gu_StateManager.GetCurrStateRef().QuizWindow._currentPopContent.PreformOnSelection('+
b+') " > <td aria-hidden="true" style="width:7%; border:'+2*window.D2LAdventureEngine.gu_canDi.scaleFactor+'px, #000000, solid;">'),a._questionData[a._CurrentQuestionNumber-1].multiAnswer?a.questionText.AppendText(' <div aria-hidden="true" id="AnswerTog_'+b+'", checked="false", style="margin:auto; width:'+a.checkBoxData.width+"px; height:"+a.checkBoxData.height+"px; background:url("+a.checkBoxData.fileLoc+") "+a.checkBoxData.stateCoords.inactiveNormal+';" > '):a.questionText.AppendText(' <div id="AnswerTog_'+
b+'", style=" margin:auto; width:'+a.radioButtonData.width+"px; height:"+a.radioButtonData.height+"px; background:url("+a.radioButtonData.fileLoc+") "+a.radioButtonData.stateCoords.inactiveNormal+';" > '),a.questionText.AppendText("</td> <td role ='option' style=\"width:93%; text-align:left; border:thin, #000000, solid; \"> <p class='AE_QuizAnswerText' style=\"padding-left: "+10*window.D2LAdventureEngine.gu_canDi.scaleFactor+"px; padding-right: "+10*window.D2LAdventureEngine.gu_canDi.scaleFactor+
'px;">'+a._questionData[a._CurrentQuestionNumber-1].Answers[b].ansText+"</p></td></tr> "),c=a.convertDomToAcess(document.getElementById(a._name+"_Button_"+b),b),window.D2LAdventureEngine.gu_TabManager.AssignAccessObject(c),b++;a.questionText.AppendText("</table>");return document.getElementById("quizQuestionText_Wrapper").scrollHeight>document.getElementById("quizQuestionText_Wrapper").offsetHeight?(a.FlashScrollWarning(),window.D2LAdventureEngine.gu_KeyManager.SetScrollingTarg(document.getElementById("quizQuestionText_Wrapper")),
document.getElementById("quizQuestionText_Wrapper").onscroll=function(){window.D2LAdventureEngine.gu_StateManager.GetCurrStateRef().QuizWindow._currentPopContent._scrollWarningFadeCall=!0;return document.getElementById("quizQuestionText_Wrapper").onscroll=void 0}):document.getElementById("quizQuestionText_Wrapper").onscroll=void 0}}(this);this.convertDomToAcess=function(a){return function(a,b){a.HandleFocus=function(b){return document.getElementById(a.id).focus()};a.HandleUnfocus=function(b){return document.getElementById(a.id).blur()};
a.HandleFocusActivation=function(a){return window.D2LAdventureEngine.gu_StateManager.GetCurrStateRef().QuizWindow._currentPopContent.PreformOnSelection(b)};a.HandleFocusDeactivation=function(a){};return a}}(this);this.disableToggleAccess=function(a){return function(){var b;for(b=0;b<a._questionData[a._CurrentQuestionNumber-1].Answers.length;)window.D2LAdventureEngine.gu_TabManager.UnassignAccessObject(document.getElementById(a._name+"_Button_"+b)),b++;return window.D2LAdventureEngine.gu_TabManager.HandleAccessModeDeactivation()}}(this);
this.FlashScrollWarning=function(a){return function(){a.scrollWarning=new D2LAdventureEngine.comp_Text("scrollWarning",void 0,D2LAdventureEngine.gu_QuizOptions.scrollWarning,{initX:a._DomRect.width,initY:a._DomRect.height+110,initWidth:150,sizeBoost:-5,color:"#F00",border:"#F00 2px solid",backgroundColor:"#FFF",zIndex:200,padding:{left:10,right:10}});return a.addChild(a.scrollWarning)}}(this);this.setButtons=function(a){return function(){a._btn_next=new D2LAdventureEngine.comp_Button("wd_next","none",
{initX:a._DomRect.x+a._DomRect.width/2-55,initY:a._DomRect.y+a._DomRect.height,InWinLockOverride:!0,initDisabled:!0,onClick:a.CallNext});a._btn_ok=new D2LAdventureEngine.comp_Button("wd_ok","none",{initX:a._DomRect.x+a._DomRect.width/2-55,initY:a._DomRect.y+a._DomRect.height,InWinLockOverride:!0,onClick:a.HandleCompletion});a._btn_prev=new D2LAdventureEngine.comp_Button("wd_prev","none",{initX:a._DomRect.x+a._DomRect.width/2-180,initY:a._DomRect.y+a._DomRect.height,InWinLockOverride:!0,onClick:a.CallPrev});
void 0===a._setQuiz.useSubmitButton?a._btn_submit=new D2LAdventureEngine.comp_Button("wd_submit","none",{initX:a._DomRect.x+a._DomRect.width/2-55,initY:a._DomRect.y+a._DomRect.height,InWinLockOverride:!0,initDisabled:!0,onClick:a.CallNext}):(a._setQuiz.useSubmitButton.ID=a._name+"_SubmitButton",a._setQuiz.useSubmitButton.interactive=!0,a._setQuiz.useSubmitButton.onClick=a.CallNext,a._setQuiz.useSubmitButton.initDisabled=!0,a._setQuiz.useSubmitButton.InWinLockOverride=!0,a._btn_submit=D2LAdventureEngine.gu_ComponentManager.BuildComponent(a._setQuiz.useSubmitButton,
"none"));return 1===a._questionData.length?a.addChild(a._btn_submit):a.addChild(a._btn_next)}}(this);this.convertToggleData=function(a){return function(){var b,c;c=function(a){var b,c,d,m,f;f=a._sprite.spriteSheet.data.AssetLocation;b=a._sprite.spriteSheet._data;c=a._sprite.spriteSheet._frames;d=c[b.inactiveNorm.frames[0]].rect;m=c[b.inactiveOver.frames[0]].rect;a=c[b.activeNorm.frames[0]].rect;b=c[b.activeOver.frames[0]].rect;return{fileLoc:f,width:d.width,height:d.height,stateCoords:{inactiveNormal:"-"+
d.x+"px -"+d.y+"px",activeNormal:"-"+a.x+"px -"+a.y+"px",inactiveOver:"-"+m.x+"px -"+m.y+"px",activeOver:"-"+b.x+"px -"+b.y+"px"}}};if(void 0!==a._setQuiz.useRadioBtn){if(a._setQuiz.useRadioBtn.constructor===String&&(b={_sprite:window.D2LAdventureEngine.gu_ResourceManager.get(a._setQuiz.useRadioBtn,"sprite")}),a._setQuiz.useRadioBtn.constructor===D2LAdventureEngine.comp_Toggle||b)b?(a.radioButtonData=c(b),b=void 0):a.radioButtonData=c(a._setQuiz.useRadioBtn)}else a.radioButtonData={fileLoc:a._togImgUrlDefault,
width:20,height:20,stateCoords:{inactiveNormal:"-64px -2px",activeNormal:"-43px -2px",inactiveOver:"-64px -2px",activeOver:"-43px -2px"}};if(void 0!==a._setQuiz.useCheckBox){if(a._setQuiz.useCheckBox.constructor===String&&(b={_sprite:window.D2LAdventureEngine.gu_ResourceManager.get(a._setQuiz.useCheckBox,"sprite")}),a._setQuiz.useCheckBox.constructor===D2LAdventureEngine.comp_Toggle||b)return b?(a.checkBoxData=c(b),b=void 0):a.checkBoxData=c(a._setQuiz.useCheckBox)}else return a.checkBoxData={fileLoc:a._togImgUrlDefault,
width:20,height:20,stateCoords:{inactiveNormal:"-23px -2px",activeNormal:"-2px -2px",inactiveOver:"-23px -2px",activeOver:"-2px -2px"}}}}(this);this.CallPrev=function(a){return function(){a.disableToggleAccess();a._CurrentQuestionNumber--;return a.HandleQuizNav()}}(this);this.CallNext=function(a){return function(){a.disableToggleAccess();a._CurrentQuestionNumber++;return a.HandleQuizNav()}}(this);this.HandleQuizNav=function(a){return function(){void 0!==a.scrollWarning&&a.scrollWarning.Destroy();
a._scrollWarningFadeCall=!1;1<a._CurrentQuestionNumber&&a.allowPrevious?(a._btn_next.x=a._DomRect.x+a._DomRect.width/2+55,a._prevOn||(a._btn_prev.Enable(),a.addChild(a._btn_prev),a._prevOn=!0)):1===a._CurrentQuestionNumber&&a._prevOn&&(a._btn_prev.Destroy(),a.removeChild(a._btn_prev),a._prevOn=!1,a._btn_next.x=a._btn_next._options.initX);a._CurrentQuestionNumber!==a._questionData.length&&a.contains(a._btn_submit)&&(a._btn_submit.Destroy(),a.removeChild(a._btn_submit),a.addChild(a._btn_next));if(a._CurrentQuestionNumber===
a._questionData.length){if(a.SetQuestionSlide(),a._btn_next.Destroy(),a.removeChild(a._btn_next),a.addChild(a._btn_submit),a._prevOn)return a._btn_submit._options.initX=a._DomRect.x+a._DomRect.width/2+55}else{if(a._CurrentQuestionNumber===a._questionData.length+1){a._setQuiz.HideQuestionNumber||a.currQuestionText.Destroy();a.questionText.Destroy();a._btn_submit.Destroy();a.contains(a._btn_next)&&(a._btn_next.Destroy(),a.removeChild(a._btn_next));a._prevOn&&(a._btn_prev.Destroy(),a.removeChild(a._btn_prev));
a._btn_submit.Destroy();a.removeChild(a._btn_submit);if(a._setQuiz.reportResult)return a.BuildReport();a.getScore();return a.HandleCompletion()}a.SetQuestionSlide();return a._btn_next.Disable()}}}(this);this.Update=function(a){return function(b){var c,d;if(a._initialized){a._scrollWarningFadeCall&&void 0!==a.scrollWarning&&(a.scrollWarning.alpha-=.1,0>=a.scrollWarning.alpha&&(a.scrollWarning.Destroy(),a._scrollWarningFadeCall=!1));c=0;for(d=[];c<a.numChildren;)void 0!==a.getChildAt(c)&&void 0!==a.getChildAt(c).Update&&
a.getChildAt(c).Update(b),d.push(c++);return d}return a.Init()}}(this);this.DeselectAllRadio=function(a){return function(){var b,c;for(b=0;b<a._questionData[a._CurrentQuestionNumber-1].Answers.length;)c=document.getElementById(document.getElementById(a._name+"_Button_"+b).id),c=c.children[0].children[0],c.style.background="url("+a.radioButtonData.fileLoc+") "+a.radioButtonData.stateCoords.inactiveNormal,b++;return!0}}(this);this.GetSelectedChecked=function(a){return function(b){var c,d,f;for(d=0;d<
a._questionData[a._CurrentQuestionNumber-1].Answers.length;){c=document.getElementById(document.getElementById(a._name+"_Button_"+d).id);f=c.children[0].children[0];for(c=0;c<f.attributes.length;)"checked"===f.attributes[c].name&&"true"===f.attributes[c].value&&b.push(d),c++;d++}return b}}(this);this.PreformOnSelection=function(a){return function(b){var c,d,f;d=document.getElementById(document.getElementById(a._name+"_Button_"+b).id).children[0].children[0];if(a._questionData[a._CurrentQuestionNumber-
1].multiAnswer){a._UserAnswerData[a._CurrentQuestionNumber-1].choosenAnswerIndices=[];f=!1;for(b=c=0;b<d.attributes.length;)"checked"===d.attributes[b].name&&(f="true"===d.attributes[b].value,c=b,b=d.attributes.length+1),b++;f?(d.style.background="url("+a.checkBoxData.fileLoc+") "+a.checkBoxData.stateCoords.inactiveNormal,d.attributes[c].value="false",void 0===a._questionData[a._CurrentQuestionNumber-1].useToggleSound&&void 0===a._questionData[a._CurrentQuestionNumber-1].useDetoggleSound?"none"!==
a._questionData[a._CurrentQuestionNumber-1].useToggleSound&&a._btn_submit.MakeDefaultClickSound():void 0!==a._questionData[a._CurrentQuestionNumber-1].useToggleSound&&void 0===a._questionData[a._CurrentQuestionNumber-1].useDetoggleSound?D2LAdventureEngine.gu_SoundManager.play(a._questionData[a._CurrentQuestionNumber-1].useToggleSound):D2LAdventureEngine.gu_SoundManager.play(a._questionData[a._CurrentQuestionNumber-1].useDetoggleSound)):(d.style.background="url("+a.checkBoxData.fileLoc+") "+a.checkBoxData.stateCoords.activeNormal,
d.attributes[c].value="true",void 0===a._questionData[a._CurrentQuestionNumber-1].useToggleSound?"none"!==a._questionData[a._CurrentQuestionNumber-1].useToggleSound&&a._btn_submit.MakeDefaultClickSound():D2LAdventureEngine.gu_SoundManager.play(a._questionData[a._CurrentQuestionNumber-1].useToggleSound));a._UserAnswerData[a._CurrentQuestionNumber-1].choosenAnswerIndices=[];a.GetSelectedChecked(a._UserAnswerData[a._CurrentQuestionNumber-1].choosenAnswerIndices);if(0!==a._UserAnswerData[a._CurrentQuestionNumber-
1].choosenAnswerIndices.length){if(a._CurrentQuestionNumber===a._questionData.length)return a._btn_submit.Enable(),a._btn_submit.EnableTabbing();a._btn_next.Enable();return a._btn_next.EnableTabbing()}a._CurrentQuestionNumber===a._questionData.length?a._btn_submit.Disable():a._btn_next.Disable();return a._btn_submit.DisableTabbing()}a._UserAnswerData[a._CurrentQuestionNumber-1].choosenAnswerIndices=b;a._UserAnswerData[a._CurrentQuestionNumber-1].choosenAnswerText=a._questionData[a._CurrentQuestionNumber-
1].Answers[b].ansText;a._UserAnswerData[a._CurrentQuestionNumber-1].questionRef=a._questionData[a._CurrentQuestionNumber-1];a.DeselectAllRadio();d.style.background="url("+a.radioButtonData.fileLoc+") "+a.radioButtonData.stateCoords.activeNormal;if(a._CurrentQuestionNumber===a._questionData.length)return a._btn_submit.Enable(),a._btn_submit.EnableTabbing();a._btn_next.Enable();return a._btn_next.EnableTabbing()}}(this);this.HandleCompletion=function(a){return function(){var b,c,d;c=!1;b="completed";
d=void 0;a._passed&&(b="passed",d=a._setQuiz.passMessage);a._failed&&(b="failed",d=a._setQuiz.failMessage);d={result:b,resultMessage:d,answerDat:a._UserAnswerData,score:parseInt(a._score),scorePossible:parseInt(a._scorePosible),scorePercent:parseInt(a._scorePercent)};for(b=0;b<D2LAdventureEngine.gu_QuizAttemptData.length;)D2LAdventureEngine.gu_QuizAttemptData[b].quizID===a._name&&(c=!0,D2LAdventureEngine.gu_QuizAttemptData[b].attempts.push(d)),b++;c||D2LAdventureEngine.gu_QuizAttemptData.push({quizID:a._name,
attempts:[d]});a._setQuiz.HideTitle||a.TitleText.Destroy();a._btn_ok.Destroy();a._btn_submit.Destroy();a.contains(a.FinalScore)&&(a.FinalScore.Destroy(),a.reportResponceText.Destroy());window.D2LAdventureEngine.gu_InWinButtonLock=!1;window.D2LAdventureEngine.gu_TabManager.HandleAccessModeDeactivation();a.HandleCompletionEvents();return a._completionFucntion(a.parent)}}(this);this.HandleCompletionEvents=function(a){return function(){var b;b={compRef:a};if(a._passed)if(b.interactionType="onPass",b.data=
void 0!==a._setQuiz.onPassData?a._setQuiz.onPassData:a._setQuiz.useDefaultPassFunctionData,void 0!==a._setQuiz.onPass)if(a._setQuiz.onPass.constructor===Function)a._setQuiz.onPass(b);else a._setQuiz.onPass.constructor===String&&D2LAdventureEngine.gu_StateManager.GetCurrStateRef().callCustomFunction(a._setQuiz.onPass,b);else D2LAdventureEngine.gu_QuizOptions.useDefaultPassFunction&&(D2LAdventureEngine.gu_QuizOptions.useDefaultPassFunction.constructor===Function?D2LAdventureEngine.gu_QuizOptions.useDefaultPassFunction(b):
D2LAdventureEngine.gu_QuizOptions.useDefaultPassFunction.constructor===String&&D2LAdventureEngine.gu_StateManager.GetCurrStateRef().callCustomFunction(D2LAdventureEngine.gu_QuizOptions.useDefaultPassFunction,b));if(a._failed)if(b.interactionType="onFail",b.data=void 0!==a._setQuiz.onFailData?a._setQuiz.onFailData:a._setQuiz.useDefaultFailFunctionData,void 0!==a._setQuiz.onFail)if(a._setQuiz.onFail.constructor===Function)a._setQuiz.onFail(b);else a._setQuiz.onFail.constructor===String&&D2LAdventureEngine.gu_StateManager.GetCurrStateRef().callCustomFunction(a._setQuiz.onFail,
b);else D2LAdventureEngine.gu_QuizOptions.useDefaultFailFunction&&(D2LAdventureEngine.gu_QuizOptions.useDefaultFailFunction.constructor===Function?D2LAdventureEngine.gu_QuizOptions.useDefaultFailFunction(b):D2LAdventureEngine.gu_QuizOptions.useDefaultFailFunction.constructor===String&&D2LAdventureEngine.gu_StateManager.GetCurrStateRef().callCustomFunction(D2LAdventureEngine.gu_QuizOptions.useDefaultFailFunction,b));b.interactionType="onComplete";b.data=void 0!==a._setQuiz.onCompleteData?a._setQuiz.onCompleteData:
a._setQuiz.useDefaultCompleteFunctionData;if(void 0!==a._setQuiz.onComplete){if(a._setQuiz.onComplete.constructor===Function)return a._setQuiz.onComplete(b);if(a._setQuiz.onComplete.constructor===String)return D2LAdventureEngine.gu_StateManager.GetCurrStateRef().callCustomFunction(a._setQuiz.onComplete,b)}else if(D2LAdventureEngine.gu_QuizOptions.useDefaultCompleteFunction){if(D2LAdventureEngine.gu_QuizOptions.useDefaultCompleteFunction.constructor===Function)return D2LAdventureEngine.gu_QuizOptions.useDefaultCompleteFunction(b);
if(D2LAdventureEngine.gu_QuizOptions.useDefaultCompleteFunction.constructor===String)return D2LAdventureEngine.gu_StateManager.GetCurrStateRef().callCustomFunction(D2LAdventureEngine.gu_QuizOptions.useDefaultCompleteFunction,b)}}}(this);this.BuildReport=function(a){return function(){var b;a.addChild(a._btn_ok);D2LAdventureEngine.gu_debugManager.log(a.getScore()+"%");a.FinalScore=new D2LAdventureEngine.comp_Text("FinalScoreText",void 0,"<strong>"+D2LAdventureEngine.gu_QuizOptions.langReport+Math.round(100*
a._score)/100+" "+D2LAdventureEngine.gu_QuizOptions.langOf+" "+a._scorePosible+"  ( "+a._scorePercent+"% ) </strong>",{initX:a._DomRect.x+30,initY:a._DomRect.y+40,initWidth:a._DomRect.width-60});a.addChild(a.FinalScore);b="- error occurred -";void 0!==a._setQuiz.passMessage&&a._passed?b=a._setQuiz.passMessage:void 0===a._setQuiz.passMessage&&a._passed?b=D2LAdventureEngine.gu_QuizOptions.useDefaultPassMessage:void 0!==a._setQuiz.failMessage&&a._failed?b=a._setQuiz.failMessage:void 0===a._setQuiz.failMessage&&
a._failed&&(b=D2LAdventureEngine.gu_QuizOptions.useDefaultFailMessage);a.reportResponceText=new D2LAdventureEngine.comp_Text("reportResponceText",void 0,b,{initX:a._DomRect.x+10,initY:a._DomRect.y+70,initWidth:a._DomRect.width+20,initHeight:.75*a._DomRect.height,overflow:"y-auto"});return a.addChild(a.reportResponceText)}}(this);this.getScore=function(a){return function(){var b,c,d,f;a._score=0;a._scorePosible=0;for(f=a._scorePercent=0;f<a._questionData.length;){a._scorePosible+=a._questionData[f].scoreValue;
if(a._questionData[f].multiAnswer){for(b=d=c=0;b<a._questionData[f].Answers.length;)a._questionData[f].Answers[b].isCorrect?-1!==a._UserAnswerData[f].choosenAnswerIndices.indexOf(b)?c++:d++:-1!==a._UserAnswerData[f].choosenAnswerIndices.indexOf(b)&&d++,b++;"strict"===a._questionData[f].multiAnswerMode?0===d&&(a._score+=a._questionData[f].scoreValue):("average"!==a._questionData[f].multiAnswerMode&&void 0!==a._questionData[f].multiAnswerMode&&D2LAdventureEngine.gu_debugManager.log("WARNING: Quiz "+
a._name+" Question "+f+" multiAnswerMode "+a._questionData[f].multiAnswerMode+' not recognized, using "average" instead'),b=c/(d+c),a._score+=a._questionData[f].scoreValue*b)}else a._questionData[f].Answers[a._UserAnswerData[f].choosenAnswerIndices].isCorrect&&(a._score+=a._questionData[f].scoreValue);f++}a._scorePercent=Math.round(a._score/a._scorePosible*1E4)/100;void 0!==a._setQuiz.passPercentNeeded?a._scorePercent>=a._setQuiz.passPercentNeeded&&(a._passed=!0):50<=a._scorePercent&&(a._passed=!0);
a._passed||(a._failed=!0);return a._scorePercent}}(this)}r(b,f);return b}(createjs.Container);window.D2LAdventureEngine.ScreenReaderHelper=function(){function f(){this.ShowReadText=g(this.ShowReadText,this);this.HideReadText=g(this.HideReadText,this);this.AddReadText=g(this.AddReadText,this);this.setSceneDesc=g(this.setSceneDesc,this);this.Init=g(this.Init,this);this._ignoreStateDescription=this._initalized=!1}f.prototype.StateSectionElem=void 0;f.prototype.SceneSectionElem=void 0;f.prototype.SceneDescriptorElem=
void 0;f.prototype._initalized=void 0;f.prototype._ignoreStateDescription=void 0;f.prototype.Init=function(){var b;this.StateSectionElem=document.createElement("section");this.StateSectionElem.setAttribute("id","AE_stateSection");this.StateSectionElem.setAttribute("role","label");this.StateSectionElem.setAttribute("aria-labeledby","AE_stateSection_head");this._ignoreStateDescription||(b=document.createElement("h2"),b.setAttribute("id","AE_stateSection_head"),b.setAttribute("class","AE_AccessHide"),
b.setAttribute("role","sectionhead"),b.setAttribute("aria-live","assertive"),b.innerHTML="State: Loading Screen",this.StateSectionElem.appendChild(b));this.SceneSectionElem=document.createElement("section");this.SceneSectionElem.setAttribute("id","AE_sceneSection");this.SceneSectionElem.setAttribute("role","label");this.SceneSectionElem.setAttribute("aria-labeledby","AE_sceneSection_head");b=document.createElement("h2");b.setAttribute("id","AE_sceneSection_head");b.setAttribute("class","AE_AccessHide");
b.setAttribute("role","sectionhead");b.setAttribute("aria-live","assertive");b.innerHTML="Scene: Loading Screen";this.SceneSectionElem.appendChild(b);D2LAdventureEngine.gu_ScreenReaderAccessible?(this.SceneDescriptorElem=document.createElement("p"),this.SceneDescriptorElem.setAttribute("id","AE_SceneDescription"),this.SceneDescriptorElem.setAttribute("class","AE_AccessHide"),this.SceneDescriptorElem.setAttribute("role","description"),this.SceneDescriptorElem.setAttribute("aria-live","assertive"),
this.SceneSectionElem.appendChild(this.SceneDescriptorElem)):this.StateSectionElem.setAttribute("aria-hidden","true");this.StateSectionElem.appendChild(this.SceneSectionElem);D2LAdventureEngine.gu_stageRef.canvas.parentElement.appendChild(this.StateSectionElem);return this._initalized=!0};f.prototype.setSceneDesc=function(b){if(this._initalized&&D2LAdventureEngine.gu_ScreenReaderAccessible&&(document.getElementById("AE_SceneDescription").innerHTML=b._options.SceneDescription,document.getElementById("AE_sceneSection_head").innerHTML=
"Scene: "+b.ID,!this._ignoreStateDescription))return document.getElementById("AE_stateSection_head").innerHTML="State: "+b.assoiatedStateID};f.prototype.AddReadText=function(b,a,c,d,f){var h;void 0===d&&(d="AE_sceneSection");h=document.getElementById(b);null!==h&&h.parentElement.removeChild(h);void 0===f&&(f={});d=document.getElementById(d);if(null===d)return D2LAdventureEngine.gu_debugManager.log("Warning AddReadText on "+b+" failed for locate requested container "+d);h=document.createElement(c);
h.setAttribute("id",b);"section"===c?(h.setAttribute("aria-labeledby","AE_windowHead_"+b),h.setAttribute("role","label"),h.setAttribute("aria-live","assertive"),a=document.createElement("h3"),a.setAttribute("id","AE_windowHead_"+b),a.setAttribute("role","sectionhead"),a.setAttribute("class","AE_AccessHide"),a.innerHTML=f.SectionLable?f.SectionLable:"Section content:",h.appendChild(a)):null!==d&&(h.setAttribute("class","AE_AccessHide"),h.innerHTML=a);f.onClick&&h.setAttribute("onclick",f.onClick);
void 0!==f.insertBefore?(a=document.getElementById(f.insertBefore),null!==f.insertBefore?d.insertBefore(h,a):D2LAdventureEngine.gu_debugManager.log(b+" failed to AddReadText  insertBefore failed to get ID")):void 0!==f.insertAfter?(a=document.getElementById(f.insertAfter))&&a.nextSibling?d.insertBefore(h,a.nextSibling):D2LAdventureEngine.gu_debugManager.log(b+" failed to AddReadText  insertAfter failed to get ID of target after "+f.insertAfter):d.appendChild(h);return h};f.prototype.HideReadText=
function(b){b=document.getElementById(b);if(null!==b)return b.setAttribute("hidden","true")};f.prototype.ShowReadText=function(b){b=document.getElementById(b);if(null!==b)return b.removeAttribute("hidden")};return f}();window.D2LAdventureEngine.CustomFunctionManager=function(){function f(){this.CallGlobalFunc=g(this.CallGlobalFunc,this);this.SetGlobalFunctions=g(this.SetGlobalFunctions,this);this.restrictionAllowence=g(this.restrictionAllowence,this);this.requestComp=g(this.requestComp,this);this.DefineFunction=
g(this.DefineFunction,this);this.GlobalCustomFunctions=[];this._eventGroups=[]}f.prototype.GlobalCustomFunctions=void 0;f.prototype._eventGroups=void 0;f.prototype.DefineFunction=function(b,a,c,d,f){var h,g;g=0;for(f=!1;!f;)void 0!==b[a.callFunc+"_"+g]?g++:f=!0;switch(a.callFunc){case "Custom Function":h=function(a){return function(b,c,d,f,h){return a.CallGlobalFunc(b[0],h)}}(this);break;case "Eval String":h=function(a){return function(a){try{return eval(a[0])}catch(b){return D2LAdventureEngine.gu_debugManager.log(b)}}}(this);
break;case "Init Default Audio Window":h=function(a){return function(a){return D2LAdventureEngine.gu_SoundManager.InitDefaultWindow()}}(this);break;case "Push Splash":h=function(a){return function(a){return D2LAdventureEngine.venture.splash.callEnd()}}(this);break;case "Change State":h=function(a){return function(a){return D2LAdventureEngine.gu_StateManager.SwitchToState(a[0])}}(this);break;case "Set Defined Global Var":h=function(a){return function(a){return D2LAdventureEngine.gu_CustomVarsManager.SetVar(a[0],
a[1],a[2])}}(this);break;case "Change Scene":h=function(a){return function(a,b){return b.ChangeScene(a[0])}}(this);break;case "Change Event Action":h=function(a){return function(a,b,c,d){if(d){c=0;for(b=[];c<d.length;)void 0!==d[c].SetEventAction&&d[c].SetEventAction(a[0],a[1],a[2]),b.push(c++);return b}return D2LAdventureEngine.gu_debugManager.log("Warning: requested 'SetEventAction' could not find targComps")}}(this);break;case "Nudge Scene":h=function(a){return function(a){return targScene?targScene.NudgeScene(a[0],
a[1],a[2]):D2LAdventureEngine.gu_debugManager.log("Warning: requested 'Nudge Scene' could not find scene")}}(this);break;case "Toggle Debug DOM":h=function(a){return function(a){return D2LAdventureEngine.gu_debugManager.toggleDOM()}}(this);break;case "Open Help Window":h=function(a){return function(a){return D2LAdventureEngine.gu_GUIManager.OpenHelpWindow()}}(this);break;case "Close Help Window":h=function(a){return function(a){return D2LAdventureEngine.gu_GUIManager.requestHelpWindowCloseCall()}}(this);
break;case "Open Audio Window":h=function(a){return function(a){return D2LAdventureEngine.gu_GUIManager.OpenAudioMenu()}}(this);break;case "Close Audio Window":h=function(a){return function(a){return D2LAdventureEngine.gu_GUIManager.requestAudioWindowCloseCall()}}(this);break;case "Show Context":h=function(a){return function(a){return D2LAdventureEngine.gu_GUIManager.ChangeContext(a[0])}}(this);break;case "Hide Context Bar":h=function(a){return function(a){return D2LAdventureEngine.gu_GUIManager.HideContext()}}(this);
break;case "Show Context Bar":h=function(a){return function(a){return D2LAdventureEngine.gu_GUIManager.ShowContext()}}(this);break;case "AccessMode Request":h=function(a){return function(a){return D2LAdventureEngine.gu_TabManager.HandleAccessReq()}}(this);break;case "AccessMode ReverseRequest":h=function(a){return function(a){return D2LAdventureEngine.gu_TabManager.HandleAccessReq(!0)}}(this);break;case "AcessMode_ScrollTargUp_start":h=function(a){return function(){return D2LAdventureEngine.gu_KeyManager.HandleScrollReq("up")}}(this);
break;case "AcessMode_ScrollTargDown_start":h=function(a){return function(){return D2LAdventureEngine.gu_KeyManager.HandleScrollReq("down")}}(this);break;case "AcessMode_ScrollTarg_stop":h=function(a){return function(){return D2LAdventureEngine.gu_KeyManager.HandleScrollReq("none")}}(this);break;case "AccessMode Activate":h=function(a){return function(a){return D2LAdventureEngine.gu_TabManager.HandleAccessActivation()}}(this);break;case "AccessMode Deactivate":h=function(a){return function(a){return D2LAdventureEngine.gu_TabManager.HandleAccessDeactivation()}}(this);
break;case "AccessCursor Nudge":h=function(a){return function(a){return D2LAdventureEngine.gu_GUIManager.AccessCur.NudgeCursor(a[0],a[1])}}(this);break;case "AccessCursor Request Start":h=function(a){return function(a){return D2LAdventureEngine.gu_GUIManager.AccessCur.HandleStartRequest()}}(this);break;case "AccessCursor Request End":h=function(a){return function(a){return D2LAdventureEngine.gu_GUIManager.AccessCur.HandleEndRequest()}}(this);break;case "AccessCursor Request Toggle":h=function(a){return function(a){return D2LAdventureEngine.gu_GUIManager.AccessCur.HandleReqToggle()}}(this);
break;case "Play Sound":h=function(a){return function(a){return D2LAdventureEngine.gu_SoundManager.play(a[0])}}(this);break;case "Stop Sound":h=function(a){return function(a){return D2LAdventureEngine.gu_SoundManager.stop(a[0])}}(this);break;case "Set Channel Volume":h=function(a){return function(a){return D2LAdventureEngine.gu_SoundManager.audjustChannelVol(a[0],a[1])}}(this);break;case "Fade Channel Volume":h=function(a){return function(a){return D2LAdventureEngine.gu_SoundManager.FadeChannelVolTo(a[0],
a[1],a[2])}}(this);break;case "Mute All Sound":h=function(a){return function(a){return D2LAdventureEngine.gu_SoundManager.Mute()}}(this);break;case "Unmute All Sound":h=function(a){return function(a){return D2LAdventureEngine.gu_SoundManager.Unmute()}}(this);break;case "Toggle Mute All Sound":h=function(a){return function(a){return D2LAdventureEngine.gu_SoundManager.ToggleMute()}}(this);break;case "Log Message":h=function(a){return function(a){return D2LAdventureEngine.gu_debugManager.log(a[0])}}(this);
break;case "Force Pan/zoom":h=function(a){return function(a){return targScene?(targScene.x=-a[0],targScene.y=-a[1],targScene.scaleX=a[2],targScene.scaleY=a[2]):D2LAdventureEngine.gu_debugManager.log("Warning: requested 'Force Pan/zoom' could not find scene")}}(this);break;case "Call Alert":h=function(a){return function(a){return alert(a[0])}}(this);break;case "Call URL":h=function(a){return function(a){return window.open(a[0],a[1],a[3])}}(this);break;case "Activate Key":h=function(a){return function(a){return D2LAdventureEngine.gu_KeyManager.ActivateKey(a[0])}}(this);
break;case "Deactivate Key":h=function(a){return function(a){return D2LAdventureEngine.gu_KeyManager.DeactivateKey(a[0])}}(this);break;case "Change Cursor":h=function(a){return function(a){return D2LAdventureEngine.gu_CSSManager.ChangeCursor(a[0])}}(this);break;case "Set Cursor":h=function(a){return function(a){return D2LAdventureEngine.gu_CSSManager.SetCursorDefault(a[0],a[1])}}(this);break;case "SetZIndex":h=function(a){return function(a,b,c,d){var f;if(c){if(d){f=0;for(b=[];f<d.length;)c.AssignZIndex(c.getComponetById(targComp.id),
a[0],a[1]),b.push(f++);return b}return D2LAdventureEngine.gu_debugManager.log("Warning: requested 'SetZIndex' could not find targComps")}return D2LAdventureEngine.gu_debugManager.log("Warning: requested 'SetZIndex' could not find scene")}}(this);break;case "Show":h=function(a){return function(a,b,c,d){if(d){b=0;for(a=[];b<d.length;)void 0!==d[b].Show&&d[b].Show(),a.push(b++);return a}return D2LAdventureEngine.gu_debugManager.log("Warning: requested 'Show' could not find targComps")}}(this);break;
case "Hide":h=function(a){return function(a,b,c,d){if(d){b=0;for(a=[];b<d.length;)void 0!==d[b].Hide&&d[b].Hide(),a.push(b++);return a}return D2LAdventureEngine.gu_debugManager.log("Warning: requested 'Hide' could not find targComps")}}(this);break;case "Call Window":h=function(a){return function(a){return D2LAdventureEngine.gu_GUIManager.OpenWindow(a[0])}}(this);break;case "Force Next Window":h=function(a){return function(a){return D2LAdventureEngine.gu_GUIManager.CurrentActiveWindow?D2LAdventureEngine.gu_GUIManager.CurrentActiveWindow.okButtonClickEvnt():
D2LAdventureEngine.gu_debugManager.log("Warning 'Force Next Window' request failed, current window not set.")}}(this);break;case "Call Quiz":h=function(a){return function(a){var b,c;b={};for(c=0;c<D2LAdventureEngine.gu_QuizInitData.length;)D2LAdventureEngine.gu_QuizInitData[c].ID===a[0]&&(b=D2LAdventureEngine.gu_JsonOps.parseConverstionRules(D2LAdventureEngine.gu_QuizInitData[c])),c++;b.closeFunction=function(a){return window.D2LAdventureEngine.gu_stageRef.removeChild(a)};D2LAdventureEngine.gu_GUIManager.QuizWindow=
new D2LAdventureEngine.InWin("quizWindow_"+a[0],b);D2LAdventureEngine.gu_GUIManager.QuizWindow.Populate({content:a[0],type:"quiz"});window.D2LAdventureEngine.gu_stageRef.addChildAt(D2LAdventureEngine.gu_GUIManager.QuizWindow,window.D2LAdventureEngine.gu_stageRef.numChildren-1);return D2LAdventureEngine.gu_GUIManager.PopWinOverideObjects()}}(this);break;case "Force Quiz Next Call":h=function(a){return function(a){return D2LAdventureEngine.gu_GUIManager.QuizWindow._currentPopContent.CallNext()}}(this);
break;case "Call Tween":h=function(a){return function(a,b,c,d){var f;if(d){f=0;for(c=[];f<d.length;)b.constructor===D2LAdventureEngine.SplashView?b.CallTween(a[0],d[f]):D2LAdventureEngine.gu_TweensManager.CallTween(a[0],d[f]),c.push(f++);return c}return D2LAdventureEngine.gu_debugManager.log("Warning: requested 'SetZIndex' could not find targComps")}}(this);break;case "Change Text":h=function(a){return function(a,b,c,d){if(d){c=0;for(b=[];c<d.length;)void 0!==d[c].ChangeText&&d[c].ChangeText(a[0]),
b.push(c++);return b}return D2LAdventureEngine.gu_debugManager.log("Warning: requested 'Change Text' could not find targComps")}}(this);break;case "Append Text":h=function(a){return function(a,b,c,d){if(d){c=0;for(b=[];c<d.length;)void 0!==d[c].AppendText&&d[c].AppendText(a[0]),b.push(c++);return b}return D2LAdventureEngine.gu_debugManager.log("Warning: requested 'Append Text' could not find targComps")}}(this);break;case "String Function":h=function(a){return function(a,b,c,d){if(d){c=0;for(b=[];c<
d.length;)void 0!==d[c].StringFunctionCall&&d[c].StringFunctionCall(a[0]),b.push(c++);return b}return D2LAdventureEngine.gu_debugManager.log("Warning: requested 'Change Text' could not find targComps")}}(this);break;case "Change Sprite Animation":h=function(a){return function(a,b,c,d){if(d){c=0;for(b=[];c<d.length;)void 0!==d[c].play&&d[c].play(a[0]),b.push(c++);return b}return D2LAdventureEngine.gu_debugManager.log("Warning: requested 'Change Sprite Animation' could not find targComps")}}(this);
break;default:h=function(b){return function(b,c,d,f){var h,g,m;c=a.callFunc.replace(/\s+/g,"");if(f){m=0;for(h=[];m<f.length;)d=b.slice(0),void 0!==f[m]&&void 0!==f[m][c]?(g=f[m][c],g.constructor===Function?g.apply(f[m],d):g.constructor===Number&&(d[0]=eval(d[0]))):D2LAdventureEngine.gu_debugManager.log("Warning: targeted componet "+f[m].id+" either doenst exist or doesnt have a "+c+" function"),h.push(m++);return h}return D2LAdventureEngine.gu_debugManager.log("Warning: requested '"+c+"' could not find targComps")}}(this)}b[a.callFunc+
"_"+g]=function(b){return function(f){var g,m,k,t,u;a.params&&(g=D2LAdventureEngine.gu_JsonOps.parseAllRules(a.params,void 0,f));m=a.restrictions;k=null===c||void 0===c?D2LAdventureEngine.gu_StateManager.GetCurrStateRef():D2LAdventureEngine.gu_StateManager.GetStateRef(c);u=null===d||void 0===d?D2LAdventureEngine.gu_StateManager.GetCurrentScene():D2LAdventureEngine.gu_StateManager.GetSceneById(d);void 0!==a.forceData&&null!==a.forceData&&(f.data=D2LAdventureEngine.gu_JsonOps.parseAllRules(a.forceData,
void 0,f));a.Target&&(t=D2LAdventureEngine.gu_JsonOps.parseAllRules(a.Target,void 0,f),t=b.requestComp(t));if(b.restrictionAllowence(m,f))return h(g,k,u,t,f)}}(this)};f.prototype.requestComp=function(b){var a;a=D2LAdventureEngine.gu_StateManager.findComponent(b);if(!1===a){for(a=0;a<this._eventGroups.length;){if(this._eventGroups[a].ID===b)return this._eventGroups[a].compRefs;a++}return!1}return[a]};f.prototype.restrictionAllowence=function(b,a){var c,d,f,h,g;c=!1;if(void 0===b)c=!0;else{for(h=g=
0;g<b.length;){d=D2LAdventureEngine.gu_JsonOps.parseAllRules(b[g].target,void 0,a);if(-1!==b[g].logic.indexOf("[target]")){f=D2LAdventureEngine.gu_JsonOps.parseAllRules(b[g].logic.replace("[target]",d),void 0,a);try{eval(f)}catch(p){d=p,D2LAdventureEngine.gu_debugManager.log("ERROR!: restrictionAllowence Logic parse "+f+" : "+d)}}eval(f)&&h++;g++}h===b.length&&(c=!0)}return c};f.prototype.SetGlobalFunctions=function(b){var a,c,d,f;a=0;for(f=[];a<b.length;){this.GlobalCustomFunctions.push({ID:b[a].ID,
effects:{},params:[]});for(c=0;c<b[a].Effects.length;){void 0===b[a].Effects[c].params&&(b[a].Effects[c].params=[]);for(d=0;d<b[a].Effects[c].params.length;)this.GlobalCustomFunctions[this.GlobalCustomFunctions.length-1].params.push(b[a].Effects[c].params),d++;this.DefineFunction(this.GlobalCustomFunctions[this.GlobalCustomFunctions.length-1].effects,b[a].Effects[c],b[a].TargState,b[a].TargScene,b[a].Effects[c].Target);c++}f.push(a++)}return f};f.prototype.CallGlobalFunc=function(b,a){var c,d,f,g;
c=!1;if(-1!==b.indexOf("[%js]")){c=void 0===a?void 0:a.compRef;c=D2LAdventureEngine.gu_JsonOps.parseAllRules(b.replace("[%js]",""),c,a);try{return eval(c)}catch(k){return a=k,D2LAdventureEngine.gu_debugManager.log("ERROR!!: Failed eval call - "+c),D2LAdventureEngine.gu_debugManager.log(a),a}}else{for(d=0;d<this.GlobalCustomFunctions.length;){if(this.GlobalCustomFunctions[d].ID===b)for(f=0,g=Object.keys(this.GlobalCustomFunctions[d].effects);f<g.length;)this.GlobalCustomFunctions[d].effects[g[f]](a),
c=!0,f++;d++}c||D2LAdventureEngine.gu_StateManager._initialized||(c=D2LAdventureEngine.venture.splash.callCustomFunction(b,a));return c}};return f}();window.D2LAdventureEngine.CustomVarsManager=function(){function f(){this.ChangeNestedIndex=g(this.ChangeNestedIndex,this);this.SetVar=g(this.SetVar,this);this.GetVar=g(this.GetVar,this);this.globalDefinedVars=[]}f.prototype.globalDefinedVars=void 0;f.prototype.GetVar=function(b,a){var c,d;for(d=0;d<this.globalDefinedVars.length;){if(this.globalDefinedVars[d].ID===
b)if(this.globalDefinedVars[d].value.constructor===Array)if(void 0!==a){if(a.constructor===Number)return this.globalDefinedVars[d].value[a];if(a.constructor===String)try{return eval("this.globalDefinedVars["+d+"].value"+a+";")}catch(f){c=f;D2LAdventureEngine.gu_debugManager.log("ERROR!: CustomVarsManager.GetVar 'this.globalDefinedVars["+d+"].value"+a+";' -- : "+c);return}}else return this.globalDefinedVars[d].value;else if("object"===typeof this.globalDefinedVars[d].value)if(void 0!==a){if(a.constructor===
Number)return this.globalDefinedVars[d].value[a];if(a.constructor===String)return eval("this.globalDefinedVars["+d+"].value"+a+";")}else return this.globalDefinedVars[d].value;else return this.globalDefinedVars[d].value;d++}return window.D2LAdventureEngine.gu_debugManager.log("WARNING: CustomVarsManager.GetVar could not locate Varible "+b)};f.prototype.SetVar=function(b,a,c){var d;for(d=0;d<this.globalDefinedVars.length;){if(this.globalDefinedVars[d].ID===b)return this.globalDefinedVars[d].value.constructor===
Array?void 0!==c?c.constructor===Number?this.globalDefinedVars[d].value[c]=a:c.constructor===String?this.ChangeNestedIndex(this.globalDefinedVars[d].value,c,a):D2LAdventureEngine.gu_debugManager.log("WARNING: CustomVarsManager.SetVar recived unknown indx type"):this.globalDefinedVars[d].value=a:"object"===typeof this.globalDefinedVars[d].value?void 0!==c?this.globalDefinedVars[d].value[c]=a:this.globalDefinedVars[d].value=a:this.globalDefinedVars[d].value=a;d++}return window.D2LAdventureEngine.gu_debugManager.log("WARNING: CustomVarsManager.SetVar could not locate Varible "+
b)};f.prototype.ChangeNestedIndex=function(b,a,c){var d,f,g,k,p;a=a.split(".");g=!1;for(p=0;p<this.globalDefinedVars.length;)this.globalDefinedVars[p].value===b&&(d=_this.globalDefinedVars[p].value,f="_this.globalDefinedVars["+p+"].value",g=!0),p++;if(g){for(g=0;g<a.length;){try{k=eval(a[g])}catch(n){k=a[g]}if(void 0!==d[k])f=d.constructor===Array?f+("["+k+"]"):f+("."+k),d=d[k];else return window.D2LAdventureEngine.gu_debugManager.log("ERROR locatedNestedIndex failed to locate "+b+" at "+k),!1;g++}return void 0===
c?d:eval(f+" = "+c)}return window.D2LAdventureEngine.gu_debugManager.log("ERROR locatedNestedIndex failed to locate "+b)};return f}();window.D2LAdventureEngine.CSSManager=function(){function f(){this.SetCursorDefault=g(this.SetCursorDefault,this);this.SetForceCursor=g(this.SetForceCursor,this);this.ChangeCursor=g(this.ChangeCursor,this);this.AlterCSSRule=g(this.AlterCSSRule,this);this.GetCSSRule=g(this.GetCSSRule,this);this.AppendDefaultCSSRules=g(this.AppendDefaultCSSRules,this);this.AppendCSSFile=
g(this.AppendCSSFile,this);this.AppendCSSFiles=g(this.AppendCSSFiles,this);this.cssSheetsReady=this.InitCSS_Set=!1;this._globalDefaultFont="Arial"}f.prototype.InitCSS_Set=void 0;f.prototype.cssSheetsReady=void 0;f.prototype.usingCursorType="default";f.prototype.forcingCursor=void 0;f.prototype._globalDefaultFont=void 0;f.prototype.usingDefaultCursor={"default":"default",pointer:"pointer",crosshair:"crosshair",move:"move","n-resize":"n-resize"};f.prototype.AppendCSSFiles=function(){var b,a,c;this.AppendCSSFile(D2LAdventureEngine.gu_EngineLoc+
"/css/adventureStyles.css",{title:"adventureStyles",onComplete:function(a){return function(a){D2LAdventureEngine.gu_CSSManager.cssSheetsReady=!0;return D2LAdventureEngine.gu_CSSManager.AppendDefaultCSSRules(a.target.sheet)}}(this)});a=D2LAdventureEngine.gu_ExFileManager._externalStlyes;b=0;for(c=[];b<a.length;)this.AppendCSSFile(a[b]),c.push(b++);return c};f.prototype.AppendCSSFile=function(b,a){var c,d,f;void 0===a&&(a={});d=document.getElementsByTagName("head")[0];if(document.createStyleSheet){document.createStyleSheet(b);
d=document.getElementsByTagName("link");f=void 0;for(c=0;c<d.length;){if(-1!==d[c].href.indexOf(b.split("\\").pop().split("/").pop())){f=d[c];break}c++}return void 0!==f?(f.setAttribute("type","text/css"),a.title&&f.setAttribute("title",a.title),a.onComplete&&(f.onload=a.onComplete.valueOf()),f.setAttribute("onerror","D2LAdventureEngine.gu_debugManager.log('failed to load "+b.valueOf()+"')")):D2LAdventureEngine.gu_debugManager.log("ERROR!! Failed to define"+b.valueOf())}c=document.createElement("link");
c.rel="stylesheet";c.type="text/css";c.href=b;a.title&&(c.title=a.title);a.onComplete&&("Safari"!==D2LAdventureEngine.gu_userBrowser&&"Firefox"!==D2LAdventureEngine.gu_userBrowser?c.addEventListener("load",a.onComplete):(D2LAdventureEngine.gu_debugManager.log("using Webkit css ready detection via image error method"),f=document.createElement("img"),f.onerror=a.onComplete,f.src=b));c.addEventListener("error",function(a){return function(){return D2LAdventureEngine.gu_debugManager.log("failed to load "+
b.valueOf())}}(this));return d.insertBefore(c,d.firstChild)};f.prototype.AppendDefaultCSSRules=function(b){var a;if(!this.InitCSS_Set&&(a=!1,void 0===b&&(b="adventureStyles"),D2LAdventureEngine.gu_canDi||(D2LAdventureEngine.gu_StageEventManager.preHandleWindowSize(),a=!0),this.AlterCSSRule(b,".AdventureCanvas","maxWidth",D2LAdventureEngine.gu_canDi.width+"px"),this.AlterCSSRule(b,".AdventureCanvas","maxHeight",D2LAdventureEngine.gu_canDi.height+"px"),D2LAdventureEngine.gu_LeManager.InitCSSAdjustments(b),
this.cssSheetsReady&&D2LAdventureEngine.gu_TouchAllowed&&(this.AlterCSSRule(b,"#compWindow_popText_text","-webkit-overflow-scrolling","touch"),this.AlterCSSRule(b,"#compWindow_popText_text","overflow","scroll")),this.InitCSS_Set=!0,!a))return D2LAdventureEngine.gu_StageEventManager.preHandleWindowSize()};f.prototype.GetCSSRule=function(b,a,c){var d,f,g;if(this.cssSheetsReady){g=void 0;if(b.constructor===String)for(d=0;d<document.styleSheets.length;){if(document.styleSheets[d].title===b){g=document.styleSheets[d];
break}d++}else b.constructor===Number&&(g=document.styleSheets[b],D2LAdventureEngine.gu_debugManager.log(g));if(void 0===g)return D2LAdventureEngine.gu_debugManager.log("Warning!: GetCSSRule failed to find style sheet "+b),!1;f=void 0;d=0;if(void 0!==g.rules)for(a=a.split(":").join("::");d<g.rules.length;){if(g.rules[d].selectorText===a){f=g.rules[d];break}d++}else for(;d<g.cssRules.length;){if(g.cssRules[d].selectorText===a){f=g.cssRules[d];break}d++}return void 0===f?(D2LAdventureEngine.gu_debugManager.log("Warning!: GetCSSRule failed to find rule "+
a+" applied to styleSheet "+b),!1):f.style[c]}};f.prototype.AlterCSSRule=function(b,a,c,d){var f,g,k;if(this.cssSheetsReady){k=void 0;if(b.constructor===String)for(f=0;f<document.styleSheets.length;){if(document.styleSheets[f].title===b){k=document.styleSheets[f];break}f++}else b.constructor===Number?k=document.styleSheets[b]:b.constructor===window.CSSStyleSheet&&(k=b);if(void 0===k)return void 0!==D2LAdventureEngine.gu_debugManager?D2LAdventureEngine.gu_debugManager.log("Warning!: AlterCSSRule failed to find style sheet "+
b):"object"===typeof console&&console.log("Warning!: AlterCSSRule failed to find style sheet "+b),!1;g=void 0;f=0;if(void 0!==k.rules)for(a=a.split(":").join("::");f<k.rules.length;){if(k.rules[f].selectorText===a){g=k.rules[f];break}f++}else if(k.cssRules)for(;f<k.cssRules.length;){if(k.cssRules[f].selectorText===a){g=k.cssRules[f];break}f++}else return void 0!==D2LAdventureEngine.gu_debugManager?D2LAdventureEngine.gu_debugManager.log("ERROR!: AlterCSSRule failed to get rules in "+b+" they may not be loaded yet"):
"object"===typeof console&&console.log("ERROR!: AlterCSSRule failed to get rules in "+b+" they may not be loaded yet"),!1;return void 0===g?(void 0!==D2LAdventureEngine.gu_debugManager?D2LAdventureEngine.gu_debugManager.log("Warning!: AlterCSSRule failed to find rule "+a+" applied to styleSheet "+b):"object"===typeof console&&console.log("Warning!: AlterCSSRule failed to find rule "+a+" applied to styleSheet "+b),!1):g.style[c]=d}};f.prototype.ChangeCursor=function(b){if(b&&!this.forcingCursor&&this.usingCursorType!==
b)return void 0!==this.usingDefaultCursor[b]?(this.usingCursorType=b,this.AlterCSSRule("adventureStyles","body","cursor",this.usingDefaultCursor[b])):D2LAdventureEngine.gu_debugManager.log("ChangeCursor set to unknown cursor type "+b)};f.prototype.SetForceCursor=function(b){this.forcingCursor=b;if(void 0===this.forcingCursor)this.ChangeCursor("default");else if(this.usingCursorType!==b)return void 0!==this.usingDefaultCursor[b]?(this.usingCursorType=b,this.AlterCSSRule("adventureStyles","body","cursor",
this.usingDefaultCursor[b])):D2LAdventureEngine.gu_debugManager.log("SetForceCursor set to unknown cursor type "+b)};f.prototype.SetCursorDefault=function(b,a){void 0===a&&(a=b);return-1===b.indexOf("url")?this.usingDefaultCursor[b]=a:D2LAdventureEngine.gu_debugManager.log("SetCursorDefault cannot be used to replace the URL cursor")};return f}();window.D2LAdventureEngine.LEManager=function(){function f(){this.CallFullScreenPopout=g(this.CallFullScreenPopout,this);this.GetBrightspaceContainer=g(this.GetBrightspaceContainer,
this);this.HeightChangeRequest=g(this.HeightChangeRequest,this);this.InitCSSAdjustments=g(this.InitCSSAdjustments,this);this.LoadCommonLibs=g(this.LoadCommonLibs,this);this.DetectLMS=g(this.DetectLMS,this);this._Environment="none";this.DetectLMS();this.LoadCommonLibs()}f.prototype._Environment=void 0;f.prototype._EnvVersion=void 0;f.prototype._D2L_CommonLibaries=[];f.prototype.DetectLMS=function(){var b;b=window.location.href;if(-1!==b.indexOf("desire2learn.com")||-1!==b.indexOf("d2l.com")||-1!==
b.indexOf("/content/"))this._Environment="Brightspace";return this._Environment};f.prototype.LoadCommonLibs=function(b){var a;a=0;if("Brightspace"===this._Environment&&(b=function(b){return function(d){return D2LAdventureEngine.gu_ExFileManager.getScript(b._D2L_CommonLibaries[a],function(f){a++;return a>b._D2L_CommonLibaries.length?d():b.LoadCommonLibs(d)},function(f){"object"===typeof console&&(console.log("D2L common library failed to load:"+f.statusText),console.log(f),a++);return a>b._D2L_CommonLibaries.length?
d():b.LoadCommonLibs(d)})}}(this),0!==this._D2L_CommonLibaries.length))return b()};f.prototype.InitCSSAdjustments=function(b){};f.prototype.HeightChangeRequest=function(b){if("Brightspace"===this._Environment&&(D2LAdventureEngine.gu_CSSManager.AlterCSSRule("adventureStyles","body","height",b+"px"),!(this.GetBrightspaceContainer().style.height=b+"px")))return!1};f.prototype.GetBrightspaceContainer=function(){var b,a,c,d;d=window.parent.document.getElementsByTagName("iframe");a=0;for(c=d.length;a<c;a++)if(b=
d[a],b.name.toLowerCase().indexOf("content"))return b;D2LAdventureEngine.gu_debugManager.log("GetBrightspaceContainer was unable to find parent container");return!1};f.prototype.CallFullScreenPopout=function(){try{window.top.D2L.O("__g1",9)()}catch(b){D2LAdventureEngine.gu_debugManager.log("CallFullScreenPopout call failed")}};return f}();window.D2LAdventureEngine.TweenManager=function(){function f(){this.RemoveTweensFromComp=g(this.RemoveTweensFromComp,this);this.CallTween=g(this.CallTween,this);
this.ForceEndEffects=g(this.ForceEndEffects,this);this.HandleTweenComplete=g(this.HandleTweenComplete,this);this.SetTweenOnComplete=g(this.SetTweenOnComplete,this);this.SetTweenEffects=g(this.SetTweenEffects,this);this.isActive=g(this.isActive,this);this.GetTween=g(this.GetTween,this);this.SetGlobalTweens=g(this.SetGlobalTweens,this);this.GlobalTweenData=[];this._currentActiveTweens=[]}f.prototype.SetGlobalTweens=function(b){var a,c;if(void 0!==b&&null!==b){a=0;for(c=[];a<b.length;)null===b[a]||void 0===
b[a]?window.D2LAdventureEngine.gu_debugManager.log("Global Tween ID "+b[a]+" has no data and will be ignored"):(null!==b[a].effects&&void 0!==b[a].effects&&(b[a].effects=b[a].effects),this.GlobalTweenData.push(b[a])),c.push(a++);return c}};f.prototype.GetTween=function(b){var a;for(a=0;a<this.GlobalTweenData.length;){if(this.GlobalTweenData[a].ID===b)return this.GlobalTweenData[a];a++}return!1};f.prototype.isActive=function(b){var a;for(a=0;a<this._currentActiveTweens.length;){if(this._currentActiveTweens[a].tweenID===
b)return!0;a++}return!1};f.prototype.SetTweenEffects=function(b,a){var c;if(c=this.GetTween(b))return c.effects=a};f.prototype.SetTweenOnComplete=function(b,a){var c;if(c=this.GetTween(b))return c.onComplete=a};f.prototype.HandleTweenComplete=function(b,a){var c,d;d=this.GetTween(b);c=D2LAdventureEngine.gu_StateManager.findComponent(a);if(void 0!==d.loop&&null!==d.loop&&"[%false]"!==d.loop&&!1!==d.loop)void 0!==d.onLoop&&null!==d.onLoop&&(c={type:"onLoop"},D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(d.onLoop,
c));else if(!1!==d&&!1!==c){c.RemoveTweeningListItem&&(this.ForceEndEffects(d,c),c.RemoveTweeningListItem(d.ID));for(c=0;c<this._currentActiveTweens.length;)this._currentActiveTweens[c].tweenID===b&&this._currentActiveTweens[c].targetID===a&&this._currentActiveTweens.splice(c,1),c++;void 0!==d.onComplete&&null!==d.onComplete&&(c={type:"onComplete"},D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(d.onComplete,c))}};f.prototype.ForceEndEffects=function(b,a){var c;if(void 0!==b.effects&&
null!==b.effects&&(c=D2LAdventureEngine.gu_JsonOps.parseConverstionRules,void 0!==b.effects.alpha&&(a.SetAlpha?a.SetAlpha(c(b.effects.alpha)):a.alpha&&(a.alpha=c(b.effects.alpha))),void 0!==b.effects.width&&(a.Resize?void 0===b.effects.height&&a.Resize(c(b.effects.width),c(a.getHeight())):a.width&&(a.width=c(b.effects.width))),void 0!==b.effects.height&&(a.Resize?void 0===b.effects.width&&a.Resize(c(a.getWidth()),c(b.effects.height)):a.height&&(a.height=b.effects.height)),void 0!==b.effects.width&&
void 0!==b.effects.height&&a.Resize&&a.Resize(c(b.effects.width),c(b.effects.height)),void 0!==b.effects.x&&(a.Move?void 0===b.effects.y&&a.Move(c(b.x),c(a.y)):a.x=c(b.effects.x)),void 0!==b.effects.y&&(a.Move?void 0===b.effects.x&&a.Move(c(a.x),c(b.effects.y)):a.y=c(b.effects.y)),void 0!==b.effects.x&&void 0!==b.effects.y&&a.Move))return a.Move(c(b.effects.x),c(b.effects.y))};f.prototype.CallTween=function(b,a){var c,d,f,g,k;a.constructor===String&&(a=D2LAdventureEngine.gu_ComponentManager.FindExistingComp(a));
a.CheckTweenValHolder&&a.CheckTweenValHolder();for(c=0;c<this.GlobalTweenData.length;){k=D2LAdventureEngine.gu_JsonOps.parseAllRules(this.GlobalTweenData[c],a);if(k.ID===b){g=createjs.Tween.get(a);void 0!==a._TweenValueHolder&&(d=createjs.Tween.get(a._TweenValueHolder));this.RemoveTweensFromComp(a);void 0!==k.wait&&null!==k.wait&&(g.wait(k.wait),d&&g.wait(k.wait));void 0!==k.effects&&null!==k.effects&&void 0!==k.tempo&&null!==k.tempo&&(f=k.effects,c={},void 0!==f.alpha&&(c.alpha=f.alpha,delete f.alpha),
void 0!==f.width&&(c.width=f.width,delete f.width),void 0!==f.height&&(c.height=f.height,delete f.height),void 0!==f.x&&(c.x=f.x,delete f.x),void 0!==f.y&&(c.y=f.y,delete f.y),void 0!==k.ease&&null!==k.ease?void 0!==k.easeParams?(f&&0!==Object.keys(f).length&&g.to(f,k.tempo,createjs.Ease[k.ease](k.easeParams[0],k.easeParams[1])),d&&0!==Object.keys(c).length&&d.to(c,k.tempo,createjs.Ease[k.ease](k.easeParams[0],k.easeParams[1]))):(f&&0!==Object.keys(f).length&&g.to(f,k.tempo,createjs.Ease[k.ease]()),
d&&0!==Object.keys(c).length&&d.to(c,k.tempo,createjs.Ease[k.ease]())):(f&&g.to(f,k.tempo),d&&d.to(c,k.tempo)),void 0!==k.loop&&null!==k.loop&&(g.loop=k.loop,d.loop=k.loop),void 0!==k.bounce&&null!==k.bounce&&(g.bounce=k.bounce,d.bounce=k.bounce),void 0!==g.target.AddTweeningListItem&&g.target.AddTweeningListItem(b),this._currentActiveTweens.push({tweenID:b,targetID:g.target._id}));d?d.call(this.HandleTweenComplete,[b,g.target._id]):g.call(this.HandleTweenComplete,[b,g.target._id]);break}c++}};f.prototype.RemoveTweensFromComp=
function(b){var a;b._id&&(b=b._id);for(a=0;a<this._currentActiveTweens.length;)this._currentActiveTweens[a].targetID===b&&this._currentActiveTweens.splice(a,1),a++;return createjs.Tween.removeTweens(D2LAdventureEngine.gu_StateManager.findComponent(b))};return f}();window.D2LAdventureEngine.AEevent=function(){function f(b){this.Dispactch=g(this.Dispactch,this);this.HasTrigger=g(this.HasTrigger,this);this.SetTriggers=g(this.SetTriggers,this);this._index=b.index;this._owner=b.owner;this._isDefault=b.isDefault;
this.SetTriggers(b.trigger);b.effects.constructor===Array&&(this._effects=b.effects);if(b.effects.constructor===String||b.effects.constructor===Function)this._effects=[b.effects];this._effectsParams=b.effectParams}f.prototype._index=void 0;f.prototype._owner=void 0;f.prototype._triggers=void 0;f.prototype._effects=void 0;f.prototype._effectsParams=void 0;f.prototype._isDefault=void 0;f.prototype.SetTriggers=function(b){var a,c,d,f;b.constructor===Array&&(this._triggers=b);b.constructor===String&&
(this._triggers=[b]);c=this._triggers;d=[];b=0;for(a=c.length;b<a;b++)f=c[b],d.push(f.toLowerCase());return d};f.prototype.HasTrigger=function(b){var a,c,d,f;d=this._triggers;a=0;for(c=d.length;a<c;a++)if(f=d[a],f.toLowerCase()===b.toLowerCase())return!0;return!1};f.prototype.Dispactch=function(b,a){var c,d,f,g;a||(a={});a.compRefString="D2LAdventureEngine.gu_StateManager.findComponent('"+this._owner._id+"')";a.compRef=this._owner;a.interactionType=b;a.data=this._effectsParams;g=this._effects;d=0;
for(f=g.length;d<f;d++)c=g[d],c.constructor===Function?c(a):c.constructor===String&&D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(c,a)};return f}();window.D2LAdventureEngine.debugManager=function(){function f(){this.drawGPoint=g(this.drawGPoint,this);this.log=g(this.log,this);this.toggleDOM=g(this.toggleDOM,this);this.updateMessages=g(this.updateMessages,this);this.DestroyDom=g(this.DestroyDom,this);this.Update=g(this.Update,this);this.BuildDOM=g(this.BuildDOM,this);this.HandleShutdownReq=
g(this.HandleShutdownReq,this);this._debugWrapperElemID="AdventureDebug_Wrapper";this._DebugMessages=[];this._DOMBuilt=!1;this._MaxShowMessages=50;this._showFPS=this._fpsIndicatorBuilt=!1;this._gpoints=0}f.prototype._DebugMessages=void 0;f.prototype._debugWrapperElemID=void 0;f.prototype._DOMBuilt=void 0;f.prototype._MaxShowMessages=void 0;f.prototype._fpsIndicator=void 0;f.prototype._showFPS=void 0;f.prototype._fpsIndicatorBuilt=void 0;f.prototype._gpoints=void 0;f.prototype.HandleShutdownReq=function(){return this.DestroyDom()};
f.prototype.BuildDOM=function(){var b;b=document.createElement("div");b.setAttribute("id",this._debugWrapperElemID);b.innerHTML="Adventure Debugger Activated";b.setAttribute("style","position:absolute; overflow-x:scroll; width: "+(window.D2LAdventureEngine.gu_canDi.trueWidth-50)+"px;");document.getElementById(window.D2LAdventureEngine.gu_AdventureID).parentNode.insertBefore(b,document.getElementById(window.D2LAdventureEngine.gu_AdventureID).nextSibling);return this._DOMBuilt=!0};f.prototype.Update=
function(b){if(!this._fpsIndicatorBuilt&&void 0!==createjs&&void 0!==window.D2LAdventureEngine.gu_GUIManager)return b=new createjs.Shape,b.graphics.beginFill("#000000").drawRect(6,6,80,20),b.alpha=.5,b.visible=this._showFPS,window.D2LAdventureEngine.gu_GUIManager.addChild(b),this._fpsIndicator=new createjs.Text("FPS: --","10px Arial","white"),this._fpsIndicator.x=10,this._fpsIndicator.y=10,this._fpsIndicator.visible=this._showFPS,window.D2LAdventureEngine.gu_GUIManager.addChild(this._fpsIndicator),
this._fpsIndicatorBuilt=!0;if(this._fpsIndicatorBuilt)return createjs.Ticker.getMeasuredFPS()<createjs.Ticker.framerate/2?this._fpsIndicator.color="#F00":createjs.Ticker.getMeasuredFPS()<createjs.Ticker.framerate/4*3?this._fpsIndicator.color="#FF0":this._fpsIndicator.color="#FFF",this._fpsIndicator.text="FPS: "+Math.floor(createjs.Ticker.getMeasuredFPS())+" / "+Math.round(createjs.Ticker.framerate)};f.prototype.DestroyDom=function(){if(this._DOMBuilt)return document.getElementById(window.D2LAdventureEngine.gu_AdventureID).parentNode.removeChild(document.getElementById(this._debugWrapperElemID)),
this._DOMBuilt=!1};f.prototype.updateMessages=function(){var b,a,c;if(this._DOMBuilt){a="<strong>Adventure Debugger:</strong> <br>";c=this._DebugMessages.length<this._MaxShowMessages?this._DebugMessages.length:this._MaxShowMessages;for(b=0;b<c;)a+=this._DebugMessages.length-1-b+": "+this._DebugMessages[this._DebugMessages.length-1-b]+"<br>",b++;return document.getElementById(this._debugWrapperElemID).innerHTML=a}};f.prototype.toggleDOM=function(){if(this._DOMBuilt)return this.DestroyDom();this.BuildDOM();
return this.updateMessages()};f.prototype.log=function(b){"object"===typeof console&&(b.message&&b.stack?console.log(b.message+" STACK:"+b.stack):console.log(b));b.message&&b.stack?this._DebugMessages.push(b.message+" STACK:"+b.stack):this._DebugMessages.push(b);return this.updateMessages()};f.prototype.drawGPoint=function(b,a){var c,d;b||(b="#FFFFFF");a||(a="Point_"+this._gpoints);d=new createjs.Container;d.initialize();c=new createjs.Graphics;c.beginStroke(b);c.moveTo(-5,0);c.lineTo(5,0);c.moveTo(0,
-5);c.lineTo(0,5);c.endStroke();d.addChild(new createjs.Shape(c));c=new createjs.Text(a,"bold 10px Arial",b);c.x=7;c.y=-10;d.addChild(c);this._gpoints++;return d};return f}();window.D2LAdventureEngine.QuizManager=function(){function f(){this.ResetAttemptData=g(this.ResetAttemptData,this);this.SubmitQuizAttempt=g(this.SubmitQuizAttempt,this);this.assignQuizID=g(this.assignQuizID,this);this.getQuizAttemptData=g(this.getQuizAttemptData,this);this.GetQuizData=g(this.GetQuizData,this);this.Init=g(this.Init,
this)}f.prototype._QuizInitData=void 0;f.prototype._QuizOptions=void 0;f.prototype._Quizes=void 0;f.prototype._QuizAttemptData=void 0;f.prototype.Init=function(){if(void 0===this._QuizInitData)return D2LAdventureEngine.gu_debugManager.log("ERROR Quiz manager was initialized without data");this._QuizAttemptData=[];return this._Quizes=[]};f.prototype.GetQuizData=function(b){var a,c,d,f;f=this._QuizInitData;a=0;for(c=f.length;a<c;a++)if(d=f[a],d.ID===b)return D2LAdventureEngine.gu_JsonOps.parseConverstionRules(d);
return!1};f.prototype.getQuizAttemptData=function(b){var a,c,d,f;f=this._QuizAttemptData;a=0;for(c=f.length;a<c;a++)if(d=f[a],d.QuizID===b)return d;return!1};f.prototype.assignQuizID=function(b){var a;for(a=0;a<this._Quizes.length;){if(b===this._Quizes[a])return a;a++}this._Quizes.push(b);return this._Quizes.length-1};f.prototype.SubmitQuizAttempt=function(b){var a,c,d,f,g;if(c=this.getQuizAttemptData(b.quizID)){g=c.Attempts;d=0;for(f=g.length;d<f;d++)if(a=g[d],a.qIndex===b.qIndex)return b;return c.Attempts.push(b)}return this._QuizAttemptData.push({QuizID:b.quizID,
Attempts:[b]})};f.prototype.ResetAttemptData=function(){return this._QuizAttemptData=[]};return f}();window.D2LAdventureEngine.dataManager=function(){function f(b){this.getImgData=g(this.getImgData,this);this.mergeObjectData=g(this.mergeObjectData,this);this.cloneDataObj=g(this.cloneDataObj,this);this.GetDataAsset=g(this.GetDataAsset,this);this._setEngineObject=g(this._setEngineObject,this);this._getEngineObject=g(this._getEngineObject,this);this._clearLocalData=g(this._clearLocalData,this);this._getLocalData=
g(this._getLocalData,this);this._setLocalData=g(this._setLocalData,this);this.getData=g(this.getData,this);this.setData=g(this.setData,this);this.SetValKeys=g(this.SetValKeys,this);this.Update=g(this.Update,this);this.Init=g(this.Init,this);this.InstanceID=b;this._ValanceAuthenticated=!1;this._KeyStoreVer="1.0";this._TraceValEvents=!1;this._LastSyncTime=-1;this._SyncRequired=this._ForceSync=this._ValenceBusy=!1;this._SyncTriggerTime=15;this.Init()}f.prototype.Init=function(){this.EngineObject=this._getEngineObject();
if(null===this.EngineObject)return this.EngineObject={InID:this.InstanceID,ar:0}};f.prototype.Update=function(b){b=(new Date).getTime();if(this._ForceSync||this._SyncRequired&&!this._ValenceBusy&&b>this._LastSyncTime+1E3*this._SyncTriggerTime)return this.SyncData(),this._SyncRequired=this._ForceSync=!1};f.prototype.SetValKeys=function(b){this._StoredValKeys=[];return this.AddValKeys(b)};f.prototype.setData=function(b,a){this._setLocalData(b,a);this._setLocalData("locPutUnixTime",(new Date).getTime());
return this._SyncRequired=!0};f.prototype.getData=function(b){return this.EngineObject[b]};f.prototype._setLocalData=function(b,a){return b!=="AE_"+this.InstanceID+"_a"?void 0!==a?(this.EngineObject[b]=a,this._setEngineObject()):D2LAdventureEngine.gu_debugManager.log("Warning: dataManager._setLocalData received undefined object data, request ignored, to delete data use deleteLocalObject"):D2LAdventureEngine.gu_debugManager.log("Warning: dataManager._setLocalData attempt to store in key id AE_"+this.InstanceID(NaN))};
f.prototype._getLocalData=function(b){return this.EngineObject[b]};f.prototype._clearLocalData=function(b){void 0===b?this.EngineObject={InID:this.InstanceID,ar:0}:this.EngineObject[b]=void 0;return this._setEngineObject()};f.prototype._getEngineObject=function(){return JSON.parse(localStorage.getItem(this.InstanceID))};f.prototype._setEngineObject=function(){try{return localStorage.removeItem(this.InstanceID),localStorage.setItem(this.InstanceID,JSON.stringify(this.EngineObject))}catch(b){return localStorage.removeItem(this.InstanceID),
D2LAdventureEngine.gu_debugManager.log("data storage has failed on this device, clearing related local data")}};f.prototype.GetDataAsset=function(b){var a,c;c=D2LAdventureEngine.gu_DataAssets;for(a=0;a<c.length;){if(b===c[a].id)return c[a].data;a++}return!1};f.prototype.cloneDataObj=function(b){var a,c;if(null==b||"object"!==typeof b)return b&&b.valueOf?b.valueOf():b;if(b instanceof Date)return new Date(b.getTime());if(b instanceof RegExp)return a="",null!=b.global&&(a+="g"),null!=b.ignoreCase&&(a+=
"i"),null!=b.multiline&&(a+="m"),null!=b.sticky&&(a+="y"),new RegExp(b.source,a);try{for(a in c=b.constructor instanceof D2LAdventureEngine.State||b.constructor instanceof D2LAdventureEngine.Scene?b:b instanceof D2LAdventureEngine.component?b.clone?b.clone():new b.constructor(b._id.valueOf(),b.location,b._options):void 0!==b.clone&&b.clone.constructor===Function?b.clone():new b.constructor,b)c[a]=this.cloneDataObj(b[a])}catch(d){c=b.valueOf()}return c.valueOf()};f.prototype.mergeObjectData=function(b,
a){var c,d;b=this.cloneDataObj(b);a=this.cloneDataObj(a);d=b;if(void 0===b&&void 0===a)return null;if(void 0===b)return a;if(void 0===a)return b;for(c=0;c<Object.keys(a).length;)d[Object.keys(a)[c]]&&d[Object.keys(a)[c]].constructor===Object?d[Object.keys(a)[c]]=this.mergeObjectData(d[Object.keys(a)[c]],a[Object.keys(a)[c]]):d[Object.keys(a)[c]]=a[Object.keys(a)[c]],c++;return d};f.prototype.getImgData=function(b,a){var c;c=document.createElement("canvas");a?(c.width=a.width,c.height=a.height,c.getContext("2d").drawImage(b,
a.x,a.y,a.width,a.height,0,0,a.width,a.height)):(c.width=b.width,c.height=b.height,c.getContext("2d").drawImage(b,0,0));return String(c.toDataURL("image/png"))};return f}();D2LAdventureEngine.KeyManager=function(){function f(){this.Update=g(this.Update,this);this.HandleScrollReq=g(this.HandleScrollReq,this);this.endScrollTargeting=g(this.endScrollTargeting,this);this.SetScrollingTarg=g(this.SetScrollingTarg,this);this.UnassignFunction=g(this.UnassignFunction,this);this.AssignFunction=g(this.AssignFunction,
this);this.HandleKeyUp=g(this.HandleKeyUp,this);this.HandleKeyPress=g(this.HandleKeyPress,this);this.HandleKeyDown=g(this.HandleKeyDown,this);this.SetGlobalKeys=g(this.SetGlobalKeys,this);this.DeactivateDebugKey=g(this.DeactivateDebugKey,this);this.ActivateDebugKey=g(this.ActivateDebugKey,this);this.DectivateAcessKeys=g(this.DectivateAcessKeys,this);this.ActivateAcessKeys=g(this.ActivateAcessKeys,this);this.DeactivateKey=g(this.DeactivateKey,this);this.SetInactiveKey=g(this.SetInactiveKey,this);this.ActivateKey=
g(this.ActivateKey,this);this.getKeyCodeOfKeyID=g(this.getKeyCodeOfKeyID,this);this.getFunctionAssignedToKeyCode=g(this.getFunctionAssignedToKeyCode,this);this.KeyStatus=g(this.KeyStatus,this);this.HandleShutdownReq=g(this.HandleShutdownReq,this);this.Init=g(this.Init,this);this._initialized=!1;this._ActiveKeys=[];this._InactiveKeys=[];this._scrollMov="none";this._storedScrollKeys={up:void 0,down:void 0};this._scrollSpeed=2}f.prototype._initGlobalKeyData=void 0;f.prototype._initialized=void 0;f.prototype._ActiveKeys=
void 0;f.prototype._InactiveKeys=void 0;f.prototype._scrollTarget=void 0;f.prototype._scrollMov=void 0;f.prototype._storedScrollKeys=void 0;f.prototype._scrollSpeed=void 0;f.prototype.Init=function(){document.onkeydown=this.HandleKeyDown;document.onkeypress=this.HandleKeyPress;document.onkeyup=this.HandleKeyUp;this.SetGlobalKeys();return this._initialized=!0};f.prototype.HandleShutdownReq=function(){document.onkeydown=void 0;document.onkeypress=void 0;return document.onkeyup=void 0};f.prototype.KeyStatus=
function(b){var a,c;for(a=0;a<this._ActiveKeys.length;){if(this._ActiveKeys[a].id===b)return"active";a++}for(c=0;c<this._InactiveKeys.length;){if(this._InactiveKeys[a].id===b)return"inactive";c++}return"unassigned"};f.prototype.getFunctionAssignedToKeyCode=function(b,a){var c,d;for(c=0;c<this._ActiveKeys.length;){if(this._ActiveKeys[c].code===b)if(a){if(d=!0,void 0!==a.useShift&&a.useShift!==this._ActiveKeys[c].useShift&&(d=!1),void 0!==a.useAlt&&a.useAlt!==this._ActiveKeys[c].useAlt&&(d=!1),void 0!==
a.useCtrl&&a.useCtrl!==this._ActiveKeys[c].useCtrl&&(d=!1),d)return this._ActiveKeys[c].id}else return this._ActiveKeys[c].id;c++}};f.prototype.getKeyCodeOfKeyID=function(b){var a,c;b=b.toLowerCase();c=void 0;for(a=0;a<this._ActiveKeys.length;)this._ActiveKeys[a].id===b&&(c=this._ActiveKeys[a].code),a++;if(void 0===c)for(a=0;a<this._InactiveKeys.length;)this._InactiveKeys[a].id===b&&(c=this._InactiveKeys[a].code),a++;return c};f.prototype.ActivateKey=function(b,a,c){b=b.toLowerCase();if(void 0===
a&&void 0===c){for(a=0;a<this._ActiveKeys.length;){if(this._ActiveKeys[a].id===b)return!0;a++}for(a=0;a<this._InactiveKeys.length;){if(this._InactiveKeys[a].id===b)return this._ActiveKeys.push(this._InactiveKeys[a]),this._InactiveKeys.splice(a,1),!0;a++}return!1}void 0===c&&(c={});if(void 0===c.capsCode||"default"===c.capsCode)c.capsCode=a;void 0===c.downFunctionRef&&(c.downFunctionRef="unassigned");void 0===c.pressFunctionRef&&(c.pressFunctionRef="unassigned");void 0===c.upFunctionRef&&(c.upFunctionRef=
"unassigned");void 0===c.useCtrl&&(c.useCtrl=!1);void 0===c.useShift&&(c.useShift=!1);void 0===c.useAlt&&(c.useAlt=!1);void 0===c.allowDefault&&(c.allowDefault=!1);void 0===c.functionData&&(c.functionData=c.data);return this._ActiveKeys.push({id:b,code:a,capsCode:c.capsCode,data:c.functionData,downFunctionRef:c.downFunctionRef,pressFunctionRef:c.pressFunctionRef,upFunctionRef:c.upFunctionRef,useCtrl:c.useCtrl,useShift:c.useShift,useAlt:c.useAlt,allowDefault:c.allowDefault})};f.prototype.SetInactiveKey=
function(b,a,c){b=b.toLowerCase();if(void 0===c)c={capsCode:"default",functionData:void 0,downFunctionRef:"unassigned",pressFunctionRef:"unassigned",upFunctionRef:"unassigned",useCtrl:!1,useShift:!1,useAlt:!1,allowDefault:!1};else{if("default"===c.capsCode||void 0===c.capsCode)c.capsCode=a;void 0===c.downFunctionRef&&(c.downFunctionRef="unassigned");void 0===c.pressFunctionRef&&(c.pressFunctionRef="unassigned");void 0===c.upFunctionRef&&(c.upFunctionRef="unassigned");void 0===c.useCtrl&&(c.useCtrl=
!1);void 0===c.useShift&&(c.useShift=!1);void 0===c.useAlt&&(c.useAlt=!1);void 0===c.allowDefault&&(c.allowDefault=!1);void 0===c.functionData&&(c.functionData=c.data)}this._InactiveKeys.push({id:b,code:a,capsCode:c.capsCode,data:c.functionData,downFunctionRef:c.downFunctionRef,pressFunctionRef:c.pressFunctionRef,upFunctionRef:c.upFunctionRef,useCtrl:c.useCtrl,useShift:c.useShift,useAlt:c.useAlt,allowDefault:c.allowDefault});return!0};f.prototype.DeactivateKey=function(b){var a,c;b=b.toLowerCase();
a=0;for(c=[];a<this._ActiveKeys.length;)b===this._ActiveKeys[a].id&&(this._InactiveKeys.push(this._ActiveKeys[a]),this._ActiveKeys.splice(a,1)),c.push(a++);return c};f.prototype.ActivateAcessKeys=function(){this.ActivateKey("gDefKey_AcessMode_Select");this.ActivateKey("gDefKey_AcessMode_ReverseSelect");return this.ActivateKey("gDefKey_AcessMode_Activate")};f.prototype.DectivateAcessKeys=function(){this.DeactivateKey("gDefKey_AcessMode_Select");this.DeactivateKey("gDefKey_AcessMode_ReverseSelect");
return this.DeactivateKey("gDefKey_AcessMode_Activate")};f.prototype.ActivateDebugKey=function(){return this.ActivateKey("gDefKey_ToggleDebugDOM")};f.prototype.DeactivateDebugKey=function(){return this.DeactivateKey("gDefKey_ToggleDebugDOM")};f.prototype.SetGlobalKeys=function(){var b,a,c;for(b=0;b<this._initGlobalKeyData.ActiveKeys.length;)a=this._initGlobalKeyData.ActiveKeys[b],this.ActivateKey(a.ID,a.keyCode,a),b++;b=0;for(c=[];b<this._initGlobalKeyData.InactiveKeys.length;)a=this._initGlobalKeyData.InactiveKeys[b],
this.SetInactiveKey(a.ID,a.keyCode,a),c.push(b++);return c};f.prototype.HandleKeyDown=function(b){var a,c;a=0;for(c=[];a<this._ActiveKeys.length;)(b.key===this._ActiveKeys[a].code||b.key===this._ActiveKeys[a].capsCode)&&"unassigned"!==this._ActiveKeys[a].downFunctionRef&&(this._ActiveKeys[a].useCtrl&&b.ctrlKey||!this._ActiveKeys[a].useCtrl&&!b.ctrlKey)&&(this._ActiveKeys[a].useShift&&b.shiftKey||!this._ActiveKeys[a].useShift&&!b.shiftKey)&&(this._ActiveKeys[a].useAlt&&b.altKey||!this._ActiveKeys[a].useAlt&&
!b.altKey)&&(this._ActiveKeys[a].allowDefault||b.preventDefault(),this._ActiveKeys[a].downFunctionRef.constructor===String?D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(this._ActiveKeys[a].downFunctionRef):this._ActiveKeys[a].downFunctionRef(this._ActiveKeys[a])),c.push(a++);return c};f.prototype.HandleKeyPress=function(b){var a,c;a=0;for(c=[];a<this._ActiveKeys.length;)(b.key===this._ActiveKeys[a].code||b.key===this._ActiveKeys[a].capsCode)&&"unassigned"!==this._ActiveKeys[a].pressFunctionRef&&
(this._ActiveKeys[a].useCtrl&&b.ctrlKey||!this._ActiveKeys[a].useCtrl&&!b.ctrlKey)&&(this._ActiveKeys[a].useShift&&b.shiftKey||!this._ActiveKeys[a].useShift&&!b.shiftKey)&&(this._ActiveKeys[a].useAlt&&b.useAlt||!this._ActiveKeys[a].useAlt&&!b.useAlt)&&(this._ActiveKeys[a].allowDefault||b.preventDefault(),this._ActiveKeys[a].pressFunctionRef.constructor===String?D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(this._ActiveKeys[a].pressFunctionRef):this._ActiveKeys[a].pressFunctionRef(this._ActiveKeys[a])),
c.push(a++);return c};f.prototype.HandleKeyUp=function(b){var a,c;a=0;for(c=[];a<this._ActiveKeys.length;)(b.key===this._ActiveKeys[a].code||b.key===this._ActiveKeys[a].capsCode)&&"unassigned"!==this._ActiveKeys[a].upFunctionRef&&(this._ActiveKeys[a].useCtrl&&b.ctrlKey||!this._ActiveKeys[a].useCtrl&&!b.ctrlKey)&&(this._ActiveKeys[a].useShift&&b.shiftKey||!this._ActiveKeys[a].useShift&&!b.shiftKey)&&(this._ActiveKeys[a].useAlt&&b.useAlt||!this._ActiveKeys[a].useAlt&&!b.useAlt)&&(this._ActiveKeys[a].allowDefault||
b.preventDefault(),this._ActiveKeys[a].upFunctionRef.constructor===String?D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(this._ActiveKeys[a].upFunctionRef):this._ActiveKeys[a].upFunctionRef(this._ActiveKeys[a])),c.push(a++);return c};f.prototype.AssignFunction=function(b,a,c){var d;b=b.toLowerCase();a=a.toLowerCase();for(d=0;d<this._ActiveKeys.length;){if(b===this._ActiveKeys[d].id){if("down"===a)return this._ActiveKeys[d].downFunctionRef=c,!0;if("up"===a)return this._ActiveKeys[d].upFunctionRef=
c,!0;if("press"===a)return this._ActiveKeys[d].pressFunctionRef=c,!0;D2LAdventureEngine.gu_debugManager.log("ERROR! attempting to assign key function to unknown state "+a+" use only up, down, or press");return!1}d++}for(d=0;d<this._InactiveKeys.length;){if(b===this._InactiveKeys[d].id){if("down"===a)return this._InactiveKeys[d].downFunctionRef=c,!0;if("up"===a)return this._InactiveKeys[d].upFunctionRef=c,!0;if("press"===a)return this._InactiveKeys[d].pressFunctionRef=c,!0;D2LAdventureEngine.gu_debugManager.log("ERROR! attempting to assign key function to unknown state "+
a+" use only up, down, or press");return!1}d++}D2LAdventureEngine.gu_debugManager.log("ERROR! attempting to assign unknown or inactive key "+b);return!1};f.prototype.UnassignFunction=function(b,a){var c;b=b.toLowerCase();a=a.toLowerCase();for(c=0;c<this._ActiveKeys.length;){if(b===this._ActiveKeys[c].id){if("down"===a)return this._ActiveKeys[c].downFunctionRef="unassigned",!0;if("up"===a)return this._ActiveKeys[c].upFunctionRef="unassigned",!0;if("press"===a)return this._ActiveKeys[c].pressFunctionRef=
"unassigned",!0;D2LAdventureEngine.gu_debugManager.log("ERROR! attempting to unassign key function to unknown state "+a+" use only up, down, or press");return!1}c++}for(c=0;c<this._InactiveKeys.length;){if(b===this._InactiveKeys[c].id){if("down"===a)return this._InactiveKeys[c].downFunctionRef="unassigned",!0;if("up"===a)return this._InactiveKeys[c].upFunctionRef="unassigned",!0;if("press"===a)return this._InactiveKeys[c].pressFunctionRef="unassigned",!0;D2LAdventureEngine.gu_debugManager.log("ERROR! attempting to unassign key function to unknown state "+
a+" use only up, down, or press");return!1}c++}D2LAdventureEngine.gu_debugManager.log("ERROR! attempting to unassign unknown or inactive key "+b);return!1};f.prototype.SetScrollingTarg=function(b){return void 0!==b&&null!==b?void 0!==b.scrollTop?(this._scrollTarget=b,this._storedScrollKeys={up:this.getFunctionAssignedToKeyCode(this.getKeyCodeOfKeyID("gDefKey_AcessMode_ScrollUp")),down:this.getFunctionAssignedToKeyCode(this.getKeyCodeOfKeyID("gDefKey_AcessMode_ScrollDown"))},this.DeactivateKey(this._storedScrollKeys.up),
this.DeactivateKey(this._storedScrollKeys.down),this.ActivateKey("gDefKey_AcessMode_ScrollUp"),this.ActivateKey("gDefKey_AcessMode_ScrollDown")):D2LAdventureEngine.gu_debugManager.log("ERROR!! attempting to call SetScrollingTarg on target which has no scrollTop property"):D2LAdventureEngine.gu_debugManager.log("ERROR!! attempting to call SetScrollingTarg on null target")};f.prototype.endScrollTargeting=function(){this._scrollTarget=void 0;this._scrollMov="none";this.DeactivateKey("gDefKey_AcessMode_ScrollUp");
this.DeactivateKey("gDefKey_AcessMode_ScrollDown");this.ActivateKey(this._storedScrollKeys.up);this.ActivateKey(this._storedScrollKeys.down);return this._storedScrollKeys=void 0};f.prototype.HandleScrollReq=function(b){if("up"===b||"down"===b||"none"===b)return this._scrollMov=b;D2LAdventureEngine.gu_debugManager.log("ERROR!! HandleScrollReq receiving unknown direction value "+b+" setting as 'none'");return this._scrollMov="none"};f.prototype.Update=function(b){if(this._initialized&&void 0!==this._scrollTarget){if("up"===
this._scrollMov)return this._scrollTarget.scrollTop-=this._scrollSpeed;if("down"===this._scrollMov)return this._scrollTarget.scrollTop+=this._scrollSpeed}};return f}();window.D2LAdventureEngine.ClippingRuleManager=function(){function f(){this.CheckClippingRules=g(this.CheckClippingRules,this);this.setRuleOrder=g(this.setRuleOrder,this);this.getRuleByOwnerID=g(this.getRuleByOwnerID,this);this.isCompRuleOwner=g(this.isCompRuleOwner,this);this.ChangeClippingRule=g(this.ChangeClippingRule,this);this.RemoveRule=
g(this.RemoveRule,this);this.SetRule=g(this.SetRule,this);this.Init=g(this.Init,this);this.clippingRules=[]}f.prototype.clippingRules=void 0;f.prototype.Init=function(){};f.prototype.SetRule=function(b,a){return this.ChangeClippingRule({rect:b,RuleOwner:a})};f.prototype.RemoveRule=function(b){var a;for(a=0;a<this.clippingRules.length;){if(this.clippingRules[a].RuleOwner._id===b._id)return this.clippingRules.splice(a,1),!0;a++}return!1};f.prototype.ChangeClippingRule=function(b){var a,c;c=!1;for(a=
0;a<this.clippingRules.length;)this.clippingRules[a].RuleOwner._id===b.RuleOwner._id&&(this.clippingRules[a].rect=b.rect,c=!0),a++;c||this.clippingRules.push(b);return this.CheckClippingRules(b.RuleOwner)};f.prototype.isCompRuleOwner=function(b){var a;for(a=0;a<this.clippingRules.length;){if(this.clippingRules[a].RuleOwner._id===b._id)return!0;a++}return!1};f.prototype.getRuleByOwnerID=function(b){var a;for(a=0;a<this.clippingRules.length;){if(this.clippingRules[a].RuleOwner._id===b)return this.clippingRules[a];
a++}return!1};f.prototype.setRuleOrder=function(b){var a,c,d;a=[];for(c=0;c<this.clippingRules.length;){d=0;this.clippingRules[c].RuleOwner===b&&(this.clippingRules[c].nestPos=0,a.push(this.clippingRules[c].valueOf()));if(0!==b.nestedInGroups.length)for(;d<b.nestedInGroups.length;)this.clippingRules[c].RuleOwner._id===b.nestedInGroups[d]._id&&(this.clippingRules[c].nestPos=a.length+1,a.push(this.clippingRules[c].valueOf())),d++;c++}return a=a.sort(function(a){return function(a,b){return a.nestPos-
b.nestPos}}(this))};f.prototype.CheckClippingRules=function(b){var a,c,d,f,g,k,p,n;if(void 0!==b){b.tabulatedClippingStatus="in";b.tabulatedClippingRule="in";b.AssessGlobalPos();b.getWidth();b.getHeight();g=void 0;n=this.setRuleOrder(b);d=this.isCompRuleOwner(b)?this.getRuleByOwnerID(b._id):{RuleOwner:b,rect:{x:b._globalPos.x,y:b._globalPos.y,width:b.getWidth(),height:b.getHeight()}};n?n.push(d):n=[d];for(f=0;f<n.length;)void 0!==n[f].rect&&null!==n[f].rect&&(void 0===g?g={x:n[f].rect.x.valueOf(),
y:n[f].rect.y.valueOf(),width:n[f].rect.width.valueOf(),height:n[f].rect.height.valueOf()}:(a=D2LAdventureEngine.gu_DataManager.cloneDataObj(g),g.x=Math.max(n[f].rect.x,a.x),g.y=Math.max(n[f].rect.y,a.y),p=a.x+a.width,k=a.y+a.height,c=n[f].rect.x+n[f].rect.width,a=n[f].rect.y+n[f].rect.height,g.width=Math.min(p.valueOf(),c.valueOf())-g.x.valueOf(),g.height=Math.min(k.valueOf(),a.valueOf())-g.y.valueOf())),f++;if(g)if(0>g.width||0>g.height)b.tabulatedClippingStatus="out",b.tabulatedClippingRule="out";
else if(g.width<d.rect.width||g.height<d.rect.height)b.tabulatedClippingStatus="clipped",b.tabulatedClippingRule={},b._isDOMObject?(d.rect.x<g.x&&(b.tabulatedClippingRule.left=Math.round(g.x-d.rect.x)),d.rect.x+d.rect.width>g.x+g.width&&(b.tabulatedClippingRule.right=Math.round(d.rect.width-(d.rect.x+d.rect.width-(g.x+g.width)))),d.rect.y<g.y&&(b.tabulatedClippingRule.top=Math.round(g.y-d.rect.y)),d.rect.y+d.rect.height>g.y+g.height&&(b.tabulatedClippingRule.bottom=Math.round(d.rect.height-(d.rect.y+
d.rect.height-(g.y+g.height))))):(d.rect.x-d.RuleOwner._groupOffset.x<g.x&&(b.tabulatedClippingRule.left=Math.round(g.x-d.rect.x)),d.rect.x+d.rect.width+d.RuleOwner._groupOffset.x>g.x+g.width&&(b.tabulatedClippingRule.right=Math.round(d.rect.x+d.rect.width+d.RuleOwner._groupOffset.x-(g.x+g.width))),d.rect.y-d.RuleOwner._groupOffset.y<g.y&&(b.tabulatedClippingRule.top=Math.round(g.y-d.rect.y)),d.rect.y+d.rect.height+d.RuleOwner._groupOffset.y>g.y+g.height&&(b.tabulatedClippingRule.bottom=Math.round(d.rect.y+
d.rect.height+d.RuleOwner._groupOffset.y-(g.y+g.height)))),0===Object.keys(b.tabulatedClippingRule).length&&(b.tabulatedClippingStatus="in",b.tabulatedClippingRule="in");if(b.comp_CheckClippingRules)return b.comp_CheckClippingRules()}else return D2LAdventureEngine.gu_debugManager.log("CheckClippingRules called with comp not defined")};return f}();window.D2LAdventureEngine.SoundManager=function(){function f(){this.GetSoundById=g(this.GetSoundById,this);this.GetSoundsPlaying=g(this.GetSoundsPlaying,
this);this.GetNumberOfSoundsPlaying=g(this.GetNumberOfSoundsPlaying,this);this.HandleSoundCompletion=g(this.HandleSoundCompletion,this);this.AssignAudioEvent=g(this.AssignAudioEvent,this);this.BuildChannelPool=g(this.BuildChannelPool,this);this.InitDefaultWindow=g(this.InitDefaultWindow,this);this.adjustAllSounds=g(this.adjustAllSounds,this);this.ToggleMute=g(this.ToggleMute,this);this.Unmute=g(this.Unmute,this);this.Mute=g(this.Mute,this);this.adjustMasterVol=g(this.adjustMasterVol,this);this.FadeChannelVolTo=
g(this.FadeChannelVolTo,this);this.audjustChannelVol=g(this.audjustChannelVol,this);this.play=g(this.play,this);this.stopAll=g(this.stopAll,this);this.pause=g(this.pause,this);this.stop=g(this.stop,this);this.setLooping=g(this.setLooping,this);this.assignToChannel=g(this.assignToChannel,this);this.channelExist=g(this.channelExist,this);this.createChannel=g(this.createChannel,this);this.HandleShutdownReq=g(this.HandleShutdownReq,this);this.AddSoundEncodedData=g(this.AddSoundEncodedData,this);this.AddSoundData=
g(this.AddSoundData,this);this.Update=g(this.Update,this);this.Init=g(this.Init,this);this._Sounds=[];this._Channels=[];this._masterVolume=.5;this._muteMem=0;this._muted=!1}f.prototype._Sounds=void 0;f.prototype._Channels=void 0;f.prototype._masterVolume=void 0;f.prototype._muteMem=void 0;f.prototype._muted=void 0;f.prototype.Init=function(){var b;D2LAdventureEngine.gu_ingoreAudio||("EN"===D2LAdventureEngine.gu_LanguageSet?b="Sound Effects":"FR"===D2LAdventureEngine.gu_LanguageSet&&(b="Effets sonores"),
this.createChannel(b),this.assignToChannel("SFX_softClick_a",b),this.assignToChannel("SFX_softClick_b",b),this.assignToChannel("SFX_softClick_c",b))};f.prototype.Update=function(b){var a,c;if(!D2LAdventureEngine.gu_ingoreAudio)for(b=0;b<this._Channels.length;)void 0!==this._Channels[b].fadeFlags.volume&&(this._Channels[b].vol===this._Channels[b].fadeFlags.volume?(this._Channels[b].fadeFlags.volume=void 0,this._Channels[b].fadeFlags.volumeSpeed=void 0):(a=this._Channels[b].fadeFlags.volumeSpeed/100,
c=Math.abs(this._Channels[b].vol-this._Channels[b].fadeFlags.volume),c<a?this._Channels[b].vol=this._Channels[b].fadeFlags.volume:this._Channels[b].vol>this._Channels[b].fadeFlags.volume?this.audjustChannelVol(this._Channels[b].id,this._Channels[b].vol-a):this._Channels[b].vol<this._Channels[b].fadeFlags.volume&&this.audjustChannelVol(this._Channels[b].id,this._Channels[b].vol+a))),b++};f.prototype.AddSoundData=function(b){D2LAdventureEngine.gu_ingoreAudio||(void 0===b.looping&&(b.looping=!1),void 0===
b.channel&&("EN"===D2LAdventureEngine.gu_LanguageSet?b.channel="Sound Effects":"FR"===D2LAdventureEngine.gu_LanguageSet&&(b.channel="Effets sonores")),this.createChannel(b.channel),b.instance=createjs.Sound.createInstance(b.id),this._Sounds.push(b),this.setLooping(b.id,b.looping),this.assignToChannel(b.id,b.channel))};f.prototype.AddSoundEncodedData=function(b){var a;D2LAdventureEngine.gu_ingoreAudio||(void 0===b.looping&&(b.looping=!1),void 0===b.channel&&("EN"===D2LAdventureEngine.gu_LanguageSet?
b.channel="Sound Effects":"FR"===D2LAdventureEngine.gu_LanguageSet&&(b.channel="Effets sonores")),this.createChannel(b.channel),a=document.createElement("audio"),a.setAttribute("id",b.id),a.setAttribute("class","AdventureEngineAudioDOM"),a.setAttribute("src",b.src),b.isBase64=!0,b.instance=a,b.fadeFlags={},this._Sounds.push(b),this.setLooping(b.id,b.looping),this.assignToChannel(b.id,b.channel))};f.prototype.HandleShutdownReq=function(){var b,a;createjs.Sound.removeAllSounds();createjs.Sound.removeAllEventListeners();
a=document.getElementsByClassName("AdventureEngineAudioDOM");for(b=0;0<a.length;)a[0].parentNode.removeChild(a[0]),b++,999<b&&(a=[],"object"===typeof console&&console.log("Warning AE shutdown safe check tripped, stray adventure audio objects may still exist"))};f.prototype.createChannel=function(b){D2LAdventureEngine.gu_ingoreAudio||this.channelExist(b)||this._Channels.push({id:b,vol:this._masterVolume,fadeFlags:{},soundsInChannel:0})};f.prototype.channelExist=function(b){var a;for(a=0;a<this._Channels.length;){if(this._Channels[a].id===
b)return!0;a++}return!1};f.prototype.assignToChannel=function(b,a){var c,d;if(!D2LAdventureEngine.gu_ingoreAudio){for(c=0;c<this._Sounds.length;){if(this._Sounds[c].id===b){for(d=0;d<this._Channels.length;){if(this._Channels[d].id===a)return this._Sounds[c].channel=a,this._Channels[d].soundsInChannel++,!0;d++}window.D2LAdventureEngine.gu_debugManager.log("assignToChannel could not locate channel "+a);return!1}c++}window.D2LAdventureEngine.gu_debugManager.log("assignToChannel could not locate sound "+
b);return!1}};f.prototype.setLooping=function(b,a){var c;if(!D2LAdventureEngine.gu_ingoreAudio){void 0===a&&(a=!0);for(c=0;c<this._Sounds.length;){if(this._Sounds[c].id===b)return this._Sounds[c].looping=a,this.adjustAllSounds(),!0;c++}D2LAdventureEngine.gu_debugManager.log("setLooping could not locate sound "+b);return!1}};f.prototype.stop=function(b){var a,c;if(!D2LAdventureEngine.gu_ingoreAudio){for(a=0;a<this._Sounds.length;){c=this._Sounds[a];if(c.id===b){c.instance.stop?c.instance.stop():(c.instance.pause(),
c.instance.currentTime=0);if(c.onStop)for(a=0;a<c.onStop.length;)void 0!==c.onStop[a]&&(b={compRef:c,interactionType:"onStop",data:c.onStop[a].data},c.onStop[a].functionRef.constructor===Function?c.onStop[a].functionRef(b):c.onStop[a].functionRef.constructor===String&&(b.interactionType="Stop",b.data=c.onStop[a].data,D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(c.onStop[a].functionRef,e)),c.onStop[a].onceOnly&&(c.onStop.splice(c,1),a--)),a++;return!0}a++}D2LAdventureEngine.gu_debugManager.log("stop could not locate sound "+
b);return!1}};f.prototype.pause=function(b){var a;if(!D2LAdventureEngine.gu_ingoreAudio){for(a=0;a<this._Sounds.length;){if(this._Sounds[a].id===b)return this._Sounds[a].instance.pause(),!0;a++}D2LAdventureEngine.gu_debugManager.log("pause could not locate sound "+b);return!1}};f.prototype.stopAll=function(){var b,a,c,d,f,g,k;if(!D2LAdventureEngine.gu_ingoreAudio){f=this._Sounds;g=[];c=0;for(d=f.length;c<d;c++)k=f[c],k.instance.removeAllEventListeners(),k.instance.stop?k.instance.stop():(k.instance.pause(),
k.instance.currentTime=0),k.onStop?(a=0,g.push(function(){var c;for(c=[];a<k.onStop.length;)void 0!==k.onStop[a]&&(b={compRef:k,interactionType:"onStop",data:k.onStop[a].data},k.onStop[a].functionRef.constructor===Function?k.onStop[a].functionRef(b):k.onStop[a].functionRef.constructor===String&&(b.interactionType="Stop",b.data=k.onStop[a].data,D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(k.onStop[a].functionRef,e)),k.onStop[a].onceOnly&&(k.onStop.splice(k,1),a--)),c.push(a++);return c}())):
g.push(void 0);return g}};f.prototype.play=function(b){var a;if(!D2LAdventureEngine.gu_ingoreAudio){for(a=0;a<this._Sounds.length;){if(this._Sounds[a].id===b)return this._Sounds[a].isBase64?(document.getElementById(D2LAdventureEngine.gu_AdventureID).parentNode.insertBefore(this._Sounds[a].instance,document.getElementById(D2LAdventureEngine.gu_AdventureID)),this._Sounds[a].instance.addEventListener("ended",function(a){return function(a){if(null!==document.getElementById(a.srcElement.id))return document.getElementById(D2LAdventureEngine.gu_AdventureID).parentNode.removeChild(a.srcElement)}}(this)),
this._Sounds[a].instance.onended=this.HandleSoundCompletion,this._Sounds[a].instance.play()):(b=!1,this._Sounds[a].looping&&(b=-1),this._Sounds[a].instance.play({delay:0,loop:b,volume:this._Sounds[a].volume,pan:1E-8}),this._Sounds[a].instance.on("complete",createjs.proxy(this.HandleSoundCompletion,this),null,!0)),!0;a++}window.D2LAdventureEngine.gu_debugManager.log("ERROR, requested sound "+b+" not found in SoundManager.play");return!1}};f.prototype.audjustChannelVol=function(b,a){var c;if(!D2LAdventureEngine.gu_ingoreAudio){for(c=
0;c<this._Channels.length;){if(this._Channels[c].id===b)return this._Channels[c].vol=a,this.adjustAllSounds(),!0;c++}window.D2LAdventureEngine.gu_debugManager.log("audjustChannelVol could not locate channel "+b);return!1}};f.prototype.FadeChannelVolTo=function(b,a,c){var d;if(!D2LAdventureEngine.gu_ingoreAudio){void 0===c&&(c=1);if(void 0!==b&&void 0!==a){for(d=0;d<this._Channels.length;){if(this._Channels[d].id===b)return this._Channels[d].fadeFlags.volume=a,this._Channels[d].fadeFlags.volumeSpeed=
c,!0;d++}window.D2LAdventureEngine.gu_debugManager.log("FadeVolTo could not locate sound "+b)}else window.D2LAdventureEngine.gu_debugManager.log("FadeVolTo was missing params");return!1}};f.prototype.adjustMasterVol=function(b){if(!D2LAdventureEngine.gu_ingoreAudio)return void 0!==b&&(this._masterVolume=b),this.adjustAllSounds()};f.prototype.Mute=function(){if(!D2LAdventureEngine.gu_ingoreAudio&&!this._muted)return this._muteMem=this._masterVolume,this._masterVolume=0,this._muted=!0,this.adjustAllSounds()};
f.prototype.Unmute=function(){if(!D2LAdventureEngine.gu_ingoreAudio&&this._muted)return this._masterVolume=this._muteMem,this._muted=!1,this.adjustAllSounds()};f.prototype.ToggleMute=function(){if(!D2LAdventureEngine.gu_ingoreAudio)return this._muted?this.Unmute():this.Mute()};f.prototype.adjustAllSounds=function(){var b,a,c;if(!D2LAdventureEngine.gu_ingoreAudio)for(b=0;b<this._Sounds.length;){if(void 0!==this._Sounds[b].channel&&"unassigned"!==this._Sounds[b].channel){c=!1;for(a=0;a<this._Channels.length;)this._Channels[a].id===
this._Sounds[b].channel&&(c=!0,this._Sounds[b].volume=this._masterVolume*this._Channels[a].vol,this._Sounds[b].isBase64||(this._Sounds[b].instance.volume=this._Sounds[b].volume)),a++;c||window.D2LAdventureEngine.gu_debugManager.log("adjustAllSounds could not locate channel "+this._Sounds[b].channel+" assigned to "+this._Sounds[b].id)}b++}};f.prototype.InitDefaultWindow=function(){var b;if(!D2LAdventureEngine.gu_ingoreAudio)return this._contoller=window.D2LAdventureEngine.gu_GUIManager.GetGlobalWindowByID("gDefWindow_Audio"),
b=this._contoller._currentPopContent.getComponetById("SubSliderPool"),this._contoller._currentPopContent.getComponetById("MasterVolSlider")._options.onChange=function(a){return function(b){return a.adjustMasterVol(b.pos)}}(this),void 0===b||!1===b?window.D2LAdventureEngine.gu_debugManager.log("SubSliderPool was not found in window"):this.BuildChannelPool(b)};f.prototype.BuildChannelPool=function(b){var a,c,d,f;if(!D2LAdventureEngine.gu_ingoreAudio){this._ChannelControls=[];d=0;for(f=[];d<this._Channels.length;)a=
{ID:this._Channels[d].id+"_VolLabel",Type:"Text",InitText:this._Channels[d].id,weight:"bold",sizeBoost:5,initX:0,initY:0,initWidth:b.getWidth(),weight:"bold"},c={ID:this._Channels[d].id+"_VolSlider",Type:"Slider",initWidth:620,initX:65,initY:30,InWinLockOverride:!0,onChange:function(a){return function(b){var c;c=b.compRef._id.replace("_VolSlider","");return a.audjustChannelVol(c,b.pos)}}(this),onChangeData:d,onInitData:d,onInit:function(a){return function(b){return b.compRef.PushToPos(a._Channels[b.data].vol)}}(this)},
a={ID:this._Channels[d].id+"_ControllGroup",Type:"Group",initX:0,initY:80*d,initContent:[a,c]},this._ChannelControls[d]={active:!0,controlObjectID:a.ID},void 0===b.initContent&&(b.initContent=[]),b.initContent.push(a),b.addComponet(D2LAdventureEngine.gu_ComponentManager.BuildComponent(a,"none")),f.push(d++);return f}};f.prototype.AssignAudioEvent=function(b,a,c,d,f){var g,k,p,n;p=this._Sounds;g=0;for(k=p.length;g<k;g++)if(n=p[g],n.id===b){if("complete"===a||"onComplete"===a)return void 0===n.onComplete&&
(n.onComplete=[]),n.onComplete.push({functionRef:c,data:d,onceOnly:f}),!0;if("stop"===a||"onStop"===a)return void 0===n.onStop&&(n.onStop=[]),n.onStop.push({functionRef:c,data:d,onceOnly:f}),!0;D2LAdventureEngine.gu_debugManager.log("AssignAudioEvent recived unknown EventType "+a+" for sound "+b);return!1}D2LAdventureEngine.gu_debugManager.log("AssignAudioEvent: sound "+b+" was not found");return!1};f.prototype.HandleSoundCompletion=function(b){var a,c,d,f,g,k;g=this._Sounds;d=0;for(f=g.length;d<
f;d++)if(k=g[d],k.onComplete)for(c=0;c<k.onComplete.length;)void 0!==k.onComplete[c]&&k.instance===b.target&&(a={compRef:k,interactionType:"onComplete",data:k.onComplete[c].data},k.onComplete[c].functionRef.constructor===Function?k.onComplete[c].functionRef(a):k.onComplete[c].functionRef.constructor===String&&(a.interactionType="Complete",a.data=k.onComplete[c].data,D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(k.onComplete[c].functionRef,b)),k.onComplete[c].onceOnly&&(k.onComplete.splice(k,
1),c--)),c++;return!1};f.prototype.GetNumberOfSoundsPlaying=function(b){var a,c,d,f,g,k,p,n,w;if(b){n=0;k=this._Sounds;c=0;for(d=k.length;c<d;c++)if(w=k[c],w.channel===b)for(p=createjs.Sound._instances,g=0,f=p.length;g<f;g++)a=p[g],w.src===a.src&&n++;return n}return createjs.Sound._instances.length+document.getElementsByClassName("AdventureEngineAudioDOM").length};f.prototype.GetSoundsPlaying=function(){var b,a,c,d,f;d=[];c=this._Sounds;b=0;for(a=c.length;b<a;b++)f=c[b],(f.instance.position||f.instance.currentTime)&&
d.push(f);return d};f.prototype.GetSoundById=function(b){var a,c,d,f;d=this._Sounds;a=0;for(c=d.length;a<c;a++)if(f=d[a],f.id===b)return f;return!1};return f}();window.D2LAdventureEngine.StateManager=function(f){function b(){this.SwitchToState=g(this.SwitchToState,this);this.findComponent=g(this.findComponent,this);this.SwitchCompents=g(this.SwitchCompents,this);this.GetCurrentScene=g(this.GetCurrentScene,this);this.GetSceneById=g(this.GetSceneById,this);this.GetCurrStateRef=g(this.GetCurrStateRef,
this);this.GetStateRef=g(this.GetStateRef,this);this.Renewcomp_ButtonObjs=g(this.Renewcomp_ButtonObjs,this);this.Removecomp_ButtonObjs=g(this.Removecomp_ButtonObjs,this);this.RenewBaseTextObjs=g(this.RenewBaseTextObjs,this);this.RemoveBaseTextObjs=g(this.RemoveBaseTextObjs,this);this.HandleDimentionChange=g(this.HandleDimentionChange,this);this.HandleWinScrollEvent=g(this.HandleWinScrollEvent,this);this.HandleResizeEvent=g(this.HandleResizeEvent,this);this.HandleMouseWheel=g(this.HandleMouseWheel,
this);this.HandleDoubleClick=g(this.HandleDoubleClick,this);this.HandleMouseDown=g(this.HandleMouseDown,this);this.HandleMouseUpOver=g(this.HandleMouseUpOver,this);this.HandleMouseUp=g(this.HandleMouseUp,this);this.HandleMouseMove=g(this.HandleMouseMove,this);this.HandleMouseMoveOver=g(this.HandleMouseMoveOver,this);this.HandleMouseOut=g(this.HandleMouseOut,this);this.HandleMouseOver=g(this.HandleMouseOver,this);this.getComponetsByPosition=g(this.getComponetsByPosition,this);this.Update=g(this.Update,
this);this.AddState=g(this.AddState,this);this.ActivateInitState=g(this.ActivateInitState,this);this.BuildInitStates=g(this.BuildInitStates,this);this.HandleShutdownReq=g(this.HandleShutdownReq,this);this.Init=g(this.Init,this);this.States=[];this.CurrentStateIndex=this._initStateIndex=0;this._initialized=this.Transitioning=!1;b.__super__.constructor.call(this);this.initialize()}r(b,f);b.prototype.Init=function(a){this.BuildInitStates(a);this._onWindowsResizeEvent=a.onWindowsResize;this._onWindowsResizeEventData=
a._onWindowsResizeEventData;this._onWindowsScrollEvent=a.onWindowsScroll;this._onWindowsScrollEventData=a._onWindowsScrollData;this._onWindowsResizeEvent||(this._onWindowsResizeEvent=function(){});this._onWindowsScrollEvent||(this._onWindowsScrollEvent=function(){});if(this._initialized)return window.D2LAdventureEngine.gu_debugManager.log("ERROR: attempting to reInit StateManager");a={trigger:"onWindowsResize",effects:this._onWindowsResizeEvent,effectParams:this._onWindowsResizeEventData,isDefault:!1,
owner:"StateManager"};D2LAdventureEngine.gu_EventManager.NewEvent(a);a={trigger:"onWindowsScroll",effects:this._onWindowsScrollEvent,effectParams:this._onWindowsScrollEventData,isDefault:!1,owner:"StateManager"};D2LAdventureEngine.gu_EventManager.NewEvent(a);this.addChild(this.States[this._initStateIndex]);this._initialized=!0;return this.HandleResizeEvent()};b.prototype.HandleShutdownReq=function(){var a,b;b=0;for(a=[];b<this.States.length;)void 0!==this.States[b].HandleShutdownReq&&this.States[b].HandleShutdownReq(),
a.push(b++);return a};b.prototype.BuildInitStates=function(a){var b,d,f;d=0;for(b=[];d<a.States.length;)f=new window.D2LAdventureEngine.State(a.States[d].ID,D2LAdventureEngine.venture,a.States[d]),this.AddState(f),D2LAdventureEngine.gu_JsonOps.parseAllRules(a.States[d].initial)&&(this._initStateIndex=this.States.length-1),b.push(d++);return b};b.prototype.ActivateInitState=function(){return this.States[this._initStateIndex].Activate()};b.prototype.AddState=function(a){var b,d;b=!1;for(d=0;d<this.States.length;)this.States[d].ID===
a.ID&&(b=!0),d++;return b?window.D2LAdventureEngine.gu_debugManager.log("Warning: attempted to reAdd preExisting state "+a.ID):void 0!==a?(this.States.push(a),this.States[this.States.length-1].Activate(),this.States[this.States.length-1].Deactivate(),this.RemoveBaseTextObjs(),this.RenewBaseTextObjs(),this.Removecomp_ButtonObjs(),this.Renewcomp_ButtonObjs()):window.D2LAdventureEngine.gu_debugManager.log("ERROR: attempting to add null state")};b.prototype.Update=function(a){var b,d;d=0;for(b=[];d<this.States.length;)void 0!==
this.States[d].preUpdate&&this.States[d].Active&&this.States[d].initialized&&this.States[d].preUpdate(a),b.push(d++);return b};b.prototype.getComponetsByPosition=function(a){var b,d;b=[];for(d=0;d<this.States.length;)void 0!==this.States[d].getComponetsByPosition&&this.States[d].initialized&&b.push(this.States[d].getComponetsByPosition(a)),d++;return b};b.prototype.HandleMouseOver=function(a){var b,d;d=0;for(b=[];d<this.States.length;)void 0!==this.States[d].preHandleMouseOver&&this.States[d].Active&&
this.States[d].initialized&&this.States[d].preHandleMouseOver(a),b.push(d++);return b};b.prototype.HandleMouseOut=function(a){var b,d;d=0;for(b=[];d<this.States.length;)void 0!==this.States[d].preHandleMouseOut&&this.States[d].Active&&this.States[d].initialized&&this.States[d].preHandleMouseOut(a),b.push(d++);return b};b.prototype.HandleMouseMoveOver=function(a){var b,d;d=0;for(b=[];d<this.States.length;)void 0!==this.States[d].preHandleMouseMoveOver&&this.States[d].Active&&this.States[d].initialized&&
this.States[d].preHandleMouseMoveOver(a),b.push(d++);return b};b.prototype.HandleMouseMove=function(a){var b,d;d=0;for(b=[];d<this.States.length;)void 0!==this.States[d].preHandleMouseMove&&this.States[d].Active&&this.States[d].initialized&&this.States[d].preHandleMouseMove(a),b.push(d++);return b};b.prototype.HandleMouseUp=function(a){var b,d;d=0;for(b=[];d<this.States.length;)void 0!==this.States[d].preHandleMouseUp&&this.States[d].Active&&this.States[d].initialized&&this.States[d].preHandleMouseUp(a),
b.push(d++);return b};b.prototype.HandleMouseUpOver=function(a){var b,d;d=0;for(b=[];d<this.States.length;)void 0!==this.States[d].HandleMouseUpOver&&this.States[d].Active&&this.States[d].initialized&&this.States[d].HandleMouseUpOver(a),b.push(d++);return b};b.prototype.HandleMouseDown=function(a){var b,d;d=0;for(b=[];d<this.States.length;)void 0!==this.States[d].preHandleMouseDown&&this.States[d].Active&&this.States[d].initialized&&this.States[d].preHandleMouseDown(a),b.push(d++);return b};b.prototype.HandleDoubleClick=
function(a){var b,d;d=0;for(b=[];d<this.States.length;)void 0!==this.States[d].preHandleDoubleClick&&this.States[d].Active&&this.States[d].initialized&&this.States[d].preHandleDoubleClick(a),b.push(d++);return b};b.prototype.HandleMouseWheel=function(a){var b,d;d=0;for(b=[];d<this.States.length;)void 0!==this.States[d].preHandleMouseWheel&&this.States[d].Active&&this.States[d].initialized&&this.States[d].preHandleMouseWheel(a),b.push(d++);return b};b.prototype.HandleResizeEvent=function(a){var b;
if(this._initialized){for(b=0;b<this.States.length;)void 0!==this.States[b].preHandleResizeEvent&&this.States[b].Active&&this.States[b].initialized&&this.States[b].preHandleResizeEvent(a),b++;D2LAdventureEngine.venture.splash.preHandleResizeEvent&&D2LAdventureEngine.venture.splash.preHandleResizeEvent(a);D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onWindowsResize",a)}};b.prototype.HandleWinScrollEvent=function(a){var b;if(this._initialized){for(b=0;b<this.States.length;)void 0!==this.States[b].preHandleWinScrollEvent&&
this.States[b].Active&&this.States[b].initialized&&this.States[b].preHandleWinScrollEvent(),b++;D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onWindowsScroll",a)}};b.prototype.HandleDimentionChange=function(a,b){var d,f;this.height=b;this.width=a;f=0;for(d=[];f<this.States.length;)void 0!==this.States[f].HandleDimentionChange&&this.States[f].HandleDimentionChange(a,b),d.push(f++);return d};b.prototype.RemoveBaseTextObjs=function(){var a,b,d;b=0;for(a=[];b<this.States.length;){for(d=0;d<window.D2LAdventureEngine.gu_ActiveTextCompObjects.length;)this.States[b].ID===
window.D2LAdventureEngine.gu_ActiveTextCompObjects[d].assoiatedStateID&&(this.States[b].DisabledAssciotedText.push(window.D2LAdventureEngine.gu_ActiveTextCompObjects[d]),window.D2LAdventureEngine.gu_ActiveTextCompObjects[d].Destroy(),d=-1),d++;a.push(b++)}return a};b.prototype.RenewBaseTextObjs=function(){var a,b;a=0;for(b=[];a<this.States[this.CurrentStateIndex].DisabledAssciotedText.length;)this.States[this.CurrentStateIndex].DisabledAssciotedText[a].Init(),b.push(a++);return b};b.prototype.Removecomp_ButtonObjs=
function(){var a,b,d;d=0;for(b=[];d<this.States.length;){for(a=0;a<window.D2LAdventureEngine.gu_TabManager._accessRefs.length;)this.States[d].ID===window.D2LAdventureEngine.gu_TabManager._accessRefs[a].objRef.assoiatedStateID&&window.D2LAdventureEngine.gu_TabManager._accessRefs[a].objRef._enabled&&(this.States[d].DisabledAssciotedButtons.push(window.D2LAdventureEngine.gu_TabManager._accessRefs[a].objRef),window.D2LAdventureEngine.gu_TabManager._accessRefs[a].objRef.Disable(),a--),a++;b.push(d++)}return b};
b.prototype.Renewcomp_ButtonObjs=function(){var a,b;a=0;for(b=[];a<this.States[this.CurrentStateIndex].DisabledAssciotedButtons.length;)this.States[this.CurrentStateIndex].DisabledAssciotedButtons[a].Enable(),b.push(a++);return b};b.prototype.GetStateRef=function(a){var b;if("current"===a)return this.States[this.CurrentStateIndex];if("SplashScreen"===a)return D2LAdventureEngine.venture.splash;if("Master_UI"===a)return D2LAdventureEngine.gu_GUIManager;for(b=0;b<this.States.length;){if(this.States[b].ID===
a)return this.States[b];b++}window.D2LAdventureEngine.gu_debugManager.log("WARNING:  State "+a+" was not found in GetStateRef");return!1};b.prototype.GetCurrStateRef=function(){return D2LAdventureEngine.venture.PlayingSplash?D2LAdventureEngine.venture.splash:this.States[this.CurrentStateIndex]};b.prototype.GetSceneById=function(a){var b,d;if("Master_UI"===a)return D2LAdventureEngine.gu_GUIManager;for(b=0;b<this.States.length;){d=this.States[b].GetScene(a);if(!1!==d)return d;b++}for(b=0;b<D2LAdventureEngine.venture.AvaililbleSplash.length;){d=
D2LAdventureEngine.venture.AvaililbleSplash[b];if(d.ID===a)return d;b++}return!1};b.prototype.GetCurrentScene=function(){return D2LAdventureEngine.venture.PlayingSplash?D2LAdventureEngine.venture.splash:this.States[this.CurrentStateIndex].GetCurrentScene()};b.prototype.SwitchCompents=function(a){this.CurrentStateIndex=a;this.RenewBaseTextObjs();return this.Renewcomp_ButtonObjs()};b.prototype.findComponent=function(a){var b;if(void 0===a||null===a)return!1;if(D2LAdventureEngine.venture.PlayingSplash)return D2LAdventureEngine.venture.splash.getComponetById(a);
for(b=0;b<this.States.length;){if(!1!==this.States[b].findComponent(a))return this.States[b].findComponent(a);b++}return D2LAdventureEngine.gu_GUIManager.getComponetById(a)?D2LAdventureEngine.gu_GUIManager.getComponetById(a):D2LAdventureEngine.venture.splash.getComponetById(a)};b.prototype.SwitchToState=function(a,b){var d,f,g,k,p;b||(b={style:"cut",speed:"normal",postTransisionAction:void 0});window.D2LAdventureEngine.gu_InWinButtonLock=!0;this.States[this.CurrentStateIndex].DisabledAssciotedText=
[];this.States[this.CurrentStateIndex].DisabledAssciotedButtons=[];this.RemoveBaseTextObjs();this.Removecomp_ButtonObjs();D2LAdventureEngine.gu_AccessCursorDisabled||D2LAdventureEngine.gu_GUIManager.AccessCur.refreshCB();void 0===b.style&&(b.style="cut");void 0===b.speed&&(b.speed="normal");"slow"===b.speed?p=4500:"normal"===b.speed?p=1700:"fast"===b.speed&&(p=300);for(k=0;k<this.States.length;)this.States[k].ID===a&&(g=k),k++;D2LAdventureEngine.gu_CSSManager.ChangeCursor();if(void 0!==g){switch(b.style){case "cut":this.States[g].Activate();
this.addChildAt(this.States[g],0);this.States[this.CurrentStateIndex].Deactivate();this.removeChild(this.States[this.CurrentStateIndex]);this.SwitchCompents(g);window.D2LAdventureEngine.gu_InWinButtonLock=!1;void 0!==b.postTransisionAction&&b.postTransisionAction();break;case "cutToBlack":k=new createjs.Graphics;k.beginFill(createjs.Graphics.getRGB(0,0,0));k.rect(0,0,window.D2LAdventureEngine.gu_canDi.width,window.D2LAdventureEngine.gu_canDi.height);k.endFill();this._screen=new createjs.Shape(k);
this.addChild(this._screen);this.States[g].Activate();this.addChildAt(this.States[g],0);this.States[this.CurrentStateIndex].Deactivate();this.removeChild(this.States[this.CurrentStateIndex]);this.SwitchCompents(g);window.D2LAdventureEngine.gu_InWinButtonLock=!1;this.removeChild(this._screen);this._screen=void 0;void 0!==b.postTransisionAction&&b.postTransisionAction();break;case "fade":this.States[g].Activate();this.addChildAt(this.States[g],0);f=this.CurrentStateIndex;createjs.Tween.get(this.States[f]).to({alpha:0},
p).call(function(a){return function(){a.States[f].Deactivate();a.removeChild(a.States[f]);a.States[f].alpha=1;a.SwitchCompents(g);window.D2LAdventureEngine.gu_InWinButtonLock=!1;if(void 0!==b.postTransisionAction)return b.postTransisionAction()}}(this));break;case "fadeToBlack":this.States[g].Activate(),this.addChildAt(this.States[g],0),f=this.CurrentStateIndex,k=new createjs.Graphics,k.beginFill(createjs.Graphics.getRGB(0,0,0)),k.rect(0,0,window.D2LAdventureEngine.gu_canDi.width,window.D2LAdventureEngine.gu_canDi.height),
k.endFill(),this._screen=new createjs.Shape(k),this._screen.alpha=0,this.addChild(this._screen),createjs.Tween.get(this._screen).to({alpha:1},p/2).call(function(a){return function(){a.States[f].Deactivate();a.removeChild(a.States[f]);return createjs.Tween.get(a._screen).to({alpha:0},p/2).call(function(){a.SwitchCompents(g);window.D2LAdventureEngine.gu_InWinButtonLock=!1;a.removeChild(a._screen);a._screen=void 0;if(void 0!==b.postTransisionAction)return b.postTransisionAction()})}}(this))}k=void 0===
this.States[this.CurrentStateIndex].CurrentScene?this.States[this.CurrentStateIndex]._initScene:this.States[this.CurrentStateIndex].CurrentScene;d=!k._initialized;this.States[this.CurrentStateIndex].preUpdate();this.RenewBaseTextObjs();if(void 0!==k._options.onEnter&&!d){d={compRef:k,interactionType:"onEnter",data:k._options.onEnterData};if(k._options.onEnter.constructor===Function)return k._options.onEnter(d);if(k._options.onEnter.constructor===String)return D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(k._options.onEnter,
d)}}else return window.D2LAdventureEngine.gu_debugManager.log("ERROR: StateManager could not locate the requested state "+a)};return b}(createjs.Container);window.D2LAdventureEngine.StageEventManager=function(){function f(b){this.stageRef=b;this.ChangeCanvasDimentions=g(this.ChangeCanvasDimentions,this);this.setFPS=g(this.setFPS,this);this.handleMouseLeave=g(this.handleMouseLeave,this);this.preHandleWindowScroll=g(this.preHandleWindowScroll,this);this.preHandleWindowSize=g(this.preHandleWindowSize,
this);this.HandleTouchMove=g(this.HandleTouchMove,this);this.HandleTouchEnd=g(this.HandleTouchEnd,this);this.HandleTouchStart=g(this.HandleTouchStart,this);this.preHandleMouseWheel=g(this.preHandleMouseWheel,this);this.preHandleMouseUp=g(this.preHandleMouseUp,this);this.preHandleDoubleClick=g(this.preHandleDoubleClick,this);this.preHandleMouseDown=g(this.preHandleMouseDown,this);this.mouseOverOveride=g(this.mouseOverOveride,this);this.GetObjectsUnderMouse=g(this.GetObjectsUnderMouse,this);this.preHandleMouseMove=
g(this.preHandleMouseMove,this);this.CanvasBlur=g(this.CanvasBlur,this);this.CanvasFocus=g(this.CanvasFocus,this);this.preUpdate=g(this.preUpdate,this);this.Shutdown=g(this.Shutdown,this);this.Init=g(this.Init,this);this.canvas=document.getElementById(D2LAdventureEngine.gu_AdventureID)}f.prototype.canvas=void 0;f.prototype._muCalled=void 0;f.prototype._MouseDown=void 0;f.prototype._resizeVaildCheck=void 0;f.prototype.Init=function(){var b;this.stageRef.getCompsUnderPoint=function(a){return function(a){var b;
b=[];b.concat(D2LAdventureEngine.gu_GUIManager.getComponetsByPosition(a));b.concat(D2LAdventureEngine.gu_StateManager.getComponetsByPosition(a));return b}}(this);this._muCalled=!0;this.stageRef.enableDOMEvents(!0);this.stageRef.enableMouseOver(10);this.stageRef.addEventListener("stagemouseup",this.preHandleMouseUp);this.stageRef.addEventListener("stagemousemove",this.preHandleMouseMove);this.stageRef.addEventListener("dblclick",this.preHandleDoubleClick);window.addEventListener("mouseout",this.preHandleMouseUp);
window.addEventListener("mouseleave",this.preHandleMouseUp);D2LAdventureEngine.gu_TouchAllowed&&createjs.Touch.enable(this.stageRef);"Firefox"===D2LAdventureEngine.gu_userBrowser?this.canvas.addEventListener("DOMMouseScroll",this.preHandleMouseWheel):this.canvas.onmousewheel=this.preHandleMouseWheel;this.canvas.onmouseleave=this.handleMouseLeave;"Safari"===D2LAdventureEngine.gu_userBrowser&&(b=parent.document.getElementsByClassName("d2l-iframe"),0<b.length&&b[0].setAttribute("onmousewheel",""));D2LAdventureEngine.gu_CSSManager.AppendDefaultCSSRules();
return this.setFPS(D2LAdventureEngine.gu_fpsCap)};f.prototype.Shutdown=function(){this.stageRef.clear();this.stageRef.removeAllEventListeners();this.stageRef.removeAllChildren();window.onresize=void 0;return window.onscroll=void 0};f.prototype.preUpdate=function(b){if("tick"===b.type&&!D2LAdventureEngine.ShutdownCalled&&(D2LAdventureEngine.venture.preinitialized&&(D2LAdventureEngine.gu_debugManager.Update(b),D2LAdventureEngine.gu_SoundManager.Update(b),D2LAdventureEngine.gu_KeyManager.Update(b),D2LAdventureEngine.gu_GUIManager.preUpdate(b),
D2LAdventureEngine.gu_StateManager.Update(b),D2LAdventureEngine.gu_DataManager.Update(b)),void 0!==this.stageRef))return this.stageRef.update()};f.prototype.CanvasFocus=function(b){D2LAdventureEngine.gu_KeyManager.ActivateAcessKeys()};f.prototype.CanvasBlur=function(b){D2LAdventureEngine.gu_KeyManager.DectivateAcessKeys()};f.prototype.preHandleMouseMove=function(b){var a;b.nativeEvent&&(b=b.nativeEvent);a=b;a.x||(a.x=b.pageX,a.y=b.pageY);this.mouseOverOveride(a);this.stageRef.ObjectsUnderMouse=this.GetObjectsUnderMouse((b.rawX|
b.pageX)*D2LAdventureEngine.gu_canDi.inverseScaleFactor,(b.rawY|b.pageY)*D2LAdventureEngine.gu_canDi.inverseScaleFactor);b.targets=this.stageRef.ObjectsUnderMouse;b.target=this.stageRef.ObjectsUnderMouse[0];b.mPos=a;D2LAdventureEngine.gu_GUIManager.preHandleMouseOut(a);D2LAdventureEngine.gu_StateManager.HandleMouseOut(a);D2LAdventureEngine.gu_GUIManager.preHandleMouseMove(b);D2LAdventureEngine.gu_StateManager.HandleMouseMove(b);if(!D2LAdventureEngine.gu_GUIManager.preHandleMouseMoveOver(b))return D2LAdventureEngine.gu_StateManager.HandleMouseMoveOver(b)};
f.prototype.GetObjectsUnderMouse=function(b,a){var c,d,f;b-=D2LAdventureEngine.gu_canDi.left-D2LAdventureEngine.gu_canDi.containerScrollOffset.left;a-=D2LAdventureEngine.gu_canDi.top-D2LAdventureEngine.gu_canDi.containerScrollOffset.top;createjs.DisplayObject._hitTestContext.globalAlpha=1;f=this.stageRef.getObjectsUnderPoint(b,a,0);d=function(a){return function(a,b){var c;for(c=0;c<b.length;){if(b[c]===a)return!0;c++}return!1}}(this);c=function(f){return function(f,g){var h,m,l,q,t,u;h=[];for(m=0;m<
f.length;){if(void 0!==f[m].getObjectsUnderPoint)for(l=f[m].globalToLocal(b,a),q=f[m].getObjectsUnderPoint(l.x,l.y,0),l=0;l<q.length;)if(!d(q[l],h)){if(void 0!==q[l].getObjectsUnderPoint)for(u=c([q[l]]),t=0;t<u.length;)u[t]===[q[l]]||d(u[t],h)||h.push(u[t]),t++;else h.push(q[l]);l++}d(f[m],h)||h.push(f[m]);m++}return h}}(this);return c(f)};f.prototype.mouseOverOveride=function(b){this.stageRef.ObjectsUnderMouse=this.GetObjectsUnderMouse((b.rawX|b.pageX)*D2LAdventureEngine.gu_canDi.inverseScaleFactor,
(b.rawY|b.pageY)*D2LAdventureEngine.gu_canDi.inverseScaleFactor);b.targets=this.stageRef.ObjectsUnderMouse;b.target=this.stageRef.ObjectsUnderMouse[0];if(!D2LAdventureEngine.gu_GUIManager.preHandleMouseOver(b))return D2LAdventureEngine.gu_StateManager.HandleMouseOver(b)};f.prototype.preHandleMouseDown=function(b){var a,c;if(this.stageRef&&!this._MouseDown&&(this._MouseDown=!0,a=(b.rawX|b.pageX)*D2LAdventureEngine.gu_canDi.inverseScaleFactor,c=(b.rawY|b.pageY)*D2LAdventureEngine.gu_canDi.inverseScaleFactor,
this.stageRef.ObjectsUnderMouse=this.GetObjectsUnderMouse(a,c),b.targets=this.stageRef.ObjectsUnderMouse,b.target=this.stageRef.ObjectsUnderMouse[0],this._muCalled=!1,!D2LAdventureEngine.gu_GUIManager.preHandleMouseDown(b)))return D2LAdventureEngine.gu_StateManager.HandleMouseDown(b)};f.prototype.preHandleDoubleClick=function(b){var a,c;if(this.stageRef&&(b.nativeEvent?(a=(b.nativeEvent.rawX|b.nativeEvent.pageX)*D2LAdventureEngine.gu_canDi.inverseScaleFactor,c=(b.nativeEvent.rawY|b.nativeEvent.pageY)*
D2LAdventureEngine.gu_canDi.inverseScaleFactor):(a=(b.rawX|b.pageX)*D2LAdventureEngine.gu_canDi.inverseScaleFactor,c=(b.rawY|b.pageY)*D2LAdventureEngine.gu_canDi.inverseScaleFactor),this.stageRef.ObjectsUnderMouse=this.GetObjectsUnderMouse(a,c),b.targets=this.stageRef.ObjectsUnderMouse,b.target=this.stageRef.ObjectsUnderMouse[0],!D2LAdventureEngine.gu_GUIManager.preHandleDoubleClick(b)))return D2LAdventureEngine.gu_StateManager.HandleDoubleClick(b)};f.prototype.preHandleMouseUp=function(b){var a,
c;this._MouseDown=!1;if(!this._muCalled)return b.nativeEvent?(a=b.nativeEvent.clientX*D2LAdventureEngine.gu_canDi.inverseScaleFactor,c=b.nativeEvent.clientY*D2LAdventureEngine.gu_canDi.inverseScaleFactor):(a=b.clientX*D2LAdventureEngine.gu_canDi.inverseScaleFactor,c=b.clientY*D2LAdventureEngine.gu_canDi.inverseScaleFactor),this.stageRef.ObjectsUnderMouse=this.GetObjectsUnderMouse(a,c),b.targets=this.stageRef.ObjectsUnderMouse,b.target=this.stageRef.ObjectsUnderMouse[0],D2LAdventureEngine.gu_GUIManager.preHandleMouseUp(),
D2LAdventureEngine.gu_StateManager.HandleMouseUp(),D2LAdventureEngine.gu_GUIManager.preHandleMouseUpOver(b)||D2LAdventureEngine.gu_StateManager.HandleMouseUpOver(b),D2LAdventureEngine.gu_TabManager.HandleAccessModeDeactivation(!0),this._muCalled=!0};f.prototype.preHandleMouseWheel=function(b){var a,c;b.preventDefault();this.stageRef&&(a=(b.rawX|b.pageX)*D2LAdventureEngine.gu_canDi.inverseScaleFactor,c=(b.rawY|b.pageY)*D2LAdventureEngine.gu_canDi.inverseScaleFactor,this.stageRef.ObjectsUnderMouse=
this.GetObjectsUnderMouse(a,c),b.targets=this.stageRef.ObjectsUnderMouse,b.target=this.stageRef.ObjectsUnderMouse[0]);void 0===b.wheelDelta&&void 0!==b.detail&&(b.wheelDelta=-120*b.detail);D2LAdventureEngine.gu_GUIManager.preHandleMouseWheel(b);return D2LAdventureEngine.gu_StateManager.HandleMouseWheel(b)};f.prototype.HandleTouchStart=function(b){b.changedTouches?(this.stageRef.touchX=b.changedTouches[0].pageX,this.stageRef.touchY=b.changedTouches[0].pageY,b.x=b.changedTouches[0].pageX,b.y=b.changedTouches[0].pageY,
b.rawX=b.changedTouches[0].pageX,b.rawY=b.changedTouches[0].pageY,b.clientX=b.changedTouches[0].clientX,b.clientY=b.changedTouches[0].clientY):(this.stageRef.touchX=b.pageX,this.stageRef.touchY=b.pageY,b.x=b.pageX,b.y=b.pageY);return this.preHandleMouseDown(b)};f.prototype.HandleTouchEnd=function(b){b.changedTouches?(b.clientX=b.changedTouches[0].pageX,b.clientY=b.changedTouches[0].pageY):(b.clientX=b.touchX,b.clientY=b.touchY);return this.preHandleMouseUp(b)};f.prototype.HandleTouchMove=function(b){b.preventDefault();
b.changedTouches?(this.stageRef.touchX=b.changedTouches[0].pageX,this.stageRef.touchY=b.changedTouches[0].pageY,b.x=b.changedTouches[0].pageX,b.y=b.changedTouches[0].pageY,b.rawX=b.changedTouches[0].pageX,b.rawY=b.changedTouches[0].pageY,b.clientX=b.changedTouches[0].clientX,b.clientY=b.changedTouches[0].clientY):(this.stageRef.touchX=b.pageX,this.stageRef.touchY=b.pageY,b.x=b.pageX,b.y=b.pageY);return this.preHandleMouseMove(b)};f.prototype.preHandleWindowSize=function(b,a){var c,d;D2LAdventureEngine.gu_LeManager.GetBrightspaceContainer()&&
D2LAdventureEngine.gu_mobileDevice?(c=D2LAdventureEngine.gu_LeManager.GetBrightspaceContainer(),d=c.parentElement.clientWidth,b||(b={}),b.forceWidth=d):d=window.innerWidth;if(!this._resizeVaildCheck||this._resizeVaildCheck.width!==d||this._resizeVaildCheck.height!==window.innerHeight){this._resizeVaildCheck={width:d,height:window.innerHeight};c={};c.useWinInnerWidth=b&&b.forceWidth?b.forceWidth:window.innerWidth;!D2LAdventureEngine.gu_canDi||a?(c.initWidth=this.canvas.width,c.initHeight=this.canvas.height,
c.landscape=this.canvas.width>this.canvas.height):(c.initWidth=D2LAdventureEngine.gu_canDi.initWidth,c.initHeight=D2LAdventureEngine.gu_canDi.initHeight,c.landscape=D2LAdventureEngine.gu_canDi.landscape);D2LAdventureEngine.disableScaling||(d<c.initWidth?(D2LAdventureEngine.gu_CSSManager.AlterCSSRule("adventureStyles",".AdventureCanvas","width",d-this.canvas.offsetLeft+"px"),D2LAdventureEngine.gu_stageRef.canvas.style.width=d-this.canvas.offsetLeft+"px",d=this.canvas.offsetWidth/c.initWidth,d*=c.initHeight,
D2LAdventureEngine.gu_CSSManager.AlterCSSRule("adventureStyles",".AdventureCanvas","height",d+"px"),D2LAdventureEngine.gu_stageRef.canvas.style.height=d+"px"):(D2LAdventureEngine.gu_CSSManager.AlterCSSRule("adventureStyles",".AdventureCanvas","width",this.canvas.width+"px"),D2LAdventureEngine.gu_stageRef.canvas.style.height=this.canvas.height+"px",d+this.canvas.offsetLeft>c.initWidth&&(D2LAdventureEngine.gu_stageRef.canvas.style.width=c.initWidth+"px")));c.width=this.canvas.width;c.height=this.canvas.height;
c.trueHeight=this.canvas.offsetHeight;c.trueWidth=this.canvas.offsetWidth;c.left=this.GetOffsetTrue(this.canvas,"left");c.top=this.GetOffsetTrue(this.canvas,"top")+1;c.containerScrollOffset={};this.canvas.parentElement?(c.containerScrollOffset.left=this.canvas.parentElement.scrollLeft,c.containerScrollOffset.top=this.canvas.parentElement.scrollTop):(c.containerScrollOffset.left=0,c.containerScrollOffset.top=0);D2LAdventureEngine.disableScaling?(c.scaleFactor=1,c.inverseScaleFactor=1):(c.scaleFactor=
c.trueWidth/c.initWidth,c.inverseScaleFactor=c.initWidth/(c.initWidth*c.scaleFactor),D2LAdventureEngine.gu_CSSManager.AlterCSSRule("adventureStyles",".embd_iFrame iframe","-ms-zoom",c.scaleFactor),D2LAdventureEngine.gu_CSSManager.AlterCSSRule("adventureStyles",".embd_iFrame iframe","-moz-transform","scale("+c.scaleFactor+")"),D2LAdventureEngine.gu_CSSManager.AlterCSSRule("adventureStyles",".embd_iFrame iframe","-o-transform","scale("+c.scaleFactor+")"),D2LAdventureEngine.gu_CSSManager.AlterCSSRule("adventureStyles",
".embd_iFrame iframe","-webkit-transform","scale("+c.scaleFactor+")"),d=100*c.inverseScaleFactor,D2LAdventureEngine.gu_CSSManager.AlterCSSRule("adventureStyles",".embd_iFrame iframe","width",d+"%"),D2LAdventureEngine.gu_CSSManager.AlterCSSRule("adventureStyles",".embd_iFrame iframe","height",d+"%"));D2LAdventureEngine.gu_canDi=c;this.DynamicTextOveride||(c=Math.round(D2LAdventureEngine.gu_DynamicTextBaseSize*c.scaleFactor),D2LAdventureEngine.gu_CSSManager.AlterCSSRule("adventureStyles",".AdventureText",
"font-size",c+"px"));for(d=0;d<D2LAdventureEngine.gu_ActiveTextCompObjects.length;)(c=D2LAdventureEngine.gu_ActiveTextCompObjects[d])&&c.HandleWindowSize&&c.HandleWindowSize(),d++;D2LAdventureEngine.gu_GUIManager.preHandleResizeEvent(b);D2LAdventureEngine.gu_StateManager.HandleResizeEvent(b)}};f.prototype.preHandleWindowScroll=function(b){D2LAdventureEngine.gu_canDi&&(this.canvas.parentElement?(D2LAdventureEngine.gu_canDi.containerScrollOffset.left=this.canvas.parentElement.scrollLeft,D2LAdventureEngine.gu_canDi.containerScrollOffset.top=
this.canvas.parentElement.scrollTop):(D2LAdventureEngine.gu_canDi.containerScrollOffset.left=0,D2LAdventureEngine.gu_canDi.containerScrollOffset.top=0));D2LAdventureEngine.gu_GUIManager.preHandleWinScrollEvent(b);return D2LAdventureEngine.gu_StateManager.HandleWinScrollEvent(b)};f.prototype.handleMouseLeave=function(b){return D2LAdventureEngine.gu_CSSManager.ChangeCursor("default")};f.prototype.setFPS=function(b){return createjs.Ticker.framerate=b};f.prototype.ChangeCanvasDimentions=function(b,a){var c;
c=this.stageRef.getBounds()?this.stageRef.getBounds():{x:0,y:0,width:D2LAdventureEngine.gu_canDi.width,height:D2LAdventureEngine.gu_canDi.height};b&&(this.canvas.style.width=b+"px",this.canvas.style["max-width"]=b+"px",this.canvas.width=b,a||(this.stageRef.setBounds(c.x,c.y,b,c.height),c=this.stageRef.getBounds()));a&&(this.canvas.style.height=a+"px",this.canvas.style["max-height"]=a+"px",this.canvas.height=a,b?this.stageRef.setBounds(c.x,c.y,b,a):this.stageRef.setBounds(c.x,c.y,c.width,a),this.stageRef.getBounds());
this.preHandleWindowSize(void 0,!0);D2LAdventureEngine.gu_GUIManager.HandleDimentionChange(this.canvas.width,this.canvas.height);D2LAdventureEngine.gu_StateManager.HandleDimentionChange(this.canvas.width,this.canvas.height);return D2LAdventureEngine.gu_LeManager.HeightChangeRequest(this.canvas.height)};f.prototype.GetOffsetTrue=function(b,a){var c,d,f;d="offset"+a.charAt(0).toUpperCase()+a.slice(1);c=b;for(f=b[d];null!==c.offsetParent;)f+=c.offsetParent[d],c=c.offsetParent;return f};return f}();D2LAdventureEngine.TabAccessManager=
function(){function f(){this.ChangeTabbingPostion=g(this.ChangeTabbingPostion,this);this.ForceRefIndex=g(this.ForceRefIndex,this);this.GetAccessRefIndex=g(this.GetAccessRefIndex,this);this.GetAccessRef=g(this.GetAccessRef,this);this.HandleAccessDeactivation=g(this.HandleAccessDeactivation,this);this.HandleAccessActivation=g(this.HandleAccessActivation,this);this.HandleWindowClose=g(this.HandleWindowClose,this);this.HandleWindowOpen=g(this.HandleWindowOpen,this);this.CheckRequestIgnore=g(this.CheckRequestIgnore,
this);this.CheckRequestBypass=g(this.CheckRequestBypass,this);this.HandleAccessReq=g(this.HandleAccessReq,this);this.UnfocusPreviousRef=g(this.UnfocusPreviousRef,this);this.HandleAccessModeDeactivation=g(this.HandleAccessModeDeactivation,this);this.UnassignAllAccessObjects=g(this.UnassignAllAccessObjects,this);this.UnassignAccessObject=g(this.UnassignAccessObject,this);this.AssignAccessObject=g(this.AssignAccessObject,this);this.CheckAssignStorage=g(this.CheckAssignStorage,this);this.RemoveTextShapeBufferRequest=
g(this.RemoveTextShapeBufferRequest,this);this.BuildTextShapeBufferedItem=g(this.BuildTextShapeBufferedItem,this);this.AddTextShapeBufferRequest=g(this.AddTextShapeBufferRequest,this);this.RemoveBufferRequest=g(this.RemoveBufferRequest,this);this.BuildBufferedItem=g(this.BuildBufferedItem,this);this.AddBufferRequest=g(this.AddBufferRequest,this);this.Init=g(this.Init,this);this._initialized=!1;this._accessRefs=[];this._accessPos=-1;this._windowOpen=!1;this._textAccessShapes=[];this._bufferedOutlines=
[];this._assignmentStorage=[]}f.prototype._initialized=void 0;f.prototype._accessRefs=void 0;f.prototype._accessPos=void 0;f.prototype._windowOpen=void 0;f.prototype._bufferedOutlines=void 0;f.prototype._assignmentStorage=void 0;f.prototype.Init=function(){return this._initialized=!0};f.prototype.AddBufferRequest=function(b){if(0>x.call(this._bufferedOutlines,b))return this._bufferedOutlines.push(b)};f.prototype.BuildBufferedItem=function(b){var a;a=this._bufferedOutlines.indexOf(b);if(-1!==a)return(b=
D2LAdventureEngine.gu_ComponentManager.FindExistingComp(this._bufferedOutlines[a]))&&b.BuildTabOutline&&b.BuildTabOutline(),this.RemoveBufferRequest(this._bufferedOutlines[a])};f.prototype.RemoveBufferRequest=function(b){b=this._bufferedOutlines.indexOf(b);if(-1!==b)return this._bufferedOutlines.splice(b,1)};f.prototype.AddTextShapeBufferRequest=function(b){if(0>x.call(this._textAccessShapes,b))return this._textAccessShapes.push(b)};f.prototype.BuildTextShapeBufferedItem=function(b){var a;a=this._textAccessShapes.indexOf(b);
if(-1!==a)return(b=D2LAdventureEngine.gu_ComponentManager.FindExistingComp(this._textAccessShapes[a]))&&b.BuildTabOutline&&b.BuildTabOutline(),this.RemoveTextShapeBufferRequest(this._textAccessShapes[a])};f.prototype.RemoveTextShapeBufferRequest=function(b){b=this._textAccessShapes.indexOf(b);if(-1!==b)return this._textAccessShapes.splice(b,1)};f.prototype.CheckAssignStorage=function(b){var a,c;a=0;for(c=[];a<this._assignmentStorage.length;)this._assignmentStorage[a].waitingOn===b?(this.AssignAccessObject(this._assignmentStorage[a].objReferance,
this._assignmentStorage[a].orderPos,this._assignmentStorage[a].asInit),c.push(this._assignmentStorage.splice(a,1))):c.push(a++);return c};f.prototype.AssignAccessObject=function(b,a,c){var d,f,g;for(d=0;d<this._accessRefs.length;){if(this._accessRefs[d].objRef._id===b._id)return!1;d++}d={objRef:b,active:!1};if("first"===a)return this._accessRefs.unshift(d),this.CheckAssignStorage(b._id),!0;if(void 0===a||"last"===a)return this._accessRefs.push(d),this.CheckAssignStorage(b._id),!0;if(0===a.indexOf("after ")||
0===a.indexOf("before ")){if(0===a.indexOf("after ")){g=a.replace("after ","");f=this.GetAccessRefIndex(g);if(!1===f)return this._assignmentStorage.push({objReferance:b,orderPos:a,asInit:c,waitingOn:g}),c||D2LAdventureEngine.gu_debugManager.log("Warning AssignAccessObject passed unknown comp "+g+" for componet "+d.objRef._id+" assignment rejected"),!1;f++}else if(0===a.indexOf("before ")&&(g=a.replace("before ",""),f=this.GetAccessRefIndex(g),!1===f))return this._assignmentStorage.push({objReferance:b,
orderPos:a,asInit:c,waitingOn:g}),c||D2LAdventureEngine.gu_debugManager.log("Warning AssignAccessObject passed unknown comp "+g+" for componet "+d.objRef._id+" assignment rejected"),!1;this._accessRefs.splice(f,0,d);this.CheckAssignStorage(b._id);return!0}return!1};f.prototype.UnassignAccessObject=function(b){var a;for(a=0;a<this._accessRefs.length;)!b===HTMLInputElement?b===this._accessRefs[a].objRef&&(this._accessRefs[a].active&&this.HandleAccessReq(),this._accessRefs.splice(a,1)):b.id===this._accessRefs[a].objRef.id&&
this._accessRefs.splice(a,1),a++;return!0};f.prototype.UnassignAllAccessObjects=function(){this._accessPos=0;this._accessRefs=[];return!0};f.prototype.HandleAccessModeDeactivation=function(b){void 0===b&&(b=!1);0<=this._accessPos-1&&this._accessPos-1<this._accessRefs.length&&(D2LAdventureEngine.gu_KeyManager.DeactivateKey("gDefKey_AcessMode_Activate"),void 0!==this._accessRefs[this._accessPos-1].objRef.HandleUnfocus?(this._accessRefs[this._accessPos-1].active=!1,this._accessRefs[this._accessPos-1].objRef.HandleUnfocus()):
D2LAdventureEngine.gu_debugManager.log("ERROR!! HandleAccessReq object does not contain the needed HandleUnfocus function"));D2LAdventureEngine.gu_AccessMode=!1;D2LAdventureEngine.venture.canvas.blur();D2LAdventureEngine.gu_GUIManager.HideAccessIndicator();if(b&&void 0!==D2LAdventureEngine.gu_GUIManager.AccessCur)return D2LAdventureEngine.gu_GUIManager.AccessCur.HandleFocusDeactivation()};f.prototype.UnfocusPreviousRef=function(){var b,a,c,d;d=this._accessRefs;a=0;for(c=d.length;a<c;a++)b=d[a],!0===
b.lastSelectedFlag&&(b.lastSelectedFlag=!1,void 0!==b.objRef.HandleUnfocus?(b.active=!1,D2LAdventureEngine.gu_debugManager.log("unfocused call: "+b.objRef._id),b.objRef.HandleUnfocus()):D2LAdventureEngine.gu_debugManager.log("ERROR!! HandleAccessReq object does not contain the needed HandleUnfocus function"))};f.prototype.HandleAccessReq=function(b){var a;D2LAdventureEngine.gu_KeyManager.ActivateKey("gDefKey_AcessMode_Activate");b?-1===this._accessPos?this._accessPos=this._accessRefs.length-1:this._accessPos--:
this._accessPos++;if(this._accessRefs[this._accessPos])if(a=this.CheckRequestBypass(this._accessRefs[this._accessPos].objRef),this.CheckRequestIgnore()&&D2LAdventureEngine.gu_debugManager.log("Warning! no tab enabled objects available"),this.UnfocusPreviousRef(b),a)this.HandleAccessReq(b);else if(void 0!==this._accessRefs[this._accessPos].objRef.HandleFocus){this._accessRefs[this._accessPos].active=!0;D2LAdventureEngine.gu_debugManager.log("focus call: "+this._accessRefs[this._accessPos].objRef._id+
" @:"+this._accessPos);this._accessRefs[this._accessPos].lastSelectedFlag=!0;this._accessRefs[this._accessPos].objRef.HandleFocus();D2LAdventureEngine.gu_AccessMode=!0;for(a=0;0!==this._textAccessShapes.length;)if(this.BuildTextShapeBufferedItem(this._textAccessShapes[0]),a++,9999===a){D2LAdventureEngine.gu_debugManager.log("ERROR!! HandleAccessReq failed to build text buffer items, loop occurred");break}for(a=0;0!==this._bufferedOutlines.length;)if(this.BuildBufferedItem(this._bufferedOutlines[0]),
a++,9999===a){D2LAdventureEngine.gu_debugManager.log("ERROR!! HandleAccessReq failed to build buffer items, loop occurred");break}D2LAdventureEngine.gu_GUIManager.ShowAccessIndicator()}else D2LAdventureEngine.gu_debugManager.log("ERROR!! HandleAccessReq object does not contain the needed HandleFocus function");if(b&&0>this._accessPos||!b&&this._accessPos>=this._accessRefs.length)D2LAdventureEngine.gu_debugManager.log("focus release @:"+this._accessPos),this._accessPos=-1,this.UnfocusPreviousRef(b),
this.HandleAccessModeDeactivation()};f.prototype.CheckRequestBypass=function(b){if(b.isTypeOf&&b.isTypeOf(D2LAdventureEngine.component)){if("none"!==b.location.state&&void 0!==b.location.state&&b.location.state!==D2LAdventureEngine.gu_StateManager.GetCurrStateRef().ID||"Master_UI"!==b.location.scene&&void 0!==b.location.scene&&b.location.scene!==D2LAdventureEngine.gu_StateManager.GetCurrentScene().ID||this._windowOpen&&!b._options.InWinLockOverride||!b._options.interactive||!b._options.tabEnabled||
!b._enabled||!b.isVisible()&&!b.isTypeOf(D2LAdventureEngine.comp_AccessCursor))return!0}else return D2LAdventureEngine.gu_debugManager.log("Warning! non comp type found in _accessRefs"),D2LAdventureEngine.gu_debugManager.log(b),!0;return!1};f.prototype.CheckRequestIgnore=function(){var b,a,c,d;d=this._accessRefs;a=0;for(c=d.length;a<c;a++)if(b=d[a],!this.CheckRequestBypass(b.objRef))return!1;return!0};f.prototype.HandleWindowOpen=function(){return this._windowOpen=!0};f.prototype.HandleWindowClose=
function(){return this._windowOpen=!1};f.prototype.HandleAccessActivation=function(){if(D2LAdventureEngine.gu_AccessMode&&void 0!==this._accessRefs[this._accessPos])return D2LAdventureEngine.gu_debugManager.log("focus activation @:"+this._accessPos),void 0!==this._accessRefs[this._accessPos].objRef.HandleFocusActivation?this._accessRefs[this._accessPos].objRef.HandleFocusActivation():D2LAdventureEngine.gu_debugManager.log("ERROR!! HandleAccessActivation object does not contain the needed HandleFocusActivation function")};
f.prototype.HandleAccessDeactivation=function(){if(D2LAdventureEngine.gu_AccessMode&&void 0!==this._accessRefs[this._accessPos])return void 0!==this._accessRefs[this._accessPos].objRef.HandleFocusDeactivation?this._accessRefs[this._accessPos].objRef.HandleFocusDeactivation():D2LAdventureEngine.gu_debugManager.log("ERROR!! HandleAccessDeactivation object does not contain the needed HandleFocusDeactivation function")};f.prototype.GetAccessRef=function(b){var a;for(a=0;a<this._accessRefs.length;){if(this._accessRefs[a].objRef._id===
b)return this._accessRefs[a];a++}return!1};f.prototype.GetAccessRefIndex=function(b){var a;for(a=0;a<this._accessRefs.length;){if(this._accessRefs[a].objRef._id===b)return a;a++}return!1};f.prototype.ForceRefIndex=function(b,a){var c;a||(a=0);for(c=0;c<this._accessRefs.length;){if(this._accessRefs[c].objRef._id===b)return this._accessPos=c.valueOf()+a;c++}return!1};f.prototype.ChangeTabbingPostion=function(b,a){var c,d,f;if(void 0===b||void 0===a)return D2LAdventureEngine.gu_debugManager.log("WARNING! ChangeTabbingPostion passed undefined values"),
!1;d=function(a){return function(b,c){var d;d=a._accessRefs[b].objRef._id.valueOf();a._accessRefs.splice(b,1);a._accessRefs.splice(c,0,{active:!1,objRef:D2LAdventureEngine.gu_StateManager.findComponent(d)});return a._accessRefs}}(this);c=D2LAdventureEngine.gu_StateManager.findComponent(b);"first"===a?a=0:"last"===a?a=this._accessRefs.length-1:-1!==a.indexOf("before ")?(f=a.replace("before ",""),a=this.GetAccessRefIndex(f)):-1!==a.indexOf("after ")&&(f=a.replace("after ",""),a=this.GetAccessRefIndex(f)+
1);return!1!==c?(c=this.GetAccessRefIndex(b),!1!==c?this._accessRefs=d(c,a):!1):!1};return f}();window.D2LAdventureEngine.UI_Manager=function(f){function b(){this.Update=g(this.Update,this);this.HandleScreenClick=g(this.HandleScreenClick,this);this.PopWinOverideObjects=g(this.PopWinOverideObjects,this);this.ShowAccessIndicator=g(this.ShowAccessIndicator,this);this.HideAccessIndicator=g(this.HideAccessIndicator,this);this.ChangeContext=g(this.ChangeContext,this);this.HideMuteToggle=g(this.HideMuteToggle,
this);this.HideAudioBtn=g(this.HideAudioBtn,this);this.ShowContext=g(this.ShowContext,this);this.HideContext=g(this.HideContext,this);this.GetGlobalWindowByID=g(this.GetGlobalWindowByID,this);this.requestAudioWindowCloseCall=g(this.requestAudioWindowCloseCall,this);this.OpenAudioMenu=g(this.OpenAudioMenu,this);this.requestHelpWindowCloseCall=g(this.requestHelpWindowCloseCall,this);this.OpenHelpWindow=g(this.OpenHelpWindow,this);this.ShowHelpBtn=g(this.ShowHelpBtn,this);this.HideHelpBtn=g(this.HideHelpBtn,
this);this.HandleShutdownReq=g(this.HandleShutdownReq,this);this.HandleCloseWindow=g(this.HandleCloseWindow,this);this.OpenWindow=g(this.OpenWindow,this);this.RemoveGlobalWindow=g(this.RemoveGlobalWindow,this);this.AddNewGlobalWindow=g(this.AddNewGlobalWindow,this);this.InitWindowSet=g(this.InitWindowSet,this);this.DrawScreen=g(this.DrawScreen,this);this.Init=g(this.Init,this);b.__super__.constructor.call(this,"Master_UI","none",{BackgroundBitmap:"none"});this.GlobalWindows=[];this.contextHidden=
!1;this._WindowZpos=0}r(b,f);b.prototype.GlobalWindows=void 0;b.prototype.initGloWinDat=void 0;b.prototype.initUI_CompData=void 0;b.prototype.UI_Options=void 0;b.prototype.contextHidden=void 0;b.prototype._ConTextBG=void 0;b.prototype.ConText=void 0;b.prototype._WindowZpos=void 0;b.prototype._accessIndicator=void 0;b.prototype.AccessCur=void 0;b.prototype.HelpButton=void 0;b.prototype.AudioButton=void 0;b.prototype.MuteToggle=void 0;b.prototype._Screen=void 0;b.prototype._WindowBuffer=void 0;b.prototype._outlineDisplayLayer=
void 0;b.prototype.Init=function(){var a;this.DrawScreen();this._accessIndicator=D2LAdventureEngine.gu_ResourceManager.get("AccessMode","sprite");this._accessIndicator.x=D2LAdventureEngine.gu_canDi.width-this._accessIndicator.spriteSheet._frames[0].rect.width-10;this._accessIndicator.y=D2LAdventureEngine.gu_canDi.height-this._accessIndicator.spriteSheet._frames[0].rect.height-10;void 0!==this.initUI_CompData?this.buildInitComponets(this.initUI_CompData):D2LAdventureEngine.gu_debugManager.log("ERROR!: initUI_CompData was not defined in UI_Manager");
this.UI_Options=void 0===this.UI_Options?{}:D2LAdventureEngine.gu_JsonOps.parseAllRules(this.UI_Options);void 0===this.UI_Options.HelpText&&(this.UI_Options.HelpText="UI_Options.HelpText was not defined");void 0===this.UI_Options.useContextBar&&(this.UI_Options.useContextBar=!0);void 0===this.UI_Options.useHelpButton&&(this.UI_Options.useHelpButton=!0);void 0===this.UI_Options.useAudioButton&&(this.UI_Options.useAudioButton=void 0===this.UI_Options.useMuteToggle?!0:!1);void 0===this.UI_Options.useMuteToggle&&
(this.UI_Options.useMuteToggle=!1);this._WindowBuffer=[];if(void 0!==this.initGloWinDat){if(void 0!==this.UI_Options.HelpText)for(a=0;a<this.initGloWinDat.length;)"gDefWindow_Help"===this.initGloWinDat[a].ID&&(this.initGloWinDat[a].useInitPopulation=this.UI_Options.HelpText),a++;this.InitWindowSet(this.initGloWinDat)}else D2LAdventureEngine.gu_debugManager.log("ERROR!: initGloWinDat was not defined in UI_Manager");D2LAdventureEngine.gu_AccessCursorDisabled||(this.AccessCur=new D2LAdventureEngine.comp_AccessCursor,
this.addChild(this.AccessCur));a=new createjs.Graphics;a.beginLinearGradientFill(["rgba(0, 0, 0, 0)","rgba(0, 0, 0, 1)"],[0,1],0,D2LAdventureEngine.gu_canDi.height-100,0,D2LAdventureEngine.gu_canDi.height-75);a.rect(0,D2LAdventureEngine.gu_canDi.height-100,D2LAdventureEngine.gu_canDi.width,100);a.endFill();this._ConTextBG=new createjs.Shape(a);this._ConTextBG.cache(0,D2LAdventureEngine.gu_canDi.height-100,D2LAdventureEngine.gu_canDi.width,100);this._ConTextBG.alpha=.7;this.addChild(this._ConTextBG);
this.ConText=D2LAdventureEngine.gu_ComponentManager.BuildComponent({id:"Context",Type:"Text",initX:0,initY:D2LAdventureEngine.gu_canDi.height-80,initWidth:D2LAdventureEngine.gu_canDi.width,initHeight:80,uiComp:!0,align:"center",sizeBoost:20,kerning:0,color:"#FDFDFD",vCenter:!0,overflow:"hidden",selectionOveride:!0});this.addChild(this.ConText);!1===this.UI_Options.useContextBar&&this.HideContext();this.UI_Options.useHelpButton.constructor===Boolean?!1===this.UI_Options.useHelpButton&&(this.HelpButton._options.initDisabled=
!0,this.HideHelpBtn()):this.UI_Options.useHelpButton.constructor===String?this.HelpButton._options.AssetID=this.UI_Options.useHelpButton:D2LAdventureEngine.gu_debugManager.log("UI_Options.useHelpButton can not be overridden with this method, please use defaults JSON or set to false to hide");this.UI_Options.useAudioButton.constructor===Boolean?!1===this.UI_Options.useAudioButton&&(this.AudioButton._options.initDisabled=!0,this.HideAudioBtn()):this.UI_Options.useAudioButton.constructor===String?this.AudioButton._options.AssetID=
this.UI_Options.useAudioButton:D2LAdventureEngine.gu_debugManager.log("UI_Options.useAudioButton can not be overridden with this method, please use defaults JSON or set to false to hide");this.UI_Options.useMuteToggle.constructor===Boolean?!0===this.UI_Options.useMuteToggle?(this.MuteToggle._options.initDisabled=!1,this.MuteToggle._options.initHidden=!1,!1!==this.UI_Options.useAudioButton&&(this.MuteToggle.initY=30)):this.HideMuteToggle():this.UI_Options.useMuteToggle.constructor===String?(this.MuteToggle._options.AssetID=
this.UI_Options.useMuteToggle,this.MuteToggle._options.initDisabled=!1,this.MuteToggle._options.initHidden=!1,!1!==this.UI_Options.useAudioButton&&(this.MuteToggle.initY=30)):D2LAdventureEngine.gu_debugManager.log("UI_Options.useMuteToggle can not be overridden with this method, please use defaults JSON or set to false to hide");return this._WindowZpos=this.numChildren};b.prototype.DrawScreen=function(){var a;this._Screen&&(this._Screen.removeAllEventListeners(),this.removeChild(this._Screen),this._Screen=
void 0);a={ID:"UIWindow_Screen",Type:"Shape",shapeType:"Rectangle",color:"#000000",initAlpha:.9,tabEnabled:!1,interactive:!0,InWinLockOverride:!0,clickAudioSFX:"none",zPos:"bottom",initHidden:!0,events:{onClick:this.HandleScreenClick},rect:{x:0,y:0,width:D2LAdventureEngine.gu_canDi.width,height:D2LAdventureEngine.gu_canDi.height}};this.UI_Options.screenOptions&&(a=D2LAdventureEngine.gu_DataManager.mergeObjectData(a,this.UI_Options.screenOptions));this._Screen=D2LAdventureEngine.gu_ComponentManager.BuildComponent(a,
this.location);return this.addChild(this._Screen)};b.prototype.InitWindowSet=function(a){var b,d;void 0===a&&(a=this.initGloWinDat);b=0;for(d=[];b<a.length;)this.AddNewGlobalWindow(a[b]),d.push(b++);return d};b.prototype.AddNewGlobalWindow=function(a){var b;for(b=0;b<this.GlobalWindows.length;){if(this.GlobalWindows[b]._id===a.ID){this.GlobalWindows[b].Destroy();this.GlobalWindows.splice(b,1);break}b++}a.Type="Window";a.closeFunction=this.HandleCloseWindow;a=D2LAdventureEngine.gu_ComponentManager.BuildComponent(a);
return this.GlobalWindows.push(a)};b.prototype.RemoveGlobalWindow=function(a){var b;for(b=0;b<this.GlobalWindows.length;){if(this.GlobalWindows[b].ID===a)return this.GlobalWindows[b].Destroy(),this.GlobalWindows.splice(b,1),!0;b++}return!1};b.prototype.OpenWindow=function(a){var b,d;d=!1;if(this.CurrentActiveWindow&&a===this.CurrentActiveWindow._id)D2LAdventureEngine.gu_debugManager.log("Warning! attemtping to open a window wich is already open "+a+". call to open will be ignored");else{for(b=0;b<
this.GlobalWindows.length;)this.GlobalWindows[b]._id===a&&(void 0!==this.CurrentActiveWindow&&(!0!==this.CurrentActiveWindow._options.dontBuffer&&(this._WindowBuffer.push(this.CurrentActiveWindow._id),this.CurrentActiveWindow._isBuffered=!0),this.CurrentActiveWindow.Hide(),this.removeChild(this.CurrentActiveWindow)),this.CurrentActiveWindow=this.GlobalWindows[b],!0===this.CurrentActiveWindow._options.useFade?this._Screen.Show():!1===this.CurrentActiveWindow._options.useFade&&this._Screen.Hide(),this.CurrentActiveWindow._initialized&&
this.CurrentActiveWindow.Populate(),this.CurrentActiveWindow.Show(),D2LAdventureEngine.gu_InWinButtonLock=!0,D2LAdventureEngine.gu_TabManager.HandleWindowOpen(),this.HideTextElements(),this.addChildAt(this.GlobalWindows[b],this.getNumChildren()-1),D2LAdventureEngine.gu_ComponentManager.DeselectAllUDCs(),d=!0),b++;if(!d)return D2LAdventureEngine.gu_debugManager.log("Warning requested Window "+a+" was not found in GlobalWindows")}};b.prototype.HideTextElements=function(){var a,b;for(a=0;a<D2LAdventureEngine.gu_ActiveTextCompObjects.length;)D2LAdventureEngine.gu_ActiveTextCompObjects[a].inWinHide(),
a++;b=0;for(a=[];b<D2LAdventureEngine.gu_ActiveTimerCompObjects.length;)D2LAdventureEngine.gu_ActiveTimerCompObjects[b].inWinStop(),a.push(b++);return a};b.prototype.UnhideTextElements=function(){var a,b;for(a=0;a<D2LAdventureEngine.gu_ActiveTextCompObjects.length;)D2LAdventureEngine.gu_ActiveTextCompObjects[a].inWinUnhide(),a++;b=0;for(a=[];b<D2LAdventureEngine.gu_ActiveTimerCompObjects.length;)D2LAdventureEngine.gu_ActiveTimerCompObjects[b].inWinStart(),a.push(b++);return a};b.prototype.HandleCloseWindow=
function(a){var b;b=this.GetGlobalWindowByID(a._id);a!==b&&D2LAdventureEngine.gu_debugManager.log("provided window to the GUI HandleCloseWindow method has been modifed and may not close as expected.");b.Hide();this.removeChild(b);if(0===this._WindowBuffer.length){if(a===this.CurrentActiveWindow||void 0===this.CurrentActiveWindow)return this._Screen.Hide(),this.CurrentActiveWindow=void 0,D2LAdventureEngine.gu_InWinButtonLock=!1,D2LAdventureEngine.gu_TabManager.HandleWindowClose(),this.UnhideTextElements()}else if(a=
this.GetGlobalWindowByID(this._WindowBuffer[this._WindowBuffer.length-1]),a!==b)return this._WindowBuffer.pop(),this.addChild(a),a.RequestBufferOpen(),this.CurrentActiveWindow=a};b.prototype.HandleShutdownReq=function(){var a,c;for(c=0;c<this.GlobalWindows.length;)a=this.GlobalWindows[c],void 0!==a.Destroy&&a.Destroy(),c++;return b.__super__.HandleShutdownReq.call(this)};b.prototype.HideHelpBtn=function(){this.HelpButton.Hide();return this.HelpButton.Disable()};b.prototype.ShowHelpBtn=function(){this.helpBtn.Enable();
return this.helpBtn.Show()};b.prototype.OpenHelpWindow=function(){var a;void 0===this.UI_Options.OverideHelpFunction||!1===this.UI_Options.OverideHelpFunction?this.OpenWindow("gDefWindow_Help"):D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(this.UI_Options.OverideHelpFunction);if(this.UI_Options.onHelpOpenRequest){a={compRef:this,interactionType:"onHelpOpenRequest",data:this.UI_Options.onHelpOpenRequestData};if(this.UI_Options.onHelpOpenRequest.constructor===Function)return this.UI_Options.onHelpOpenRequest(a);
if(this.UI_Options.onHelpOpenRequest.constructor===String)return D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(this.UI_Options.onHelpOpenRequest,a)}};b.prototype.requestHelpWindowCloseCall=function(){var a;if(this.UI_Options.onHelpCloseRequest){a={compRef:this,interactionType:"onHelpCloseRequest",data:this.UI_Options.onHelpCloseRequestData};if(this.UI_Options.onHelpCloseRequest.constructor===Function)return this.UI_Options.onHelpCloseRequest(a);if(this.UI_Options.onHelpCloseRequest.constructor===
String)return D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(this.UI_Options.onHelpCloseRequest,a)}};b.prototype.OpenAudioMenu=function(){var a;void 0===this.UI_Options.OverideAudioMenuFunction||!1===this.UI_Options.OverideAudioMenuFunction?this.OpenWindow("gDefWindow_Audio"):D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(this.UI_Options.OverideAudioMenuFunction);if(this.UI_Options.onAudioOpenRequest){a={compRef:this,interactionType:"onAudioOpenRequest",data:this.UI_Options.onAudioOpenRequestData};
if(this.UI_Options.onAudioOpenRequest.constructor===Function)return this.UI_Options.onAudioOpenRequest(a);if(this.UI_Options.onAudioOpenRequest.constructor===String)return D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(this.UI_Options.onAudioOpenRequest,a)}};b.prototype.requestAudioWindowCloseCall=function(){var a;if(this.UI_Options.onAudioCloseRequest){a={compRef:this,interactionType:"onAudioCloseRequest",data:this.UI_Options.onAudioCloseRequestData};if(this.UI_Options.onAudioCloseRequest.constructor===
Function)return this.UI_Options.onAudioCloseRequest(a);if(this.UI_Options.onAudioCloseRequest.constructor===String)return D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(this.UI_Options.onAudioCloseRequest,a)}};b.prototype.GetGlobalWindowByID=function(a){var b;if(void 0!==this.GlobalWindows&&void 0!==a)for(b=0;b<this.GlobalWindows.length;){if(this.GlobalWindows[b]._id===a)return this.GlobalWindows[b];b++}return!1};b.prototype.HideContext=function(a){void 0===a&&(a=!1);if(!this.contextHidden)return a?
this.ConText.Destroy():this.contextHidden=!0,this.removeChild(this._ConTextBG),this.removeChild(this.ConText),this.ChangeContext("")};b.prototype.ShowContext=function(){if(this.contextHidden)return this.addChild(this._ConTextBG),this.addChild(this.ConText),this.contextHidden=!1};b.prototype.HideAudioBtn=function(){this.AudioButton.Hide();this.AudioButton.Disable();if(this.HelpButton.visible&&!this.MuteToggle.visible)return this.HelpButton.Move(window.D2LAdventureEngine.gu_canDi.width-60,10)};b.prototype.HideMuteToggle=
function(){this.MuteToggle.Hide();this.MuteToggle.Disable();if(this.HelpButton.visible)return this.HelpButton.Move(window.D2LAdventureEngine.gu_canDi.width-60,10)};b.prototype.ChangeContext=function(a){if(!this.contextHidden)return this.ConText.ChangeText(a)};b.prototype.HideAccessIndicator=function(){if(this.contains(this._accessIndicator))return this.removeChild(this._accessIndicator)};b.prototype.ShowAccessIndicator=function(){if(!this.contains(this._accessIndicator))return this.addChildAt(this._accessIndicator,
this.numChildren-1)};b.prototype.PopWinOverideObjects=function(){var a,b;a=0;for(b=[];a<this.getNumChildren();)void 0!==this.getChildAt(a)&&void 0!==this.getChildAt(a)._options&&this.getChildAt(a)._options.ForceFront&&this.AssignZIndex(this.getChildAt(a),"top"),b.push(a++);return b};b.prototype.HandleScreenClick=function(a){if(this.CurrentActiveWindow&&this.CurrentActiveWindow._options.fadeClickClose)return this.CurrentActiveWindow.HandleEndWinReq()};b.prototype.Update=function(a){this.contains(this.AccessCur)&&
this.getChildAt(this.numChildren-1)!==this.AccessCur&&this.setChildIndex(this.AccessCur,this.numChildren-1);if(this.CurrentActiveWindow&&this.CurrentActiveWindow.Update)return this.CurrentActiveWindow.Update(a)};return b}(window.D2LAdventureEngine.BaseView);window.D2LAdventureEngine.AEeventManager=function(){function f(){this.GetEventsByOwner=g(this.GetEventsByOwner,this);this.DispacthEvent=g(this.DispacthEvent,this);this.RenewEventIndexing=g(this.RenewEventIndexing,this);this.ReplaceEvent=g(this.ReplaceEvent,
this);this.RemoveEventsByOwner=g(this.RemoveEventsByOwner,this);this.RemoveEventByTrigger=g(this.RemoveEventByTrigger,this);this.CheckEventsExsistance=g(this.CheckEventsExsistance,this);this.NewEvent=g(this.NewEvent,this);this._events=[]}f.prototype._events=void 0;f.prototype._eventGroups=void 0;f.prototype.NewEvent=function(b){if(this.CheckEventsExsistance(b))return D2LAdventureEngine.gu_debugManager.log("error! added event data already exist"),D2LAdventureEngine.gu_debugManager.log(b),!1;b.index=
this._events.length;b=new D2LAdventureEngine.AEevent(b);this._events.push(b);return b};f.prototype.CheckEventsExsistance=function(b){var a,c,d,f;f=this._events;c=0;for(d=f.length;c<d;c++)if(a=f[c],b.owner._id===a._owner._id&&b.trigger===a._triggers[0]&&b._isDefault===a._isDefault&&b.effectsParams===a._effectsParams&&b.effects===a.effects)return!0;return!1};f.prototype.RemoveEventByTrigger=function(b,a,c){var d,f,g,k;d=!1;k=this.GetEventsByOwner(b._id);b=0;for(f=k.length;b<f;b++)g=k[b],!g.HasTrigger(a)||
g._isDefault&&!0!==c||(this._events.splice(g._index,1),this.RenewEventIndexing(),d=!0);return d};f.prototype.RemoveEventsByOwner=function(b,a){var c,d,f,g,k;c=!1;k=this.GetEventsByOwner(b._id);d=0;for(f=k.length;d<f;d++)g=k[d],g._isDefault&&!0!==a||(this._events.splice(g._index,1),this.RenewEventIndexing(),c=!0);return c};f.prototype.ReplaceEvent=function(b,a){var c,d,f,g;if(b.owner._initialized)b.trigger.constructor===Array?this.RemoveEventByTrigger(b.owner,b.trigger[0],a):this.RemoveEventByTrigger(b.owner,
b.trigger,a),this.NewEvent(b);else if(b.owner._options)if(b.trigger.constructor===Array)for(f=b.trigger,c=0,d=f.length;c<d;c++)g=f[c],b.owner._options.events[g]=b.effects;else b.owner._options.events||(b.owner._options.events={}),b.owner._options.events[b.trigger]=b.effects};f.prototype.RenewEventIndexing=function(){var b;for(b=0;b<this._events.length;)this._events[b]._index=b,b++};f.prototype.DispacthEvent=function(b,a,c){var d,f,g,k;if(void 0===b||void 0===a)return D2LAdventureEngine.gu_debugManager.log("ERROR! DispacthEvent not provided owner or trigger"),
!1;d=!1;k=this.GetEventsByOwner(b._id);b=0;for(f=k.length;b<f;b++)g=k[b],g.HasTrigger(a)&&(g.Dispactch(a,c),d=!0);return d};f.prototype.GetEventsByOwner=function(b){var a,c,d,f,g;c=[];g=this._events;d=0;for(f=g.length;d<f;d++)a=g[d],a._owner._id===b&&c.push(a);return c};return f}();window.D2LAdventureEngine.ComponentManager=function(){function f(){this.GetSelectedUDC=g(this.GetSelectedUDC,this);this.DeleteSelectedUDC=g(this.DeleteSelectedUDC,this);this.DeselectAllUDCs=g(this.DeselectAllUDCs,this);
this.parseGroupContent=g(this.parseGroupContent,this);this.buildCompGroup=g(this.buildCompGroup,this);this.buildCompQuizQuestion=g(this.buildCompQuizQuestion,this);this.buildCompQuiz=g(this.buildCompQuiz,this);this.buildCompWindow=g(this.buildCompWindow,this);this.buildCompSpeechBubble=g(this.buildCompSpeechBubble,this);this.buildCompPaintArea=g(this.buildCompPaintArea,this);this.buildCompUDC=g(this.buildCompUDC,this);this.buildNodeMap=g(this.buildNodeMap,this);this.buildCompScrollbar=g(this.buildCompScrollbar,
this);this.buildCompSlider=g(this.buildCompSlider,this);this.buildCompProgressBar=g(this.buildCompProgressBar,this);this.buildCompTimer=g(this.buildCompTimer,this);this.buildCompToggleCluster=g(this.buildCompToggleCluster,this);this.buildCompToggle=g(this.buildCompToggle,this);this.buildCompSprite=g(this.buildCompSprite,this);this.buildCompLabeledButton=g(this.buildCompLabeledButton,this);this.buildCompButton=g(this.buildCompButton,this);this.buildCompText=g(this.buildCompText,this);this.buildShape=
g(this.buildShape,this);this.buildCompBitmap=g(this.buildCompBitmap,this);this.BuildComponent=g(this.BuildComponent,this);this._locationData="none";this.FindExistingComp=D2LAdventureEngine.gu_StateManager.findComponent}f.prototype._locationData=void 0;f.prototype._callerRef=void 0;f.prototype.BuildComponent=function(b,a,c){this._callerRef=c;c=D2LAdventureEngine.gu_DataManager.cloneDataObj(b.events);b=D2LAdventureEngine.gu_JsonOps.parseAllRules(b);b.events=c;this._locationData=a;switch(b.Type){case "Bitmap":return this.buildCompBitmap(b);
case "Shape":case "Shape - Rectangle":case "Shape - Round Rectangle":case "Shape - Circle":case "Shape - Line":return this.buildShape(b);case "Button":return this.buildCompButton(b);case "LabeledButton":return this.buildCompLabeledButton(b);case "Sprite":return this.buildCompSprite(b);case "Text":return this.buildCompText(b);case "Toggle":return this.buildCompToggle(b);case "ToggleCluster":return this.buildCompToggleCluster(b);case "Timer":return this.buildCompTimer(b);case "Progress Bar":return this.buildCompProgressBar(b);
case "Slider":return this.buildCompSlider(b);case "ScrollBar":return this.buildCompScrollbar(b);case "Node Map":return this.buildNodeMap(b);case "UDC":return this.buildCompUDC(b);case "Paint Area":return this.buildCompPaintArea(b);case "Window":return this.buildCompWindow(b);case "Quiz":return this.buildCompQuiz(b);case "QuizQuestion":return this.buildCompQuizQuestion(b);case "SpeechBubble":return this.buildCompSpeechBubble(b);case "Group":return this.buildCompGroup(b);default:return window.D2LAdventureEngine.gu_debugManager.log("ComponentManager.BuildComponent recived unknown type "+
b.ID+" : "+b.Type)}};f.prototype.buildCompBitmap=function(b,a){var c;c=void 0!==b.ID?b.ID:b.AssetID;return void 0===a?new window.D2LAdventureEngine.comp_Bitmap(c,this._locationData,b):a.push(new window.D2LAdventureEngine.comp_Bitmap(c,this._locationData,b))};f.prototype.buildShape=function(b,a){var c;c=new D2LAdventureEngine.comp_Shape(b.ID,this._locationData,b);return void 0===a?c:a.push(c)};f.prototype.buildCompText=function(b,a){var c;if(!0===b["static"]){if(void 0===a)return c=new window.D2LAdventureEngine.comp_staticText(b.ID,
this._locationData,b.InitText,b);c=new window.D2LAdventureEngine.comp_staticText(b.ID,this._locationData,b.InitText,b);return a.push(c)}if(void 0===a)return c=new window.D2LAdventureEngine.comp_Text(b.ID,this._locationData,b.InitText,b),this._callerRef&&(c.assoiatedStateID=this._callerRef.assoiatedStateID,c.assoiatedSceneID=this._callerRef.ID),c;c=new window.D2LAdventureEngine.comp_Text(b.ID,this._locationData,b.InitText,b);this._callerRef&&(c.assoiatedStateID=this.assoiatedStateID,c.assoiatedSceneID=
this.ID);return a.push(c)};f.prototype.buildCompButton=function(b,a){return void 0===a?new window.D2LAdventureEngine.comp_Button(b.ID,this._locationData,b):a.push(new window.D2LAdventureEngine.comp_Button(b.ID,this._locationData,b))};f.prototype.buildCompLabeledButton=function(b,a){return void 0===a?new window.D2LAdventureEngine.comp_LabeledButton(b.ID,this._locationData,b):a.push(new window.D2LAdventureEngine.comp_LabeledButton(b.ID,this._locationData,b))};f.prototype.buildCompSprite=function(b,
a){return void 0===a?new window.D2LAdventureEngine.comp_Sprite(b.ID,this._locationData,b):a.push(new window.D2LAdventureEngine.comp_Sprite(b.ID,this._locationData,b))};f.prototype.buildCompToggle=function(b,a){return void 0===a?new window.D2LAdventureEngine.comp_Toggle(b.ID,this._locationData,b):a.push(new window.D2LAdventureEngine.comp_Toggle(b.ID,this._locationData,b))};f.prototype.buildCompToggleCluster=function(b,a){return void 0===a?new window.D2LAdventureEngine.comp_ToggleCluster(b.ID,this._locationData,
b):a.push(new window.D2LAdventureEngine.comp_ToggleCluster(b.ID,this._locationData,b))};f.prototype.buildCompTimer=function(b,a){return void 0===a?new window.D2LAdventureEngine.comp_Timer(b.ID,this._locationData,b):a.push(new window.D2LAdventureEngine.comp_Timer(b.ID,this._locationData,b))};f.prototype.buildCompProgressBar=function(b,a){var c;c=void 0!==b.ID?b.ID:b.AssetID;return void 0===a?new window.D2LAdventureEngine.comp_ProgressBar(c,this._locationData,b):a.push(new window.D2LAdventureEngine.comp_ProgressBar(c,
this._locationData,b))};f.prototype.buildCompSlider=function(b,a){var c;c=void 0!==b.ID?b.ID:b.AssetID;void 0===b.Horizontal&&(b.Horizontal=!0);void 0===b.mobile&&(b.mobile=!1);void 0===b.horzDragNodeButton&&(b.horzDragNodeButton={AssetID:"defaultSliderNode",Type:"Button",dynamicHitmask:!0,initDisabled:b.initDisabled,InWinLockOverride:b.InWinLockOverride,tabEnabled:!1});void 0===b.leftNodeButton&&(b.leftNodeButton={AssetID:"defaultSliderLeft",Type:"Button",dynamicHitmask:!0,initDisabled:b.initDisabled,
InWinLockOverride:b.InWinLockOverride,tabEnabled:!1});void 0===b.rightNodeButton&&(b.rightNodeButton={AssetID:"defaultSliderRight",Type:"Button",dynamicHitmask:!0,initDisabled:b.initDisabled,InWinLockOverride:b.InWinLockOverride,tabEnabled:!1});void 0===b.barThickness&&(b.barThickness=10);void 0===b.initHeight&&(b.initHeight=25);void 0===b.barColor&&(b.barColor="#444444");return void 0===a?new window.D2LAdventureEngine.comp_ScrollBar(c,this._locationData,b):a.push(new window.D2LAdventureEngine.comp_ScrollBar(c,
this._locationData,b))};f.prototype.buildCompScrollbar=function(b,a){var c;c=void 0!==b.ID?b.ID:b.AssetID;return void 0===a?new window.D2LAdventureEngine.comp_ScrollBar(c,this._locationData,b):a.push(new window.D2LAdventureEngine.comp_ScrollBar(c,this._locationData,b))};f.prototype.buildNodeMap=function(b,a){return void 0===a?new window.D2LAdventureEngine.comp_NodeMap(b.ID,this._locationData,b):a.push(new window.D2LAdventureEngine.comp_NodeMap(b.ID,this._locationData,b))};f.prototype.buildCompUDC=
function(b,a){var c;void 0!==b.initContent&&(void 0===b.initContentData&&(b.initContentData=b.initContent),b.initContent=this.parseGroupContent(b.initContentData));if(void 0===a)return new window.D2LAdventureEngine.comp_UDC(b.ID,this._locationData,b);c=new window.D2LAdventureEngine.comp_UDC(b.ID,this._locationData,b);return a.push(c)};f.prototype.buildCompPaintArea=function(b,a){return void 0===a?new window.D2LAdventureEngine.comp_PaintArea(b.ID,this._locationData,b):a.push(new window.D2LAdventureEngine.comp_PaintArea(b.ID,
this._locationData,b))};f.prototype.buildCompSpeechBubble=function(b,a){return void 0===a?new window.D2LAdventureEngine.comp_SpeechBubble(b.ID,this._locationData,b):a.push(new window.D2LAdventureEngine.comp_SpeechBubble(b.ID,this._locationData,b))};f.prototype.buildCompWindow=function(b,a){return"Bubble"===b.Style?this.buildCompSpeechBubble(b,a):void 0===a?new window.D2LAdventureEngine.comp_Window(b.ID,this._locationData,b):a.push(new window.D2LAdventureEngine.comp_Window(b.ID,this._locationData,
b))};f.prototype.buildCompQuiz=function(b,a){return void 0===a?new window.D2LAdventureEngine.comp_Quiz(b.ID,this._locationData,b):a.push(new window.D2LAdventureEngine.comp_Quiz(b.ID,this._locationData,b))};f.prototype.buildCompQuizQuestion=function(b,a){return void 0===a?new window.D2LAdventureEngine.comp_QuizQuestion(b.ID,this._locationData,b):a.push(new window.D2LAdventureEngine.comp_QuizQuestion(b.ID,this._locationData,b))};f.prototype.buildCompGroup=function(b,a){var c;void 0!==b.initContent&&
(void 0===b.initContentData&&(b.initContentData=b.initContent),b.initContent=this.parseGroupContent(b.initContentData));if(void 0===a)return new window.D2LAdventureEngine.comp_Group(b.ID,this._locationData,b);c=new window.D2LAdventureEngine.comp_Group(b.ID,this._locationData,b);return a.push(c)};f.prototype.parseGroupContent=function(b,a){var c,d;if(void 0!==b){c=D2LAdventureEngine.gu_DataManager.cloneDataObj(b.events);b=D2LAdventureEngine.gu_JsonOps.parseAllRules(b);b.events=c;c=[];for(d=0;d<b.length;){switch(b[d].Type){case "Bitmap":this.buildCompBitmap(b[d],
c);break;case "Shape":case "Shape - Rectangle":case "Shape - Round Rectangle":case "Shape - Circle":case "Shape - Line":this.buildShape(b[d],c);break;case "Button":this.buildCompButton(b[d],c);break;case "LabeledButton":this.buildCompLabeledButton(b[d],c);break;case "Sprite":this.buildCompSprite(b[d],c);break;case "Text":this.buildCompText(b[d],c);break;case "Toggle":this.buildCompToggle(b[d],c);break;case "ToggleCluster":this.buildCompToggleCluster(b[d],c);break;case "Timer":this.buildCompTimer(b[d],
c);break;case "Progress Bar":this.buildCompProgressBar(b[d],c);break;case "Slider":this.buildCompSlider(b[d],c);break;case "Node Map":this.buildNodeMap(b[d],c);break;case "UDC":this.buildCompUDC(b[d],c);break;case "Paint Area":this.buildCompPaintArea(b[d],c);break;case "Window":this.buildCompWindow(b[d],c);break;case "Quiz":this.buildCompQuiz(b[d],c);break;case "QuizQuestion":this.buildCompQuizQuestion(b[d],c);break;case "SpeechBubble":return this.buildCompSpeechBubble(b[d],c);case "Group":this.buildCompGroup(b[d],
c);break;default:D2LAdventureEngine.gu_debugManager.log("parseGroupContent recived unknown type "+b[d].ID+" : "+b[d].Type)}d++}return c}D2LAdventureEngine.gu_debugManager.log("ERROR: parseGroupContent recived null data")};f.prototype.DeselectAllUDCs=function(){var b,a;a=D2LAdventureEngine.gu_StateManager.GetCurrentScene().getCompsByType("UDC");for(b=0;b<a.length;)a[b].Deselect(),b++;D2LAdventureEngine.gu_KeyManager.DeactivateKey("delSelectedUDS")};f.prototype.DeleteSelectedUDC=function(){var b,a;
a=D2LAdventureEngine.gu_StateManager.GetCurrentScene().getCompsByType("UDC");for(b=0;b<a.length;)a[b]._Selected&&a[b].topGroup&&(a[b]._deleteButtonData.onClick===a[b].DeleteUDC?a[b].DeleteUDC():D2LAdventureEngine.gu_EventManager.DispacthEvent(a[b]._deleteButton,"onClick")),b++};f.prototype.GetSelectedUDC=function(){var b,a,c;c=[];a=D2LAdventureEngine.gu_StateManager.GetCurrentScene().getCompsByType("UDC");for(b=0;b<a.length;)a[b]._Selected&&a[b].topGroup&&c.push(a[b]),b++;return c};return f}();window.D2LAdventureEngine.SpriteDataObject=
function(f){function b(a,c,d){this.clone=g(this.clone,this);this.VailidateFrames=g(this.VailidateFrames,this);var f,h;this.data=a;this._type=c;this._name=this.data.AssetID;this._loaded=!1;this._handleOnLoad=d;this._framesVaildated=!1;f=function(a){return function(c){b.__super__.constructor.call(a,{images:[c],frames:a.data.spriteFrameData,animations:a.data.animationsData});a.VailidateFrames();a._loaded=!0;if(a._handleOnLoad)return a._handleOnLoad(a)}}(this);a.crossOrigin?(h=new Image,h.crossOrigin=
a.crossOrigin,h.src=this.data.AssetLocation,h.complete?f(h):h.onload=function(a){return function(a){h.onload=void 0;return f(a.target)}}(this),console.log("attempting to load "+a.AssetID+" with CORS set as "+h.crossOrigin)):f(this.data.AssetLocation)}r(b,f);b.prototype.data=void 0;b.prototype._type=void 0;b.prototype._name=void 0;b.prototype._handleOnLoad=void 0;b.prototype._framesVaildated=void 0;b.prototype.VailidateFrames=function(){var a;if(!this._framesVaildated){for(a=0;a<this._frames.length;){if(!1===
this._frames[a].image.complete)return this._framesVaildated=!0,!1;a++}for(a=0;a<this._frames.length;)this._frames[a].rect.width>this._frames[a].image.naturalWidth&&(D2LAdventureEngine.gu_debugManager.log("Warning SpriteDataObject VailidateFrames "+this._name+" had a frame width that exceeded the bounds. This would crash IE or Safari."),this._frames[a].rect.width=this._frames[a].image.naturalWidth),this._frames[a].rect.height>this._frames[a].image.naturalHeight&&(D2LAdventureEngine.gu_debugManager.log("Warning SpriteDataObject VailidateFrames "+
this._name+" had a frame height that exceeded the bounds. This would crash IE or Safari."),this._frames[a].rect.height=this._frames[a].image.naturalHeight),a++;this._framesVaildated=!0}return this._framesVaildated};b.prototype.clone=function(){return new b(this.data,this._type)};return b}(createjs.SpriteSheet);window.D2LAdventureEngine.JsonOperations=function(){function f(){this.parseAllRules=g(this.parseAllRules,this);this.LangTagsCheck=g(this.LangTagsCheck,this);this.parseEventRules=g(this.parseEventRules,
this);this.parseSubCommand=g(this.parseSubCommand,this);this.parseConverstionRules=g(this.parseConverstionRules,this);this.parseGlobalReq=g(this.parseGlobalReq,this);this.parseReferanceRules=g(this.parseReferanceRules,this);this._eventStorage=[]}f.prototype._eventStorage=void 0;f.prototype.parseReferanceRules=function(b,a,c){var d,f;d=function(b){return function(b,d){var f,g,h,m,t,u;null==d&&(d=String);m=b.valueOf();for(u=0;;){u++;if(999<u)return D2LAdventureEngine.gu_debugManager.log("ERROR!: parseReferanceRules TIMED OUT "+
m+" : "+c),m;if(m.constructor===String){if(-1!==m.indexOf("[")&&-1!==m.indexOf("]")){g=0;for(f=!1;!f;)m.indexOf("[%",g)!==m.indexOf("[",g)?f=!0:(g=m.indexOf("[%",g)+2,t=m.indexOf("[",g),-1===t&&(f=!0));g=m.indexOf("[",g)+1;f=m.indexOf("]",g);f=m.substr(g,f-g);if(void 0!==a[f])if(d===Number||d===Boolean)try{h=eval(m.replace("["+f+"]",a[f]))}catch(v){c=v,D2LAdventureEngine.gu_debugManager.log("ERROR!: parseReferanceRules "+m+" : "+c)}else h=m.replace("["+f+"]",a[f]);else return m}else return m;void 0!==
h&&(m=h)}else return m}}}(this);if(void 0!==b){if(void 0===a)return window.D2LAdventureEngine.gu_debugManager.log("Warning, parseReferanceRules, undefined targetRef"),!1;if(b.constructor===String)return d(b);if(b.constructor===Array){f=[];for(d=0;d<b.length;)f.push(this.parseAllRules(b[d],a,c)),d++;return f}if("object"===typeof b){f={};for(d=0;d<Object.keys(b).length;)void 0!==f[Object.keys(b)[d]]&&Object.keys(b),f[Object.keys(b)[d]]=this.parseAllRules(b[Object.keys(b)[d]],a,c),d++;return f}b.constructor!==
Number&&D2LAdventureEngine.gu_debugManager.log("ERROR!: parseReferanceRules passed unknown param type");return b}};f.prototype.parseGlobalReq=function(b,a,c,d){var f,g;void 0===c&&(c=!0);if(-1!==b.indexOf("[%getGlobal(")&&-1!==b.indexOf(")]")){g=this.parseSubCommand(b,"[%getGlobal(",")]");a=this.parseAllRules(g,a,d);try{f=eval("D2LAdventureEngine.gu_CustomVarsManager.GetVar("+a+");")}catch(k){return D2LAdventureEngine.gu_debugManager.log("@parseGlobalReq ERROR line "+b+" failed to retrieve "+a),b}return c?
b.replace("[%getGlobal("+g+")]",f):f}return b};f.prototype.parseConverstionRules=function(b,a,c){var d,f;if(void 0!==b){d=function(b){return function(d){var f,g,m,l,q,t,u;u=0;for(q=function(a,b){var c,d;for(c=0;-1!==a.indexOf("[",c)&&-1!==a.indexOf("]",c);)d=a.substring(a.indexOf("[",c),c),a=a.replace(d,d[b]()),c=a.indexOf("]",c);return a};;){u++;if(99999<u)return D2LAdventureEngine.gu_debugManager.log("ERROR!: parseReferanceRules TIMED OUT "+l+" : "+c),l;if(d.constructor===String)if(l=void 0!==f?
f:d.valueOf(),f=void 0,l.constructor===String){t=Object.keys(D2LAdventureEngine.gu_CustomJsonTags);g=0;for(m=t.length;g<m;g++)f=t[g],-1!==l.indexOf(f)&&(f=l.replace(f,D2LAdventureEngine.gu_CustomJsonTags[f]));if(-1!==l.indexOf("[%getGlobal(")&&-1!==l.indexOf(")]"))f=b.parseGlobalReq(l,a,!0,c);else if(-1!==l.indexOf("[%lb]"))f=l.replace("[%lb]","[");else if(-1!==l.indexOf("[%rb]"))f=l.replace("[%rb]","]");else if(-1!==l.indexOf("[%lComm]"))f=l.replace("[%lComm]","<");else if(-1!==l.indexOf("[%rComm]"))f=
l.replace("[%rComm]",">");else if(-1!==l.indexOf("[%esc]"))f=l.replace("[%esc]","\\");else if(-1!==l.indexOf("[%amp]"))f=l.replace("[%amp]","&");else if(-1!==l.indexOf("[%dquot]"))f=l.replace("[%dquot]",'"');else if(-1!==l.indexOf("[%squot]"))f=l.replace("[%squot]","'");else if(-1!==l.indexOf("[%true]")){f=l.replace("[%true]","");try{f=eval(!0)}catch(v){c=v,D2LAdventureEngine.gu_debugManager.log("ERROR!: parseConverstionRules "+l+" : "+c)}}else if(-1!==l.indexOf("[%false]")){f=l.replace("[%false]",
"");try{f=eval(!1)}catch(v){c=v,D2LAdventureEngine.gu_debugManager.log("ERROR!: parseConverstionRules "+l+" : "+c)}}else if(-1!==l.indexOf("[%canDi.width]"))f=l.replace("[%canDi.width]",D2LAdventureEngine.gu_canDi.width.toString());else if(-1!==l.indexOf("[%canDi.height]"))f=l.replace("[%canDi.height]",D2LAdventureEngine.gu_canDi.height.toString());else if(-1!==l.indexOf("[%string]"))f=String(l.replace("[%string]",""));else if(-1!==l.indexOf("[%substr(")){g=b.parseSubCommand(l,"[%substr(",")]");f=
l.replace("[%substr("+g+")]","");if(void 0!==g.split(",")[2])try{eval(g.split(",")[2])}catch(v){c=v,D2LAdventureEngine.gu_debugManager.log("ERROR!: failed to apply addon in line "+l+" "+c)}try{f=eval("newline.substr("+g+") + addon")}catch(v){c=v,f=l,D2LAdventureEngine.gu_debugManager.log("ERROR!: parseConverstionRules "+l+" : "+c)}}else if(-1!==l.indexOf("[%randNum("))m=b.parseSubCommand(l,"[%randNum(",")]"),-1===m.indexOf(",")?(console.log("ERROR [%randNum(#,#)] found in src "+locString+" was not formatted correctly."),
f=l):(m=m.split(","),g=Math.round(Math.random()*(parseInt(m[1])-parseInt(m[0]))+parseInt(m[0])),f=l.replace("[%randNum("+m.join(",")+")]",g));else if(-1!==l.indexOf("[%num]"))if(f=l.replace("[%num]",""),-1===l.indexOf("undefined")&&-1===l.indexOf("null"))try{f=eval(f)}catch(v){c=v,D2LAdventureEngine.gu_debugManager.log("ERROR!: parseConverstionRules "+l+" : "+c)}else D2LAdventureEngine.gu_debugManager.log("Warning!: parseConverstionRules "+l+" contained null value"),f="null";else if(-1!==l.indexOf("[%lowerCase]"))f=
l.replace("[%lowerCase]",""),f=q(f,"toLowerCase");else if(-1!==l.indexOf("[%upperCase]"))f=l.replace("[%upperCase]",""),f=q(f,"toUpperCase");else return l}else return l;else return d}}}(this);if(b.constructor===String)return d(b);if(b.constructor===Array){f=[];for(d=0;d<b.length;)f.push(this.parseAllRules(b[d],a,c)),d++;return f}if("object"===typeof b){d=0;for(f={};d<Object.keys(b).length;)void 0!==a&&void 0!==a[Object.keys(b)[d]]&&null!==a[Object.keys(b)[d]]&&Object.keys(b),f[Object.keys(b)[d]]=
this.parseAllRules(b[Object.keys(b)[d]],a,c),d++;return f}return b}};f.prototype.parseSubCommand=function(b,a,c){var d,f;if(-1!==b.indexOf(a)&&-1!==b.indexOf(c)){d=b.indexOf(a)+a.length;f=b.slice(d,b.indexOf(c,d));if(-1!==f.indexOf(a)){d=b.slice(b.indexOf(a)+a.length,b.length);for(a=b=0;-1!==d.indexOf("[%",a);)a=d.indexOf("]",d.indexOf("[%",a)+2)+1,b++;c=d.slice(0,d.indexOf(c,a))}else c=b.slice(b.indexOf(a)+a.length,b.indexOf(c,d));return c}return b};f.prototype.parseEventRules=function(b,a,c){var d,
f,g;if(void 0!==b&&(d=function(a){return function(b){var d,f;if(void 0!==c){if(-1!==b.indexOf("[%eventData(")&&-1!==b.indexOf(")]")){f=a.parseSubCommand(b,"[%eventData(",")]");d=a.parseAllRules(f,c);try{d=eval(d)}catch(g){}d=c.compRef.FindValueWithString(d);return b.replace("[%eventData("+f+")]",d)}return b}}}(this),f=function(a){return function(b){var f,g;g=b.valueOf();for(f=void 0;;)if(g.constructor===String){if(-1!==g.indexOf("[%eventData]"))f=void 0!==c.compRef._options?c.data&&c.data.constructor===
String?g.replace("[%eventData]",c.data):void 0!==c.compRef._options.events[c.interactionType+"Data"]&&null!==c.compRef._options.events[c.interactionType+"Data"]?c.compRef._options.events[c.interactionType+"Data"].constructor===String?g.replace("[%eventData]",c.compRef._options.events[c.interactionType+"Data"]):g.replace("[%eventData]",c.compRef._options.events[c.interactionType+"Data"].toString()):g.replace("[%eventData]","undefined"):void 0!==c.compRef.events[c.interactionType+"Data"]&&null!==c.compRef.events[c.interactionType+
"Data"]?c.compRef.events[c.interactionType+"Data"].constructor===String?g.replace("[%eventData]",c.compRef.events[c.interactionType+"Data"]):g.replace("[%eventData]",c.compRef.events[c.interactionType+"Data"].toString()):g.replace("[%eventData]","undefined");else if(-1!==g.indexOf("[%eventData(")&&-1!==b.indexOf(")]"))f=d(g,c);else if(-1!==g.indexOf("[%eventObject]"))c.compRef._id||c.compRef.constructor!==String?(void 0===c.compRefString&&(c.compRefString="D2LAdventureEngine.gu_StateManager.findComponent('"+
c.compRef._id+"')"),f=g.replace("[%eventObject]",c.compRefString)):(f=a._eventStorage.indexOf(c.compRef),-1===f?(a._eventStorage.push(c),f=D2LAdventureEngine.gu_JsonOps._eventStorage.length-1):a._eventStorage[f]=c,f=g.replace("[%eventObject]","D2LAdventureEngine.gu_JsonOps._eventStorage["+f.valueOf()+"]"));else if(-1!==g.indexOf("[%mouseX]"))void 0!==c.stageX?f=g.replace("[%mouseX]",c.stageX):c.x?f=g.replace("[%mouseX]",c.x):c.rawX?f=g.replace("[%mouseX]",c.rawX):void 0!==c.eventObj?void 0!==c.eventObj.stageX?
f=g.replace("[%mouseX]",c.eventObj.stageX):void 0!==c.eventObj.rawX&&(f=g.replace("[%mouseX]",c.eventObj.rawX)):f=c.clientX?g.replace("[%mouseX]",c.clientX):g;else if(-1!==g.indexOf("[%mouseY]"))void 0!==c.stageY?f=g.replace("[%mouseY]",c.stageY):c.y?f=g.replace("[%mouseY]",c.y):c.rawY?f=g.replace("[%mouseY]",c.rawY):void 0!==c.eventObj?void 0!==c.eventObj.stageY?f=g.replace("[%mouseY]",c.eventObj.stageY):void 0!==c.eventObj.rawY&&(f=g.replace("[%mouseY]",c.eventObj.rawY)):f=c.clientY?g.replace("[%mouseY]",
c.clientY):g;else return g;void 0!==f&&(g=f)}else return g}}(this),void 0!==b)){if(b.constructor===String)return void 0!==c?f(b,c):-1!==b.indexOf("[%eventData]")?b=b.replace("[%eventData]","undefined"):b;if(b.constructor===Array){g=[];for(f=0;f<b.length;)void 0!==c?g.push(this.parseAllRules(b[f],a,c)):void 0!==b[f]&&null!==b[f]&&b[f].constructor===String&&-1!==b[f].indexOf("[%eventData]")?g.push(b[f].replace("[%eventData]","undefined")):g.push(b[f]),f++;return g}if("object"===typeof b){g={};for(f=
0;f<Object.keys(b).length;)null!==b[Object.keys(b)[f]]&&(void 0!==c?g[Object.keys(b)[f]]=this.parseAllRules(b[Object.keys(b)[f]],a,c):void 0!==b[Object.keys(b)[f]]&&b[Object.keys(b)[f]].constructor===String&&-1!==b[Object.keys(b)[f]].indexOf("[%eventData]")?g[Object.keys(b)[f]]=b[Object.keys(b)[f]].replace("[%eventData]","undefined"):g[Object.keys(b)[f]]=b[Object.keys(b)[f]]),f++;return g}return b}};f.prototype.LangTagsCheck=function(b){var a,c,d,f,g;a=function(c){return function(c){var d,f,g,h,k,
m,v,r;d=D2LAdventureEngine.gu_LanguageData;r="";if(c)for(f=0;f<c.length;)d=d[c[f]],r=""===r?r+(""+c[f]):r+("."+c[f]),f++;else c=[];f=b.substring(b.lastIndexOf("[%LANG ")+7,b.lastIndexOf("]"));v=Object.keys(d);g=0;for(m=v.length;g<m;g++){h=v[g];if(d[h].constructor===String&&f===r+"."+h)return b=b.replace("[%LANG "+f+"]",d[h]);if(d[h].constructor===Object&&(k=f.split(".")[c.length],""===r&&k===h||""!==r&&k===h))return c.push(h),a(c)}}}(this);if(void 0===b||null===b)return b;if(b.constructor===String){if(-1===
b.indexOf("[%LANG"))return b;-1!==b.indexOf("[%LANGCODE")&&(b=b.replace("[%LANGCODE]",D2LAdventureEngine.gu_LanguageSet));a(void 0)}else if(b.constructor===Array)for(c=0;c<b.length;)b[c]=this.LangTagsCheck(b[c]),c++;else if(b.constructor===Object)for(g=Object.keys(b),c=0,d=g.length;c<d;c++)f=g[c],b[f]=this.LangTagsCheck(b[f]);return b};f.prototype.parseAllRules=function(b,a,c){if(void 0===b||null===b||b.constructor===Boolean||b.constructor===Number||b.constructor===D2LAdventureEngine.SpriteDataObject)return b;
b=this.LangTagsCheck(b);void 0!==a&&(b=this.parseReferanceRules(b,a,c));b=this.parseConverstionRules(b,a,c);return b=this.parseEventRules(b,a,c)};return f}();window.D2LAdventureEngine.AE_version="1.00.0";window.D2LAdventureEngine.gu_ScreenReaderHelper=new D2LAdventureEngine.ScreenReaderHelper;window.D2LAdventureEngine.gu_CSSManager=new D2LAdventureEngine.CSSManager;window.D2LAdventureEngine.gu_ResourceManager=new D2LAdventureEngine.ResourceManager;window.D2LAdventureEngine.gu_StateManager=new D2LAdventureEngine.StateManager;
window.D2LAdventureEngine.gu_EventManager=new D2LAdventureEngine.AEeventManager;window.D2LAdventureEngine.gu_GUIManager=new D2LAdventureEngine.UI_Manager;window.D2LAdventureEngine.gu_KeyManager=new D2LAdventureEngine.KeyManager;window.D2LAdventureEngine.gu_ClippingRuleManager=new D2LAdventureEngine.ClippingRuleManager;window.D2LAdventureEngine.gu_TabManager=new D2LAdventureEngine.TabAccessManager;window.D2LAdventureEngine.gu_CustomFunctionsManager=new D2LAdventureEngine.CustomFunctionManager;window.D2LAdventureEngine.gu_TweensManager=
new D2LAdventureEngine.TweenManager;window.D2LAdventureEngine.gu_CustomVarsManager=new D2LAdventureEngine.CustomVarsManager;window.D2LAdventureEngine.gu_JsonOps=new D2LAdventureEngine.JsonOperations;window.D2LAdventureEngine.gu_SoundManager=new D2LAdventureEngine.SoundManager;window.D2LAdventureEngine.gu_debugManager=new D2LAdventureEngine.debugManager;window.D2LAdventureEngine.gu_LeManager=new D2LAdventureEngine.LEManager;window.D2LAdventureEngine.gu_canDi=null;window.D2LAdventureEngine.gu_AdventureID=
null;window.D2LAdventureEngine.gu_stageRef=null;window.D2LAdventureEngine.gu_InWinButtonLock=!1;window.D2LAdventureEngine.gu_AccessMode=!1;window.D2LAdventureEngine.gu_DataAssets=[];window.D2LAdventureEngine.gu_QuizAttemptData=[];window.D2LAdventureEngine.gu_QuizManager=new D2LAdventureEngine.QuizManager;window.D2LAdventureEngine.gu_TabLineThickness=4;window.D2LAdventureEngine.gu_DynamicTextBaseSize=16;window.D2LAdventureEngine.gu_ActiveTextCompObjects=[];window.D2LAdventureEngine.gu_ActiveTimerCompObjects=
[];D2LAdventureEngine.Adventure=function(){function f(b){this.canvasID=b;this.Shutdown=g(this.Shutdown,this);this.preInit=g(this.preInit,this);this.PreHandleSplashCompletion=g(this.PreHandleSplashCompletion,this);this.SetSplash=g(this.SetSplash,this);this.CreateSplashes=g(this.CreateSplashes,this);this.preLoadingPhase=g(this.preLoadingPhase,this);this.useSplashID="defaultD2LSpash";this.AvaililbleSplash=[];this.initialized=this.preinitialized=this.handlePostSlashOP=this.DynamicTextOveride=this.PlayingSplash=
!1}f.prototype.compData=void 0;f.prototype.useSplashID=void 0;f.prototype.AvaililbleSplash=void 0;f.prototype.PlayingSplash=void 0;f.prototype.DefindedVarDat=void 0;f.prototype.DynamicTextOveride=void 0;f.prototype.StageEventManager=void 0;f.prototype.handlePostSlashOP=void 0;f.prototype.canvas=void 0;f.prototype.stage=void 0;f.prototype.preinitialized=void 0;f.prototype.initialized=void 0;f.prototype.preLoadingPhase=function(){if(!D2LAdventureEngine.ShutdownCalled)return D2LAdventureEngine.gu_ComponentManager=
new D2LAdventureEngine.ComponentManager,this.canvas=document.getElementById(this.canvasID),D2LAdventureEngine.gu_AdventureID=this.canvasID,D2LAdventureEngine.gu_CSSManager.AppendCSSFiles(),this.stage=new createjs.Stage(this.canvas),D2LAdventureEngine.gu_stageRef=this.stage,this.StageEventManager=new D2LAdventureEngine.StageEventManager(this.stage),D2LAdventureEngine.gu_StageEventManager=this.StageEventManager,createjs.Ticker.timingMode=createjs.Ticker.RAF_SYNCHED,createjs.Ticker.addEventListener("tick",
this.StageEventManager.preUpdate),window.onresize=this.StageEventManager.preHandleWindowSize,window.ondeviceorientation=this.StageEventManager.preHandleWindowSize,window.onscroll=this.StageEventManager.preHandleWindowScroll,this.StageEventManager.preHandleWindowSize(),D2LAdventureEngine.gu_TouchAllowed&&(this.canvas.ontouchstart=this.StageEventManager.HandleTouchStart,this.canvas.ontouchend=this.StageEventManager.HandleTouchEnd,this.canvas.ontouchmove=this.StageEventManager.HandleTouchMove),this.canvas.addEventListener("focus",
this.StageEventManager.CanvasFocus),this.canvas.addEventListener("blur",this.StageEventManager.CanvasBlur),this.canvas.ondragstart=function(b){return b.preventDefault()},this.canvas.onmousedown=function(b){return function(a){a.preventDefault();b.StageEventManager.preHandleMouseDown(a);if(void 0!==D2LAdventureEngine.gu_KeyManager)return D2LAdventureEngine.gu_TabManager.HandleAccessModeDeactivation(!0)}}(this),this.canvas.focus(),this.SetSplash(),this.PlayingSplash=!0,D2LAdventureEngine.gu_stageRef.update(),
this.splash.play(this.PreHandleSplashCompletion)};f.prototype.CreateSplashes=function(b){var a,c,d;c=0;for(a=[];c<b.length;)d=new D2LAdventureEngine.SplashView(b[c].ID,b[c]),this.AvaililbleSplash.push(d),a.push(c++);return a};f.prototype.SetSplash=function(){var b,a,c;b=function(a){return function(){a.PreHandleSplashCompletion();a.handlePostSlashOP=!1;return D2LAdventureEngine.gu_KeyManager.DeactivateKey("gDefKey_PushSplash")}}(this);c=!1;for(a=0;a<this.AvaililbleSplash.length;)this.AvaililbleSplash[a].ID===
this.useSplashID&&(this.splash=this.AvaililbleSplash[a],this.splash.closeFunc=b,this.splash.preInit(),c=!0,D2LAdventureEngine.gu_debugManager.log("using splash "+this.useSplashID)),a++;c||(D2LAdventureEngine.gu_debugManager.log("Splash ID "+this.useSplashID+" not loaded correctly using default"),this.splash=this.AvaililbleSplash[0],this.splash.closeFunc=b,this.splash.preInit());D2LAdventureEngine.gu_stageRef.addChild(this.splash);void 0===this.splash.SS_options.endOnDone&&(this.splash.SS_options.endOnDone=
!0);void 0===this.splash._options.useProgBar&&(this.preloadProgressBar=new D2LAdventureEngine.comp_ProgressBar("preloadProgressBar",{state:"SPLASH",scene:"SPLASH"},{bypassParentDefine:!0,onComplete:function(a){return function(){D2LAdventureEngine.gu_stageRef.removeChild(a.preloadProgressBar);a.preloadProgressBar=void 0;a.splash._allowClick=!0;if(!0===a.splash.SS_options.endOnDone||"[%true]"===a.splash.SS_options.endOnDone)return a.splash.callEnd()}}(this)}),this.splash.addChildAt(this.preloadProgressBar,
1),this.preloadProgressBar.Update(),this.preloadProgressBar.Move(this.canvas.width/2-this.preloadProgressBar._options.initWidth/2,this.canvas.height-250));void 0===this.splash._options.useProgBar||!1===this.splash._options.useProgBar||"[%false]"===this.splash._options.useProgBar||"none"===this.splash._options.useProgBar?(this.preloadProgressBar=new D2LAdventureEngine.comp_ProgressBar("preloadProgressBar",{state:"SPLASH",scene:"SPLASH"},{bypassParentDefine:!0,initHidden:!0,onComplete:function(a){return function(){D2LAdventureEngine.gu_stageRef.removeChild(a.preloadProgressBar);
a.preloadProgressBar=void 0;a.splash._allowClick=!0;if(!0===a.splash.SS_options.endOnDone||"[%true]"===a.splash.SS_options.endOnDone)return a.splash.callEnd()}}(this)}),this.splash.addChildAt(this.preloadProgressBar,1),this.preloadProgressBar.Update(),this.preloadProgressBar.Move(this.canvas.width/2-this.preloadProgressBar._options.initWidth/2,this.canvas.height-250)):(b=D2LAdventureEngine.gu_JsonOps.parseAllRules(this.splash._options.useProgBar),this.preloadProgressBar=D2LAdventureEngine.gu_ComponentManager.BuildComponent(b,
{state:"SPLASH",scene:"SPLASH"},this.splash),this.splash.addChildAt(this.preloadProgressBar,1),this.preloadProgressBar.Update());"none"===this.splash._options.useTextOptions?(this.preloadProgressText=new createjs.Text("0","0px","#000"),this.preloadProgressText.width=0,this.preloadProgressText.x=-200,this.preloadProgressText.y=-200):void 0===this.splash._options.useTextOptions?(this.preloadProgressText=new createjs.Text("0%","30px "+D2LAdventureEngine.gu_CSSManager._globalDefaultFont,"#444444"),this.preloadProgressText.width=
2*this.preloadProgressBar.width,this.preloadProgressText.x=this.canvas.width/2,this.preloadProgressText.y=this.preloadProgressBar.y+20,this.preloadProgressText.textAlign="center"):(b=D2LAdventureEngine.gu_JsonOps.parseAllRules(this.splash._options.useTextOptions),void 0===b.font&&(b.font="12px "+D2LAdventureEngine.gu_CSSManager._globalDefaultFont),void 0===b.color&&(b.color="#000000"),void 0===b.initWidth&&(b.initWidth=200),void 0===b.initX&&(b.initX=0),void 0===b.initY&&(b.initY=0),void 0===b.align&&
(b.align="center"),this.preloadProgressText=new createjs.Text(b.loadingMessage,b.font,b.color),this.preloadProgressText.width=b.initWidth,this.preloadProgressText.x=b.initX,this.preloadProgressText.y=b.initY,this.preloadProgressText.textAlign=b.align);return D2LAdventureEngine.gu_stageRef.addChild(this.preloadProgressText)};f.prototype.PreHandleSplashCompletion=function(){var b;if(this.preinitialized){if(D2LAdventureEngine.gu_KeyManager.DeactivateKey("gdefkey_pushsplash"),D2LAdventureEngine.gu_stageRef.removeChild(this.splash),
D2LAdventureEngine.gu_stageRef.removeChild(this.preloadProgressText),this.StageEventManager.preHandleWindowSize(),this.PlayingSplash=!1,D2LAdventureEngine.gu_stageRef.addChild(D2LAdventureEngine.gu_StateManager),D2LAdventureEngine.gu_stageRef.addChild(D2LAdventureEngine.gu_GUIManager),this.StageEventManager.preUpdate(b={type:"tick"}),D2LAdventureEngine.gu_StateManager.ActivateInitState(),void 0!==this.onSplashCompletion){if(this.onSplashCompletion.constructor===Function)return this.onSplashCompletion(b);
if(this.onSplashCompletion.constructor===String)return D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(this.onSplashCompletion,b)}}else return this.handlePostSlashOP=!0};f.prototype.preInit=function(){this.StageEventManager.Init();D2LAdventureEngine.gu_CustomVarsManager.globalDefinedVars=D2LAdventureEngine.gu_JsonOps.parseAllRules(this.DefindedVarDat);1===this.compData.States.length&&(D2LAdventureEngine.gu_ScreenReaderHelper._ignoreStateDescription=!0);D2LAdventureEngine.gu_ScreenReaderHelper.Init();
D2LAdventureEngine.gu_QuizManager.Init();D2LAdventureEngine.gu_KeyManager.Init();D2LAdventureEngine.gu_TabManager.Init();D2LAdventureEngine.gu_SoundManager.Init();D2LAdventureEngine.gu_ClippingRuleManager.Init();D2LAdventureEngine.gu_StateManager.Init(this.compData);this.preinitialized=!0;this.handlePostSlashOP&&this.PreHandleSplashCompletion();void 0!==this.Init&&this.Init();return this.initialized=!0};f.prototype.Shutdown=function(){var b,a,c;b=window.D2LAdventureEngine;b.ShutdownCalled=!0;for(a=
0;a<b.gu_ActiveTextCompObjects.length;)b.gu_ActiveTextCompObjects[a].Destroy(),a++;this.splash.HandleShutdownReq();b.gu_KeyManager.HandleShutdownReq();b.gu_StateManager.HandleShutdownReq();b.gu_debugManager.HandleShutdownReq();b.gu_SoundManager.HandleShutdownReq();a=document.getElementsByClassName("AdventureText");for(b=0;0<a.length;)c=a[0].parentNode,c.parentNode.removeChild(c),b++,999<b&&(a=[],"object"===typeof console&&console.log("Warning AE shutdown safe-check tripped, stray adventure text objects may still exist"));
createjs.Ticker.removeAllEventListeners();this.StageEventManager.Shutdown();b=this.canvas.cloneNode(!0);this.canvas.parentNode.replaceChild(b,this.canvas);if("object"===typeof console)return console.log("Adventure Engine has been shutdown. Thank you for playing!")};return f}();window.D2LAdventureEngine.component=function(f){function b(a,b,d){this._id=a;this.location=b;this._options=d;this.clone=g(this.clone,this);this.isTypeOf=g(this.isTypeOf,this);this.inGroup=g(this.inGroup,this);this.FindValueWithString=
g(this.FindValueWithString,this);this.getActiveTabParent=g(this.getActiveTabParent,this);this.getIndexPos=g(this.getIndexPos,this);this.HandleAC_ReqEnd=g(this.HandleAC_ReqEnd,this);this.HandleAC_ReqStart=g(this.HandleAC_ReqStart,this);this.HandleFocusDeactivation=g(this.HandleFocusDeactivation,this);this.HandleFocusActivation=g(this.HandleFocusActivation,this);this.HandleUnfocus=g(this.HandleUnfocus,this);this.HandleFocus=g(this.HandleFocus,this);this.blur=g(this.blur,this);this.focus=g(this.focus,
this);this.HandleMouseWheel=g(this.HandleMouseWheel,this);this.Destroy=g(this.Destroy,this);this.Disable=g(this.Disable,this);this.Enable=g(this.Enable,this);this.DisableTabbing=g(this.DisableTabbing,this);this.EnableTabbing=g(this.EnableTabbing,this);this.Hide=g(this.Hide,this);this.Show=g(this.Show,this);this.DragStop=g(this.DragStop,this);this.DragStart=g(this.DragStart,this);this.MakeUndraggable=g(this.MakeUndraggable,this);this.MakeDraggable=g(this.MakeDraggable,this);this.MakeDefaultClickSound=
g(this.MakeDefaultClickSound,this);this.HandleMouseUpOver=g(this.HandleMouseUpOver,this);this.HandleMouseUp=g(this.HandleMouseUp,this);this.HandleMouseOut=g(this.HandleMouseOut,this);this.HandleMouseOver=g(this.HandleMouseOver,this);this.HandleWinScrollEvent=g(this.HandleWinScrollEvent,this);this.HandleResizeEvent=g(this.HandleResizeEvent,this);this.SetInWinLockOverride=g(this.SetInWinLockOverride,this);this.ValidateWinOveride=g(this.ValidateWinOveride,this);this.isUnderCheck=g(this.isUnderCheck,
this);this.HandleDoubleClick=g(this.HandleDoubleClick,this);this.HandlePress=g(this.HandlePress,this);this.HandleMouseMoveOver=g(this.HandleMouseMoveOver,this);this.HandleMouseMove=g(this.HandleMouseMove,this);this.CheckMouseOut=g(this.CheckMouseOut,this);this.CheckClipOnPoint=g(this.CheckClipOnPoint,this);this.AdjustShadowOptions=g(this.AdjustShadowOptions,this);this.AssessGlobalPos=g(this.AssessGlobalPos,this);this.Scale=g(this.Scale,this);this.ShiftY=g(this.ShiftY,this);this.ShiftX=g(this.ShiftX,
this);this.Move=g(this.Move,this);this.CheckTweenValHolder=g(this.CheckTweenValHolder,this);this.Update=g(this.Update,this);this.BuildAccessContext=g(this.BuildAccessContext,this);this.RemoveTweeningListItem=g(this.RemoveTweeningListItem,this);this.AddTweeningListItem=g(this.AddTweeningListItem,this);this.SetEventEffect=g(this.SetEventEffect,this);this.Resize=g(this.Resize,this);this.getHeight=g(this.getHeight,this);this.getWidth=g(this.getWidth,this);this.SetAlpha=g(this.SetAlpha,this);this.ChangeCursor=
g(this.ChangeCursor,this);this.SetZPos=g(this.SetZPos,this);this.BuildTabOutline=g(this.BuildTabOutline,this);this.RemoveTabOutline=g(this.RemoveTabOutline,this);this.BufferTabOutline=g(this.BufferTabOutline,this);this.PostLoadInit=g(this.PostLoadInit,this);this.addToEventGroup=g(this.addToEventGroup,this);this.setEventGroups=g(this.setEventGroups,this);this.SetEvents=g(this.SetEvents,this);this.AccessInit=g(this.AccessInit,this);this.Init=g(this.Init,this);this.AssessDefaultOptions=g(this.AssessDefaultOptions,
this);this._options||(this._options={initX:0,initY:0,scaleX:1,scaleY:1,initRegX:0,initRegY:0,initWidth:void 0,initHeight:void 0,initHidden:!1,initRotationAngle:0,allowMouseThrough:!1,noOutline:!1,forceOutlineRect:void 0,initAlpha:1,zPos:void 0,initDisabled:!1,tabEnabled:!0,initTabPos:void 0,outOnClick:!1,draggable:!1,dragConstraint:void 0,interactive:!1,InWinLockOverride:!1,clickAudioSFX:"default",overAudioSFX:"none",bubbleEvents:!1,useContext:void 0,useContextParent:void 0,useContextOptions:void 0,
useCursor:void 0,useCursorDrag:void 0,bypassParentDefine:!1,nodeMapData:void 0,baseDataOveride:void 0,Shadow:void 0,uiComp:void 0,isAccessLinkedTo:void 0,eventGroups:[],events:void 0});this._defined=this._accessInitialized=this._initialized=this._inTabFocus=this._postLoadReq=this._isunder=this._hasBeenClicked=!1;this._tabAssignAttemptsLeft=10;this._TweenValueHolder=new createjs.DisplayObject;this._cursorMemory={};this._inheritanceChain=[D2LAdventureEngine.component];this.constructor===D2LAdventureEngine.component||
this.isTypeOf(this.constructor)||this._inheritanceChain.push(this.constructor);this._isTweening=[];this._MouseOver=this._MouseDown=this._dragging=!1;this._assignedEvents=[];this._isDOMObject=!1;this.tabulatedClippingRule="in";this.nestedInGroups=[];this._groupOffset={x:0,y:0};this._globalPos={x:void 0,y:void 0};this.initialize()}r(b,f);b.prototype._hasBeenClicked=void 0;b.prototype._isunder=void 0;b.prototype._postLoadReq=void 0;b.prototype._accessInitialized=void 0;b.prototype._inTabFocus=void 0;
b.prototype._initialized=void 0;b.prototype._defined=void 0;b.prototype._assignedEvents=void 0;b.prototype._allowedEvents=void 0;b.prototype._TweenValueHolder=void 0;b.prototype._isTweening=void 0;b.prototype._dragging=void 0;b.prototype._dragClickLoc=void 0;b.prototype._MouseDown=void 0;b.prototype._MouseOver=void 0;b.prototype._cursorMemory=void 0;b.prototype._isDOMObject=void 0;b.prototype._mouseAtLoc=void 0;b.prototype._destroyed=void 0;b.prototype._inheritanceChain=void 0;b.prototype._tabAssignAttemptsLeft=
void 0;b.prototype.tabulatedClippingRule=void 0;b.prototype.assignedScrollParent=void 0;b.prototype.topGroup=void 0;b.prototype.nestedInGroups=void 0;b.prototype._globalPos=void 0;b.prototype.BaseOptionsData=void 0;b.prototype.AssessDefaultOptions=function(){var a;this.BaseOptionsData=this.clone(void 0,!0);this._destroyed=!1;void 0===this.location&&(this.location={});this.assoiatedCanvasID=void 0===this.location.canvas?D2LAdventureEngine.gu_AdventureID:this.location.canvas;this.assoiatedStateID=void 0===
this.location.state?"none":this.location.state;this.assoiatedSceneID=void 0===this.location.scene?"none":this.location.scene;void 0!==this._options.baseDataOveride&&(this.BaseOptionsData=this._options.baseDataOveride);void 0===this._options.allowMouseThrough&&(this._options.allowMouseThrough=!1);void 0===this._options.initX||null===this._options.initX?(this.x=0,this._options.initX=0):"center"===this._options.initX?(this.x=0,this.visible=!1):this.x=D2LAdventureEngine.gu_JsonOps.parseAllRules(this._options.initX,
this);void 0===this._options.initY||null===this._options.initY?(this.y=0,this._options.initY=0):"center"===this._options.initY?(this.y=0,this.visible=!1):this.y=D2LAdventureEngine.gu_JsonOps.parseAllRules(this._options.initY,this);this.regX=void 0===this._options.initRegX||null===this._options.initRegX?0:this._options.initRegX;this.regY=void 0===this._options.initRegY||null===this._options.initRegY?0:this._options.initRegY;this._options.scaleX=void 0===this._options.scaleX?1:D2LAdventureEngine.gu_JsonOps.parseAllRules(this._options.scaleX,
this);this._options.scaleY=void 0===this._options.scaleY?1:D2LAdventureEngine.gu_JsonOps.parseAllRules(this._options.scaleY,this);this.visible=!0===this._options.initHidden?!1:!0;void 0!==this._options.initRotationAngle&&(this.rotation=this._options.initRotationAngle);void 0===this._options.clickAudioSFX&&this._options.interactive&&(this._options.clickAudioSFX="default");void 0===this._options.overAudioSFX&&(this._options.overAudioSFX="none");void 0===this._options.initDisabled&&(this._options.initDisabled=
!1);void 0===this._options.InWinLockOverride&&(this._options.InWinLockOverride=!1);void 0===this._options.Shadow?this._options.Shadow=null:this.AdjustShadowOptions(this._options.Shadow);void 0===this._options.outOnClick&&(this._options.outOnClick=!1);void 0===this._options.draggable&&(this._options.draggable=!1);void 0!==this._options.dragConstraint&&"parent"!==this._options.dragConstraint&&(void 0!==this._options.dragConstraint.x&&void 0!==this._options.dragConstraint.y&&void 0!==this._options.dragConstraint.width&&
void 0!==this._options.dragConstraint.height||D2LAdventureEngine.gu_debugManager.log("Warning, some values in the dragConstraint of "+this._id(NaN)),void 0===this._options.dragConstraint.x&&(this._options.dragConstraint.x=0),void 0===this._options.dragConstraint.y&&(this._options.dragConstraint.y=0),void 0===this._options.dragConstraint.width&&(this._options.dragConstraint.width=100),void 0===this._options.dragConstraint.height&&(this._options.dragConstraint.height=100));void 0===this._options.eventGroups?
this._options.eventGroups=[]:this._options.eventGroups.constructor===String&&(this._options.eventGroups=this._options.eventGroups.split(","));void 0!==this._options.mask&&(this._options.mask.constructor===D2LAdventureEngine.comp_Shape?this.mask=this._options.mask:this._options.mask.constructor===Object&&(this._options.mask.ID||(this._options.mask.ID=this._id+"_mask"),a=D2LAdventureEngine.gu_ComponentManager.BuildComponent(this._options.mask,this.location),a.Update(),this.mask=a._shape,this.mask.x=
this.x,this.mask.y=this.y,this.mask.regX=a.regX,this.mask.regY=a.regY));this._enabled=!this._options.initDisabled;void 0!==this.comp_AssessDefaultOptions&&this.comp_AssessDefaultOptions();return this.BuildAccessContext()};b.prototype.Init=function(){this._defined||(this.AssessDefaultOptions(),this.SetEvents(),this.setEventGroups(),this.AssessGlobalPos());this._defined=!0;this._postLoadReq||this.PostLoadInit();return this._TweenValueHolder.defined=!1};b.prototype.AccessInit=function(){var a;a=!0;this._options.interactive||
(this._options.tabEnabled=!1);void 0===this._options.tabEnabled&&"Text"!==this._options.Type&&(this._options.tabEnabled=!0);if(!D2LAdventureEngine.gu_TabManager.GetAccessRef(this._id))return this._options.tabEnabled&&(a=D2LAdventureEngine.gu_TabManager.AssignAccessObject(this,this._options.initTabPos,!0),a||(this._tabAssignAttemptsLeft--,0===this._tabAssignAttemptsLeft&&(D2LAdventureEngine.gu_debugManager.log("Error tab assignment for "+this._id+" failed, comp will not be tabEnabled"),this._options.initTabPos=
void 0,this._options.tabEnabled=!1,a=!0,this._tabAssignAttemptsLeft=10))),a&&(this._options.noOutline||(this.BufferTabOutline(),this._tabAssignAttemptsLeft=10),this.comp_AccessInit&&this.comp_AccessInit()),this._accessInitialized=!0};b.prototype.SetEvents=function(){var a,b,d,f,g;void 0===this._options.events&&(this._options.events={});g=[];this.comp_Update&&g.push({trigger:"onupdate",effects:[this.comp_Update]});this.comp_Scale&&g.push({trigger:"onscale",effects:[this.comp_Scale]});this.comp_HandlePress&&
g.push({trigger:"onclick",effects:[this.comp_HandlePress]});this.comp_HandleMouseUpOver&&g.push({trigger:"onMouseUpOver",effects:[this.comp_HandleMouseUpOver]});this.comp_HandleMouseUp&&g.push({trigger:"onMouseUp",effects:[this.comp_HandleMouseUp]});this.comp_HandleDoubleClick&&g.push({trigger:"ondblclick",effects:[this.comp_HandleDoubleClick]});this.comp_HandleMouseOver&&g.push({trigger:"onover",effects:[this.comp_HandleMouseOver]});this.comp_HandleMouseOut&&g.push({trigger:"onout",effects:[this.comp_HandleMouseOut]});
this.comp_HandleMouseMove&&g.push({trigger:"onmousemove",effects:[this.comp_HandleMouseMove]});this.comp_Enable&&g.push({trigger:"onenable",effects:[this.comp_Enable]});this.comp_Show&&g.push({trigger:"onshow",effects:[this.comp_Show]});this.comp_Disable&&g.push({trigger:"ondisable",effects:[this.comp_Disable]});this.comp_Hide&&g.push({trigger:"onhide",effects:[this.comp_Hide]});this.comp_HandleDragStart&&g.push({trigger:"onDragStart",effects:[this.comp_HandleDragStart]});this.comp_HandleDragging&&
g.push({trigger:"whileDragging",effects:[this.comp_HandleDragging]});this.comp_HandleDragEnd&&g.push({trigger:"ondragend",effects:[this.comp_HandleDragEnd]});this.comp_HandleResizeEvent&&g.push({trigger:"onWinResize",effects:[this.comp_HandleResizeEvent]});this.comp_HandleWinScrollEvent&&g.push({trigger:"onWinScroll",effects:[this.comp_HandleWinScrollEvent]});b=0;for(f=g.length;b<f;b++)d=g[b],d.owner=this,d.isDefault=!0,this._assignedEvents.push(D2LAdventureEngine.gu_EventManager.NewEvent(d));if(this._options.events){f=
Object.keys(this._options.events);g=[];d=0;for(b=f.length;d<b;d++)a=f[d],void 0!==a&&null!==a&&""!==a?-1===a.indexOf("Data",this.length-4)?(a={trigger:a,effects:this._options.events[a],effectParams:this._options.events[a+"Data"],isDefault:!1,owner:this},g.push(this._assignedEvents.push(D2LAdventureEngine.gu_EventManager.NewEvent(a)))):g.push(void 0):g.push(void 0);return g}};b.prototype.setEventGroups=function(){var a,b;a=0;for(b=[];a<this._options.eventGroups.length;)this.addToEventGroup(this._options.eventGroups[a]),
b.push(a++);return b};b.prototype.addToEventGroup=function(a){var b,d,f,g,k;g=D2LAdventureEngine.gu_CustomFunctionsManager._eventGroups;f=!1;for(d=0;d<g.length;){if(g[d].ID===a){f=!0;k=!1;for(b=0;b<g[d].compRefs.length;)g[d].compRefs[b]._id===this._id&&(k=!0,b=g[d].compRefs.length+1),b++;k||g[d].compRefs.push(this);d=g.length+1}d++}f||g.push({ID:a,compRefs:[this]});b=!1;0<this._options.eventGroups.length&&this._options.eventGroups[0]===a&&(b=!0);if(!b)return this._options.eventGroups.push(a)};b.prototype.PostLoadInit=
function(){var a,b;this.scaleX=this._options.scaleX;this.scaleY=this._options.scaleY;!0!==this._options.bypassParentDefine&&(this.parentScene="none"===this.assoiatedSceneID?D2LAdventureEngine.gu_GUIManager:"SPLASH"!==this.assoiatedSceneID?D2LAdventureEngine.gu_StateManager.GetSceneById(this.assoiatedSceneID):D2LAdventureEngine.venture.splash);this.zPosSetFunc=this.zPosSetTo=void 0;void 0!==this._options.zPos?this.SetZPos(this._options.zPos):"SPLASH"!==this.assoiatedSceneID&&this.SetZPos("top");void 0!==
this.comp_Init&&this.comp_Init();void 0!==this.width&&void 0!==this.height||void 0===this.DetermineDimentions||this.DetermineDimentions();void 0!==this._options.initAlpha&&this.SetAlpha(D2LAdventureEngine.gu_JsonOps.parseAllRules(this._options.initAlpha,this));"center"===this._options.initX&&(a=this.topGroup&&this.topGroup.getWidth()?this.topGroup.getWidth():"none"===this.assoiatedSceneID?D2LAdventureEngine.gu_canDi.width:D2LAdventureEngine.gu_StateManager.GetSceneById(this.location.scene).width,
this._options.useAdaptiveWidth&&a>D2LAdventureEngine.gu_canDi.useWinInnerWidth?(a=D2LAdventureEngine.gu_canDi.useWinInnerWidth,a=a/2-this.getWidth()/2+D2LAdventureEngine.gu_canDi.containerScrollOffset.left):a=a/2-this.getWidth()/2,0>a&&(a=0),"center"!==this._options.initY&&(this.y=0,this.Move(a,this._options.initY)));"center"===this._options.initY&&(b=this.topGroup&&this.topGroup.getHeight()?this.topGroup.getHeight()/2-this.getHeight()/2:"none"===this.assoiatedSceneID?D2LAdventureEngine.gu_canDi.height/
2-this.getHeight()/2:D2LAdventureEngine.gu_StateManager.GetSceneById(this.location.scene).height/2-this.getHeight()/2,"center"!==this._options.initX?(this.x=0,this.Move(this.x,b)):this.Move(a,b));if("center"===this._options.initX||"center"===this._options.initY)this.visible=!0;this.AssessGlobalPos();(a=D2LAdventureEngine.gu_ClippingRuleManager.getRuleByOwnerID(this._id))&&D2LAdventureEngine.gu_ClippingRuleManager.SetRule({x:this._globalPos.x,y:this._globalPos.y,width:a.rect.width-(this._groupOffset.x|
0),height:a.rect.height-(this._groupOffset.y|0)},this);this._initialized=!0;return D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onInit")};b.prototype.BufferTabOutline=function(){if(this._options.tabEnabled)return D2LAdventureEngine.gu_TabManager.AddBufferRequest(this._id)};b.prototype.RemoveTabOutline=function(){return D2LAdventureEngine.gu_TabManager.RemoveBufferRequest(this._id)};b.prototype.BuildTabOutline=function(){var a,b,d,f,g;if(this._accessInitialized)return g=D2LAdventureEngine.gu_TabLineThickness,
this._tabOutline&&this._tabOutline.Destroy(),this._options.forceOutlineRect?(a=this._options.forceOutlineRect.x?this._options.forceOutlineRect.x:-g/2,b=this._options.forceOutlineRect.y?this._options.forceOutlineRect.y:-g/2,d=this._options.forceOutlineRect.width?this._options.forceOutlineRect.width:-g/2,f=this._options.forceOutlineRect.height?this._options.forceOutlineRect.height:-g/2):(a=-g/2,b=-g/2,d=this.width*this.scaleX,f=this.height*this.scaleY+g),a={ID:this._id+"_accOutline",Type:"Shape",shapeType:"Rectangle",
interactive:"[%false]",allowMouseThrough:"[%true]",tabEnabled:!1,color:"rgba(0,0,0,0)",noOutline:!0,initHidden:!this._inTabFocus,initX:"[%num]"+a,initY:"[%num]"+b,strokeWidth:"[%num]"+g,strokeColor:"#FFFF00",rect:{x:"[%num]0",y:"[%num]0",width:"[%num]"+d,height:"[%num]"+f}},this._tabOutline=D2LAdventureEngine.gu_ComponentManager.BuildComponent(a,this.location,this),this.addChild(this._tabOutline)};b.prototype.SetZPos=function(a){var b;this._options.zPos=a;if(this._initialized){if(this.topGroup)a=
this.topGroup;else if(void 0!==this.parentScene&&void 0!==this.parentScene.AssignZIndex)a=this.parentScene;else return D2LAdventureEngine.gu_debugManager.log("Warning requested zPos for "+this._id+" not recognized");this._options.zPos.constructor===Number?(b=this._options.zPos,1>b?a.AssignZIndex(this,"bottom"):a.setChildIndex(this,this._options.zPos)):this._options.zPos.constructor===String&&("bottom"===this._options.zPos?a.AssignZIndex(this,this._options.zPos):"top"===this._options.zPos?a.AssignZIndex(this,
this._options.zPos):-1!==this._options.zPos.indexOf("above ")?(b=this._options.zPos.slice(6,this._options.zPos.length),a.AssignZIndex(this,"above",b)):-1!==this._options.zPos.indexOf("below ")?(b=this._options.zPos.slice(6,this._options.zPos.length),a.AssignZIndex(this,"below",b)):D2LAdventureEngine.gu_debugManager.log("Warning requested zPos for "+this._id+" not recognized"))}};b.prototype.ChangeCursor=function(a,b){void 0===a&&(void 0===b?this._cursorMemory.over&&(a=this._cursorMemory.over.valueOf(),
this._cursorMemory.over=void 0):this._cursorMemory[b]&&(a=this._cursorMemory[b].valueOf(),this._cursorMemory[b]=void 0));void 0!==a&&a!==D2LAdventureEngine.gu_CSSManager.usingCursorType&&(void 0===b?this._cursorMemory.over=D2LAdventureEngine.gu_CSSManager.usingCursorType.valueOf():this._cursorMemory[b]=D2LAdventureEngine.gu_CSSManager.usingCursorType.valueOf(),D2LAdventureEngine.gu_CSSManager.ChangeCursor(a))};b.prototype.SetAlpha=function(a,b){var d;this.alpha=1;for(d=0;d<this.children.length;)this.getChildAt(d).SetAlpha?
this.getChildAt(d).SetAlpha(a,b):void 0!==this.getChildAt(d).alpha&&(this.getChildAt(d).alpha=a),d++;this.comp_SetAlpha&&this.comp_SetAlpha(a,b);this._tabOutline&&(this._tabOutline.alpha=1);if(!b)return this._TweenValueHolder.alpha=a};b.prototype.getWidth=function(){if(this.comp_getWidth)return this.comp_getWidth();if(void 0===this.width||null===this.width||isNaN(this.width)){if(!this._initialized&&this._options.initWidth)return this._options.initWidth;D2LAdventureEngine.gu_debugManager.log("Warning, getWidth in comp "+
this._id+" has failed")}else return this.width*this.scaleX};b.prototype.getHeight=function(){if(this.comp_getHeight)return this.comp_getHeight();if(void 0===this.height||null===this.height||isNaN(this.height)){if(!this._initialized&&this._options.initHeight)return this._options.initHeight;D2LAdventureEngine.gu_debugManager.log("Warning, getHeight in comp "+this._id+" has failed")}else return this.height*this.scaleY};b.prototype.Resize=function(a,b,d){this.comp_Resize?this.comp_Resize(a,b):(this.width=
a,this.height=b);if(!d)return this._TweenValueHolder.width=this.width,this._TweenValueHolder.height=this.height};b.prototype.SetEventEffect=function(a,b,d){if(this._initialized)return a={trigger:a,effects:b,effectParams:d,isDefault:!1,owner:this},D2LAdventureEngine.gu_EventManager.ReplaceEvent(a);void 0===this._options.events&&(this._options.events={});this._options.events[a]=b;return this._options.events[a+"Data"]=d};b.prototype.AddTweeningListItem=function(a){return this._isTweening.push(a)};b.prototype.RemoveTweeningListItem=
function(a){var b;for(b=0;b<this._isTweening.length;){if(this._isTweening[b]===a){this._isTweening.splice(b,1);return}b++}return!1};b.prototype.BuildAccessContext=function(){var a;if(this.comp_BuildAccessContext)return this.comp_BuildAccessContext();this._options.useContext&&(this._options.useContext.constructor===String?a=this._options.useContext:this._options.interactive&&!0===this._options.useContext&&(a=this._id));if(a&&(D2LAdventureEngine.gu_ScreenReaderHelper.AddReadText(this._id,a,"div",this._options.useContextParent,
this._options.useContextOptions),this._options.initHidden||this._options.initDisabled))return D2LAdventureEngine.gu_ScreenReaderHelper.HideReadText(this._id)};b.prototype.Update=function(a){var b;null==a&&(a={});if(this._initialized){this._accessInitialized?this._tabOutline&&this._tabOutline.Update():this.AccessInit();void 0!==this.parentScene&&void 0!==this.zPosSetFunc&&this.parent!==this.zPosSetTo&&(this.zPosSetFunc(),this.zPosSetTo=this.parent);if(this._options.interactive){a.compRefString="D2LAdventureEngine.gu_StateManager.findComponent('"+
this._id+"')";a.compRef=this;this._MouseDown&&void 0!==this._whileDownEvent&&(this._whileDownEvent.constructor===Function?this._whileDownEvent(a):this._whileDownEvent.constructor===String&&(a.interactionType="whileDown",a.data=this._options.whileDownData,D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(this._whileDownEvent,a)));if(this._MouseOver&&this.ValidateWinOveride()){for(b=0;b<this.nestedInGroups.length;)b++;this._dragging&&(this._options.useCursorDrag?this.ChangeCursor(this._options.useCursorDrag,
"drag"):this.ChangeCursor("move","drag"));this._options.events&&this._options.events.whileOver&&D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"whileOver",a)}this._accessInitialized&&this._inTabFocus&&void 0!==this._options.whileInFocus&&(this._options.whileInFocus.constructor===Function?this._options.whileInFocus(a):this._options.whileInFocus.constructor===String&&(a.interactionType="whileInFocus",a.data=this._options.whileInFocusData,D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(this._options.whileInFocus,
a)))}0!==this._isTweening.length&&this.CheckTweenValHolder()}else this._destroyed||this.Init();return D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onupdate",a)};b.prototype.CheckTweenValHolder=function(){this._TweenValueHolder.defined||(this._TweenValueHolder.alpha=this.alpha,this._TweenValueHolder.x=this.x,this._TweenValueHolder.y=this.y,this._TweenValueHolder.width=this.getWidth(),this._TweenValueHolder.height=this.getHeight(),this._TweenValueHolder.defined=!0);this.alpha!==this._TweenValueHolder.alpha&&
this.SetAlpha(this._TweenValueHolder.alpha,!0);this.x===this._TweenValueHolder.x&&this.y===this._TweenValueHolder.y||this.Move(Math.round(this._TweenValueHolder.x),Math.round(this._TweenValueHolder.y),{asTweenAction:!0});if(this.getWidth()!==this._TweenValueHolder.width||this.getHeight()!==this._TweenValueHolder.height)return this.Resize(this._TweenValueHolder.width,this._TweenValueHolder.height,!0)};b.prototype.Move=function(a,b,d){var f;"center"!==a&&isNaN(a)||"center"!==b&&isNaN(b)?D2LAdventureEngine.gu_debugManager.log("Warning: Move request for "+
this._id+" contained a NaN value, only number values or 'center' are valid values with the move method."):("center"===a&&(a=this.topGroup&&this.topGroup.getWidth()?this.topGroup.getWidth():"none"!==this.assoiatedSceneID&&this.location?D2LAdventureEngine.gu_StateManager.GetSceneById(this.location.scene).width:D2LAdventureEngine.gu_canDi.width,this._options.useAdaptiveWidth&&a>D2LAdventureEngine.gu_canDi.useWinInnerWidth?(a=D2LAdventureEngine.gu_canDi.useWinInnerWidth,a=a/2-this.getWidth()*this.scaleX/
2+D2LAdventureEngine.gu_canDi.containerScrollOffset.left):a=a/2-this.getWidth()*this.scaleX/2),"center"===b&&(b=this.topGroup&&this.topGroup.getHeight()?this.topGroup.getHeight()/2-this.getHeight()/2:"none"!==this.assoiatedSceneID&&this.location?D2LAdventureEngine.gu_StateManager.GetSceneById(this.location.scene).height/2-this.getHeight()/2:D2LAdventureEngine.gu_canDi.height/2-this.getHeight()/2),void 0===d&&(d={asTweenAction:void 0,useGroupedTextOffsets:void 0}),f={interactionType:"onMove",data:this._options.onMoveData,
sourcePostion:{x:this.x,y:this.y},newPostion:{x:a,y:b},postionDiffence:{x:a-this.x,y:b-this.y}},this._options.initX=a,this._options.initY=b,this.x=a,this.y=b,this.mask&&(this.mask.x=this.x,this.mask.y=this.y),this._options.noOutline||this.BufferTabOutline(),this._options.tabEnabled&&this._enabled&&D2LAdventureEngine.gu_TabManager.AssignAccessObject(this,this._options.initTabPos),this.AssessGlobalPos(),d.ignoreClipCheck||D2LAdventureEngine.gu_ClippingRuleManager.SetRule({x:this._globalPos.x,y:this._globalPos.y,
width:this.getWidth()-(this._groupOffset.x|0),height:this.getHeight()-(this._groupOffset.y|0)},this),void 0!==this.comp_Move&&this.comp_Move(f,d),d.asTweenAction||(this._TweenValueHolder.x=this.x,this._TweenValueHolder.y=this.y),D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onMove",f))};b.prototype.ShiftX=function(a){this._initialized?(this.Move(this.x+a,this.y),this.AssessGlobalPos()):this.Move(this._options.initX+a,this._options.initY)};b.prototype.ShiftY=function(a){this._initialized?
(this.Move(this.x,this.y+a),this.AssessGlobalPos()):this.Move(this._options.initX,this._options.initY+a)};b.prototype.Scale=function(a){this.scaleY=this.scaleX=a;D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onScale",a)};b.prototype.AssessGlobalPos=function(){var a,b,d,f,g;this._globalPos={x:0,y:0};if(!this._isDOMObject)for(f=this.nestedInGroups,b=0,d=f.length;b<d;b++)a=f[b],g=a.x,a=a.y,this._globalPos.x+=g,this._globalPos.y+=a;this._globalPos.x+=this.x;this._globalPos.y+=this.y;return this._globalPos};
b.prototype.AdjustShadowOptions=function(a,b){if(void 0!==a){if(null===a||"null"===a||"none"===a||!1===a)return this.shadow=null;if(a.constructor===String)return void 0!==b?(null===this.shadow&&(this.shadow=new createjs.Shadow("#000000",5,5,10)),"color"===a?this.shadow.color=b:"x"===a||"offsetX"===a?this.shadow.offsetX=b:"y"===a||"offsetY"===a?this.shadow.offsetY=b:"blur"===a?this.shadow.blur=b:D2LAdventureEngine.gu_debugManager.log("Warning! AdjustShadowOptions called on "+this._id+" option string "+
a+" was an unknown param of Shadow.")):D2LAdventureEngine.gu_debugManager.log("Warning! AdjustShadowOptions called on "+this._id+" option string "+a+" was included but with no value param.");if(a.constructor===Object)return void 0===a.color&&(a.color="#000000"),void 0===a.offsetX&&(a.offsetX=5),void 0===a.offsetY&&(a.offsetY=5),void 0===a.blur&&(a.blur=10),this.shadow=new createjs.Shadow(a.color,a.offsetX,a.offsetY,a.blur);if(!0===a){if(null===this.shadow)return this.shadow=new createjs.Shadow("#000000",
5,5,10)}else return D2LAdventureEngine.gu_debugManager.log("Warning! AdjustShadowOptions called on "+this._id+" without an unsupported option param.")}else return D2LAdventureEngine.gu_debugManager.log("Warning! AdjustShadowOptions called on "+this._id+" without an option param.")};b.prototype.CheckClipOnPoint=function(a,b){var d;return"out"===this.tabulatedClippingRule||"in"!==this.tabulatedClippingRule&&(d=this.globalToLocal(a*D2LAdventureEngine.gu_canDi.inverseScaleFactor,b*D2LAdventureEngine.gu_canDi.inverseScaleFactor),
this.tabulatedClippingRule.top&&d.y<=this.tabulatedClippingRule.top||this.tabulatedClippingRule.bottom&&d.y>=this.getHeight()-this.tabulatedClippingRule.bottom||this.tabulatedClippingRule.left&&d.x<=this.tabulatedClippingRule.left||this.tabulatedClippingRule.right&&d.x>=this.getWidth()-this.tabulatedClippingRule.right)?!1:!0};b.prototype.CheckMouseOut=function(a){var b;this._isunder=this.isUnderCheck(a);b=window.D2LAdventureEngine.gu_AccessCursorDisabled?!1:D2LAdventureEngine.gu_GUIManager.AccessCur.visible;
this._isunder||!this._MouseOver||"Text"===this._options.Type||b||(this.HandleMouseOut(a),this._mouseAtLoc=null);if(this.comp_CheckMouseOut)return this.comp_CheckMouseOut(a)};b.prototype.HandleMouseMove=function(a){var b,d;if(this._initialized&&this._enabled&&this._options.interactive)return D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onMouseMove",a),this._options.draggable&&this._dragging&&this._enabled?(void 0===this._dragClickLoc&&(this._dragClickLoc="x-only"===this._options.draggable?
{x:a.mPos.x-this.x,y:this.y}:"y-only"===this._options.draggable?{x:this.x,y:a.mPos.y-this.y}:{x:a.mPos.x-this.x,y:a.mPos.y-this.y}),"x-only"===this._options.draggable?(b=a.mPos.x-this._dragClickLoc.x,d=this._dragClickLoc.y):(b="y-only"===this._options.draggable?this._dragClickLoc.x:a.mPos.x-this._dragClickLoc.x,d=a.mPos.y-this._dragClickLoc.y),void 0!==this._options.dragConstraint&&("parent"===this._options.dragConstraint?this.topGroup&&(0>b?b=0:b>this.topGroup.getWidth()&&(b=this.topGroup.getWidth()),
0>d?d=0:d>this.topGroup.getHeight()&&(d=this.topGroup.getHeight())):(b<this._options.dragConstraint.x?b=this._options.dragConstraint.x:b>this._options.dragConstraint.width&&(b=this._options.dragConstraint.width),d<this._options.dragConstraint.y?d=this._options.dragConstraint.y:d>this._options.dragConstraint.height&&(d=this._options.dragConstraint.height))),this.Move(b,d,{ignoreClipCheck:!0}),D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"whileDragging",a)):this._dragClickLoc=void 0};b.prototype.HandleMouseMoveOver=
function(a){this._mouseAtLoc={x:a.mPos.x,y:a.mPos.y};return this._initialized&&this.ValidateWinOveride()&&this.CheckClipOnPoint(a.x,a.y)&&(this.topGroup&&this.topGroup._options.interactive&&this._options.bubbleEvents&&this.topGroup.HandleMouseMove(a),this._enabled&&this._options.interactive)?(D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onMouseMoveOver",a),this._options.allowMouseThrough):!1};b.prototype.HandlePress=function(a,b){void 0===a&&(a={});return this._initialized&&this.ValidateWinOveride()&&
this.CheckClipOnPoint(a.x,a.y)&&(this.topGroup&&this.topGroup._options.interactive&&this._options.bubbleEvents&&this.topGroup.HandlePress(a),this._MouseDown=!0,this._enabled&&this._options.interactive)?(this._hasBeenClicked=!0,void 0!==this._options.useContext&&window.D2LAdventureEngine.gu_GUIManager.ChangeContext(""),this._options.clickAudioSFX&&"none"!==this._options.clickAudioSFX&&("default"!==this._options.clickAudioSFX?window.D2LAdventureEngine.gu_SoundManager.play(this._options.clickAudioSFX):
this.MakeDefaultClickSound()),this._options.outOnClick&&!this._options.bubbleEvents&&this.ChangeCursor("default"),D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onclick",a),this.DragStart(),(window.D2LAdventureEngine.gu_TouchAllowed||this._options.outOnClick)&&this.addEventListener("pressup",this.HandleMouseOut),this._options.allowMouseThrough):!1};b.prototype.HandleDoubleClick=function(a){return this._initialized&&this.ValidateWinOveride()&&this.CheckClipOnPoint(a.x,a.y)?(this.topGroup&&
this.topGroup._options.interactive&&this._options.bubbleEvents&&this.topGroup.HandleDoubleClick(a),this._enabled&&this._options.interactive&&(this._hasBeenClicked=!0,this._options.clickAudioSFX&&"none"!==this._options.clickAudioSFX&&("default"!==this._options.clickAudioSFX?window.D2LAdventureEngine.gu_SoundManager.play(this._options.clickAudioSFX):this.MakeDefaultClickSound()),D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onDblClick",a)),this._options.allowMouseThrough):!1};b.prototype.isUnderCheck=
function(a){var b,d,f,g;this._isunder=!1;f=(a.rawX|a.pageX)*D2LAdventureEngine.gu_canDi.inverseScaleFactor;g=(a.rawY|a.pageY)*D2LAdventureEngine.gu_canDi.inverseScaleFactor;if(a.targets)for(b=0,a=a.targets;b<a.length;){if(d=null===a[b].inGroup||void 0===a[b].inGroup)if(a[b].parent&&null!==a[b].parent.inGroup&&void 0!==a[b].parent.inGroup)a[b]=a[b].parent;else break;if(a[b]===this||a[b].inGroup(this))if(void 0===f&&this.CheckClipOnPoint(f,g)||void 0!==f&&this.CheckClipOnPoint(f,g))return this._isunder=
!0;b++}return this._isunder};b.prototype.ValidateWinOveride=function(){return this._options.InWinLockOverride||!D2LAdventureEngine.gu_InWinButtonLock||void 0!==D2LAdventureEngine.gu_GUIManager.CurrentActiveWindow&&void 0!==D2LAdventureEngine.gu_GUIManager.CurrentActiveWindow._options&&D2LAdventureEngine.gu_GUIManager.CurrentActiveWindow._options.allowUI&&this._options.uiComp?!0:!1};b.prototype.SetInWinLockOverride=function(a){void 0===a&&(a=!0);this._options.InWinLockOverride=a;this.comp_SetInWinLockOverride&&
this.comp_SetInWinLockOverride(a);D2LAdventureEngine.gu_InWinButtonLock&&(a?this.inWinUnhide&&this.inWinUnhide(!0):this.inWinHide&&this.inWinHide(!0));return a};b.prototype.HandleResizeEvent=function(a){D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onWinResize",a)};b.prototype.HandleWinScrollEvent=function(a){D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onWinScroll",a)};b.prototype.HandleMouseOver=function(a){return!this._MouseOver&&this._initialized&&!this._dragging&&this.ValidateWinOveride()&&
this.CheckClipOnPoint(a.x,a.y)?(void 0!==this.assignedScrollParent&&void 0!==this.assignedScrollParent.HandleMouseOver&&this.assignedScrollParent.HandleMouseOver(a),this.topGroup&&this.topGroup._options.interactive&&this._options.bubbleEvents&&this.topGroup.HandleMouseOver(a),this._MouseOver=!0,this._enabled&&this._options.interactive&&("none"!==this._options.overAudioSFX&&window.D2LAdventureEngine.gu_SoundManager.play(this._options.overAudioSFX),void 0!==this._options.useContext&&(this._options.useContext.constructor!==
String?window.D2LAdventureEngine.gu_GUIManager.ChangeContext(this._id):this._options.useContext.constructor===String&&window.D2LAdventureEngine.gu_GUIManager.ChangeContext(this._options.useContext)),D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onover",a),this._options.useCursor&&this.ChangeCursor(this._options.useCursor),this.addEventListener("mouseout",this.HandleMouseOut)),this._options.allowMouseThrough):this._options.allowMouseThrough&&this._MouseOver};b.prototype.HandleMouseOut=function(a){null==
a&&(a={});if(!(this._isunder||!this._initialized||this._dragging||void 0!==this.mouseOverChild&&this.mouseOverChild(a))&&(void 0!==this.assignedScrollParent&&void 0!==this.assignedScrollParent.HandleMouseOut&&this.assignedScrollParent.HandleMouseOut(a),this.topGroup&&this.topGroup._options.interactive&&this._options.bubbleEvents&&this.topGroup.HandleMouseOut(a),this._MouseDown=this._MouseOver=!1,this._options.interactive))return void 0!==this._options.useContext&&!1!==this._options.useContext&&window.D2LAdventureEngine.gu_GUIManager.ChangeContext(""),
this._options.useCursor&&!this._options.bubbleEvents&&this.ChangeCursor("default"),D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onOut",a),this.removeEventListener("mouseout")};b.prototype.HandleMouseUp=function(a){null==a&&(a={});this._initialized&&this._options.interactive&&(this._MouseDown=!1,this.DragStop(),D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onMouseUp",a))};b.prototype.HandleMouseUpOver=function(a){null==a&&(a={});if(this._initialized&&this._options.interactive)return a.compRefString=
"D2LAdventureEngine.gu_StateManager.findComponent('"+this._id+"')",a.compRef=this,a.interactionType="onMouseUpOver",a.data=this._options.onMouseUpOverData,void 0===this.assignedScrollParent||void 0===this.assignedScrollParent.HandleMouseUpOver||a.bypassScrollParentCall||this.assignedScrollParent.HandleMouseUpOver(a),this.topGroup&&this.topGroup._options.interactive&&this._options.bubbleEvents&&this.topGroup.HandleMouseUpOver(a),D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onMouseUpOver",
a),this._options.allowMouseThrough};b.prototype.MakeDefaultClickSound=function(){var a;a=Math.floor(3*Math.random()+1);return 1===a?window.D2LAdventureEngine.gu_SoundManager.play("SFX_softClick_a"):2===a?window.D2LAdventureEngine.gu_SoundManager.play("SFX_softClick_b"):3===a?window.D2LAdventureEngine.gu_SoundManager.play("SFX_softClick_c"):window.D2LAdventureEngine.gu_debugManager.log("ERROR!! "+this._id+" HandlePress rand SFX error")};b.prototype.MakeDraggable=function(){return this._options.draggable=
!0};b.prototype.MakeUndraggable=function(){return this._options.draggable=!1};b.prototype.DragStart=function(){var a;a={};if(this._options.draggable&&(this._dragging=!0,void 0!==this._options.events.onDragStart))return void 0!==this.comp_HandleDragStart&&this.comp_HandleDragStart(a),D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onDragStart",a)};b.prototype.DragStop=function(){var a;a={};if(this._options.draggable&&this._dragging&&(this.ChangeCursor(void 0,"drag"),this._dragging=!1,void 0!==
this._options.events.onDragEnd&&(a.compRefString="D2LAdventureEngine.gu_StateManager.findComponent('"+this._id+"')",a.compRef=this,a.interactionType="onDragEnd",a.data=this._options.onDragEndData,void 0!==this.comp_HandleDragEnd&&this.comp_HandleDragEnd(a),D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onDragEnd",a)),!this._isunder))return this.HandleMouseOut()};b.prototype.Show=function(){this._options.initHidden=!1;this._initialized&&(this.visible=!0,this._enabled&&D2LAdventureEngine.gu_ScreenReaderHelper.ShowReadText(this._id),
D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onShow"))};b.prototype.Hide=function(){this._options.initHidden=!0;if(this._initialized)return this.visible=!1,this.topGroup&&this.topGroup.hidden&&this.topGroup._HiddenMemory.push(this._id),D2LAdventureEngine.gu_ScreenReaderHelper.HideReadText(this._id),D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onHide")};b.prototype.EnableTabbing=function(){if(!this._options.tabEnabled)return this._options.tabEnabled=!0,D2LAdventureEngine.gu_TabManager.AssignAccessObject(this,
this._options.initTabPos)};b.prototype.DisableTabbing=function(){if(this._options.tabEnabled)return this._options.tabEnabled=!1,D2LAdventureEngine.gu_TabManager.UnassignAccessObject(this)};b.prototype.Enable=function(a){null==a&&(a={});if(!this._enabled)return this._enabled=!0,this._options.tabEnabled&&D2LAdventureEngine.gu_TabManager.AssignAccessObject(this,this._options.initTabPos),D2LAdventureEngine.gu_ScreenReaderHelper.HideReadText(this._id),D2LAdventureEngine.gu_EventManager.DispacthEvent(this,
"onEnable",a)};b.prototype.Disable=function(a){null==a&&(a={});if(this._enabled)return this._enabled=!1,this._options.tabEnabled&&D2LAdventureEngine.gu_TabManager.UnassignAccessObject(this),this.visible&&D2LAdventureEngine.gu_ScreenReaderHelper.HideReadText(this._id),D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onDisable",a)};b.prototype.Destroy=function(a){this.Disable();this.comp_destroy&&this.comp_destroy(a);this.removeAllTweens&&this.removeAllTweens();this.removeAllEventListeners();
D2LAdventureEngine.gu_EventManager.RemoveEventsByOwner(this,!0);this.removeAllChildren();D2LAdventureEngine.gu_ClippingRuleManager.RemoveRule(this);this.topGroup&&a&&a.constructor===D2LAdventureEngine.State&&this.topGroup.removeComponet(this._id);this.parent&&this.parent.removeChild&&this.parent.removeChild(this);this._defined=this._initialized=!1;this._globalPos=void 0;this._destroyed=!0;return D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onDestroy")};b.prototype.HandleMouseWheel=function(a){return this._initialized&&
this.ValidateWinOveride()&&this.CheckClipOnPoint(a.x,a.y)?(a.compRefString="D2LAdventureEngine.gu_StateManager.findComponent('"+this._id+"')",a.compRef=this,void 0!==this.assignedScrollParent&&void 0!==this.assignedScrollParent.HandleMouseWheel&&this.assignedScrollParent.HandleMouseWheel(a),0<a.wheelDelta?(a.data=this._options.onWheelUpData,a.interactionType="onWheelUp",void 0!==this.comp_HandleWheelUp&&this.comp_HandleWheelUp(a),D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onWheelUp",a)):
0>a.wheelDelta&&(a.data=this._options.onWheelDownData,a.interactionType="onWheelDown",void 0!==this.comp_HandleWheelDown&&this.comp_HandleWheelDown(a),D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onWheelDown",a)),this._options.allowMouseThrough):!1};b.prototype.focus=function(a){a=D2LAdventureEngine.gu_TabManager.GetAccessRefIndex(this._id);if(!1!==a)return D2LAdventureEngine.gu_TabManager._accessPos=a--,D2LAdventureEngine.gu_TabManager.HandleAccessReq()};b.prototype.blur=function(a){if(this._inTabFocus)return D2LAdventureEngine.gu_TabManager.HandleAccessReq()};
b.prototype.HandleFocus=function(a){null==a&&(a={});if(this._enabled&&this._options.tabEnabled&&this._initialized)return a.compRef=this,a.data=this._options.onFocusData,a.interactionType="onFocus",this._inTabFocus=!0,this._tabOutline&&this._tabOutline.Show(),void 0!==this.comp_HandleFocus&&this.comp_HandleFocus(a),D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onFocus",a),this.HandleMouseOver(a)};b.prototype.HandleUnfocus=function(a){null==a&&(a={});if(this._options.tabEnabled&&this._initialized)return a.compRef=
this,a.data=this._options.onUnfocusData,a.interactionType="onFocus",this._inTabFocus=!1,this._tabOutline&&this._tabOutline.Hide(),void 0!==this.comp_HandleUnfocus&&this.comp_HandleUnfocus(a),D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onUnfocus",a),this.HandleMouseOut(a)};b.prototype.HandleFocusActivation=function(a){if(this._enabled&&this._options.tabEnabled&&this._initialized&&this._options.interactive&&this._inTabFocus&&(this.HandlePress(a),void 0!==this.comp_HandleFocusActivation&&
this.comp_HandleFocusActivation(a),D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onFocusActivate",a),this._options.outOnClick))return this.HandleUnfocus(a)};b.prototype.HandleFocusDeactivation=function(a){if(this._options.tabEnabled&&this._initialized&&this._options.interactive&&a)return this.HandleMouseOver(a)};b.prototype.HandleAC_ReqStart=function(a){if(this._initialized&&this._options.interactive)return this.HandlePress(a)};b.prototype.HandleAC_ReqEnd=function(a){if(this._initialized&&
this._options.interactive)return this.HandleMouseUp(a)};b.prototype.getIndexPos=function(){return this.parent.getChildIndex(this)};b.prototype.getActiveTabParent=function(){return D2LAdventureEngine.gu_TabManager.GetAccessRefIndex(this._id)?this:this.topGroup&&this.topGroup.getActiveTabParent()?this.topGroup.getActiveTabParent():!1};b.prototype.FindValueWithString=function(a,b){var d,f,g,k,p,n;n=a.split(".");p=0;d=this;for(f="D2LAdventureEngine.gu_StateManager.GetStateRef("+this.assoiatedStateID+
").GetScene("+this.assoiatedSceneID+")["+this._id+"]";p<n.length;){try{k=eval(n[p])}catch(r){g=r,k=n[p]}if(void 0!==d[k])f=d.constructor===Array?f+("["+k+"]"):f+("."+k),d=d[k];else return window.D2LAdventureEngine.gu_debugManager.log("ERROR FindValueWithString failed to locate "+this._id+" at "+k),!1;p++}if(void 0===b)return d;try{return eval(f+" = "+b)}catch(r){return D2LAdventureEngine.gu_debugManager.log("ERROR FindValueWithString failed to set "+f+" to "+b+" -- "+g),!1}};b.prototype.inGroup=function(a){var b;
for(b=0;b<this.nestedInGroups.length;){if(a.constructor===String&&this.nestedInGroups[b]._id===a||a.constructor===D2LAdventureEngine.comp_Group&&this.nestedInGroups[b]._id===a._id)return!0;b++}return!1};b.prototype.isTypeOf=function(a){var b,d,f,g;g=this._inheritanceChain;d=0;for(f=g.length;d<f;d++)if(b=g[d],b===a)return!0;return!1};b.prototype.clone=function(a,b){var d;d=this.comp_RequestCloneSafeData?this.comp_RequestCloneSafeData(b):D2LAdventureEngine.gu_DataManager.cloneDataObj(this._options);
a&&(d=D2LAdventureEngine.gu_DataManager.mergeObjectData(d,a));return b?d:D2LAdventureEngine.gu_ComponentManager.BuildComponent(d,this.location)};return b}(createjs.Container)}).call(this);
