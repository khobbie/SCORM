(function(){var d=function(d,c){return function(){return d.apply(c,arguments)}},q=function(d,c){function a(){this.constructor=d}for(var b in c)x.call(c,b)&&(d[b]=c[b]);a.prototype=c.prototype;d.prototype=new a;d.__super__=c.prototype;return d},x={}.hasOwnProperty;window.D2LAdventureEngine.comp_Group=function(h){function c(a,b,l){this._id=a;this.location=b;this._options=l;this.comp_RequestCloneSafeData=d(this.comp_RequestCloneSafeData,this);this.HandleVerticalScrollReq=d(this.HandleVerticalScrollReq,
this);this.buildVerticalScroll=d(this.buildVerticalScroll,this);this.HandleHorizontalScrollReq=d(this.HandleHorizontalScrollReq,this);this.buildHorizontalScroll=d(this.buildHorizontalScroll,this);this.HandleScrollEvent=d(this.HandleScrollEvent,this);this.PreDetermineScrollBarDimentions=d(this.PreDetermineScrollBarDimentions,this);this.ResetScrollPos=d(this.ResetScrollPos,this);this.ejectAll=d(this.ejectAll,this);this.ejectComponet=d(this.ejectComponet,this);this.removeComponet=d(this.removeComponet,
this);this.AssignZIndex=d(this.AssignZIndex,this);this.comp_CheckClippingRules=d(this.comp_CheckClippingRules,this);this.addComponet=d(this.addComponet,this);this.checkDuplicate=d(this.checkDuplicate,this);this.mouseOverChild=d(this.mouseOverChild,this);this.comp_HandleWinScrollEvent=d(this.comp_HandleWinScrollEvent,this);this.comp_HandleResizeEvent=d(this.comp_HandleResizeEvent,this);this.comp_HandleWheelDown=d(this.comp_HandleWheelDown,this);this.comp_HandleWheelUp=d(this.comp_HandleWheelUp,this);
this.comp_HandleMouseUp=d(this.comp_HandleMouseUp,this);this.comp_HandleMouseUpOver=d(this.comp_HandleMouseUpOver,this);this.comp_HandleMouseMove=d(this.comp_HandleMouseMove,this);this.comp_HandleMouseMoveOver=d(this.comp_HandleMouseMoveOver,this);this.comp_HandleMouseOver=d(this.comp_HandleMouseOver,this);this.comp_HandleMouseOut=d(this.comp_HandleMouseOut,this);this.comp_CheckMouseOut=d(this.comp_CheckMouseOut,this);this.comp_HandlePress=d(this.comp_HandlePress,this);this.comp_Disable=d(this.comp_Disable,
this);this.comp_Enable=d(this.comp_Enable,this);this.getCompsByType=d(this.getCompsByType,this);this.getComponetByIndex=d(this.getComponetByIndex,this);this.getComponetById=d(this.getComponetById,this);this.addComponets=d(this.addComponets,this);this.ExpandToFit=d(this.ExpandToFit,this);this.DetermineDimentions=d(this.DetermineDimentions,this);this.ClearGroupContent=d(this.ClearGroupContent,this);this.comp_destroy=d(this.comp_destroy,this);this.getComponetsByPosition=d(this.getComponetsByPosition,
this);this.comp_isUnderCheck=d(this.comp_isUnderCheck,this);this.comp_SetAlpha=d(this.comp_SetAlpha,this);this.comp_Hide=d(this.comp_Hide,this);this.comp_Show=d(this.comp_Show,this);this.comp_SetInWinLockOverride=d(this.comp_SetInWinLockOverride,this);this.comp_Scale=d(this.comp_Scale,this);this.comp_Resize=d(this.comp_Resize,this);this.comp_Move=d(this.comp_Move,this);this.setOffsets=d(this.setOffsets,this);this.comp_Update=d(this.comp_Update,this);this.setChildrenTabbingOrder=d(this.setChildrenTabbingOrder,
this);this.setScrollAssignChildren=d(this.setScrollAssignChildren,this);this.buildMask=d(this.buildMask,this);this.setMaskShape=d(this.setMaskShape,this);this.setGroupOffset=d(this.setGroupOffset,this);this.adjustDimentionsForScroll=d(this.adjustDimentionsForScroll,this);this.comp_getHeight=d(this.comp_getHeight,this);this.comp_getWidth=d(this.comp_getWidth,this);this.comp_Init=d(this.comp_Init,this);this.comp_AssessDefaultOptions=d(this.comp_AssessDefaultOptions,this);this._options||(this._options=
{initContent:void 0,overflow:"auto",scrollBarOptions:void 0,forceChildClipping:void 0,forceContextParent:void 0,ContentDimentionOveride:void 0,useMobileMode:"auto"});this.MobileScrollData={down:!1};this.groupedComponets=[];this.gcContainer=new createjs.Container;this.gcContainerOffsetY=this.gcContainerOffsetX=0;this.textOffsets={x:0,y:0};this.Scrollable=!1;this.ScrollMode="none";this.scrollBarOffset=5;this._HiddenMemory=[];this._showingMask=this._MaskBuilt=!1;this._CompsToRecenter=[];this.findComponent=
this.getComponetById;this._options.interactive&&void 0===this._options.useCursor&&(this._options.useCursor="pointer");void 0===this._options.forceChildClipping&&(this._options.forceChildClipping=!1);c.__super__.constructor.call(this,this._id,this.location,this._options)}q(c,h);c.prototype.MobileScrollData=void 0;c.prototype.groupedComponets=void 0;c.prototype.gcContainer=void 0;c.prototype.gcContainerOffsetX=void 0;c.prototype.gcContainerOffsetY=void 0;c.prototype.interactionMask=void 0;c.prototype.textOffsets=
void 0;c.prototype.Scrollable=void 0;c.prototype.ScrollMode=void 0;c.prototype.scrollBarOffset=void 0;c.prototype._mobileMode=!1;c.prototype._CheckLoadList=void 0;c.prototype._loadCheckRequired=void 0;c.prototype._HiddenMemory=void 0;c.prototype._MaskBuilt=void 0;c.prototype._CompsToRecenter=void 0;c.prototype._showingMask=void 0;c.prototype.comp_AssessDefaultOptions=function(a){void 0===this._options.useMobileMode&&(this._options.useMobileMode="auto");this._postLoadReq=!0;this.scrollBarOffset=(this._mobileMode=
"auto"===this._options.useMobileMode?D2LAdventureEngine.gu_mobileDevice:this._options.useMobileMode?!0:!1)?5:20;this._CheckLoadList=[];void 0===this._options.initContent||a||this.addComponets(this._options.initContent,{inital:!0});void 0===this._options.overflow&&(this._options.overflow="auto");void 0===this._options.scrollBarOptions&&(this._options.scrollBarOptions={});return this._options.interactive=!0};c.prototype.comp_Init=function(){void 0===this._options.ContentDimentionOveride?this.DetermineDimentions():
void 0===this._options.ContentDimentionOveride.width||void 0===this._options.ContentDimentionOveride.height?(D2LAdventureEngine.gu_debugManager.log("WARNING: ContentDimentionOveride for "+this._id+" was missing values, using auto"),this.DetermineDimentions()):(this.width=this._options.ContentDimentionOveride.width,this.height=this._options.ContentDimentionOveride.height,this.gcContainer.width=this.width,this.gcContainer.height=this.height);this.addChild(this.gcContainer);this._initialized=!0;void 0!==
this.assignedScrollParent&&this.setScrollAssignChildren(this.assignedScrollParent);this.setChildrenTabbingOrder();this.adjustDimentionsForScroll();return this.buildMask()};c.prototype.comp_getWidth=function(){return this._options.initWidth?this._options.useAdaptiveWidth?this._options.initWidth>D2LAdventureEngine.gu_canDi.useWinInnerWidth?D2LAdventureEngine.gu_canDi.useWinInnerWidth:this._options.initWidth:this._options.initWidth:this._initialized?this.width:!1};c.prototype.comp_getHeight=function(){return this._options.initHeight?
this._options.initHeight:this._initialized?this.height:!1};c.prototype.adjustDimentionsForScroll=function(a,b){var c;null==a&&(a=!1);null==b&&(b=!1);!(this._mobileMode||a&&b)&&(c=this.scrollBarOffset,-1!==this._options.overflow.indexOf("scroll")||"auto"===this._options.overflow||(this._options.initHeight||this._options.initWidth)&&(this.height>this._options.initHeight||this.width>this._options.initWidth))&&("scroll-x"===this._options.overflow||void 0!==this._options.initWidth&&void 0===this._options.initHeight?
a||(this.height+=c,this.adjustDimentionsForScroll(!0,b)):"scroll-y"===this._options.overflow||void 0===this._options.initWidth&&void 0!==this._options.initHeight?b||(this.width+=c,this.adjustDimentionsForScroll(a,!0)):(this.width>this._options.initWidth&&(this.height+=c),this.height>this._options.initHeight&&(this.width+=c)))};c.prototype.setGroupOffset=function(){var a,b,c,e,f;e=this.groupedComponets;f=[];b=0;for(c=e.length;b<c;b++)a=e[b],a._groupOffset.x=this.gcContainerOffsetX+this._groupOffset.x,
a._groupOffset.y=this.gcContainerOffsetY+this._groupOffset.y,a.setGroupOffset?f.push(a.setGroupOffset()):f.push(void 0);return f};c.prototype.setMaskShape=function(){var a,b,c,e;b=this._options.initWidth?this._options.initWidth:this.width;if("Vertical"===this.ScrollMode||"Both"===this.ScrollMode)b-=this.scrollBarOffset;a=this._options.initHeight?this._options.initHeight:this.height;if("Horizontal"===this.ScrollMode||"Both"===this.ScrollMode)a-=this.scrollBarOffset;this._showingMask&&this.removeChild(this.gcContainer.mask);
this.gcContainer.mask=void 0;c=new createjs.Graphics;c.beginFill("rgba(255,0,0,.3)");c.rect(0,0,b,a);c.endFill();this.gcContainer.mask=new createjs.Shape(c);this.gcContainer.mask.setBounds(0,0,b,a);this.gcContainer.hitArea=this.gcContainer.mask;this.setGroupOffset();D2LAdventureEngine.gu_ClippingRuleManager.SetRule({x:this._globalPos.x,y:this._globalPos.y,width:b-(this._groupOffset.x|0),height:a-(this._groupOffset.y|0)},this);e=this.groupedComponets;b=0;for(c=e.length;b<c;b++)a=e[b],a.AssessGlobalPos(),
a.setMaskShape?a.setMaskShape():D2LAdventureEngine.gu_ClippingRuleManager.SetRule({x:a._globalPos.x,y:a._globalPos.y,width:a.getWidth(),height:a.getHeight()},a);if(this._showingMask)return this.addChild(this.gcContainer.mask)};c.prototype.buildMask=function(a){var b,c,e;if("hidden"===this._options.overflow||void 0===this._options.initWidth&&void 0===this._options.initHeight)this.ScrollMode="None",this.setMaskShape();else if(void 0!==this._options.initWidth||void 0!==this._options.initHeight){c=this.getWidth();
b=this.getHeight();a=this.width>this._options.initWidth;e=this.height>this._options.initHeight;"scroll-x"===this._options.overflow?this.ScrollMode="Horizontal":"auto"===this._options.overflow&&a&&!e?this.ScrollMode="Horizontal":"x-auto"===this._options.overflow&&a?this.ScrollMode="Horizontal":"scroll-y"===this._options.overflow?this.ScrollMode="Vertical":"auto"===this._options.overflow&&!a&&e?this.ScrollMode="Vertical":"y-auto"===this._options.overflow&&e?this.ScrollMode="Vertical":"scroll"===this._options.overflow||
"scroll-both"===this._options.overflow||"auto"===this._options.overflow&&a&&e?this.ScrollMode="Both":"auto"!==this._options.overflow||a||e||(this.ScrollMode="None");if("Horizontal"===this.ScrollMode||"Both"===this.ScrollMode)b-=this.scrollBarOffset;if("Vertical"===this.ScrollMode||"Both"===this.ScrollMode)b-=this.scrollBarOffset;if("Horizontal"===this.ScrollMode||"Both"===this.ScrollMode)this.setMaskShape(),this.buildHorizontalScroll();if("Vertical"===this.ScrollMode||"Both"===this.ScrollMode)this.setMaskShape(),
this.buildVerticalScroll();"None"===this.ScrollMode&&this.setMaskShape();"Both"!==this.ScrollMode||this._mobileMode||(a=new createjs.Graphics,a.beginFill("#B8B8B8"),a.rect(this._options.initWidth-this.scrollBarOffset,this._options.initHeight-this.scrollBarOffset,this.scrollBarOffset,this.scrollBarOffset),this.scrollCornerNode=new createjs.Shape(a),this.addChild(this.scrollCornerNode));"None"!==this.ScrollMode&&"none"!==this.ScrollMode&&this.setScrollAssignChildren();void 0!==this._options.initWidth&&
(c=this._options.initWidth,"Both"===this.ScrollMode&&(c-=this.scrollBarOffset));void 0!==this._options.initHeight&&(b=this._options.initHeight,"Both"===this.ScrollMode&&(b-=this.scrollBarOffset))}void 0===c&&(c=this.getWidth());void 0===b&&(b=this.getHeight());this.interactionMask=D2LAdventureEngine.gu_ComponentManager.BuildComponent({ID:this._id+"interactionMask",Type:"Shape - Rectangle",color:"#000000",initAlpha:.01,tabEnabled:!1,interactive:!0,rect:{x:0,y:0,width:c,height:b}},this.location);this.interactionMask.assignedScrollParent=
this;this.getComponetById(this.interactionMask._id)||this.addChild(this.interactionMask);this._MaskBuilt=!0};c.prototype.setScrollAssignChildren=function(a){var b,c;this.Scrollable=!0;void 0===a&&(a=this);b=0;for(c=[];b<this.groupedComponets.length;)void 0!==this.groupedComponets[b]&&(this.groupedComponets[b].assignedScrollParent=a,this.groupedComponets[b]._options.interactive=!0,this.groupedComponets[b].isTypeOf(D2LAdventureEngine.comp_Group)&&!this.groupedComponets[b].Scrollable&&(this.groupedComponets[b].setScrollAssignChildren(a),
this.groupedComponets[b]._options.interactive=!0)),c.push(b++);return c};c.prototype.setChildrenTabbingOrder=function(){var a,b;for(a=0;a<=this.groupedComponets.length-1;)b=this.groupedComponets[a],void 0!==b._options.initTabPos&&b._accessInitialized&&D2LAdventureEngine.gu_TabManager.ChangeTabbingPostion(b._id,b._options.initTabPos),a++};c.prototype.comp_Update=function(a){var b,c;if(this._initialized)for(void 0!==this._vertScroll&&this._vertScroll.Update(a),void 0!==this._horzScroll&&this._horzScroll.Update(a),
void 0!==this.interactionMask&&this.interactionMask.Update&&this.interactionMask.Update(a),b=0;b<this.groupedComponets.length;)void 0!==this.groupedComponets[b]&&void 0!==this.groupedComponets[b].Update&&this.groupedComponets[b].Update(a),b++;else if(this._postLoadReq||this._loadCheckRequired){this._loadCheckRequired=!1;for(c=b=0;b<this._CheckLoadList.length;)this._CheckLoadList[b]._initialized?c++:this._CheckLoadList[b].Update(a),b++;c===this._CheckLoadList.length&&(this._initialized?this.DetermineDimentions():
this.PostLoadInit())}if(this._MaskBuilt&&0!==this._CompsToRecenter.length){for(a=0;a<this._CompsToRecenter.length;)b=this.getComponetById(this._CompsToRecenter[a]),b.textOffsets={x:this.textOffsets.x+this.x,y:this.textOffsets.y+this.y},b.Move(b.x,b.y,{useGroupedTextOffsets:!0}),a++;return this._CompsToRecenter=[]}};c.prototype.setOffsets=function(){var a,b,c,e;e=this.groupedComponets;b=0;for(c=e.length;b<c;b++)a=e[b],this.textOffsets&&(a.textOffsets=void 0!==this.x&&void 0!==this.y?{x:this.textOffsets.x+
this.x,y:this.textOffsets.y+this.y}:{x:this.textOffsets.x,y:this.textOffsets.y},a.setOffsets&&a.setOffsets())};c.prototype.comp_Move=function(a,b){var c,e,f;c=0;for(e=[];c<this.groupedComponets.length;)f=this.groupedComponets[c],f.constructor===D2LAdventureEngine.comp_Text?(this.setOffsets(),f.Move(f.x+a.postionDiffence.x,f.y+a.postionDiffence.y,b)):(D2LAdventureEngine.gu_ClippingRuleManager.isCompRuleOwner(f)&&!b.ignoreClipCheck&&(f.AssessGlobalPos(),D2LAdventureEngine.gu_ClippingRuleManager.SetRule({x:f._globalPos.x,
y:f._globalPos.y,width:f.getWidth()-(this._groupOffset.x|0),height:f.getHeight()-(this._groupOffset.y|0)},f)),f.isTypeOf(D2LAdventureEngine.comp_Group)&&(f.comp_Move(a,b),this.setOffsets())),e.push(c++);return e};c.prototype.comp_Resize=function(a,b,c,e){this._options.initWidth=a;this._options.initHeight=b;if(this._initialized)return void 0!==this._vertScroll&&this._vertScroll.Destroy(),void 0!==this._horzScroll&&this._horzScroll.Destroy(),void 0!==this.interactionMask&&this.interactionMask.Destroy&&
this.interactionMask.Destroy(),void 0!==c&&(void 0!==c.width&&void 0!==c.height?this._options.ContentDimentionOveride=c:D2LAdventureEngine.gu_debugManager.log("WARNING: ContentDimentionOveride for "+this._id+" in comp_Resize was missing values, ingnoring value")),void 0===this._options.ContentDimentionOveride?this.DetermineDimentions():void 0===this._options.ContentDimentionOveride.width||void 0===this._options.ContentDimentionOveride.height?(D2LAdventureEngine.gu_debugManager.log("WARNING: ContentDimentionOveride for "+
this._id+" was missing values, using auto"),this.DetermineDimentions()):(this.width=this._options.ContentDimentionOveride.width,this.height=this._options.ContentDimentionOveride.height,this.gcContainer.width=this.width,this.gcContainer.height=this.height),this.buildMask()};c.prototype.comp_Scale=function(a){var b,c;for(b=0;b<this.groupedComponets.length;)c=this.groupedComponets[b],c.constructor===D2LAdventureEngine.comp_Text?c.Scale(a):c.constructor===D2LAdventureEngine.comp_Group&&c.comp_Scale(a),
b++};c.prototype.comp_SetInWinLockOverride=function(a){var b;for(b=0;b<this.groupedComponets.length;)this.groupedComponets[b].SetInWinLockOverride(a),b++};c.prototype.comp_Show=function(a){void 0!==this._vertScroll&&this._vertScroll.Show(a);void 0!==this._horzScroll&&this._horzScroll.Show(a);for(a=0;a<this._HiddenMemory.length;)void 0!==this._HiddenMemory[a]&&this.getComponetById(this._HiddenMemory[a])&&this.getComponetById(this._HiddenMemory[a]).Show(),a++;return this._HiddenMemory=[]};c.prototype.comp_Hide=
function(a){var b,c;void 0!==this._vertScroll&&this._vertScroll.Hide(a);void 0!==this._horzScroll&&this._horzScroll.Hide(a);b=0;for(c=[];b<this.groupedComponets.length;)void 0!==this.groupedComponets[b]&&(this.groupedComponets[b]._id&&this.groupedComponets[b].visible&&this._HiddenMemory.push(this.groupedComponets[b]._id),void 0!==this.groupedComponets[b].Hide?this.groupedComponets[b].Hide(a):this.groupedComponets[b].visible=!1),c.push(b++);return c};c.prototype.comp_SetAlpha=function(a,b){var c;for(c=
0;c<this.groupedComponets.length;)this.groupedComponets[c].SetAlpha(a,b),c++};c.prototype.comp_isUnderCheck=function(a,b){a=a*D2LAdventureEngine.gu_canDi.inverseScaleFactor-this.textOffsets.x;b=b*D2LAdventureEngine.gu_canDi.inverseScaleFactor-this.textOffsets.y;if(!this._initialized||a<this.x||b<this.y)return!1;if(void 0!==this._options.initWidth){if(a>this.x+this._options.initWidth)return!1}else if(void 0!==this.width&&a>this.x+this.width)return!1;if(void 0!==this._options.initHeight){if(b>this.y+
this._options.initHeight)return!1}else if(void 0!==this.height&&b>this.y+this.height)return!1;return!0};c.prototype.getComponetsByPosition=function(a){var b,c;c=[];for(b=0;b<this.groupedComponets.length;)void 0!==this.groupedComponets[b]&&void 0!==this.groupedComponets[b].isUnderCheck&&this.groupedComponets[b].isUnderCheck(a)&&(void 0!==this.groupedComponets[b].getComponetsByPosition&&c.concat(this.groupedComponets[b].getComponetsByPosition(a)),c.push(this.groupedComponets[b])),b++;return c};c.prototype.comp_destroy=
function(a){void 0!==this._vertScroll&&this._vertScroll.Destroy(a);void 0!==this._horzScroll&&this._horzScroll.Destroy(a);void 0!==this.interactionMask&&this.interactionMask.Destroy&&this.interactionMask.Destroy(a);return this.ClearGroupContent(!0)};c.prototype.ClearGroupContent=function(a){var b;for(b=0;b<this.groupedComponets.length;)void 0!==this.groupedComponets[b].Destroy&&(this.gcContainer.removeChild(this.groupedComponets[b]),this.groupedComponets[b].Destroy()),b++;this.groupedComponets=[];
this._options.initContent=[];if(!a)return this.DetermineDimentions()};c.prototype.DetermineDimentions=function(){var a,b,c,e,f;f=[];e=[];this.AssessGlobalPos();if(0!==this.groupedComponets.length){for(c=0;c<this.groupedComponets.length;)this.groupedComponets[c]._initialized?this.groupedComponets[c].constructor!==D2LAdventureEngine.comp_Text?void 0!==this.groupedComponets[c].x&&void 0!==this.groupedComponets[c].y&&(f.push(this.groupedComponets[c].x+this.groupedComponets[c].getWidth()),e.push(this.groupedComponets[c].y+
this.groupedComponets[c].getHeight())):(this.groupedComponets[c].AssessGlobalPos(),a=this.groupedComponets[c].x-this._globalPos.x,b=this.groupedComponets[c].y-this._globalPos.y,f.push(a+this.groupedComponets[c].getWidth()),e.push(b+this.groupedComponets[c].getHeight())):(void 0===this.groupedComponets[c].BaseOptionsData&&(this.groupedComponets[c].Update(),void 0===this.groupedComponets[c].BaseOptionsData&&D2LAdventureEngine.gu_debugManager.log("WARNING! group "+this._id+" has attemted to read base data of "+
this.groupedComponets[c]._id+" prior to definition, this will be ignored.")),this.groupedComponets[c].BaseOptionsData&&!1!==this.groupedComponets[c].getWidth()&&!1!==this.groupedComponets[c].getHeight()&&(f.push((this.groupedComponets[c].BaseOptionsData.initX|0)+this.groupedComponets[c].getWidth()),e.push((this.groupedComponets[c].BaseOptionsData.initY|0)+this.groupedComponets[c].getHeight()))),c++;this.width=Math.max.apply(Math,f);this.height=Math.max.apply(Math,e);(isNaN(this.width)||isNaN(this.height))&&
D2LAdventureEngine.gu_debugManager.log("WARNING! group "+this._id+" has NaN values in DetermineDimentions ")}else this.height=this.width=0;this.gcContainer.width=this.width;this.gcContainer.height=this.height;return this.setMaskShape()};c.prototype.ExpandToFit=function(a){return"width"===a||"x"===a?this.Resize(this.gcContainer.width,this.getHeight()):"height"===a||"y"===a?this.Resize(this.getWidth(),this.gcContainer.height):this.Resize(this.gcContainer.width,this.gcContainer.height)};c.prototype.addComponets=
function(a,b){var c;if(a.constructor===Array)for(c=0;c<a.length;)this.addComponet(a[c],b),c++;else D2LAdventureEngine.gu_debugManager.log("WARNING: addComponets requires Array, ignoring request")};c.prototype.getComponetById=function(a){var b;if(this._initialized){if(this._vertScroll&&this._vertScroll.getComponetById(a))return this._vertScroll.getComponetById(a);if(this._horzScroll&&this._horzScroll.getComponetById(a))return this._horzScroll.getComponetById(a);if(this.interactionMask&&a===this.interactionMask._id)return this.interactionMask;
for(b=0;b<this.groupedComponets.length;){if(this.groupedComponets[b]._id===a&&!this.groupedComponets[b]._destroyed)return this.groupedComponets[b];if(this.groupedComponets[b].getComponetById&&!1!==this.groupedComponets[b].getComponetById(a))return this.groupedComponets[b].getComponetById(a);b++}}else if(this._options.initContent)for(b=0;b<this._options.initContent.length;){if(this._options.initContent[b]._id===a)return this._options.initContent[b];if(this._options.initContent[b].getComponetById&&
!1!==this._options.initContent[b].getComponetById(a))return this._options.initContent[b].getComponetById(a);b++}return!1};c.prototype.getComponetByIndex=function(a){return this._initialized?this.groupedComponets[a]:this._options.initContent[a]};c.prototype.getCompsByType=function(a){var b,c,e;e=[];for(b=0;b<this.groupedComponets.length;)c=this.groupedComponets[b],void 0!==c._options&&(c._options.Type===a&&e.push(c),void 0!==c.getCompsByType&&(c=c.getCompsByType(a))&&(e=e.concat(c))),b++;return 0!==
e.length?e:!1};c.prototype.comp_Enable=function(a){var b;void 0!==this._vertScroll&&this._vertScroll.Enable(a);void 0!==this._horzScroll&&this._horzScroll.Enable(a);a=0;for(b=[];a<this.groupedComponets.length;)void 0!==this.groupedComponets[a].Enable&&this.groupedComponets[a].Enable(),b.push(a++);return b};c.prototype.comp_Disable=function(a){var b;void 0!==this._vertScroll&&this._vertScroll.Disable(a);void 0!==this._horzScroll&&this._horzScroll.Disable(a);a=0;for(b=[];a<this.groupedComponets.length;)void 0!==
this.groupedComponets[a].Disable&&this.groupedComponets[a].Disable(),b.push(a++);return b};c.prototype.comp_HandlePress=function(a){if(this._mobileMode&&(this.MobileScrollData={down:!0,x:a.x,y:a.y},"None"===this.ScrollMode&&this.assignedScrollParent))return this.assignedScrollParent.HandlePress(a)};c.prototype.comp_CheckMouseOut=function(a){var b,c,e,f,g;this._mobileMode||(void 0!==this._vertScroll&&this._vertScroll.CheckMouseOut(a),void 0!==this._horzScroll&&this._horzScroll.CheckMouseOut(a));f=
this.groupedComponets;g=[];c=0;for(e=f.length;c<e;c++)b=f[c],b.CheckMouseOut?g.push(b.CheckMouseOut(a)):g.push(void 0);return g};c.prototype.comp_HandleMouseOut=function(a){this._mobileMode?this.MobileScrollData={down:!1}:(void 0!==this._vertScroll&&this._vertScroll.HandleMouseOut(a),void 0!==this._horzScroll&&this._horzScroll.HandleMouseOut(a));if(void 0!==this.interactionMask&&this.interactionMask.HandleMouseOut)return this.interactionMask._MouseOver=!1};c.prototype.comp_HandleMouseOver=function(a){void 0!==
this._vertScroll&&this._vertScroll.HandleMouseOver(a);if(void 0!==this._horzScroll)return this._horzScroll.HandleMouseOver(a)};c.prototype.comp_HandleMouseMoveOver=function(a){if(this._mobileMode&&this._isunder&&a.mPos&&(this.MobileScrollData.down||(this.MobileScrollData={down:!0,x:a.mPos.x,y:a.mPos.y}),"None"!==this.ScrollMode||!this._mobileMode||!this.assignedScrollParent))return"Horizontal"!==this.ScrollMode&&"Both"!==this.ScrollMode||a.mPos.x===this.MobileScrollData.x||this._horzScroll.PushToPos(this._horzScroll._pos-
.01*(a.mPos.x-this.MobileScrollData.x)),"Vertical"!==this.ScrollMode&&"Both"!==this.ScrollMode||a.mPos.y===this.MobileScrollData.y||this._vertScroll.PushToPos(this._vertScroll._pos-.01*(a.mPos.y-this.MobileScrollData.y)),this.MobileScrollData.x=a.mPos.x,this.MobileScrollData.y=a.mPos.y};c.prototype.comp_HandleMouseMove=function(a){var b,c;b=0;for(c=[];b<this.groupedComponets.length;)void 0!==this.groupedComponets[b].HandleMouseMove&&this.groupedComponets[b].HandleMouseMove(a),c.push(b++);return c};
c.prototype.comp_HandleMouseUpOver=function(a){this._mobileMode?this.MobileScrollData={down:!1}:(void 0!==this._vertScroll&&this._vertScroll.HandleMouseUp(a),void 0!==this._horzScroll&&this._horzScroll.HandleMouseUp(a));return a.bypassScrollParentCall=!0};c.prototype.comp_HandleMouseUp=function(a){var b,c;b=0;for(c=[];b<this.groupedComponets.length;)void 0!==this.groupedComponets[b].HandleMouseUp&&this.groupedComponets[b].HandleMouseUp(a),c.push(b++);return c};c.prototype.comp_HandleWheelUp=function(a){void 0!==
this._vertScroll?this._vertScroll.MoveInDir("up"):void 0!==this._horzScroll&&this._horzScroll.MoveInDir("right")};c.prototype.comp_HandleWheelDown=function(a){void 0!==this._vertScroll?this._vertScroll.MoveInDir("down"):void 0!==this._horzScroll&&this._horzScroll.MoveInDir("left")};c.prototype.comp_HandleResizeEvent=function(a){var b;for(b=0;b<this.groupedComponets.length;)void 0!==this.groupedComponets[b].HandleResizeEvent&&this.groupedComponets[b].HandleResizeEvent(a),b++};c.prototype.comp_HandleWinScrollEvent=
function(a){var b;for(b=0;b<this.groupedComponets.length;)void 0!==this.groupedComponets[b].HandleWinScroll&&this.groupedComponets[b].HandleWinScroll(a),b++};c.prototype.mouseOverChild=function(a){var b;if(void 0!==this._vertScroll&&this._vertScroll._MouseOver||void 0!==this._horzScroll&&this._horzScroll._MouseOver||void 0!==this.interactionMask&&this.interactionMask.isUnderCheck(a))return!0;for(b=0;b<this.groupedComponets.length;){if((this.groupedComponets[b]._MouseOver||void 0!==this.groupedComponets[b].mouseOverChild&&
this.groupedComponets[b].mouseOverChild(a))&&this.groupedComponets[b].isUnderCheck(a))return!0;b++}return!1};c.prototype.checkDuplicate=function(a,b){var c;for(c=0;c<this.groupedComponets.length;){if(this.groupedComponets[c]._id===a.ID||this.groupedComponets[c]._id===a._id)if(!b||b&&!this.groupedComponets[c]._destroyed)return!0;c++}return!1};c.prototype.addComponet=function(a,b){var c;void 0===b&&(b={});a.constructor===Object&&(a=D2LAdventureEngine.gu_ComponentManager.BuildComponent(a,this.location));
this.setGroupOffset();if(this.checkDuplicate(a,!0))return b.ingoreDupeWarn||D2LAdventureEngine.gu_debugManager.log("Error, attempt to add duplicate comp "+a._id+" to group "+this._id+" request rejected"),!1;void 0!==a.parent&&null!==a.parent&&a.parent.removeChild(a);this.Scrollable&&(a.assignedScrollParent=this);a.nestedInGroups=[];for(c=0;c<this.nestedInGroups.length;)a.nestedInGroups.push(this.nestedInGroups[c]),c++;a.nestedInGroups.push(this);a.topGroup=a.nestedInGroups[a.nestedInGroups.length-
1];this._options.forceContextParent&&(a._options.useContextParent=this._options.forceContextParent);this.getActiveTabParent()&&void 0===a._options.initTabPos&&(a._options.initTabPos="after "+this._id);this._options.useContextOptions&&(a._options.useContextOptions=void 0===a._options.useContextOptions?this._options.useContextOptions:D2LAdventureEngine.gu_DataManager.mergeObjectData(this._options.useContextOptions,a._options.useContextOptions));a.isTypeOf&&a.isTypeOf(D2LAdventureEngine.comp_Group)?
("center"!==this._options.initX&&"center"!==this._options.initY?a.textOffsets={x:this.textOffsets.x+this._options.initX,y:this.textOffsets.y+this._options.initY}:(this._CompsToRecenter.push(a._id),a.textOffsets={x:0,y:0}),this._options.forceContextParent&&(a._options.forceContextParent=this._options.forceContextParent)):a.constructor===D2LAdventureEngine.comp_Text&&(a._options.baseDataOveride=a.clone(void 0,!0),a._options.initX+=this.x+this.textOffsets.x,a._options.initY+=this.y+this.textOffsets.y,
void 0===a._options.interactive&&this._options.interactive&&(a._options.interactive=!0));this._options.InWinLockOverride&&(a._options.InWinLockOverride=!0);void 0!==a._options&&!1!==this._options.useContext&&void 0!==a._options.useContext&&a._options.useContext.constructor!==String&&(a._options.useContext=this._options.useContext);if(this.hidden||this._options.initHidden)a._initialized?(a.visible&&this._HiddenMemory.push(a._id),a.Hide()):(a._options.initHidden||this._HiddenMemory.push(a._id),a._options.initHidden=
!0);void 0===a._options.interactive&&(a._options.interactive=this._options.interactive);"front"===b.addAt||void 0===b.addAt?this.gcContainer.addChild(a):"back"===b.addAt?this.gcContainer.addChildAt(a,0):this.gcContainer.addChildAt(a,b.addAt);this.groupedComponets.push(a);void 0!==a.Update&&a.Update();!b.inital||!b.inital&&!a._initialized&&a._postLoadReq?(this._horzScroll&&(this.gcContainerOffsetX=0,this._horzScroll.PushToPos(0)),this._vertScroll&&(this.gcContainerOffsetY=0,this._vertScroll.PushToPos(0)),
this.DetermineDimentions(),this._initialized&&!this.Scrollable&&this.buildMask()):a._postLoadReq&&(this._loadCheckRequired=!0,this._CheckLoadList.push(a));return a};c.prototype.comp_CheckClippingRules=function(){var a,b;a=0;for(b=[];a<this.groupedComponets.length;)this._options.forceChildClipping?(this.groupedComponets[a].tabulatedClippingStatus=this.tabulatedClippingStatus,this.groupedComponets[a].tabulatedClippingRule=this.tabulatedClippingRule):D2LAdventureEngine.gu_ClippingRuleManager.CheckClippingRules(this.groupedComponets[a]),
b.push(a++);return b};c.prototype.AssignZIndex=function(a,b,c){var e,f;if(void 0!==c)for(e=0;e<Object.keys(this).length;)Object.keys(this)[e]===c&&(c=Object.keys(this)[e]),e++;e=this.gcContainer.getChildIndex(a);f=this.gcContainer.getChildIndex(this.getComponetById(c));switch(b){case "top":this.gcContainer.setChildIndex(a,this.groupedComponets.length-1);break;case "bottom":this.gcContainer.setChildIndex(a,0);this.gcContainer.setChildIndex(a,0);break;case "up":this.gcContainer.setChildIndex(a,e+1);
break;case "down":0<e&&this.gcContainer.setChildIndex(this.getChildAt(e-1),e);break;case "above":void 0!==c?e<f?(this.gcContainer.setChildIndex(a,f),this.gcContainer.setChildIndex(a,f)):(this.gcContainer.setChildIndex(a,f+1),this.gcContainer.setChildIndex(a,f+1)):D2LAdventureEngine.gu_debugManager.log("ERROR!: AssignZIndex calling 'above' with no set Reference");break;case "below":void 0!==c?e>f?(this.gcContainer.setChildIndex(a,f),this.gcContainer.setChildIndex(a,f)):(this.gcContainer.setChildIndex(a,
f-1),this.gcContainer.setChildIndex(a,f-1)):D2LAdventureEngine.gu_debugManager.log("ERROR!: AssignZIndex calling 'below' with no set Reference");break;default:D2LAdventureEngine.gu_debugManager.log("ERROR!: AssignZIndex call effect "+b+" not recognized")}for(a=0;a<this.groupedComponets.length;)this.groupedComponets[a]._options.zPos=this.gcContainer.getChildIndex(this.groupedComponets[a])+1,a++;this.groupedComponets.sort(function(a,b){return a._options.zPos<b._options.zPos?-1:a._options.zPos>b._options.zPos?
1:0});return this.groupedComponets};c.prototype.removeComponet=function(a,b){var c;void 0===b&&(b=!1);for(c=0;c<this.groupedComponets.length;){if(this.groupedComponets[c].ID===a||this.groupedComponets[c]._id===a)return b||this.groupedComponets[c].Destroy(),this.gcContainer.removeChild(this.groupedComponets[c]),this.groupedComponets.splice(c,1),b||(this.DetermineDimentions(),this._initialized&&!this.Scrollable&&this.buildMask()),!0;c++}};c.prototype.ejectComponet=function(a){var b;for(b=0;b<this.groupedComponets.length;){if(this.groupedComponets[b].ID===
a||this.groupedComponets[b]._id===a){this.groupedComponets[b].assignedScrollParent=void 0;this.gcContainer.removeChild(this.groupedComponets[b]);this.parent.addChild(this.groupedComponets[b]);this.parent.Scrollable&&(this.groupedComponets[b].assignedScrollParent=this.parent);for(a=0;a<this.groupedComponets[b].nestedInGroups.length;)this.groupedComponets[b].nestedInGroups[a]._id===this._id&&this.groupedComponets[b].nestedInGroups.splice(a,1),a++;this.groupedComponets.splice(b,1);this.groupedComponets[b].topGroup=
this.groupedComponets[b].nestedInGroups[this.groupedComponets[b].nestedInGroups.length-1];return!0}b++}};c.prototype.ejectAll=function(){var a,b;for(a=0;a<this.groupedComponets.length;){this.groupedComponets[a].assignedScrollParent=void 0;this.gcContainer.removeChild(this.groupedComponets[a]);this.parent.addChild(this.groupedComponets[a]);this.parent.Scrollable&&(this.groupedComponets[a].assignedScrollParent=this.parent);for(b=0;b<this.groupedComponets[a].nestedInGroups.length;)this.groupedComponets[a].nestedInGroups[b]._id===
this._id&&this.groupedComponets[a].nestedInGroups.splice(b,1),b++;this.groupedComponets[a].topGroup=this.groupedComponets[a].nestedInGroups[this.groupedComponets[a].nestedInGroups.length-1];a++}return this.groupedComponets=[]};c.prototype.ResetScrollPos=function(){this.HandleHorizontalScrollReq({pos:0});this.HandleVerticalScrollReq({pos:0});this.gcContainerOffsetY=this.gcContainerOffsetX=0;this._horzScroll&&this._horzScroll.PushToPos(0);if(this._vertScroll)return this._vertScroll.PushToPos(0)};c.prototype.PreDetermineScrollBarDimentions=
function(){return new D2LAdventureEngine.comp_ScrollBar(this._id+"_tScroll",this.location,this._options.scrollBarOptions)};c.prototype.HandleScrollEvent=function(){return D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onscroll",this._pos)};c.prototype.buildHorizontalScroll=function(){var a;a=D2LAdventureEngine.gu_DataManager.mergeObjectData({ID:this._id+"_horzScroll",Horizontal:!0,initWidth:this._options.initWidth?"Both"===this.ScrollMode?this._options.initWidth-this.scrollBarOffset:this._options.initWidth:
this.width,initPos:.5,initY:(this._options.initHeight?this._options.initHeight:this.height)-this.scrollBarOffset,InWinLockOverride:this._options.InWinLockOverride,onChange:this.HandleHorizontalScrollReq,initTabPos:this._options.initTabPos},this._options.scrollBarOptions);this._horzScroll=new D2LAdventureEngine.comp_ScrollBar(this._id+"_horzScroll",this.location,a);this.addChild(this._horzScroll);this._options.interactive=!0;this.Update();return this._horzScroll.PushToPos(0)};c.prototype.HandleHorizontalScrollReq=
function(a){var b;b=-((this.width-this._options.initWidth)*a.pos);for(a=0;a<this.groupedComponets.length;)this.groupedComponets[a].Move(this.groupedComponets[a]._options.initX+(b-this.gcContainerOffsetX),this.groupedComponets[a]._options.initY),a++;this.gcContainerOffsetX=b;this.setGroupOffset();this.setMaskShape();return this.HandleScrollEvent()};c.prototype.buildVerticalScroll=function(){var a,b;b=this._options.initWidth?this._options.initWidth:this.width;a=this._options.initHeight?"Both"===this.ScrollMode?
this._options.initHeight-this.scrollBarOffset:this._options.initHeight:this.height;this._vertScroll&&this._vertScroll._id===this._id+"_vertScroll"&&(this._vertScroll.Destroy(),this._vertScroll.Update());a=D2LAdventureEngine.gu_DataManager.mergeObjectData({ID:this._id+"_vertScroll",initHeight:a,initX:b-this.scrollBarOffset,initPos:.5,InWinLockOverride:this._options.InWinLockOverride,onChange:this.HandleVerticalScrollReq,initTabPos:this._options.initTabPos},this._options.scrollBarOptions);this._vertScroll=
new D2LAdventureEngine.comp_ScrollBar(this._id+"_vertScroll",this.location,a);this.addChild(this._vertScroll);this._options.interactive=!0;this.Update();return this._vertScroll.PushToPos(0)};c.prototype.HandleVerticalScrollReq=function(a){var b,c,e,f;b=-((this.height-this._options.initHeight)*a.pos);f=this.groupedComponets;c=0;for(e=f.length;c<e;c++)a=f[c],a.Move(a._options.initX,a._options.initY+(b-this.gcContainerOffsetY));this.gcContainerOffsetY=b;this.setGroupOffset();this.setGroupOffset();this.setMaskShape();
return this.HandleScrollEvent()};c.prototype.comp_RequestCloneSafeData=function(a){var b,c;a={};c=Object.keys(this._options);for(b=0;b<c.length;)"initContentData"!==c[b]&&"initContent"!==c[b]&&(a[c[b]]=D2LAdventureEngine.gu_DataManager.cloneDataObj(this._options[c[b]])),b++;c=[];for(b=0;b<this.groupedComponets.length;)c.push(this.groupedComponets[b].clone(void 0,!0)),b++;a.initContentData=c;return a};return c}(D2LAdventureEngine.component);window.D2LAdventureEngine.comp_ScrollBar=function(h){function c(a,
b,l){this._id=a;this.location=b;this._options=l;this.calcPos=d(this.calcPos,this);this.MoveInDir=d(this.MoveInDir,this);this.PushToPos=d(this.PushToPos,this);this.TriggerChangeEvent=d(this.TriggerChangeEvent,this);this.comp_Disable=d(this.comp_Disable,this);this.comp_Enable=d(this.comp_Enable,this);this.comp_HandleMouseUp=d(this.comp_HandleMouseUp,this);this.HandleNodeWhileDrag=d(this.HandleNodeWhileDrag,this);this.comp_HandleMouseMove=d(this.comp_HandleMouseMove,this);this.comp_Update=d(this.comp_Update,
this);this.HandleBarClickVertical=d(this.HandleBarClickVertical,this);this.BuildVerticalBar=d(this.BuildVerticalBar,this);this.HandleBarClickHorizontal=d(this.HandleBarClickHorizontal,this);this.BuildHorizontalBar=d(this.BuildHorizontalBar,this);this.BuildVerticalBarMobile=d(this.BuildVerticalBarMobile,this);this.BuildHorizontalBarMobile=d(this.BuildHorizontalBarMobile,this);this.getComponetById=d(this.getComponetById,this);this.comp_Init=d(this.comp_Init,this);this.comp_AssessDefaultOptions=d(this.comp_AssessDefaultOptions,
this);this._options||(this._options={initPos:.5,barColor:void 0,barThickness:void 0,Horizontal:!1,directionNodesOnOver:!1,vertDragNodeButton:void 0,upNodeButton:void 0,downNodeButton:void 0,horzDragNodeButton:void 0,leftNodeButton:void 0,rightNodeButton:void 0});c.__super__.constructor.call(this,this._id,this.location,this._options);this._inheritanceChain.push(D2LAdventureEngine.comp_Group)}q(c,h);c.prototype._hasBeenChanged=void 0;c.prototype._DrgNodeButtonPushSpeed=void 0;c.prototype._mobileMode=
void 0;c.prototype._DrgNodeButton=void 0;c.prototype.comp_AssessDefaultOptions=function(){c.__super__.comp_AssessDefaultOptions.apply(this,arguments);this._hasBeenChanged=!1;this._DrgNodeButtonPushSpeed=5;void 0===this._options.Horizontal&&(this._options.Horizontal=!1);void 0===this._options.initWidth&&(this._options.initWidth=this._options.Horizontal?200:this._mobileMode?5:20);void 0===this._options.initHeight&&(this._options.initHeight=this._options.Horizontal?this._mobileMode?5:20:200);void 0===
this._options.initPos&&(this._options.initPos=.5);void 0===this._options.barColor&&(this._options.barColor=createjs.Graphics.getRGB(201,201,201));void 0===this._options.barThickness&&(this._options.barThickness=this._options.initHeight);void 0===this._options.useCursor&&(this._options.useCursor="pointer");void 0===this._options.useCursorOnOut&&(this._options.useCursorOnOut="default");this._options.tabEnabled=!1;this._options.interactive=!0;this._options.overflow="hidden";return this._pos=this._options.initPos};
c.prototype.comp_Init=function(){c.__super__.comp_Init.apply(this,arguments);this.width=this._options.initWidth;this.height=this._options.initHeight;this._enabled||(this._bar.alpha=.5);return this._options.Horizontal?this._mobileMode?this.BuildHorizontalBarMobile():this.BuildHorizontalBar():this._mobileMode?this.BuildVerticalBarMobile():this.BuildVerticalBar()};c.prototype.getComponetById=function(a){return this._DrgNodeButton&&a===this._DrgNodeButton._id?this._DrgNodeButton:this._upNodeBtn&&a===
this._upNodeBtn._id?this._upNodeBtn:this._downNodeBtn&&a===this._downNodeBtn._id?this._downNodeBtn:this._leftNodeBtn&&a===this._leftNodeBtn._id?this._leftNodeBtn:this._rightNodeBtn&&a===this._rightNodeBtn._id?this._rightNodeBtn:this._bar&&a===this._bar._id?this._bar:c.__super__.getComponetById.apply(this,arguments)};c.prototype.BuildHorizontalBarMobile=function(){var a;a={ID:this._id+"_SB_HORIZONTAL_DRAGNODE",Type:"Shape - Round Rectangle",color:this._options.barColor,useContext:!1,rect:{x:0,y:0,
width:60,height:this.getHeight(),radius:2}};this.addComponet(a);this._DrgNodeButton=this.getComponetById(a.ID);this.maxX=this.getWidth()-this._DrgNodeButton.width/2;this.minX=this._DrgNodeButton.width/2;return this._DrgNodeButton.regX=this._DrgNodeButton.width/2};c.prototype.BuildVerticalBarMobile=function(){var a;a={ID:this._id+"_SB_VERTICAL_DRAGNODE",Type:"Shape - Round Rectangle",color:this._options.barColor,useContext:!1,initX:0,initY:0,rect:{x:0,y:0,width:this.getWidth(),height:60,radius:2}};
this.addComponet(a);this._DrgNodeButton=this.getComponetById(a.ID);this.maxY=this.getHeight()-this._DrgNodeButton.height/2;this.minY=this._DrgNodeButton.height/2;return this._DrgNodeButton.regY=this._DrgNodeButton.height/2};c.prototype.BuildHorizontalBar=function(){void 0===this._options.leftNodeButton?this._options.leftNodeButton={ID:this._id+"_SB_LEFTNODE",Type:"Button",AssetID:"DEF_SB_LEFTNODE",initDisabled:this._options.initDisabled,bypassParentDefine:!0,useContext:!1,InWinLockOverride:this._options.InWinLockOverride,
initTabPos:this._options.initTabPos,forceOutlineRect:{x:3,y:3,width:14,height:14},events:{whileDown:function(a){return function(){return a.MoveInDir("left")}}(this),whileOver:function(a){return function(){if(a._options.directionNodesOnOver)return a.MoveInDir("left")}}(this)}}:(this._options.leftNodeButton.ID=this._id+"_SB_LEFTNODE",this._options.leftNodeButton.bypassParentDefine=!0,this._options.leftNodeButton.InWinLockOverride=this._options.InWinLockOverride,void 0===this._options.leftNodeButton.events&&
(this._options.leftNodeButton.events={}),this._options.leftNodeButton.events.whileDown=function(a){return function(){return a.MoveInDir("left")}}(this),this._options.leftNodeButton.events.whileOver=function(a){return function(){if(a._options.directionNodesOnOver)return a.MoveInDir("left")}}(this));this.addComponet(this._options.leftNodeButton);this._leftNodeBtn=this.getComponetById(this._options.leftNodeButton.ID);void 0===this._options.rightNodeButton?this._options.rightNodeButton={ID:this._id+"_SB_RIGHTNODE",
Type:"Button",AssetID:"DEF_SB_RIGHTNODE",initX:this.getWidth()-this._leftNodeBtn.width,bypassParentDefine:!0,useContext:!1,initDisabled:this._options.initDisabled,InWinLockOverride:this._options.InWinLockOverride,initTabPos:"after "+this._id+"_SB_LEFTNODE",forceOutlineRect:{x:3,y:3,width:14,height:14},events:{whileDown:function(a){return function(){return a.MoveInDir("right")}}(this),whileOver:function(a){return function(){if(a._options.directionNodesOnOver)return a.MoveInDir("right")}}(this)}}:(this._options.rightNodeButton.ID=
this._id+"_SB_RIGHTNODE",this._options.rightNodeButton.bypassParentDefine=!0,void 0===this._options.rightNodeButton.initX&&(this._options.rightNodeButton.initX=this.getWidth()-this._leftNodeBtn.width),this._options.rightNodeButton.InWinLockOverride=this._options.InWinLockOverride,void 0===this._options.rightNodeButton.events&&(this._options.rightNodeButton.events={}),this._options.rightNodeButton.events.whileDown=function(a){return function(){return a.MoveInDir("right")}}(this),this._options.rightNodeButton.events.whileOver=
function(a){return function(){if(a._options.directionNodesOnOver)return a.MoveInDir("right")}}(this));this.addComponet(this._options.rightNodeButton);this._rightNodeBtn=this.getComponetById(this._options.rightNodeButton.ID);void 0===this._options.horzDragNodeButton?this._options.horzDragNodeButton={ID:this._id+"_SB_HORIZONTAL_DRAGNODE",Type:"Button",AssetID:"DEF_SB_HORIZONTAL_DRAGNODE",initDisabled:this._options.initDisabled,bypassParentDefine:!0,InWinLockOverride:this._options.InWinLockOverride,
tabEnabled:!1,draggable:"x-only",useContext:!1,events:{whileDragging:this.HandleNodeWhileDrag}}:(this._options.horzDragNodeButton.ID=this._id+"_SB_HORZDRAGNODE",this._options.horzDragNodeButton.initDisabled=this._options.initDisabled,this._options.horzDragNodeButton.bypassParentDefine=!0,this._options.horzDragNodeButton.InWinLockOverride=this._options.InWinLockOverride,this._options.horzDragNodeButton.tabEnabled=!1,this._options.horzDragNodeButton.draggable="x-only",this._options.horzDragNodeButton.interactive=
!0,this._options.horzDragNodeButton.events||(this._options.horzDragNodeButton.events={}),this._options.horzDragNodeButton.events.whileDragging=this.HandleNodeWhileDrag);this.addComponet(this._options.horzDragNodeButton);this._DrgNodeButton=this.getComponetById(this._options.horzDragNodeButton.ID);void 0===this._options.barShape?this._options.barShape={ID:this._id+"_SB_BARSHAPE",Type:"Shape - Rectangle",color:this._options.barColor,zPos:"bottom",interactive:!0,InWinLockOverride:this._options.InWinLockOverride,
rect:{x:this._leftNodeBtn.width,y:(this.getHeight()-this._options.barThickness)/2,width:Math.round(this.getWidth()-this._rightNodeBtn.width-this._leftNodeBtn.width+1),height:this._options.barThickness},events:{onClick:this.HandleBarClickHorizontal}}:(this._options.barShape.ID=this._id+"_SB_BARSHAPE",this._options.barShape.rect.width=Math.round(this.getWidth()-this._rightNodeBtn.width-this._leftNodeBtn.width+1),this._options.barShape.rect.x=this._leftNodeBtn.width,this._options.barShape.rect.height=
this.getHeight(),this._options.barShape.bypassParentDefine=!0,this._options.barShape.interactive=!0,this._options.barShape.InWinLockOverride=this._options.InWinLockOverride,this._options.barShape.events||(this._options.horzDragNodeButton.events={}),this._options.barShape.events.onClick=this.HandleBarClickHorizontal);this.addComponet(this._options.barShape,{addAt:"back"});this._bar=this.getComponetById(this._options.barShape.ID);this.maxX=this.getWidth()-this._leftNodeBtn.width-this._DrgNodeButton.width/
2;this.minX=this._leftNodeBtn.width+this._DrgNodeButton.width/2;this._DrgNodeButton.regX=this._DrgNodeButton.width/2;this._DrgNodeButton.regY=this._DrgNodeButton.height/2;return this._DrgNodeButton.Move(this._leftNodeBtn.width+this.getWidth()*this._pos+this._DrgNodeButton.width/2,this.getHeight()/2)};c.prototype.HandleBarClickHorizontal=function(a){if(this._enabled&&(!window.D2LAdventureEngine.gu_InWinButtonLock||this._options.InWinLockOverride)&&(a=this.globalToLocal(a.clientX,a.clientY),a=a.x,a<
this.maxX&&a>this.minX))return this._hasBeenChanged=!0,this._DrgNodeButton.x=a,this.calcPos(),this.TriggerChangeEvent()};c.prototype.BuildVerticalBar=function(){void 0===this._options.upNodeButton?this._options.upNodeButton={ID:this._id+"_SB_UPNODE",Type:"Button",AssetID:"DEF_SB_UPNODE",initDisabled:this._options.initDisabled,bypassParentDefine:!0,useContext:!1,InWinLockOverride:this._options.InWinLockOverride,initTabPos:this._options.initTabPos,forceOutlineRect:{x:3,y:3,width:14,height:14},events:{whileDown:function(a){return function(){return a.MoveInDir("up")}}(this),
whileOver:function(a){return function(){if(a._options.directionNodesOnOver)return a.MoveInDir("up")}}(this)}}:(this._options.upNodeButton.ID=this._id+"_SB_UPNODE",this._options.upNodeButton.bypassParentDefine=!0,this._options.upNodeButton.InWinLockOverride=this._options.InWinLockOverride,void 0===this._options.upNodeButton.events&&(this._options.upNodeButton.events={}),this._options.upNodeButton.events.whileDown=function(a){return function(){return a.MoveInDir("up")}}(this),this._options.upNodeButton.events.whileOver=
function(a){return function(){if(a._options.directionNodesOnOver)return a.MoveInDir("up")}}(this));this.addComponet(this._options.upNodeButton);this._upNodeBtn=this.getComponetById(this._options.upNodeButton.ID);void 0===this._options.downNodeButton?this._options.downNodeButton={ID:this._id+"_SB_DOWNNODE",Type:"Button",AssetID:"DEF_SB_DOWNNODE",initX:0,initY:this.getHeight()-this._upNodeBtn.height,bypassParentDefine:!0,useContext:!1,initDisabled:this._options.initDisabled,InWinLockOverride:this._options.InWinLockOverride,
initTabPos:"after "+this._id+"_SB_UPNODE",forceOutlineRect:{x:3,y:3,width:14,height:14},events:{whileDown:function(a){return function(){return a.MoveInDir("down")}}(this),whileOver:function(a){return function(){if(a._options.directionNodesOnOver)return a.MoveInDir("down")}}(this)}}:(this._options.downNodeButton.ID=this._id+"_SB_DOWNNODE",this._options.downNodeButton.bypassParentDefine=!0,this._options.downNodeButton.InWinLockOverride=this._options.InWinLockOverride,void 0===this._options.downNodeButton.events&&
(this._options.downNodeButton.events={}),this._options.downNodeButton.events.whileDown=function(a){return function(){return a.MoveInDir("down")}}(this),this._options.downNodeButton.events.whileOver=function(a){return function(){if(a._options.directionNodesOnOver)return a.MoveInDir("down")}}(this));this.addComponet(this._options.downNodeButton);this._downNodeBtn=this.getComponetById(this._options.downNodeButton.ID);void 0===this._options.vertDragNodeButton?this._options.vertDragNodeButton={ID:this._id+
"_SB_VERTICAL_DRAGNODE",Type:"Button",AssetID:"DEF_SB_VERTICAL_DRAGNODE",initDisabled:this._options.initDisabled,bypassParentDefine:!0,InWinLockOverride:this._options.InWinLockOverride,tabEnabled:!1,draggable:"y-only",useContext:!1,events:{whileDragging:this.HandleNodeWhileDrag}}:(this._options.vertDragNodeButton.ID=this._id+"_SB_VERTICAL_DRAGNODE",this._options.vertDragNodeButton.initDisabled=this._options.initDisabled,this._options.vertDragNodeButton.bypassParentDefine=!0,this._options.vertDragNodeButton.InWinLockOverride=
this._options.InWinLockOverride,this._options.vertDragNodeButton.tabEnabled=!1,this._options.vertDragNodeButton.draggable="y-only",this._options.vertDragNodeButton.interactive=!0,void 0===this._options.vertDragNodeButton.events&&(this._options.vertDragNodeButton.events={}),this._options.vertDragNodeButton.events.whileDragging=this.HandleNodeWhileDrag);this.addComponet(this._options.vertDragNodeButton);this._DrgNodeButton=this.getComponetById(this._options.vertDragNodeButton.ID);void 0===this._options.barShape?
this._options.barShape={ID:this._id+"_SB_BARSHAPE",Type:"Shape - Rectangle",color:this._options.barColor,zPos:"bottom",rect:{x:0,y:this._upNodeBtn.height,InWinLockOverride:this._options.InWinLockOverride,width:this.getWidth(),height:this.getHeight()-this._downNodeBtn.height-this._upNodeBtn.height},tabEnabled:!1,interactive:!0,events:{onClick:this.HandleBarClickVertical}}:(this._options.barShape.ID=this._id+"_SB_BARSHAPE",this._options.barShape.rect.width=this.getWidth(),this._options.barShape.rect.x=
this._leftNodeBtn.width,this._options.barShape.rect.height=this.getHeight()-this._downNodeBtn.height-this._upNodeBtn.height,this._options.barShape.bypassParentDefine=!0,this._options.barShape.interactive=!0,this._options.barShape.InWinLockOverride=this._options.InWinLockOverride,void 0===this._options.barShape.events&&(this._options.barShape.events={}),this._options.barShape.events.onClick=this.HandleBarClickVertical);this.addComponet(this._options.barShape,{addAt:"back"});this._bar=this.getComponetById(this._options.barShape.ID);
this.maxY=this.getHeight()-this._upNodeBtn.height-this._DrgNodeButton.height/2;this.minY=this._upNodeBtn.height+this._DrgNodeButton.height/2;this._DrgNodeButton.regY=this._DrgNodeButton.height/2;this._DrgNodeButton.regX=this._DrgNodeButton.width/2;this._DrgNodeButton.Move(this.getWidth()/2,this._upNodeBtn.height+this.getHeight()*this._pos+this._DrgNodeButton.height/2)};c.prototype.HandleBarClickVertical=function(a){if(this._enabled&&(!window.D2LAdventureEngine.gu_InWinButtonLock||this._options.InWinLockOverride)&&
(a=this.globalToLocal(a.clientX,a.clientY),a=a.y,a<this.maxY+this._DrgNodeButton.height/2&&a>this.minY-this._DrgNodeButton.height/2))return this._hasBeenChanged=!0,this._DrgNodeButton.Move(this._DrgNodeButton.x,a),this.calcPos(),a>this.maxY?this.PushToPos(1):a<this.minY?this.PushToPos(0):this.PushToPos(this._pos)};c.prototype.comp_Update=function(a){c.__super__.comp_Update.apply(this,arguments);this._initialized&&this._DrgNodeButton&&(this._DrgNodeButton.Update(a),this._mobileMode||(this._options.Horizontal?
(this._leftNodeBtn.Update(a),this._rightNodeBtn.Update(a)):(this._upNodeBtn.Update(a),this._downNodeBtn.Update(a))))};c.prototype.comp_HandleMouseMove=function(a){this._mobileMode||(this._DrgNodeButton.HandleMouseMove(a),this._options.Horizontal?(this._leftNodeBtn.HandleMouseMove(a),this._rightNodeBtn.HandleMouseMove(a)):(this._upNodeBtn.HandleMouseMove(a),this._downNodeBtn.HandleMouseMove(a)))};c.prototype.HandleNodeWhileDrag=function(a){this._options.Horizontal?this._DrgNodeButton.x<this.minX?this._DrgNodeButton.Move(this.minX,
this._DrgNodeButton.y):this._DrgNodeButton.x>this.maxX&&this._DrgNodeButton.Move(this.maxX,this._DrgNodeButton.y):this._DrgNodeButton.y<this.minY?this._DrgNodeButton.Move(this._DrgNodeButton.x,this.minY):this._DrgNodeButton.y>this.maxY&&this._DrgNodeButton.Move(this._DrgNodeButton.x,this.maxY);this._hasBeenChanged=!0;this.calcPos();this.TriggerChangeEvent()};c.prototype.comp_HandleMouseUp=function(a){this._mobileMode||(this._options.Horizontal?(this._leftNodeBtn.HandleMouseUp(a),this._rightNodeBtn.HandleMouseUp(a)):
(this._upNodeBtn.HandleMouseUp(a),this._downNodeBtn.HandleMouseUp(a)));this._DrgNodeButton.HandleMouseUp(a)};c.prototype.comp_Enable=function(a){this.alpha=1;this._mobileMode||(this._options.Horizontal?(this._leftNodeBtn.Enable(),this._rightNodeBtn.Enable()):(this._upNodeBtn.Enable(),this._downNodeBtn.Enable()));this._DrgNodeButton.Enable()};c.prototype.comp_Disable=function(a){this.alpha=.5;this._mobileMode||(this._options.Horizontal?(this._leftNodeBtn.Disable(),this._rightNodeBtn.Disable()):(this._upNodeBtn.Disable(),
this._downNodeBtn.Disable()));this._DrgNodeButton.Disable()};c.prototype.TriggerChangeEvent=function(){return D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onchange",this._pos)};c.prototype.PushToPos=function(a){return this._initialized?(0>a?a=0:1<a&&(a=1),this._pos=a,this._options.Horizontal?this._DrgNodeButton.Move((this.maxX-this.minX)*a+this.minX,this._DrgNodeButton.y):this._DrgNodeButton.Move(this._DrgNodeButton.x,(this.maxY-this.minY)*a+this.minY),this.TriggerChangeEvent()):this._options.initPos=
a};c.prototype.MoveInDir=function(a){this._hasBeenChanged=!0;"down"===a?this._DrgNodeButton.y<this.maxY&&this._DrgNodeButton.ShiftY(this._DrgNodeButtonPushSpeed):"up"===a?this._DrgNodeButton.y>this.minY&&this._DrgNodeButton.ShiftY(-this._DrgNodeButtonPushSpeed):"left"===a?this._DrgNodeButton.x>this.minX&&this._DrgNodeButton.ShiftX(-this._DrgNodeButtonPushSpeed):"right"===a&&this._DrgNodeButton.x<this.maxX&&this._DrgNodeButton.ShiftX(this._DrgNodeButtonPushSpeed);this.calcPos();this.TriggerChangeEvent()};
c.prototype.calcPos=function(){var a;a=this._options.Horizontal?0===this._DrgNodeButton.x-this.minX?0:(this._DrgNodeButton.x-this.minX)/(this.maxX-this.minX):0===this._DrgNodeButton.y-this.minY?0:(this._DrgNodeButton.y-this.minY)/(this.maxY-this.minY);0>a?a=0:1<a&&(a=1);this._pos=a};return c}(window.D2LAdventureEngine.comp_Group);window.D2LAdventureEngine.comp_Window=function(h){function c(a,b,l){this._id=a;this.location=b;this._options=l;this.noButtonClickEvnt=d(this.noButtonClickEvnt,this);this.yesButtonClickEvnt=
d(this.yesButtonClickEvnt,this);this.okButtonClickEvnt=d(this.okButtonClickEvnt,this);this.HandleOnPopulate=d(this.HandleOnPopulate,this);this.HandleOnClose=d(this.HandleOnClose,this);this.HandleEndWinReq=d(this.HandleEndWinReq,this);this.AdjustAdaptiveWidth=d(this.AdjustAdaptiveWidth,this);this.comp_HandleWinScrollEvent=d(this.comp_HandleWinScrollEvent,this);this.comp_HandleResizeEvent=d(this.comp_HandleResizeEvent,this);this.comp_Resize=d(this.comp_Resize,this);this.Repopulate=d(this.Repopulate,
this);this.Populate=d(this.Populate,this);this.VaildatePopulationData=d(this.VaildatePopulationData,this);this.PosistionButtonSet=d(this.PosistionButtonSet,this);this.BuildWindowButton=d(this.BuildWindowButton,this);this.BuildButtonSet=d(this.BuildButtonSet,this);this.comp_Update=d(this.comp_Update,this);this.DrawContRect=d(this.DrawContRect,this);this.DrawWindowGraphic=d(this.DrawWindowGraphic,this);this.RequestBufferOpen=d(this.RequestBufferOpen,this);this.Build=d(this.Build,this);this.comp_BuildAccessContext=
d(this.comp_BuildAccessContext,this);this.comp_Init=d(this.comp_Init,this);this.comp_AssessDefaultOptions=d(this.comp_AssessDefaultOptions,this);this._options||(this._options={useFade:void 0,useBG:void 0,autoCenter:void 0,useContentRect:void 0,useContentPadding:void 0,useInitPopulation:void 0,ButtonSet:"ok",centerWinText:!1,contentWeight:void 0,contentColor:void 0,contentFont:void 0,contentAlign:"left",contentOverflow:"auto",contentTextSizeBoost:void 0,allowUI:!1,dontBuffer:!1,fadeClickClose:!1,useAdaptiveWidth:!0,
okButton:void 0,okButtonPosition:void 0,xButton:void 0,xButtonPosition:void 0,yesButton:void 0,yesButtonPosition:void 0,noButton:void 0,noButtonPosition:void 0});this._ShowContRect=this._isBuffered=this._BtnsSet=this._BtnsBuilt=this._popEventCalled=this._populated=!1;this._PopulationDataIndex=0;this._pdgOffset={x:0,y:0};void 0===this._options.useFade&&(this._options.useFade=!0);void 0===this._options.forceChildClipping&&(this._options.forceChildClipping=!0);void 0===this._options.useAdaptiveWidth&&
(this._options.useAdaptiveWidth=!0);this._winSizeMem={width:void 0,height:void 0};c.__super__.constructor.call(this,this._id,this.location,this._options);this._inheritanceChain.push(D2LAdventureEngine.comp_Group)}q(c,h);c.prototype._populated=!1;c.prototype._BtnsBuilt=!1;c.prototype._BtnsSet=!1;c.prototype._isBuffered=!1;c.prototype._ContentRect=void 0;c.prototype._ShowContRect=!0;c.prototype._DrawnContRect=void 0;c.prototype._currentPopContent=void 0;c.prototype._populationDisplayGroup=void 0;c.prototype._pdgOffset=
void 0;c.prototype._PopulationData=void 0;c.prototype._PopulationDataIndex=0;c.prototype._PopulationDataMaxIndex=void 0;c.prototype._winSizeMem=void 0;c.prototype._bg=void 0;c.prototype._btn_x=void 0;c.prototype._btn_ok=void 0;c.prototype._btn_yes=void 0;c.prototype._btn_no=void 0;c.prototype._popEventCalled=void 0;c.prototype.comp_AssessDefaultOptions=function(){void 0===this.BaseOptionsData.initX&&(this._options.initX="center");void 0===this.BaseOptionsData.initY&&(this._options.initY="center");
void 0===this._options.autoCenter&&(this._options.autoCenter={x:void 0,y:void 0});"center"===this._options.initX&&void 0===this._options.autoCenter.x&&(this._options.autoCenter.x=!0);"center"===this._options.initY&&void 0===this._options.autoCenter.y&&(this._options.autoCenter.y=!0);void 0===this._options.useContentPadding&&(this._options.useContentPadding=void 0!==this._options.useBG?0:20);void 0===this._options.ButtonSet&&(this._options.ButtonSet="ok");void 0===this._options.contentOverflow&&(this._options.contentOverflow=
"auto");void 0===this._options.xButton&&(this._options.xButton="default");void 0===this._options.okButton&&(this._options.okButton="default");void 0===this._options.yesButton&&(this._options.yesButton="default");void 0===this._options.noButton&&(this._options.noButton="default");void 0===this._options.allowUI&&(this._options.allowUI=!1);void 0===this._options.dontBuffer&&(this._options.dontBuffer=!1);this._options.overflow="hidden";this._options.InWinLockOverride=!0;this._options.tabEnabled=!1;void 0===
this._options.events&&(this._options.events={});this._options.forceContextParent=this._id;return c.__super__.comp_AssessDefaultOptions.call(this)};c.prototype.comp_Init=function(){void 0===this._options.initContent&&(this._options.initContent=[]);void 0!==this._options.useInitPopulation&&(this._PopulationData=this._options.useInitPopulation);this.Build();void 0!==this._options.initContent&&(this.Populate(),this.addComponets(this._options.initContent,{inital:!0}));c.__super__.comp_Init.call(this);
this._ShowContRect&&this.DrawContRect();this._currentPopContent=this.getComponetById(this._id+"_populationDisplayGroup");if(!this._BtnsSet)return this.Hide(),D2LAdventureEngine.gu_stageRef.update()};c.prototype.comp_BuildAccessContext=function(){return D2LAdventureEngine.gu_ScreenReaderHelper.AddReadText(this._id,"","section",void 0,{SectionLable:"Window content:"})};c.prototype.Build=function(){var a,b;this.DrawWindowGraphic();void 0===this._options.useContentRect?(b=void 0!==this._options.initWidth?
this._options.initWidth:this._bg.getWidth(),a=void 0!==this._options.initHeight?this._options.initHeight:this._bg.getHeight(),this._ContentRect={x:this._bg.x+this._options.useContentPadding,y:this._bg.y+this._options.useContentPadding,width:Math.ceil(b-2*this._options.useContentPadding),height:Math.ceil(a-2*this._options.useContentPadding)}):this._ContentRect=D2LAdventureEngine.gu_DataManager.cloneDataObj(this._options.useContentRect);this._options.useAdaptiveWidth&&this._ContentRect.width>D2LAdventureEngine.gu_canDi.useWinInnerWidth&&
(this._ContentRect.width=D2LAdventureEngine.gu_canDi.useWinInnerWidth);return this.BuildButtonSet()};c.prototype.RequestBufferOpen=function(){this._isBuffered=!1;this._populated||this.Populate();this.Show();return D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onBufferOpen")};c.prototype.DrawWindowGraphic=function(){var a,b;a={};b=this._options.initWidth.valueOf();this._options.useAdaptiveWidth&&b>D2LAdventureEngine.gu_canDi.useWinInnerWidth&&(b=D2LAdventureEngine.gu_canDi.useWinInnerWidth.valueOf());
if("none"===this._options.useBG)a={ID:this._id+"_bg",Type:"Shape",shapeType:"Rectangle",color:"rgba(0,0,0,0)",interactive:!1,tabEnabled:"[%false]",rect:{x:0,y:0,width:b,height:this._options.initHeight}};else if(void 0===this._options.useBG)a={ID:this._id+"_bg",Type:"Bitmap",AssetID:"window_bg",initWidth:b,initHeight:this._options.initHeight,tabEnabled:"[%false]",scaleToSize:!0};else if(this._options.useBG.constructor===String)a={ID:this._id+"_bg",Type:"Bitmap",AssetID:this._options.useBG,initWidth:b,
initHeight:this._options.initHeight,tabEnabled:"[%false]"};else if(this._options.useBG.Type){if(a=this._options.useBG,-1!==this._options.useBG.Type.indexOf("Shape")){a.ID||(a.ID=this._id+"_bg");if(!a.rect||this._options.useAdaptiveWidth)a.rect={x:0,y:0,width:b,height:this._options.initHeight};a.tabEnabled||(a.tabEnabled="[%false]")}}else D2LAdventureEngine.gu_debugManager.log("invaild BG data provided with "+this._id);this._bg&&(this.removeComponet(this._bg._id,!0),this._bg=void 0);this._bg=D2LAdventureEngine.gu_ComponentManager.BuildComponent(a,
this.location);return this._initialized?this.addComponet(a):this._options.initContent?this._options.initContent.push(a):this._options.initContent=[a]};c.prototype.DrawContRect=function(){var a;a={ID:this._id+"_ContentRect",Type:"Shape",shapeType:"Rectangle",color:"rgba(0,0,0,0)",strokeWidth:3,strokeColor:"#00FF00",tabEnabled:!1,interactive:!1,initX:this._ContentRect.x+this._options.useContentPadding+this.x+this._pdgOffset.x,initY:this._ContentRect.y+this._options.useContentPadding+this.y+this._pdgOffset.y,
rect:{x:0,y:0,width:this._ContentRect.width-2*this._options.useContentPadding,height:this._ContentRect.height-2*this._options.useContentPadding}};return this._initialized?this.addComponet(a):this._options.initContent.push(a)};c.prototype.comp_Update=function(a){this._BtnsBuilt&&this._MaskBuilt&&!this._BtnsSet&&this.PosistionButtonSet();this._initialized&&this._populated&&!this._popEventCalled&&this._BtnsSet&&(this.Show(),this.HandleOnPopulate());return c.__super__.comp_Update.call(this,a)};c.prototype.BuildButtonSet=
function(){var a,b;a=[];if("ok"===this._options.ButtonSet)a.push("ok");else if("confirm"===this._options.ButtonSet)a.push("yes"),a.push("no");else if("none"===this._options.ButtonSet)return this._BtnsBuilt=[];for(b=0;b<a.length;)this.BuildWindowButton(a[b],a.length),b++;this._BtnsBuilt=a};c.prototype.BuildWindowButton=function(a,b){var c,e,f;c=D2LAdventureEngine.gu_DataManager.cloneDataObj(this._options[a+"Button"]);if("none"!==c&&void 0!==c){this["_btn_"+a]&&(this.removeComponet(this["_btn_"+a]._id),
this["_btn_"+a]=void 0);if("default"===c)e={ID:this._id+"_"+a+"Button",Type:"LabeledButton",InitText:"[%LANG uiDefaults.window_"+a(NaN),InWinLockOverride:!0,useContext:a,outOnClick:!0,initHidden:!0,events:{onClick:this[a+"ButtonClickEvnt"]}};else if("object"===typeof c)e=c,e.ID=this._id+"_"+a+"Button",e.interactive=!0,void 0===e.events?e.events={onclick:this[a+"ButtonClickEvnt"]}:void 0===e.events.onclick?e.events.onclick=[this[a+"ButtonClickEvnt"]]:e.events.onclick.constructor===Array?e.events.onclick.push([this[a+
"ButtonClickEvnt"]]):e.events.onclick.constructor===String&&(e.events.onclick=[e.events.onclick,this[a+"ButtonClickEvnt"]]),e.InWinLockOverride=!0;else return window.D2LAdventureEngine.gu_debugManager.log("Error: Unknown button received in "+this._id+", using default"),this._options[a+"Button"]="default",this.BuildWindowButton(a);this._options.useAdaptiveWidth&&e.initWidth>D2LAdventureEngine.gu_canDi.useWinInnerWidth&&(e.initWidth=D2LAdventureEngine.gu_canDi.useWinInnerWidth);this["_btn_"+a]=D2LAdventureEngine.gu_ComponentManager.BuildComponent(e,
"none");f=this["_btn_"+a];c=this._options[a+"ButtonPosition"];void 0===c&&void 0===e.initY&&(this._ContentRect.height-=f.getHeight()/b);this._initialized?(this.addComponet(f),f.Update(),f.Hide()):this._options.initContent.push(e)}};c.prototype.PosistionButtonSet=function(){var a,b,c,e,f;this.AssessGlobalPos();for(e=0;e<this._BtnsBuilt.length;)f=this.getComponetById(this._id+"_"+this._BtnsBuilt[e]+"Button"),f.Hide(),c=this._options[this._BtnsBuilt[e]+"ButtonPosition"],b=a=void 0,f._options.outOnClick=
!0,void 0===c?(1===this._BtnsBuilt.length&&(a=this._ContentRect.width/2-f.getWidth()/2+this._ContentRect.x),2===this._BtnsBuilt.length&&(0===e?a=this._ContentRect.width/4-f.getWidth()/2+this._options.useContentPadding:1===e&&(a=this._ContentRect.width/4*3-f.getWidth()/2+this._options.useContentPadding))):void 0!==c&&void 0!==c.x&&(a=c.x),void 0===c?b=this._ContentRect.y+this._ContentRect.height:void 0!==c&&void 0!==c.y&&(b=c.y),"center"!==a&&(a=Math.round(a)),"center"!==b&&(b=Math.round(b)),f._initialized?
f.Move(a,b):(f._options.initX=a,f._options.initY=b),f.Show(),f.SetZPos("top"),e++;return this._BtnsSet=!0};c.prototype.VaildatePopulationData=function(a){var b,c,e,f,g,d;if(!a||a.constructor!==String&&a.constructor!==Array&&void 0===a.ID)return D2LAdventureEngine.gu_debugManager.log("VaildatePopulationData Returned false on "+this._id),!1;c=function(a){return function(b,g){var e;e={ID:a._id+"_Content_"+g,Type:"Text",classes:["AEWindowText"],InWinLockOverride:!0,initWidth:a._ContentRect.width-2*a._options.useContentPadding,
initHeight:a._ContentRect.height-2*a._options.useContentPadding,align:a._options.contentAlign,InitText:b,overflow:"y-auto",interactive:!1,initX:0,initY:0,forceTextWidth:!0};a._options.contentWeight&&(e.weight=a._options.contentWeight);a._options.contentColor&&(e.color=a._options.contentColor);a._options.contentFont&&(e.fontFamily=a._options.contentFont);void 0!==a._options.contentTextSizeBoost&&(e.sizeBoost=a._options.contentTextSizeBoost);-1===b.indexOf("<")||-1===b.indexOf(">")||-1===b.indexOf("<textarea")&&
-1===b.indexOf("<input")&&-1===b.indexOf("<a")||(e.interactive=!0,e.tabEnabled=!0,e.noOutline=!0);return e}}(this);b=function(a){return function(b,g){var e;e=D2LAdventureEngine.gu_DataManager.cloneDataObj(b);b.constructor===Object&&void 0===e.ID&&(e.ID=a._id+"_Content_"+g);return e}}(this);if(a.constructor===String)return this._PopulationDataMaxIndex=1,[c(a,0)];if(a.constructor===Array){g=[];for(e=0;e<a.length;){if(a[e].constructor===String||void 0!==a[e].ID)a[e].constructor===String?(this._PopulationDataMaxIndex=
a.length,f=c(a[e],e)):(this._PopulationDataMaxIndex=a.length,f=b(a[e],e)),0!==e&&(f.initHidden=!0),g.push(f);else if(a[e].constructor===Array){f=0;d=[];for(this._PopulationDataMaxIndex=a.length;f<a[e].length;)void 0!==a[e][f].ID?d.push(b(a[e][f],e+"_"+f)):D2LAdventureEngine.gu_debugManager.log("VaildatePopulationData Returned false on "+this._id+" index "+e+" sub index "+f),f++;g.push(b(d,e))}else return D2LAdventureEngine.gu_debugManager.log("VaildatePopulationData Returned false on "+this._id+" index "+
e),!1;e++}return g}D2LAdventureEngine.gu_debugManager.log("VaildatePopulationData Returned false on "+this._id);return!1};c.prototype.Populate=function(a){var b,c,e,f;if(this._winSizeMem.width&&this._winSizeMem.width!==D2LAdventureEngine.gu_canDi.useWinInnerWidth)return this._winSizeMem={width:D2LAdventureEngine.gu_canDi.useWinInnerWidth,height:window.innerHeight},this.AdjustAdaptiveWidth(void 0,!0);this.Enable();this._PopulationDataIndex=0;if(a)if(this.VaildatePopulationData(a))this._PopulationData=
this.VaildatePopulationData(a);else return D2LAdventureEngine.gu_debugManager.log("Window Populate Failed on "+this._id+" invaild Data"),!1;else if(this.VaildatePopulationData(this._PopulationData))this._PopulationData=this.VaildatePopulationData(this._PopulationData);else return D2LAdventureEngine.gu_debugManager.log("Window Populate Failed on "+this._id+" invaild Data"),!1;if(a=this.getComponetById(this._id+"_populationDisplayGroup"))this.removeComponet(a._id),this._currentPopContent=void 0;a={ID:this._id+
"_populationDisplayGroup",Type:"Group",initX:(this._ContentRect.x+this._options.useContentPadding)*this.scaleX+this._pdgOffset.x,initY:(this._ContentRect.y+this._options.useContentPadding)*this.scaleY+this._pdgOffset.y,clickAudioSFX:"none",initWidth:this._ContentRect.width,initHeight:this._ContentRect.height,overflow:this._options.contentOverflow,tabEnabled:"[%false]",zPos:"top",allowMouseThrough:"[%true]",useContextOptions:{insertAfter:"AE_windowHead_"+this._id}};a.initContent=this._PopulationData[0].constructor!==
Array?this._PopulationData:this._PopulationData[0];if(this._initialized)if(void 0===this._currentPopContent)this.addComponet(a),this._currentPopContent=this.getComponetById(this._id+"_populationDisplayGroup");else{f=a.initContent;c=0;for(e=f.length;c<e;c++)if(b=f[c],this._currentPopContent.checkDuplicate(b))return!1;this._currentPopContent.addComponets(a.initContent)}else this._options.initContent.push(a);this._options.autoCenter.x&&this._options.autoCenter.y?this.Move("center","center"):this._options.autoCenter.x?
this.Move("center",this._options.initY):this._options.autoCenter.y&&this.Move(this._options.initX,"center");this._winSizeMem={width:D2LAdventureEngine.gu_canDi.useWinInnerWidth,height:window.innerHeight};return this._populated=!0};c.prototype.Repopulate=function(a){var b;this._PopulationDataIndex=0;a||(a=D2LAdventureEngine.gu_DataManager.cloneDataObj(this._options.useInitPopulation));this._options.useInitPopulation=a;if(this._initialized){if(this.VaildatePopulationData(a))this._PopulationData=this.VaildatePopulationData(a);
else return D2LAdventureEngine.gu_debugManager.log("Window Repopulate Failed on "+this._id+" invaild Data"),!1;this._currentPopContent._options.initWidth===this._ContentRect.width&&this._currentPopContent._options.initHeight===this._ContentRect.height||this._currentPopContent.Resize(this._ContentRect.width,this._ContentRect.height);this._currentPopContent.ClearGroupContent();this._PopulationData.constructor===Object?this._currentPopContent.addComponets([this._PopulationData]):this._PopulationData.constructor===
Array&&(this._PopulationData[this._PopulationDataIndex].constructor===Object?this._currentPopContent.addComponets([this._PopulationData[this._PopulationDataIndex]]):this._PopulationData[this._PopulationDataIndex].constructor===Array&&this._currentPopContent.addComponets(this._PopulationData[this._PopulationDataIndex]));D2LAdventureEngine.gu_GUIManager.CurrentActiveWindow===this&&this.Show();this._currentPopContent.SetZPos("top");this._options.autoCenter.x&&this._options.autoCenter.y?this.Move("center",
"center"):this._options.autoCenter.x?this.Move("center",this._options.initY):this._options.autoCenter.y&&this.Move(this._options.initX,"center");a=(this._ContentRect.x+this._options.useContentPadding)*this.scaleX+this._pdgOffset.x;b=(this._ContentRect.y+this._options.useContentPadding)*this.scaleY+this._pdgOffset.y;this._currentPopContent.Move(a,b);this._currentPopContent.Scale(this.scaleX);this._winSizeMem={width:D2LAdventureEngine.gu_canDi.useWinInnerWidth,height:window.innerHeight};D2LAdventureEngine.gu_EventManager.DispacthEvent(this,
"onRepopulate");return this._populated=!0}return!0};c.prototype.comp_Resize=function(a,b){var l,e,f;if(this._initialized){this._ContentRect.width=a-2*this._options.useContentPadding;this._ContentRect.height=b-2*this._options.useContentPadding;for(e=0;e<this._BtnsBuilt.length;)f=this.getComponetById(this._id+"_"+this._BtnsBuilt[e]+"Button"),l=this._options[this._BtnsBuilt[e]+"ButtonPosition"],void 0===l&&(this._ContentRect.height-=f.getHeight()),e++;this._options.useBG&&(this._options.useBG.rect.width=
a,this._options.useBG.rect.height=b,this.DrawWindowGraphic());this._options.initHeight=b;this._options.initWidth=a;this.Move("center","center");this._BtnsSet=!1;c.__super__.comp_Resize.call(this,a,b);return this.Repopulate()}return c.__super__.comp_Resize.call(this,a,b)};c.prototype.comp_HandleResizeEvent=function(a){this.AdjustAdaptiveWidth(a);c.__super__.comp_HandleResizeEvent.call(this)};c.prototype.comp_HandleWinScrollEvent=function(a){this.AdjustAdaptiveWidth(a);c.__super__.comp_HandleWinScrollEvent.call(this)};
c.prototype.AdjustAdaptiveWidth=function(a,b){this._options.useAdaptiveWidth&&(this.Build(),b?this.Populate():this.Repopulate(),this.PosistionButtonSet())};c.prototype.HandleEndWinReq=function(a,b){var c;this._currentPopContent||this.Update();this._PopulationDataIndex<this._PopulationDataMaxIndex-1?((c=this._currentPopContent.getComponetById(this._id+"_Content_"+this._PopulationDataIndex))&&c.Hide(),this._PopulationDataIndex++,(c=this._currentPopContent.getComponetById(this._id+"_Content_"+this._PopulationDataIndex))&&
c.Show()):this._currentPopContent&&(this._currentPopContent.ClearGroupContent(!0),this._populated=!1,void 0!==this.ReleseKeyCommand&&this.ReleseKeyCommand(),b||this.HandleOnClose(),this.Disable(),D2LAdventureEngine.gu_ScreenReaderHelper.HideReadText(this._id),void 0!==this._options.closeFunction&&this._options.closeFunction(this));return this._popEventCalled=!1};c.prototype.HandleOnClose=function(){return D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onClose")};c.prototype.HandleOnPopulate=
function(){this._popEventCalled||D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onPopulate");return this._popEventCalled=!0};c.prototype.okButtonClickEvnt=function(a){D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"okButtonFunction");return this.HandleEndWinReq(a)};c.prototype.yesButtonClickEvnt=function(a){D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"yesButtonFunction");return this.HandleEndWinReq(a)};c.prototype.noButtonClickEvnt=function(a){D2LAdventureEngine.gu_EventManager.DispacthEvent(this,
"noButtonFunction");return this.HandleEndWinReq(a)};return c}(D2LAdventureEngine.comp_Group);window.D2LAdventureEngine.comp_LabeledButton=function(h){function c(a,b,l){this._id=a;this.location=b;this._options=l;this.comp_BuildAccessContext=d(this.comp_BuildAccessContext,this);this.comp_Enable=d(this.comp_Enable,this);this.comp_Disable=d(this.comp_Disable,this);this.comp_HandleMouseUp=d(this.comp_HandleMouseUp,this);this.comp_HandlePress=d(this.comp_HandlePress,this);this.comp_HandleMouseOut=d(this.comp_HandleMouseOut,
this);this.comp_HandleMouseOver=d(this.comp_HandleMouseOver,this);this.comp_Show=d(this.comp_Show,this);this.comp_destroy=d(this.comp_destroy,this);this.comp_getHeight=d(this.comp_getHeight,this);this.comp_getWidth=d(this.comp_getWidth,this);this.comp_Init=d(this.comp_Init,this);this.comp_AssessDefaultOptions=d(this.comp_AssessDefaultOptions,this);this._options||(this._options={InitText:void 0,textOptions:void 0,baseOptions:void 0});this._ArbratraitedDimentions={width:128,height:28};c.__super__.constructor.call(this,
this._id,this.location,this._options);this._inheritanceChain.push(D2LAdventureEngine.comp_Group)}q(c,h);c.prototype._BaseType=void 0;c.prototype._TextRef=void 0;c.prototype._StaticOverState=void 0;c.prototype._StaticDownState=void 0;c.prototype._ArbratraitedDimentions=void 0;c.prototype.comp_AssessDefaultOptions=function(){var a,b;this._options.overflow="hidden";void 0===this._options.textOptions&&(this._options.textOptions={});void 0===this._options.baseOptions&&(this._options.baseOptions={});void 0===
this._options.baseOptions.ID&&(this._options.baseOptions.ID=this._id+"_ButtonComp");void 0===this._options.baseOptions.Type&&(this._options.baseOptions.Type="Shape");this._options.baseOptions.bubbleEvents="[%true]";this._options.baseOptions.InitX=0;this._options.baseOptions.InitY=0;this._BaseType=this._options.baseOptions.Type;void 0===this._options.useCursor&&(this._options.useCursor="pointer");void 0===this._options.useContext&&(this._options.useContext=this._options.InitText);"Shape"===this._BaseType&&
(void 0===this._options.baseOptions.shapeType&&(this._options.baseOptions.shapeType="Round Rectangle"),void 0===this._options.baseOptions.tabEnabled&&(this._options.baseOptions.tabEnabled=!1),b=this._ArbratraitedDimentions.width,a=this._ArbratraitedDimentions.height,void 0!==this._options.initWidth&&(b=this._options.initWidth),void 0!==this._options.baseOptions.initWidth&&(b=this._options.baseOptions.initWidth),void 0!==this._options.baseOptions.rect&&this._options.baseOptions.rect.width&&(b=this._options.baseOptions.rect.width),
void 0!==this._options.initHeight&&(a=this._options.initHeight),void 0!==this._options.baseOptions.initHeight&&(a=this._options.baseOptions.initHeight),void 0!==this._options.baseOptions.rect&&this._options.baseOptions.rect.height&&(a=this._options.baseOptions.rect.height),void 0===this._options.baseOptions.rect&&(this._options.baseOptions.rect={x:0,y:0,width:b,height:a}),void 0===this._options.baseOptions.radius&&(this._options.baseOptions.radius=0),void 0===this._options.baseOptions.color&&(this._options.baseOptions.color=
"#3D3D3D"),void 0===this._options.baseOptions.strokeWidth&&(this._options.baseOptions.strokeWidth=0),void 0===this._options.baseOptions.strokeColor&&(this._options.baseOptions.strokeColor="#D8D8D8"),void 0===this._options.baseOptions.jointStyle&&(this._options.baseOptions.jointStyle="round"),a=D2LAdventureEngine.gu_ComponentManager.BuildComponent(this._options.baseOptions,this.location),void 0===this._options.initWidth&&(this._options.initWidth=a.getWidth()),void 0===this._options.initHeight&&(this._options.initHeight=
a.getHeight()),void 0===this._options.baseOptions.initWidth&&(this._options.baseOptions.initWidth=a.getWidth()),void 0===this._options.baseOptions.initHeight&&(this._options.baseOptions.initHeight=a.getHeight()),this._options.initDisabled&&(this._options.baseOptions.initAlpha="[%num].5",this._options.textOptions.initAlpha="[%num].5",this._options.useCursor="default"),a.Destroy());this._options.textOptions.Type="Text";this._options.textOptions.bubbleEvents="[%true]";this._options.textOptions.overflow=
"hidden";void 0===this._options.textOptions.ID&&(this._options.textOptions.ID=this._id+"_TextComp");void 0===this._options.textOptions["static"]&&(this._options.textOptions["static"]="[%true]");void 0===this._options.textOptions.align&&(this._options.textOptions.align="center");void 0===this._options.textOptions.vCenter&&(this._options.textOptions.vCenter="[%true]");void 0===this._options.textOptions.color&&(this._options.textOptions.color="#FFFFFF");void 0===this._options.textOptions.tabEnabled&&
(this._options.textOptions.tabEnabled=!1);void 0===this._options.textOptions.InitText&&(this._options.textOptions.InitText=void 0!==this._options.InitText?this._options.InitText:"My Button");void 0===this._options.textOptions.initX&&(this._options.textOptions.initX=0);void 0===this._options.textOptions.initY&&(this._options.textOptions.initY=0);void 0===this._options.textOptions.initWidth&&(this._options.textOptions.initWidth=this._options.initWidth);void 0===this._options.textOptions.initHeight&&
(this._options.textOptions.initHeight=this._options.initHeight);void 0===this._options.textOptions.lineHeight&&(this._options.textOptions.lineHeight=1.2);this._options.initContent=[this._options.baseOptions,this._options.textOptions];void 0===this._options.baseOptions.overColor&&(this._options.baseOptions.overColor="#606060");void 0===this._options.baseOptions.overStrokeWidth&&(this._options.baseOptions.overStrokeWidth=this._options.baseOptions.strokeWidth);void 0===this._options.baseOptions.overStrokeColor&&
(this._options.baseOptions.overStrokeColor=this._options.baseOptions.strokeColor);void 0===this._options.baseOptions.downColor&&(this._options.baseOptions.downColor="#2D2D2D");void 0===this._options.baseOptions.downStrokeWidth&&(this._options.baseOptions.downStrokeWidth=this._options.baseOptions.strokeWidth);void 0===this._options.baseOptions.downStrokeColor&&(this._options.baseOptions.downStrokeColor=this._options.baseOptions.strokeColor);void 0===this._options.textOptions.padding&&(a=Math.max.apply(Math,
[this._options.baseOptions.strokeWidth,this._options.baseOptions.overStrokeWidth,this._options.baseOptions.downStrokeWidth]),this._options.textOptions.padding=a);this._options.forceChildClipping=!0;return c.__super__.comp_AssessDefaultOptions.call(this)};c.prototype.comp_Init=function(){var a,b;c.__super__.comp_Init.call(this);if("Shape"===this._BaseType)return this._TextRef=this.getComponetById(this._options.textOptions.ID),b=this._options.textOptions.initWidth,a=this._options.textOptions.initHeight,
this._options.textOptions.forceSize||this._TextRef.SetFontToDimentions(b,a),a=this.getComponetById(this._options.baseOptions.ID).clone({ID:this._options.baseOptions.ID+"_OverState",color:this._options.baseOptions.overColor,strokeWidth:this._options.baseOptions.overStrokeWidth,strokeColor:this._options.baseOptions.overStrokeColor,zPos:"above "+this._options.baseOptions.ID,tabEnabled:"[%false]",initHidden:!0},!0),this._StaticOverState=D2LAdventureEngine.gu_ComponentManager.BuildComponent(a,this.location),
this.addComponet(this._StaticOverState,{inital:!0}),this._StaticOverState.Update(),a=this.getComponetById(this._options.baseOptions.ID).clone({ID:this._options.baseOptions.ID+"_DownState",color:this._options.baseOptions.downColor,strokeWidth:this._options.baseOptions.downStrokeWidth,strokeColor:this._options.baseOptions.downStrokeColor,zPos:"above "+this._options.baseOptions.ID,tabEnabled:"[%false]",initHidden:!0},!0),this._StaticDownState=D2LAdventureEngine.gu_ComponentManager.BuildComponent(a,this.location),
this.addComponet(this._StaticDownState,{inital:!0}),this._StaticDownState.Update()};c.prototype.comp_getWidth=function(){var a,b;if(!this._initialized&&void 0===this._options.initWidth){if(void 0===this._options.baseOptions)return this._ArbratraitedDimentions.width;b=D2LAdventureEngine.gu_ComponentManager.BuildComponent(this._options.baseOptions,this.location);a=b.getWidth().valueOf();b.Destroy();return a}return c.__super__.comp_getWidth.call(this)};c.prototype.comp_getHeight=function(){var a,b;if(!this._initialized&&
void 0===this._options.initHeight){if(void 0===this._options.baseOptions)return this._ArbratraitedDimentions.height;b=D2LAdventureEngine.gu_ComponentManager.BuildComponent(this._options.baseOptions,this.location);a=b.getHeight().valueOf();b.Destroy();return a}return c.__super__.comp_getHeight.call(this)};c.prototype.comp_destroy=function(a){this._StaticOverState.Hide();this._StaticDownState.Hide();return c.__super__.comp_destroy.call(this,a)};c.prototype.comp_Show=function(){this._StaticOverState.Hide();
this._StaticDownState.Hide();return c.__super__.comp_Show.call(this)};c.prototype.comp_HandleMouseOver=function(a){"Shape"===this._BaseType&&(this._StaticOverState.Show(),this._TextRef.SetZPos("top"));return c.__super__.comp_HandleMouseOver.call(this,a)};c.prototype.comp_HandleMouseOut=function(a){"Shape"===this._BaseType&&(this._StaticOverState.Hide(),this._StaticDownState.Hide());return c.__super__.comp_HandleMouseOut.call(this,a)};c.prototype.comp_HandlePress=function(a){"Shape"===this._BaseType&&
(this._StaticOverState.Hide(),this._StaticDownState.Show());return c.__super__.comp_HandlePress.call(this,a)};c.prototype.comp_HandleMouseUp=function(a){"Shape"===this._BaseType&&(this._StaticDownState.Hide(),this._MouseOver&&this.isUnderCheck(a)&&this._enabled&&this._StaticOverState.Show());return c.__super__.comp_HandleMouseUp.call(this,a)};c.prototype.comp_Disable=function(a){this._options.useCursor="default";this.SetAlpha(.5);return c.__super__.comp_Disable.call(this,a)};c.prototype.comp_Enable=
function(a){this._options.useCursor="pointer";this.SetAlpha(1);return c.__super__.comp_Enable.call(this,a)};c.prototype.comp_BuildAccessContext=function(){D2LAdventureEngine.gu_ScreenReaderHelper.AddReadText(this._id,this._options.useContext,"button",this._options.useContextParent,{events:{onClick:"D2LAdventureEngine.gu_ComponentManager.FindExistingComp('"+this._id+"').HandlePress()"}});if(this._options.initHidden||this._options.initDisabled)return D2LAdventureEngine.gu_ScreenReaderHelper.HideReadText(this._id)};
return c}(D2LAdventureEngine.comp_Group);window.D2LAdventureEngine.comp_UDC=function(h){function c(a,b,l){this._id=a;this.location=b;this._options=l;this.HandleUnfocus=d(this.HandleUnfocus,this);this.comp_HandleFocus=d(this.comp_HandleFocus,this);this.SelectionToggle=d(this.SelectionToggle,this);this.Deselect=d(this.Deselect,this);this.Select=d(this.Select,this);this.comp_HandlePress=d(this.comp_HandlePress,this);this.comp_Hide=d(this.comp_Hide,this);this.comp_Show=d(this.comp_Show,this);this.comp_Update=
d(this.comp_Update,this);this.comp_Resize=d(this.comp_Resize,this);this.SetLable=d(this.SetLable,this);this.SetOutline=d(this.SetOutline,this);this.comp_Init=d(this.comp_Init,this);this.comp_HandleDragging=d(this.comp_HandleDragging,this);this.DeleteUDC=d(this.DeleteUDC,this);this.comp_AssessDefaultOptions=d(this.comp_AssessDefaultOptions,this);this._options||(this._options={overflow:"hidden",useDeleteButton:!1,deleteButtonOptions:!1,buttonPostion:"topRight",overflow:"visible",deselectComp:void 0,
outlineSettings:{showOutline:!0,showLabel:!0,interfaceColor:"#FF0000",strokeWidth:2,strokeDash:[5,2]},constrainToRect:void 0});c.__super__.constructor.call(this,this._id,this.location,this._options);this._inheritanceChain.push(D2LAdventureEngine.comp_Group)}q(c,h);c.prototype._focusOutline=void 0;c.prototype._focusLable=void 0;c.prototype._Selected=!1;c.prototype._deselectionCompRef=void 0;c.prototype._deleteButtonData=void 0;c.prototype._deleteButton=void 0;c.prototype.comp_AssessDefaultOptions=
function(){var a;this._options.overflow="visible";this._options.draggable=!1;this._options.interactive=!0;this._options.tabEnabled=!0;void 0===this._options.useCursor&&(this._options.useCursor="pointer");void 0===this._options.outlineSettings?this._options.outlineSettings={showOutline:!0,showLabel:!0,interfaceColor:"#FF0000"}:(void 0===this._options.outlineSettings.showOutline&&(this._options.outlineSettings.showOutline=!0),void 0===this._options.outlineSettings.showLabel&&(this._options.outlineSettings.showLabel=
!0),void 0===this._options.outlineSettings.interfaceColor&&(this._options.outlineSettings.interfaceColor="#FF0000"));void 0===this._options.deselectComp||"self"===this._options.deselectComp?this._deselectionCompRef=this:D2LAdventureEngine.gu_StateManager.findComponent(this._options.deselectComp)?this._deselectionCompRef=D2LAdventureEngine.gu_StateManager.findComponent(this._options.deselectComp):(D2LAdventureEngine.gu_debugManager.log("deselectComp "+this._options.deselectComp+" in "+this._id+" was not found, using 'self'"),
this._deselectionCompRef=this);a={trigger:"onclick",effects:this.Deselect,isDefault:!0,owner:this._deselectionCompRef};D2LAdventureEngine.gu_EventManager.CheckEventsExsistance(a)||this._assignedEvents.push(D2LAdventureEngine.gu_EventManager.NewEvent(a));void 0===this._options.useDeleteButton&&(this._options.useDeleteButton=!1);void 0===this._options.deleteButtonOptions&&(this._options.deleteButtonOptions={});this._options.useDeleteButton&&(this._deleteButtonData=this._options.deleteButtonOptions,
this._deleteButtonData.ID=this._id+"_delBtn",this._deleteButtonData.Type||(this._deleteButtonData.Type="Button"),this._deleteButtonData.interactive=!0,void 0===this._deleteButtonData.events&&(this._deleteButtonData.events={}),!0===this._deleteButtonData.tabEnabled&&void 0===this._deleteButtonData.initTabPos&&(this._deleteButtonData.initTabPos="after "+this._id,this._deleteButtonData.events.onDeselect&&(this._deleteButtonData.events.onDeselect=this.Deselect)),void 0===this._deleteButtonData.events.onClick&&
(this._deleteButtonData.events.onClick=this.DeleteUDC));return c.__super__.comp_AssessDefaultOptions.call(this)};c.prototype.DeleteUDC=function(){if(this.topGroup)return this.topGroup.removeComponet(this._id,!0),this.Destroy()};c.prototype.comp_HandleDragging=function(){var a;a=this._options.constrainToRect;if(void 0===a){if(0>this.x?this.Move(0,this.y):this.topGroup&&this.x>this.topGroup.getWidth()-this._focusOutline.getWidth()&&this.Move(this.topGroup.getWidth()-this._focusOutline.getWidth(),this.y),
0>this.y?this.Move(this.x,0):this.y>this.topGroup.getHeight()-this._focusOutline.getHeight()&&this.Move(this.x,this.topGroup.getHeight()-this._focusOutline.getHeight()),this.topGroup&&this.x+this.getWidth()>this.x+this.topGroup.getWidth())return a=this.getWidth()-this._focusOutline.getWidth(),this._deleteButton.Move(this.getWidth()-a,this.y)}else return this.x<a.x?this.Move(a.x,this.y):this.topGroup&&this.x>a.x+a.width-this._focusOutline.getWidth()&&this.Move(a.x+a.width-this._focusOutline.getWidth(),
this.y),this.y<a.y?this.Move(this.x,a.y):this.y>a.y+a.height-this._focusOutline.getHeight()&&this.Move(this.x,a.y+a.height-this._focusOutline.getHeight()),this.topGroup&&this.x+this._focusOutline.getWidth()+this._deleteButton.getWidth()/2>a.x+a.width?this._deleteButton.Move(this._focusOutline.getWidth()-this._deleteButton.getWidth()/2+5,0):this._deleteButton.Move(this._focusOutline.getWidth()+5,0)};c.prototype.comp_Init=function(){c.__super__.comp_Init.call(this);this.SetOutline();if(this._options.outlineSettings.showLabel)return this.SetLable()};
c.prototype.SetOutline=function(){var a;a={ID:this._id+"_SelOutline",Type:"Shape - Rectangle",initHidden:!0,strokeWidth:this._options.outlineSettings.strokeWidth,strokeColor:this._options.outlineSettings.interfaceColor,strokeDash:this._options.outlineSettings.strokeDash,color:"rgba(0,0,0,0)",rect:{x:-5,y:-5,width:this.width+10,height:this.height+10}};this._options.outlineSettings.showOutline||(a.initHidden=!0);this._focusOutline&&this.removeChild(this._focusOutline);this._focusOutline=D2LAdventureEngine.gu_ComponentManager.BuildComponent(a,
this.location);return this.addChild(this._focusOutline)};c.prototype.SetLable=function(){this._focusLable=D2LAdventureEngine.gu_ComponentManager.BuildComponent({ID:this._id+"_focusLable",Type:"Text",initHidden:!0,"static":!0,color:this._options.outlineSettings.interfaceColor,InitText:this._id,sizeBoost:-4,initX:0,initY:-10},this.location);return this.addChild(this._focusLable)};c.prototype.comp_Resize=function(a,b){this.width=a;this.height=b;this.DetermineDimentions();this._initialized&&this.SetOutline();
return this.Update()};c.prototype.comp_Update=function(a){this._initialized&&(this._focusOutline&&this._focusOutline.Update(a),this._focusLable&&this._focusLable.Update(a));return c.__super__.comp_Update.call(this,a)};c.prototype.comp_Show=function(a){c.__super__.comp_Show.call(this,a);if(!this._Selected&&void 0!==this._deleteButton)return this._deleteButton.Hide()};c.prototype.comp_Hide=function(a){return c.__super__.comp_Hide.call(this,a)};c.prototype.comp_HandlePress=function(a){this.Select();
return c.__super__.comp_HandlePress.call(this,a)};c.prototype.Select=function(){if(!this._Selected)return D2LAdventureEngine.gu_ComponentManager.DeselectAllUDCs(),this._Selected=!0,this._focusOutline&&this._options.outlineSettings.showOutline&&this._focusOutline.Show(),this._focusLable&&this._focusLable.Show(),this._options.useDeleteButton&&(this._deleteButton=this.addComponet(D2LAdventureEngine.gu_ComponentManager.BuildComponent(this._deleteButtonData,this.location)),this._deleteButton.Move(this.getWidth()-
this._deleteButton.getWidth(),0)),this.MakeDraggable(),D2LAdventureEngine.gu_KeyManager.ActivateKey("delSelectedUDS",46,{pressFunctionRef:D2LAdventureEngine.gu_ComponentManager.DeleteSelectedUDC,downFunctionRef:D2LAdventureEngine.gu_ComponentManager.DeleteSelectedUDC}),D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onselect")};c.prototype.Deselect=function(){if(this._Selected)return this._Selected=!1,this._focusOutline&&this._focusOutline.Hide(),this._focusLable&&this._focusLable.Hide(),this._options.useDeleteButton&&
this.removeComponet(this._deleteButton._id),this._tabOutline&&this._tabOutline.Hide(),this.MakeUndraggable(),D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"ondeselect")};c.prototype.SelectionToggle=function(a){return this._Selected?this.Deselect():this.Select()};c.prototype.comp_HandleFocus=function(a){this.Select();if(this._deleteButton&&this._deleteButtonData.tabEnabled)return D2LAdventureEngine.gu_TabManager.ForceRefIndex(this._deleteButton._id,-1)};c.prototype.HandleUnfocus=function(a){!0!==
this._deleteButtonData.tabEnabled?this.Deselect():this._deleteButton&&(D2LAdventureEngine.gu_TabManager.UnassignAccessObject(this._deleteButton._id),this._deleteButton.Update(),this._deleteButton._accessInitialized=!0,this._deleteButton.BuildTabOutline(),this._deleteButton._tabOutline.visible=!0);if(this._tabOutline)return this._tabOutline.visible=!1};return c}(D2LAdventureEngine.comp_Group);window.D2LAdventureEngine.comp_ToggleCluster=function(h){function c(a,b,l){this._id=a;this.location=b;this._options=
l;this.SortClusterLayers=d(this.SortClusterLayers,this);this.SelectToggle=d(this.SelectToggle,this);this.DeselectToggles=d(this.DeselectToggles,this);this.getSelectedToggle=d(this.getSelectedToggle,this);this.HandelToggleSelection=d(this.HandelToggleSelection,this);this.AddToggle=d(this.AddToggle,this);this.AddInitToggles=d(this.AddInitToggles,this);this.comp_AssessDefaultOptions=d(this.comp_AssessDefaultOptions,this);this._options||(this._options={InitToggles:void 0,DefaultSelection:"none"});this._options.initContent=
this._options.InitToggles;c.__super__.constructor.call(this,this._id,this.location,this._options);this._inheritanceChain.push(D2LAdventureEngine.comp_Group)}q(c,h);c.prototype.comp_AssessDefaultOptions=function(){this.AddInitToggles();this._options.interactive=!1;this._options.tabEnabled=!1;return c.__super__.comp_AssessDefaultOptions.call(this,!0)};c.prototype.AddInitToggles=function(){var a,b,c;if(void 0!==this._options.InitToggles){if(this._options.InitToggles.constructor!==Array)if(this._options.InitToggles.constructor===
D2LAdventureEngine.comp_Toggle||"object"===typeof this._options.InitToggles&&"Toggle"===this._options.InitToggles.Type)this._options.InitToggles=[this._options.InitToggles];else return D2LAdventureEngine.gu_debugManager.log("WARNING: the InitToggles value for toggle cluster "+this._id+" was not an Array or comp_Toggle object and will be ignored.");for(b=0;b<this._options.InitToggles.length;)this._options.InitToggles[b].constructor===D2LAdventureEngine.comp_Toggle?(b=0,a=this._options.InitToggles[b].clone({ClusterIndex:b},
!0),a=D2LAdventureEngine.gu_ComponentManager.BuildComponent(a,this.location),a._idInCluster=this._options.InitToggles[b].ID,c=b.valueOf(),this._options.InitToggles[b].ClusterIndex?c=this._options.InitToggles[b].ClusterIndex:this._options.InitToggles[b]._options&&this._options.InitToggles[b]._options.ClusterIndex&&(c=this._options.InitToggles[b]._options.ClusterIndex),D2LAdventureEngine.gu_EventManager.NewEvent({trigger:"onclick",effects:this.HandelToggleSelection,effectParams:c,isDefault:!0,owner:a}),
this.addComponet(a)):"object"===typeof this._options.InitToggles[b]&&"Toggle"===this._options.InitToggles[b].Type?(a=this._options.InitToggles[b],a.ClusterIndex=b.valueOf(),a.events||(a.events={}),a.events.onClick=this.HandelToggleSelection,a.events.onClickData=b.valueOf(),a=D2LAdventureEngine.gu_ComponentManager.BuildComponent(a,this.location),a._idInCluster=this._options.InitToggles[b].ID,c=b.valueOf(),this._options.InitToggles[b].ClusterIndex?c=this._options.InitToggles[b].ClusterIndex:this._options.InitToggles[b]._options&&
this._options.InitToggles[b]._options.ClusterIndex&&(c=this._options.InitToggles[b]._options.ClusterIndex),D2LAdventureEngine.gu_EventManager.NewEvent({trigger:"onclick",effects:this.HandelToggleSelection,effectParams:c,isDefault:!0,owner:a}),this.addComponet(a)):D2LAdventureEngine.gu_debugManager.log("WARNING: the InitToggles value for toggle cluster "+b+":  "+this._id+" was not a Toggle object and will be ignored."),b++}if(void 0!==this._options.DefaultSelection&&"none"!==this._options.DefaultSelection)if(this._options.DefaultSelection.constructor===
Number)this.groupedComponets[this._options.DefaultSelection]._options.startActive=!0,this._selectedTogIndex=this._options.DefaultSelection;else{if(this._options.DefaultSelection.constructor===String)for(b=0;b<this.groupedComponets.length;)this.groupedComponets[b]._idInCluster===this._options.DefaultSelection&&(this.groupedComponets[b]._initialized&&this.groupedComponets[b].Activate(),this.groupedComponets[b]._options.startActive=!0,this._selectedTogIndex=b),b++}else this._selectedTogIndex=void 0;
return this._selectionMade=!1};c.prototype.AddToggle=function(a){var b;if(void 0!==a){if(a.constructor===D2LAdventureEngine.comp_Toggle){if(this.getComponetById(a._id))return D2LAdventureEngine.gu_debugManager.log("WARNING: Attempted to add duplicate Comp "+a._id+" to togCluster "+this._id),!1;a.Deactivate();a._options.ClusterIndex=this.groupedComponets.length;D2LAdventureEngine.gu_EventManager.NewEvent({trigger:"onclick",effects:this.HandelToggleSelection,effectParams:a._options.ClusterIndex,isDefault:!0,
owner:a});a._idInCluster=a.ID;return this.addComponet(a)}if(a.constructor===String){if(this.getComponetById(a))return D2LAdventureEngine.gu_debugManager.log("WARNING: Attempted to add duplicate Comp "+a._id+" to togCluster "+this._id),!1;if(void 0!==this.parentScene&&null!==this.parentScene&&void 0!==this.parentScene[a]&&this.parentScene[a].constructor===D2LAdventureEngine.comp_Toggle)return b=a,a=this.parentScene[b].clone(),a.Deactivate(),a._options.ClusterIndex=this.groupedComponets.length,D2LAdventureEngine.gu_EventManager.NewEvent({trigger:"onclick",
effects:this.HandelToggleSelection,effectParams:a._options.ClusterIndex,isDefault:!0,owner:a}),a._idInCluster=b,this.addComponet(a)}else if(a.constructor===Object)return a.startActive=!1,a.ClusterIndex=this.groupedComponets.length,b=D2LAdventureEngine.gu_ComponentManager.BuildComponent(a,this.location,this),D2LAdventureEngine.gu_EventManager.NewEvent({trigger:"onclick",effects:this.HandelToggleSelection,effectParams:a.ClusterIndex,isDefault:!0,owner:b}),b._idInCluster=a.ID,this.addComponet(b)}else return D2LAdventureEngine.gu_debugManager.log("ERROR!: AddToggle was called with no toggle set")};
c.prototype.HandelToggleSelection=function(a){var b;for(b=0;b<this.groupedComponets.length;)b===a.compRef._options.ClusterIndex?(this.groupedComponets[b].Activate(),this._selectedTogIndex=b):this.groupedComponets[b].Deactivate(),b++;D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onselection");return this._selectionMade=!0};c.prototype.getSelectedToggle=function(a){return this.groupedComponets[this._selectedTogIndex]};c.prototype.DeselectToggles=function(a){var b,c,e,f;c=this.groupedComponets;
e=[];a=0;for(b=c.length;a<b;a++)f=c[a],f.Deactivate?e.push(f.Deactivate()):e.push(void 0);return e};c.prototype.SelectToggle=function(a){var b;a.constructor===Number?b=this.groupedComponets[a]:a.constructor===String?b=this.getComponetById(a):a["this"].isTypeOf(D2LAdventureEngine.comp_Toggle)?b=this.getComponetById(a._id):a.constructor===Object&&a.ID&&(b=this.getComponetById(a.ID));return b?(a={compRef:b},this.HandelToggleSelection(a),b):!1};c.prototype.SortClusterLayers=function(){var a,b,c,e;c=this.groupedComponets;
a=0;for(b=c.length;a<b;a++)e=c[a],this.gcContainer.setChildIndex(e._options.ClusterIndex);this.groupedComponets.sort(function(a,b){return a._options.ClusterIndex-b._options.ClusterIndex});return this.groupedComponets};return c}(D2LAdventureEngine.comp_Group);window.D2LAdventureEngine.comp_QuizQuestion=function(h){function c(a,b,l){this._id=a;this.location=b;this._options=l;this.MakeAdjustments=d(this.MakeAdjustments,this);this.comp_Update=d(this.comp_Update,this);this.BuildContinuousReport=d(this.BuildContinuousReport,
this);this.isCorrect=d(this.isCorrect,this);this.DisplayQuestion=d(this.DisplayQuestion,this);this.DisplayContReport=d(this.DisplayContReport,this);this.HandleSelection=d(this.HandleSelection,this);this.HandleTextClick=d(this.HandleTextClick,this);this.BuildQuestionDom=d(this.BuildQuestionDom,this);this.BuildAnswerPool=d(this.BuildAnswerPool,this);this.Build=d(this.Build,this);this.comp_getHeight=d(this.comp_getHeight,this);this.comp_Init=d(this.comp_Init,this);this.comp_AssessDefaultOptions=d(this.comp_AssessDefaultOptions,
this);this._options||(this._options={QuizDataID:void 0,questionIndex:void 0,questionText:void 0,Answers:void 0,multiAnswer:void 0,toggleOptions:void 0,useToggleSound:void 0,useDetoggleSound:void 0,layoutStyle:void 0,buildReport:void 0,fullReports:void 0,forceCorrect:void 0,scoreValue:void 0,useResultIconSpriteAsset:void 0,textOptions:void 0});c.__super__.constructor.call(this,this._id,this.location,this._options);this._inheritanceChain.push(D2LAdventureEngine.comp_Group)}q(c,h);c.prototype._questionText=
void 0;c.prototype._questionToggleCluster=void 0;c.prototype._qSlideYoffset=void 0;c.prototype._answerPool=void 0;c.prototype._contReport=void 0;c.prototype._answers=void 0;c.prototype._currentAttemptData=void 0;c.prototype._alignmentNeeded=void 0;c.prototype.comp_AssessDefaultOptions=function(){this._qSlideYoffset=0;this._answers=[];this._attemptCount=0;void 0===this._options.QuizDataID&&(this._options.QuizDataID="unnamedQuiz");void 0===this._options.questionIndex&&(this._options.QuizDataID="unnamedQuiz");
void 0===this._options.questionText&&(this._options.questionText="undefined question");void 0===this._options.scoreValue&&(this._options.scoreValue=1);void 0===this._options.toggleOptions&&(this._options.toggleOptions={});this._options.overflow="hidden";this._options.tabEnabled=!0;void 0===this._options.textOptions&&(this._options.textOptions={question:{},answer:{},report:{}});void 0===this._options.useResultIconSpriteAsset&&(this._options.useResultIconSpriteAsset="qio_feedbackIcon");c.__super__.comp_AssessDefaultOptions.call(this);
return this._options.tabEnabled=!1};c.prototype.comp_Init=function(){this.Build();return c.__super__.comp_Init.call(this)};c.prototype.comp_getHeight=function(){if(this._initialized&&!this._alignmentNeeded){if(this._answerPool.isVisible())return this._answerPool.getHeight()+this._answerPool.y;if(this._contReport.isVisible())return this._contReport.getHeight()+this._contReport.y}return c.__super__.comp_getHeight.call(this)};c.prototype.Build=function(){this._currentAttemptData={quIndex:0,status:"unattempted",
score:0,maxScore:parseInt(this._options.scoreValue),feedback:"not attempted",attempts:1,allResponses:[]};this.BuildQuestionDom();this.BuildAnswerPool();if(this._options.buildReport)return this.BuildContinuousReport()};c.prototype.BuildAnswerPool=function(){var a,b,c,e,f,g,d,n;a={ID:this._id+"_answerPool",Type:"Group",tabEnabled:!1,clickAudioSFX:"none",initX:0,initY:0,initWidth:this.getWidth(),initContent:[]};f=[];c=1;n=this._options.Answers;g=0;for(d=n.length;g<d;g++)e=n[g],b=this._options.textOptions.answer?
D2LAdventureEngine.gu_DataManager.cloneDataObj(this._options.textOptions.answer):{},b.ID=this._id+"_A"+c,b.Type="Text",b.InitText=e.ansText,void 0===b.events&&(b.events={}),b.events.onClick=this.HandleTextClick,b.events.onClickData=c-1,this._options.textOptions.answer.classes?b.classes.push("AE_QuizAnswertext"):b.classes=["AE_QuizAnswertext"],this._options.textOptions.answer.initX||(b.initX=this.x+35),this._options.textOptions.answer.initY||(b.initY=-1E4),this._options.textOptions.answer.initWidth||
(b.initWidth=this.getWidth()-80),a.initContent.push(b.valueOf()),b=D2LAdventureEngine.gu_DataManager.cloneDataObj(this._options.toggleOptions),b.ID=this._id+"_Atog"+c,b.Type="Toggle",void 0===b.AssetID&&(b.AssetID="qio_radio"),b.initHidden=!0,f.push(b),c++;a.initContent.push({ID:this._id+"_AtogCluster",Type:"ToggleCluster",InitToggles:f,initX:10,onSelection:this.topGroup.onAnswerSelection,initTabPos:this._options.initTabPos});this._answerPool=D2LAdventureEngine.gu_ComponentManager.BuildComponent(a,
this.location);this.addComponet(this._answerPool);this._answerPool.Update();this._questionToggleCluster=this._answerPool.getComponetById(this._id+"_AtogCluster");f=this._options.Answers;c=[];a=0;for(f=f.length;a<f;a++)c.push(this._answers.push(this._answerPool.getComponetById(this._id+"_A"+(this._answers.length+1))));return c};c.prototype.BuildQuestionDom=function(){var a;a=this._options.textOptions.question?this._options.textOptions.question:{};a.ID=this._id+"_text";a.Type="Text";a.InitText=this._options.questionText;
this._options.textOptions.question.classes?a.classes.push("AE_QuizQuestionText"):a.classes=["AE_QuizQuestionText"];this._options.textOptions.question.initX||(a.initX=this.x);this._options.textOptions.question.initY||(a.initY=this._qSlideYoffset);this._options.textOptions.question.initWidth||(a.initWidth=this.getWidth()-30);this._options.textOptions.question.overflow||(a.overflow="hidden");this._options.textOptions.question.weight||(a.weight="bold");this._options.textOptions.question.interactive||
(a.interactive=!1);this._questionText=D2LAdventureEngine.gu_ComponentManager.BuildComponent(a,this.location);return this.addComponet(this._questionText)};c.prototype.HandleTextClick=function(a){return this._questionToggleCluster.SelectToggle(a.data)};c.prototype.HandleSelection=function(){var a;this._questionToggleCluster.DeselectToggles();this._currentAttemptData.attempts++;"unattempted"===this._currentAttemptData.status&&(this.isCorrect()?(this._currentAttemptData.status="correct",this._currentAttemptData.score=
parseInt(this._options.scoreValue)):(this._currentAttemptData.status="incorrect",this._currentAttemptData.score=0));a=this._options.Answers[this._questionToggleCluster._selectedTogIndex];this._currentAttemptData.latestAnswerValue=a.ansText;this._currentAttemptData.feedback=a.feedback;a={feedback:this._currentAttemptData.feedback,selectedAnswer:this._currentAttemptData.latestAnswerValue,status:"incorrect"};this.isCorrect()&&(a.status="correct");this._currentAttemptData.allResponses.push(a);return this.DisplayContReport()};
c.prototype.DisplayContReport=function(){var a,b,c;this._contReport.Show();this._answerPool.Hide();a=this.getComponetById(this._id+"_cRep_icon");c=this.getComponetById(this._id+"_cRep_info");b=this._options.Answers[this._questionToggleCluster._selectedTogIndex];this.isCorrect()?(a.play("check"),b.feedback?c.ChangeText(b.feedback):c.ChangeText("Correct")):(a.play("cross"),b.feedback?c.ChangeText(b.feedback):c.ChangeText("Incorrect"));this._contReport.ExpandToFit("height");this.Resize(this.getWidth(),
this.getHeight());this.topGroup._reportOpen=!0;this.topGroup.HandleReportEvent()};c.prototype.DisplayQuestion=function(){this.topGroup._reportOpen=!1;this._contReport.Hide();this._answerPool.Show();return this.Resize(this.getWidth(),this.getHeight())};c.prototype.isCorrect=function(){return this._options.Answers[this._questionToggleCluster._selectedTogIndex].isCorrect};c.prototype.BuildContinuousReport=function(){var a;a={ID:this._id+"_cRep",Type:"Group",initX:10,initY:0,initWidth:this.getWidth()-
30,initHidden:!0,overflow:"hidden",tabEnabled:!1,initContent:[{ID:this._id+"_cRep_icon",Type:"Sprite",AssetID:this._options.useResultIconSpriteAsset,initX:0,initY:this._qSlideYoffset,tabEnabled:!1,initWidth:40},{ID:this._id+"_cRep_info",Type:"Text",initX:40,initY:this._qSlideYoffset,InitText:"REPORT TEXT",initWidth:this.getWidth()-80}]};this._contReport=D2LAdventureEngine.gu_ComponentManager.BuildComponent(a,this.location);return this.addComponet(this._contReport)};c.prototype.comp_Update=function(a){void 0===
this._alignmentNeeded&&this._questionText&&this._questionText.built&&(this._alignmentNeeded=!0);return c.__super__.comp_Update.call(this,a)};c.prototype.MakeAdjustments=function(){var a,b,c;if(this._alignmentNeeded&&this._questionText&&this._questionText.built){this._qSlideYoffset=this._questionText.getHeight()+10;this._contReport.Move(5,this._qSlideYoffset+5);this._answerPool.Move(0,this._qSlideYoffset);for(a=0;a<this._answers.length;)this._answers[a].Move(this._answers[a].x,this._qSlideYoffset+
this._globalPos.y),c=this._questionToggleCluster.groupedComponets[a],b=Math.abs(this._answers[a].getHeight()-c.getHeight()),b=this._qSlideYoffset-(this._questionText.getHeight()+10)+b/2,c.Move(5,b),D2LAdventureEngine.gu_TabManager.ChangeTabbingPostion(c._id,this._options.initTabPos),this._qSlideYoffset+=this._answers[a].getHeight()+10,c.isVisible()||c.Show(),a++;this._questionToggleCluster.DetermineDimentions();this._answerPool.DetermineDimentions();this._answerPool.ExpandToFit("height");this.DetermineDimentions();
this.ExpandToFit("height");return this._alignmentNeeded=!1}};return c}(D2LAdventureEngine.comp_Group);window.D2LAdventureEngine.comp_Quiz=function(h){function c(a,b,l){this._id=a;this.location=b;this._options=l;this.comp_Show=d(this.comp_Show,this);this.BuildEndNotice=d(this.BuildEndNotice,this);this.BuildSummativeReport=d(this.BuildSummativeReport,this);this.RetryQuestion=d(this.RetryQuestion,this);this.CheckAnswer=d(this.CheckAnswer,this);this.SubmitQuiz=d(this.SubmitQuiz,this);this.GotoQuestion=
d(this.GotoQuestion,this);this.onAnswerSelection=d(this.onAnswerSelection,this);this.BuildSpacerPixel=d(this.BuildSpacerPixel,this);this.SetButtons=d(this.SetButtons,this);this.UpdateQuestionIndexDom=d(this.UpdateQuestionIndexDom,this);this.BuildQuestionIndexDom=d(this.BuildQuestionIndexDom,this);this.BuildTitleDom=d(this.BuildTitleDom,this);this.GetQuestionHeight=d(this.GetQuestionHeight,this);this.AdjustButtons=d(this.AdjustButtons,this);this.HandleReportEvent=d(this.HandleReportEvent,this);this.MakeAdjustments=
d(this.MakeAdjustments,this);this.BuildQuestions=d(this.BuildQuestions,this);this.Build=d(this.Build,this);this.RetriveQuizData=d(this.RetriveQuizData,this);this.ChangeData=d(this.ChangeData,this);this.comp_Update=d(this.comp_Update,this);this.comp_Init=d(this.comp_Init,this);this.comp_AssessDefaultOptions=d(this.comp_AssessDefaultOptions,this);this._options||(this._options={QuizDataID:void 0,allowPrevious:void 0,reportStyle:void 0,fullReports:void 0,textOptions:void 0,buttonOptions:void 0,toggleOptions:void 0,
allowRepeat:void 0,allowHints:void 0,forceCorrect:void 0,useResultIconSpriteAsset:void 0,onComplete:void 0,onCompleteData:void 0,onPass:void 0,onPassData:void 0,onFail:void 0,onFailData:void 0,onReport:void 0,onReportData:void 0,onRetry:void 0,onRetryData:void 0,onAdjust:void 0,onAdjustData:void 0});this._qMan=D2LAdventureEngine.gu_QuizManager;this._CurrentQuestionIndex=0;this._buttons=[];this._adjustmentHiding=this._alignmentNeeded=!1;c.__super__.constructor.call(this,this._id,this.location,this._options);
this._inheritanceChain.push(D2LAdventureEngine.comp_Group)}q(c,h);c.prototype._setQuiz=void 0;c.prototype._questions=void 0;c.prototype._CurrentQuestionIndex=void 0;c.prototype._titleText=void 0;c.prototype._CurrentQuestionIndexText=void 0;c.prototype._qMan=void 0;c.prototype._qSlideYoffset=void 0;c.prototype._buttons=void 0;c.prototype._alignmentNeeded=void 0;c.prototype._adjustmentHiding=void 0;c.prototype._spacerPixel=void 0;c.prototype._attemptData=void 0;c.prototype._reportOpen=void 0;c.prototype.comp_AssessDefaultOptions=
function(){this._qSlideYoffset=0;this._questions=[];void 0===this._options.QuizDataID?(D2LAdventureEngine.gu_debugManager.log("ERROR nameless quiz provided, using fall-back"),this._options.QuizDataID="unnamedQuiz"):this.RetriveQuizData();void 0===this._options.reportStyle&&(this._options.reportStyle="continuous");void 0===this._options.tabEnabled&&(this._options.tabEnabled=!1);this._options.clickAudioSFX="none";void 0===this._options.buttonOptions&&(this._options.buttonOptions={PreviousButton:{},
NextButton:{},CheckButton:{},RetryButton:{},SubmitButton:{},HintButton:{}});void 0===this._options.useResultIconSpriteAsset&&(this._options.useResultIconSpriteAsset="qio_feedbackIcon");return c.__super__.comp_AssessDefaultOptions.call(this)};c.prototype.comp_Init=function(){this.Build();return c.__super__.comp_Init.call(this)};c.prototype.comp_Update=function(){var a,b,d,e;this._alignmentNeeded=!1;e=this._questions;a=0;for(b=e.length;a<b;a++)if(d=e[a],d._alignmentNeeded){this._alignmentNeeded=!0;
break}this._alignmentNeeded&&this.MakeAdjustments();return c.__super__.comp_Update.call(this)};c.prototype.ChangeData=function(a){var b,c,e,f;if(this._setQuiz.ID!==a){this._options.QuizDataID=a;this._currentAttemptData={quizID:this._options.QuizDataID,questions:[],status:"uncompleted",score:0,feedback:this._options.uncompletedMessage||this._setQuiz.uncompletedMessage,qIndex:this._qMan.assignQuizID(this.id),startTime:(new Date).getTime()};if(this._defined){this.RetriveQuizData();f=this._questions;
b=0;for(c=f.length;b<c;b++)e=f[b],this.removeComponet(e._id);this._questions=[];this._CurrentQuestionIndex=this._qSlideYoffset=0;this.Update();this._titleText&&this._titleText.ChangeText("<h2 class='AE_QuizTitle'>"+a+"</h2>");this.BuildQuestions()}b=this.getComponetById(this._id+"_NextButton");c=this.getComponetById(this._id+"_SubmitButton");a=this.getComponetById(this._id+"_CheckButton");1===this._questions.length&&"report"===this._options.reportStyle?b.Show():1!==this._questions.length||"report"===
this._options.reportStyle?c.Show():1===this._questions.length&&"continuous"===this._options.reportStyle&&a.Show();return this._qMan.SubmitQuizAttempt(this._currentAttemptData)}};c.prototype.RetriveQuizData=function(){this._setQuiz=this._qMan.GetQuizData(this._options.QuizDataID);if(!this._setQuiz)return D2LAdventureEngine.gu_debugManager.log("ERROR Provided quiz ID "+this._options.QuizDataID+" was not found in global quiz data, using fall-back"),this._options.QuizDataID="unnamedQuiz",this.RetriveQuizData()};
c.prototype.Build=function(){this._adjustmentHiding=!0;this._currentAttemptData={quizID:this._options.QuizDataID,questions:[],status:"uncompleted",score:0,feedback:this._options.uncompletedMessage||this._setQuiz.uncompletedMessage,qIndex:this._qMan.assignQuizID(this._id),startTime:(new Date).getTime()};this._initialized?this.isVisible()&&(this._adjustmentHiding=!0,this.Hide()):this._options.initHidden||(this._options.initHidden=!0);this._options.HideTitle||this.BuildTitleDom();this._options.HideQuestionNumber||
this.BuildQuestionIndexDom();this.BuildSpacerPixel();this.BuildQuestions();this._qSlideYoffset+=this._questions[0].getHeight();this.SetButtons(0);return this._qMan.SubmitQuizAttempt(this._currentAttemptData)};c.prototype.BuildQuestions=function(){var a,b,c;a=0;for(c=[];a<this._setQuiz.Questions.length;)b=this._setQuiz.Questions[a],b.ID=this._id+"_Q"+a,b.questionIndex=a,b.Type="QuizQuestion",b.initX=10,b.initY=this._qSlideYoffset,b.initWidth=this.getWidth()-10,b.toggleOptions=this._options.toggleOptions,
b.initTabPos=this._options.initTabPos,b.textOptions=this._options.textOptions,b.scoreValue=this._setQuiz.Questions[a].scoreValue,b.useResultIconSpriteAsset=this._options.useResultIconSpriteAsset,0!==a&&(b.initHidden=!0),"continuous"===this._options.reportStyle&&(b.buildReport=!0),this._questions[a]=D2LAdventureEngine.gu_ComponentManager.BuildComponent(b,this.location),this.addComponet(this._questions[a]),this._questions[a]._currentAttemptData.quIndex=a,this._currentAttemptData.questions.push(this._questions[a]._currentAttemptData),
c.push(a++);return c};c.prototype.MakeAdjustments=function(){var a,b,c,e,f,g,d,n;e=this._questions;a=0;for(c=e.length;a<c;a++)b=e[a],b.MakeAdjustments();f=this.GetQuestionHeight();e=this._buttons;a=0;for(c=e.length;a<c;a++)b=e[a],b.Move(b.x,f+10);this._spacerPixel.Move(0,this._buttons[0].getHeight()+this._buttons[0].y+10);this.DetermineDimentions();this.height>this.getHeight()&&this.buildMask();d=this._questions;f=0;for(c=d.length;f<c;f++){b=d[f];n=b._answers;g=0;for(e=n.length;g<e;g++)a=n[g],D2LAdventureEngine.gu_ClippingRuleManager.CheckClippingRules(a);
D2LAdventureEngine.gu_ClippingRuleManager.CheckClippingRules(b)}D2LAdventureEngine.gu_ClippingRuleManager.CheckClippingRules(this);this._alignmentNeeded=!1;this._adjustmentHiding&&(this._adjustmentHiding=!1,this.Show());this.AdjustButtons();return D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onadjust")};c.prototype.HandleReportEvent=function(){var a;a={compRef:this,data:this._options.onReportData,interactionType:"onReport"};if(void 0!==this._options.onReport){if(this._options.onReport.constructor===
Function)return this._options.onReport(a);if(this._options.onReport.constructor===String)return D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(this._options.onReport,a)}};c.prototype.AdjustButtons=function(){var a,b,c,e;this.ResetScrollPos();e=this._buttons;b=0;for(c=e.length;b<c;b++)a=e[b],a.Move(a.x,this._questions[this._CurrentQuestionIndex].getHeight()+this._questions[this._CurrentQuestionIndex].y+20),D2LAdventureEngine.gu_TabManager.ChangeTabbingPostion(a._id,this._options.initTabPos);
this._spacerPixel.Move(0,this._buttons[0].getHeight()+this._buttons[0].y+10);if(this.BaseOptionsData.initHeight)return this.DetermineDimentions(),this._spacerPixel.y<this.BaseOptionsData.initHeight?this.ExpandToFit("height"):this.Resize(this.getWidth(),this.BaseOptionsData.initHeight)};c.prototype.GetQuestionHeight=function(){var a,b,c,e,f;a=[];f=this._questions;b=0;for(c=f.length;b<c;b++)e=f[b],e.getHeight&&!1!==e.getHeight()&&a.push(e.getHeight());return Math.max.apply(null,a)};c.prototype.BuildTitleDom=
function(){var a;a={ID:this._id+"_QuizTitle",Type:"Text",InitText:"<h2 class='AE_QuizTitle'>"+this._options.QuizDataID+"</h2>",initX:0,initY:this._qSlideYoffset,initWidth:this.getWidth(),initHeight:60,interactive:!1,overflow:"hidden"};this._titleText=D2LAdventureEngine.gu_ComponentManager.BuildComponent(a,this.location);this.addComponet(this._titleText);return this._qSlideYoffset+=50};c.prototype.BuildQuestionIndexDom=function(){var a;a={ID:this._id+"_QuizCurrQuestionText",Type:"Text",InitText:this._qMan._QuizOptions.langQuestion+
": "+(this._CurrentQuestionIndex+1)+" "+this._qMan._QuizOptions.langOf+" "+this._setQuiz.Questions.length,initX:0,initY:this._qSlideYoffset,initWidth:this.getWidth(),initHeight:20,interactive:!1,overflow:"hidden"};this._CurrentQuestionIndexText=D2LAdventureEngine.gu_ComponentManager.BuildComponent(a,this.location);this.addComponet(this._CurrentQuestionIndexText);return this._qSlideYoffset+=30};c.prototype.UpdateQuestionIndexDom=function(){return this._CurrentQuestionIndexText.ChangeText(this._qMan._QuizOptions.langQuestion+
": "+this._CurrentQuestionIndex+" "+this._qMan._QuizOptions.langOf+" "+this._setQuiz.Questions.length)};c.prototype.SetButtons=function(a){var b,c;c=20;this._options.allowPrevious&&(b=this._options.buttonOptions.PreviousButton,void 0===b&&(b={}),b.ID=this._id+"_PreviousButton",b.initX=c,b.initY=a,void 0===b.Type&&(b.Type="LabeledButton"),void 0===b.InitText&&(b.InitText="Previous"),void 0===b.outOnClick&&(b.outOnClick=!0),void 0===b.initWidth&&(b.initWidth=100),void 0===b.events&&(b.events={}),void 0===
b.events.onClick&&(b.events.onClick=this.GotoQuestion),void 0===b.events.onClickData&&(b.events.onClickData="Previous"),this._buttons.push(D2LAdventureEngine.gu_ComponentManager.BuildComponent(b,this.location)),this.addComponet(this._buttons[this._buttons.length-1]),c+=this._buttons[this._buttons.length-1].getWidth()+10);b=this._options.buttonOptions.NextButton;void 0===b&&(b={});b.ID=this._id+"_NextButton";b.initX=c;b.initY=a;void 0===b.Type&&(b.Type="LabeledButton");void 0===b.InitText&&(b.InitText=
"Next");void 0===b.outOnClick&&(b.outOnClick=!0);void 0===b.initWidth&&(b.initWidth=100);void 0===b.initDisabled&&(b.initDisabled=!0);void 0===b.events&&(b.events={});void 0===b.events.onClick&&(b.events.onClick=this.GotoQuestion);void 0===b.events.onClickData&&(b.events.onClickData="Next");1===this._questions.length&&(b.initHidden=!0);this._buttons.push(D2LAdventureEngine.gu_ComponentManager.BuildComponent(b,this.location));this.addComponet(this._buttons[this._buttons.length-1]);b=this._options.buttonOptions.CheckButton;
void 0===b&&(b={});b.ID=this._id+"_CheckButton";b.initX=c;b.initY=a;void 0===b.Type&&(b.Type="LabeledButton");void 0===b.InitText&&(b.InitText="Check Answer");void 0===b.outOnClick&&(b.outOnClick=!0);void 0===b.initWidth&&(b.initWidth=140);void 0===b.initDisabled&&(b.initDisabled=!0);void 0===b.events&&(b.events={});void 0===b.events.onClick&&(b.events.onClick=this.CheckAnswer);1===this._questions.length&&"continuous"!==this._options.reportStyle&&(b.initHidden=!0);this._buttons.push(D2LAdventureEngine.gu_ComponentManager.BuildComponent(b,
this.location));this.addComponet(this._buttons[this._buttons.length-1]);b=this._options.buttonOptions.RetryButton;void 0===b&&(b={});b.ID=this._id+"_RetryButton";b.initX=c;b.initY=a;b.initHidden=!0;void 0===b.Type&&(b.Type="LabeledButton");void 0===b.InitText&&(b.InitText="Try Again");void 0===b.outOnClick&&(b.outOnClick=!0);void 0===b.initWidth&&(b.initWidth=120);void 0===b.events&&(b.events={});void 0===b.events.onClick&&(b.events.onClick=this.RetryQuestion);this._buttons.push(D2LAdventureEngine.gu_ComponentManager.BuildComponent(b,
this.location));this.addComponet(this._buttons[this._buttons.length-1]);b=this._options.buttonOptions.SubmitButton;void 0===b&&(b={});b.ID=this._id+"_SubmitButton";b.initX=c;b.initY=a;void 0===b.Type&&(b.Type="LabeledButton");void 0===b.InitText&&(b.InitText="Submit");void 0===b.outOnClick&&(b.outOnClick=!0);void 0===b.initWidth&&(b.initWidth=100);void 0===b.initDisabled&&(b.initDisabled=!0);void 0===b.events&&(b.events={});void 0===b.events.onClick&&(b.events.onClick=this.SubmitQuiz);if(1!==this._questions.length||
"continuous"===this._options.reportStyle)b.initHidden=!0;this._buttons.push(D2LAdventureEngine.gu_ComponentManager.BuildComponent(b,this.location));this.addComponet(this._buttons[this._buttons.length-1]);c+=this._buttons[this._buttons.length-1].getWidth()+10;b=this._options.buttonOptions.HintButton;void 0===b&&(b={});b.ID=this._id+"_HintButton";b.initX=c;b.initY=a;b.initHidden=!0;void 0===b.Type&&(b.Type="LabeledButton");void 0===b.InitText&&(b.InitText="Hint");void 0===b.outOnClick&&(b.outOnClick=
!0);void 0===b.initWidth&&(b.initWidth=100);void 0===b.initDisabled&&(b.initDisabled=!0);this._buttons.push(D2LAdventureEngine.gu_ComponentManager.BuildComponent(b,this.location));return this.addComponet(this._buttons[this._buttons.length-1])};c.prototype.BuildSpacerPixel=function(){this._spacerPixel=D2LAdventureEngine.gu_ComponentManager.BuildComponent({ID:this._id+"_spacerPixel",AssetID:"TransPixel",Type:"Bitmap",initX:0,initY:0,initHidden:!0,interactive:!1},this.location);return this.addComponet(this._spacerPixel)};
c.prototype.onAnswerSelection=function(a){var b,c;a.compRef.getSelectedToggle();b=this.getComponetById(this._id+"_NextButton");c=this.getComponetById(this._id+"_SubmitButton");a=this.getComponetById(this._id+"_CheckButton");b.Enable();c.Enable();return a.Enable()};c.prototype.GotoQuestion=function(a){a=this.getComponetById(this._id+"_NextButton");a.Disable();this._questions[this._CurrentQuestionIndex.valueOf()].Hide();this._reportOpen=!1;this._CurrentQuestionIndex++;this._questions[this._CurrentQuestionIndex.valueOf()].Show();
if(this._CurrentQuestionIndex+1<=this._questions.length)return a.Hide(),this.getComponetById(this._id+"_SubmitButton").Show()};c.prototype.SubmitQuiz=function(a){this._questions[this._CurrentQuestionIndex.valueOf()].Hide();this.getComponetById(this._id+"_SubmitButton").Hide();this._reportOpen=!1;void 0!==this._setQuiz.onComplete&&D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onComplete");if(void 0!==this._options.onComplete)return D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onComplete")};
c.prototype.CheckAnswer=function(a){var b;this.ResetScrollPos();b=this._questions[this._CurrentQuestionIndex.valueOf()];b.HandleSelection(a);this._qMan.SubmitQuizAttempt(this._currentAttemptData);a=this.getComponetById(this._id+"_CheckButton");a.Hide();a.Disable();b=this._options.forceCorrect&&!b.isCorrect()?this.getComponetById(this._id+"_RetryButton"):this._CurrentQuestionIndex+1>=this._questions.length?this.getComponetById(this._id+"_SubmitButton"):this.getComponetById(this._id+"_NextButton");
b.Show();return this.AdjustButtons()};c.prototype.RetryQuestion=function(a){this._questions[this._CurrentQuestionIndex.valueOf()].DisplayQuestion();a=this.getComponetById(this._id+"_CheckButton");a.Show();a.Disable();this.getComponetById(this._id+"_RetryButton").Hide();this.AdjustButtons();return D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onRetry")};c.prototype.BuildSummativeReport=function(){var a;a={ID:this._id+"_sRep",Type:"Group",initX:10,initY:0,initWidth:this.getWidth()-10,initHidden:!0,
initContent:[{ID:this._id+"_sRep_icon",Type:"Sprite",AssetID:this._options.useResultIconSpriteAsset,initX:0,initY:this._qSlideYoffset,tabEnabled:!1,initWidth:40},{ID:this._id+"_sRep_info",Type:"Text",initX:40,initY:this._qSlideYoffset,InitText:"REPORT TEXT",initWidth:this.getWidth()-50}]};this._summativeReport=D2LAdventureEngine.gu_ComponentManager.BuildComponent(a,this.location);return this.addComponet(this._summativeReport)};c.prototype.BuildEndNotice=function(){this._summativeReport=D2LAdventureEngine.gu_ComponentManager.BuildComponent(repDat,
this.location);return this.addComponet(this._summativeReport)};c.prototype.comp_Show=function(a){c.__super__.comp_Show.call(this,a);this.Update();if(this._adjustmentHiding)return this.Hide()};return c}(D2LAdventureEngine.comp_Group);window.D2LAdventureEngine.comp_staticText=function(h){function c(a,b,l,e){this._id=a;this.location=b;this.text=l;this._options=e;this.comp_destroy=d(this.comp_destroy,this);this.comp_Hide=d(this.comp_Hide,this);this.comp_Show=d(this.comp_Show,this);this.SetFont=d(this.SetFont,
this);this.SetStaticsPos=d(this.SetStaticsPos,this);this.SetFontToDimentions=d(this.SetFontToDimentions,this);this.comp_Update=d(this.comp_Update,this);this.comp_Move=d(this.comp_Move,this);this.comp_getHeight=d(this.comp_getHeight,this);this.comp_getWidth=d(this.comp_getWidth,this);this.comp_Resize=d(this.comp_Resize,this);this.comp_HandleResizeEvent=d(this.comp_HandleResizeEvent,this);this.comp_cache=d(this.comp_cache,this);this.AppendText=d(this.AppendText,this);this.ChangeText=d(this.ChangeText,
this);this.createStaticElm=d(this.createStaticElm,this);this.comp_Init=d(this.comp_Init,this);this.comp_AssessDefaultOptions=d(this.comp_AssessDefaultOptions,this);this._options||(this._options={align:"left",sizeBoost:null,forceSize:null,kerning:null,color:void 0,weight:void 0,vCenter:!0,fontFamily:void 0,padding:void 0,capitalize:void 0});c.__super__.constructor.call(this,this._id,this.location,this._options)}q(c,h);c.prototype._staticElm=void 0;c.prototype._requestedAdjustSize=void 0;c.prototype._useSize=
void 0;c.prototype._cacheScale=void 0;c.prototype.comp_AssessDefaultOptions=function(){this._options.interactive&&void 0===this._options.useCursor?this._options.useCursor="pointer":this._options.interactive||void 0!==this._options.useCursor||(this._options.useCursor="default");void 0===this._options.lineHeight&&(this._options.lineHeight=1.2);if(void 0===this._options.useCursorOnOut)return this._options.useCursorOnOut="default"};c.prototype.comp_Init=function(){this.createStaticElm();this._initialized=
!0;return this._cacheScale=2};c.prototype.createStaticElm=function(){var a,b;void 0!==this._staticElm&&this.removeChild(this._staticElm);this._useSize=this._options.forceSize?this._options.forceSize*D2LAdventureEngine.gu_canDi.scaleFactor:!this._options.sizeBoost&&this._options.forceSize?this._options.forceSize*D2LAdventureEngine.gu_canDi.scaleFactor:this._options.sizeBoost?Math.round((D2LAdventureEngine.gu_DynamicTextBaseSize+this._options.sizeBoost)*D2LAdventureEngine.gu_canDi.scaleFactor):D2LAdventureEngine.gu_DynamicTextBaseSize*
D2LAdventureEngine.gu_canDi.scaleFactor;a="";this._options.weight&&(a+="bold ");a+=this._useSize+"px ";void 0===this._options.fontFamily&&(this._options.fontFamily=D2LAdventureEngine.gu_CSSManager._globalDefaultFont);a+=this._options.fontFamily+" ";void 0===this.text&&(this.text="");b=this.text;-1!==b.indexOf("[%js]")&&(b=D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(b));this._options.capitalize&&(b=this.text.toUpperCase());this._staticElm=new createjs.Text(D2LAdventureEngine.gu_JsonOps.LangTagsCheck(b),
a,this._options.color);this._staticElm.textAlign=this._options.align;this._options.vCenter&&(this._staticElm.textBaseline="middle",this._staticElm.regY-=Math.ceil((this._options.initHeight-2*this._options.padding)/2)*D2LAdventureEngine.gu_canDi.scaleFactor,this._staticElm.y=this._staticElm.regY*D2LAdventureEngine.gu_canDi.scaleFactor);this._options.initWidth?(this._staticElm.lineWidth=this._options.initWidth*D2LAdventureEngine.gu_canDi.scaleFactor,this._staticElm.maxWidth=this._options.initWidth*
D2LAdventureEngine.gu_canDi.scaleFactor):(this._staticElm.lineWidth=Math.round(this.getWidth()*D2LAdventureEngine.gu_canDi.scaleFactor),this._staticElm.maxWidth=this._staticElm.lineWidth);this._staticElm.lineHeight=Math.round(this._useSize*this._options.lineHeight);"center"===this._options.align?this._staticElm.regX=this._options.padding?this._staticElm.regX-(this._staticElm.lineWidth/2-this._options.padding*D2LAdventureEngine.gu_canDi.scaleFactor):this._staticElm.regX-this._staticElm.lineWidth/2:
"right"===this._options.align&&(this._staticElm.regX=this._options.padding?this._staticElm.regX-(this._staticElm.lineWidth-this._options.padding*D2LAdventureEngine.gu_canDi.scaleFactor):this._staticElm.regX-this._staticElm.lineWidth);this._staticElm.scaleX=D2LAdventureEngine.gu_canDi.inverseScaleFactor;this._staticElm.scaleY=D2LAdventureEngine.gu_canDi.inverseScaleFactor;this._staticElm.snapToPixel=!1;this.SetStaticsPos();return this.comp_cache()};c.prototype.ChangeText=function(a){a&&(a=D2LAdventureEngine.gu_JsonOps.LangTagsCheck(a),
this._options.capitalize&&(a=a.toUpperCase()),this._initialized?this._staticElm.text=a:this._options.InitText=a,this.text=a,this.comp_cache(!0))};c.prototype.AppendText=function(a){a&&(this._options.capitalize&&(a=a.toUpperCase()),a=D2LAdventureEngine.gu_JsonOps.LangTagsCheck(a),this._staticElm.text+=a,this.comp_cache(!0))};c.prototype.comp_cache=function(a){this._staticElm&&(a&&this._staticElm.cacheCanvas&&this._staticElm.uncache(),this._staticElm.cacheCanvas||((a=this._staticElm.getBounds())?this._options.padding?
this._options.padding.constructor===Number&&this._staticElm.cache(Math.round(a.x-this._options.padding),Math.round(a.y-this._options.padding),Math.round(a.width+this._options.padding),Math.round(a.height+this._options.padding),this._cacheScale):this._staticElm.cache(Math.round(a.x),Math.round(a.y),Math.round(a.width),Math.round(a.height),this._cacheScale):this._staticElm.cache(0,0,this.getWidth(),this.getHeight(),this._cacheScale)))};c.prototype.comp_HandleResizeEvent=function(a){this.comp_cache(!0)};
c.prototype.comp_Resize=function(a,b){this._staticElm.lineWidth=a;this._staticElm.maxWidth=a;this._options.initWidth=a;this._options.initHeight=b;this.comp_cache()};c.prototype.comp_getWidth=function(){return Math.max(this._staticElm.getMeasuredWidth(),this._staticElm.lineWidth)};c.prototype.comp_getHeight=function(){return this._staticElm.getMeasuredHeight()};c.prototype.comp_Move=function(a){this.removeChild(this._staticElm);return this.createStaticElm()};c.prototype.comp_Update=function(a){if(this._requestedAdjustSize)return this._requestedAdjustSize.constructor===
Number?this.SetFont(this._requestedAdjustSize):this._requestedAdjustSize.width&&this._requestedAdjustSize.height&&this.SetFontToDimentions(this._requestedAdjustSize.width,this._requestedAdjustSize.height),this._requestedAdjustSize=void 0};c.prototype.SetFontToDimentions=function(a,b){var c,e,f,g;if(void 0===a||void 0===b)D2LAdventureEngine.gu_debugManager.log("Warning: SetFontToDimentions call for "+this._id+" missing a value, ignoring request");else{this._options.padding?(c=a-2*this._options.padding-
40,g=b-2*this._options.padding):(c=a-40,g=2*b);f=a/100;1.5>Math.round(f)&&(f=1.5);this._staticElm.maxWidth=c;if(this._initialized)for(e=0;120>e;){c=this._staticElm.getBounds();this._staticElm.lineHeight=this._staticElm.getMeasuredLineHeight();if(c.height>g-f&&c.height<g+f)return this.SetFont(Math.floor(this._useSize));c.height>g?this.SetFont(this._useSize-.5):c.height<g&&this.SetFont(this._useSize+.5);e++}else this._requestedAdjustSize={width:a,height:b};return D2LAdventureEngine.gu_debugManager.log("Warning: SetFontToDimentions call for "+
this._id+" hit loopBreakerLimit")}};c.prototype.SetStaticsPos=function(){var a,b,c;a=b=0;void 0!==this._options.padding&&(this._options.padding.constructor===Number?a=b=this._options.padding:this._options.padding.constructor===String?(b=eval(this._options.padding),a=eval(this._options.padding)):"object"===typeof this._options.padding?(void 0!==this._options.padding.left&&(this._options.padding.left.constructor===Number?a=this._options.padding.left:this._options.padding.left.constructor===String&&
(a=eval(this._options.padding.left))),void 0!==this._options.padding.top&&(this._options.padding.top.constructor===Number?b=this._options.padding.top:this._options.padding.top.constructor===String&&(b=this._options.padding.valueOf()))):a=b=0);this._options.initWidth&&this._options.initHeight&&(c=new createjs.Graphics,c.beginFill("rgba(255,0,0,.2)"),c.rect(this.x,this.y,this._options.initWidth-a,this._options.initHeight-b),c.endFill(),this.mask=new createjs.Shape(c));this._staticElm.x=Math.round(a);
this._staticElm.y=Math.round(b);return this.addChild(this._staticElm)};c.prototype.SetFont=function(a,b,c){var e;e="";b?(e+=b,this._options.weight=b):this._options.weight&&(e+=this._options.weight);a?(this._useSize=a,e+=a+"px "):e+=this._useSize+"px ";void 0!==c?(this._options.fontFamily=c,e+=c+" "):e+=this._options.fontFamily;this._staticElm.font=e;return this.SetStaticsPos()};c.prototype.comp_Show=function(){this.comp_cache()};c.prototype.comp_Hide=function(){if(this._staticElm.cacheCanvas)return this._staticElm.uncache()};
c.prototype.comp_destroy=function(){if(this._staticElm.cacheCanvas)return this._staticElm.uncache()};return c}(D2LAdventureEngine.component);window.D2LAdventureEngine.comp_ProgressBar=function(d){function c(a,b,d){this._id=a;this.location=b;this._options=null!=d?d:{unfilledColor:void 0,filledColor:void 0,initFillPercent:0};this.built=!1;this.percent=0;this.comp_AssessDefaultOptions=function(a){return function(){void 0===a._options.initWidth&&(a._options.initWidth=200);void 0===a._options.initHeight&&
(a._options.initHeight=15);void 0===a._options.unfilledColor&&(a._options.unfilledColor=createjs.Graphics.getRGB(223,223,223));void 0===a._options.filledColor&&(a._options.filledColor=createjs.Graphics.getRGB(170,170,170));void 0===a._options.radius&&(a._options.radius=a._options.initHeight/4);a._options.tabEnabled=!1;a._options.interactive=!1;a.width=a._options.initWidth;return a.height=a._options.initHeight}}(this);this.comp_Init=function(a){return function(){var b;b=new createjs.Graphics;b.beginFill(a._options.unfilledColor);
b.drawRoundRect(0,0,a._options.initWidth,a._options.initHeight,a._options.radius);b.endFill();a._unfilledBar=new createjs.Shape(b);a.addChild(a._unfilledBar);b=new createjs.Graphics;b.beginFill(a._options.filledColor);b.drawRoundRect(0,0,1,a._options.initHeight,a._options.radius);b.endFill();a._filledBar=new createjs.Shape(b);a.addChild(a._filledBar);if(void 0!==a._options.initFillPercent)return a.fillTo(a._options.initFillPercent)}}(this);this.fillTo=function(a){return function(b){var g;a.percent=
b;b=a.percent/100*a._options.initWidth;a.removeChild(a._filledBar);g=new createjs.Graphics;g.beginFill(a._options.filledColor);g.drawRoundRect(0,0,b,a._options.initHeight,a._options.radius);g.endFill();a._filledBar=new createjs.Shape(g);a.addChild(a._filledBar);b={compRef:a,interactionType:"onChange",data:a._options.events.onChangeData};void 0!==a._options.events.onChange&&D2LAdventureEngine.gu_EventManager.DispacthEvent(a,"onChange",b);if(100<=a.percent)return b={compRef:a,interactionType:"oncomplete",
data:a._options.events.onCompleteData},D2LAdventureEngine.gu_EventManager.DispacthEvent(a,"oncomplete",b)}}(this);c.__super__.constructor.call(this,this._id,this.location,this._options)}q(c,d);return c}(D2LAdventureEngine.component);D2LAdventureEngine.comp_AccessCursor=function(h){function c(){this.NudgeCursor=d(this.NudgeCursor,this);this.comp_Update=d(this.comp_Update,this);this.RequestHitCheck=d(this.RequestHitCheck,this);this.refreshCB=d(this.refreshCB,this);this.comp_Disable=d(this.comp_Disable,
this);this.comp_Enable=d(this.comp_Enable,this);this.HandleFocusDeactivation=d(this.HandleFocusDeactivation,this);this.isInCB=d(this.isInCB,this);this.HandleEndRequest=d(this.HandleEndRequest,this);this.HandleStartRequest=d(this.HandleStartRequest,this);this.HandleReqToggle=d(this.HandleReqToggle,this);this.DeactivateKeys=d(this.DeactivateKeys,this);this.ActivateKeys=d(this.ActivateKeys,this);this.comp_HandleUnfocus=d(this.comp_HandleUnfocus,this);this.comp_HandleFocus=d(this.comp_HandleFocus,this);
this.CenterCrosshair=d(this.CenterCrosshair,this);this.DrawCrosshair=d(this.DrawCrosshair,this);this.comp_Init=d(this.comp_Init,this);this.comp_AssessDefaultOptions=d(this.comp_AssessDefaultOptions,this);this.location={state:"Master_UI",scene:"Master_UI"};this._options={InWinLockOverride:!0};c.__super__.constructor.call(this,"AE_accessCursor",this.location,this._options);this._inheritanceChain.push(D2LAdventureEngine.comp_Group)}q(c,h);c.prototype._standardSpeed=void 0;c.prototype._fastSpeed=void 0;
c.prototype._enabled=void 0;c.prototype._active=void 0;c.prototype._MovingVDir=void 0;c.prototype._MovingHDir=void 0;c.prototype._collideComps=void 0;c.prototype.controllKeys=void 0;c.prototype.tempStoredArrowKeys=void 0;c.prototype._isDown=void 0;c.prototype._options=void 0;c.prototype._choiceSpeed=void 0;c.prototype.crosshair=void 0;c.prototype.comp_AssessDefaultOptions=function(){this._standardSpeed=5;this._fastSpeed=10;this._active=!1;this._MovingHDir=this._MovingVDir="none";this._collideComps=
[];this.controllKeys=[];this.tempStoredArrowKeys=[];this._isDown=!1;this.controllKeys.push("gDefKey_AccCur_Left");this.controllKeys.push("gDefKey_AccCur_Left_Fast");this.controllKeys.push("gDefKey_AccCur_Right");this.controllKeys.push("gDefKey_AccCur_Right_Fast");this.controllKeys.push("gDefKey_AccCur_Up");this.controllKeys.push("gDefKey_AccCur_Up_Fast");this.controllKeys.push("gDefKey_AccCur_Down");this.controllKeys.push("gDefKey_AccCur_Down_Fast");this.controllKeys.push("gDefKey_AccCur_Select");
this._options.noOutline=!0;this._options.tabEnabled=!0;this._choiceSpeed=0;this.visible=!1;return c.__super__.comp_AssessDefaultOptions.apply(this,arguments)};c.prototype.comp_Init=function(){this.DrawCrosshair(20);D2LAdventureEngine.gu_TabManager.AssignAccessObject(this,"last");this.CenterCrosshair();return c.__super__.comp_Init.apply(this,arguments)};c.prototype.DrawCrosshair=function(a){var b;b={ID:"AccCur_Crosshair",Type:"Shape - Line",initX:0,initY:0,initRegX:a/2,initRegY:a/2,strokeColor:"#FFFF00",
strokeWidth:"[%num]2",noOutline:!0,tabEnabled:!1,points:[{x:a/2,y:0},{x:a/2,y:a},{x:a/2,y:a/2},{x:0,y:a/2},{x:a,y:a/2}]};this.crosshair=D2LAdventureEngine.gu_ComponentManager.BuildComponent(b,this.location);this.crosshair.Update();this.addComponet(this.crosshair);b={ID:"AccCur_OverIndicator",Type:"Shape - Rectangle",initX:0,initY:0,initRegX:a/2,initRegY:a/2,strokeColor:"#FFFF00",color:"none",strokeWidth:"[%num]2",tabEnabled:!1,initHidden:!0,rect:{x:a/3,y:a/3,width:a/3,height:a/3}};this.ActiveIndicator=
D2LAdventureEngine.gu_ComponentManager.BuildComponent(b,this.location);this.ActiveIndicator.Update();return this.addComponet(this.ActiveIndicator)};c.prototype.CenterCrosshair=function(){return this.Move(D2LAdventureEngine.gu_canDi.width/2,D2LAdventureEngine.gu_canDi.height/2)};c.prototype.comp_HandleFocus=function(){this._active=this.visible=!0;this.CenterCrosshair();this.ActivateKeys();return D2LAdventureEngine.gu_GUIManager._accessIndicator.gotoAndStop("accessCursor_up")};c.prototype.comp_HandleUnfocus=
function(){this.HandleEndRequest();this._MovingVDir=this._MovingHDir="none";this._choiceSpeed=0;this._active=this.visible=!1;this.DeactivateKeys();return D2LAdventureEngine.gu_GUIManager._accessIndicator.gotoAndStop("keymode")};c.prototype.ActivateKeys=function(){var a,b,c;this.tempStoredArrowKeys=[];a=0;for(b=[];a<this.controllKeys.length;){c=D2LAdventureEngine.gu_KeyManager.getKeyCodeOfKeyID(this.controllKeys[a]);if(c=D2LAdventureEngine.gu_KeyManager.getFunctionAssignedToKeyCode(c,{useShift:-1!==
this.controllKeys[a].indexOf("_Fast")}))this.tempStoredArrowKeys.push(c),D2LAdventureEngine.gu_KeyManager.DeactivateKey(c);D2LAdventureEngine.gu_KeyManager.ActivateKey(this.controllKeys[a]);b.push(a++)}return b};c.prototype.DeactivateKeys=function(){var a;if(void 0!==this.tempStoredArrowKeys&&0!==this.tempStoredArrowKeys.length){for(a=0;a<this.controllKeys.length;)D2LAdventureEngine.gu_KeyManager.DeactivateKey(this.controllKeys[a]),a++;for(a=0;a<this.tempStoredArrowKeys.length;)D2LAdventureEngine.gu_KeyManager.ActivateKey(this.tempStoredArrowKeys[a]),
a++;return this.tempStoredArrowKeys=void 0}};c.prototype.HandleReqToggle=function(){return this._isDown?this.HandleEndRequest():this.HandleStartRequest()};c.prototype.HandleStartRequest=function(){var a;for(a=0;a<this._collideComps.length;)this._collideComps[a].HandleAC_ReqStart(this._globalPos),a++;this._isDown=!0;D2LAdventureEngine.gu_GUIManager._accessIndicator.gotoAndStop("accessCursor_down");return this.ActiveIndicator.Show()};c.prototype.HandleEndRequest=function(){var a;for(a=0;a<this._collideComps.length;)this._collideComps[a].HandleAC_ReqEnd(this._globalPos),
a++;this._isDown=!1;D2LAdventureEngine.gu_GUIManager._accessIndicator.gotoAndStop("accessCursor_up");return this.ActiveIndicator.Hide()};c.prototype.isInCB=function(a){var b;for(b=0;b<this._collideComps.length;){if(this._collideComps[b]===a)return b;b++}return!1};c.prototype.HandleFocusDeactivation=function(){if(this._enabled&&this._active)return this.HandleEndRequest(),this._MovingVDir=this._MovingHDir="none",this._choiceSpeed=0,this.visible=!1,this.CenterCrosshair(),this.DeactivateKeys()};c.prototype.comp_Enable=
function(){this._enabled||(this._enabled=!0,D2LAdventureEngine.gu_TabManager.AssignAccessObject(this,"last"));return c.__super__.comp_Enable.apply(this,arguments)};c.prototype.comp_Disable=function(){this._enabled&&(this._enabled=!1,D2LAdventureEngine.gu_TabManager.UnassignAccessObject(this),this._MovingVDir=this._MovingHDir="none",this._choiceSpeed=0,this.visible=!1,this.CenterCrosshair(),this.DeactivateKeys());return c.__super__.comp_Disable.apply(this,arguments)};c.prototype.refreshCB=function(){return this._collideComps=
[]};c.prototype.RequestHitCheck=function(a){var b,c,e,f,g,d;if(this._enabled&&this.visible){if(void 0===a._prevACpos||void 0===a._acRel||void 0===a._allowACOverlap)a._acRel="out",a._allowACOverlap=!1,a._prevACpos={};if(a._prevACpos!==a._globalPos&&a._enabled&&a.visible){if(void 0!==a.hitTest){e=function(a){return function(b){void 0!==b.HandleMouseOver&&b.HandleMouseOver(a._globalPos);!1===a.isInCB(b)&&a._collideComps.push(b);return b._acRel="over"}}(this);c=function(a){return function(b){void 0!==
b.HandleMouseOut&&b.HandleMouseOut(a._globalPos);!1!==a.isInCB(b)&&a._collideComps.splice(b,1);return b._acRel="out"}}(this);f=function(a){return function(){var b,g;b=0;for(g=[];b<a._collideComps.length;)c(a._collideComps[b]),g.push(b++);return g}}(this);b=D2LAdventureEngine.gu_StageEventManager.stageRef.getObjectsUnderPoint(this._globalPos.x,this._globalPos.y+this.getHeight(),0);d=!1;for(g=0;g<b.length;){if(b[g]._id){if(b[g]._id===a._id||b[g]._id===a._id+"_accessShape")d=!0}else if(b[g].parent._id){if(b[g].parent._id===
a._id||b[g].parent._id===a._id+"_accessShape")d=!0;a.parent&&a.parent._id&&(b[g].parent._id===a.parent._id||b[g].parent._id===a.parent._id+"_accessShape")&&(d=!0)}g++}if("out"===a._acRel&&d)if(0===this._collideComps.length||a._allowACOverlap)e(a);else if("none"===a.assoiatedStateID||"Master_UI"===a.assoiatedStateID)f(),e(a);else{if(a.parentScene===D2LAdventureEngine.gu_StateManager.GetCurrStateRef().CurrentScene){d=!1;for(b=g=0;b<this._collideComps.length;)this._collideComps[b].parentScene===D2LAdventureEngine.gu_StateManager.GetCurrStateRef().CurrentScene&&
this._collideComps[b]._enabled&&this._collideComps[b].visible?(d=!0,this._collideComps[b].constructor===D2LAdventureEngine.comp_Group&&a.inGroup(this._collideComps[b])||this._collideComps[b].getIndexPos()>g&&(g=this._collideComps[b].getIndexPos())):("none"===this._collideComps[b].assoiatedStateID||"Master_UI"===this._collideComps[b].assoiatedStateID)&&this._collideComps[b]._enabled&&this._collideComps[b].visible&&(d=!0,g=993,b=this._collideComps.length),b++;if(!d||a.getIndexPos()>=g)f(),e(a)}}else"over"!==
a._acRel||d||c(a)}else D2LAdventureEngine.gu_debugManager.log("ERROR!! RequestHitCheck received object with no hitTest function");void 0!==a.HandleMouseMove&&(e={mPos:{x:this._globalPos.x,y:this._globalPos.y,origEvnt:this._globalPos}},a.HandleMouseMove(e));return a._prevACpos=this._globalPos}}};c.prototype.comp_Update=function(){var a;this._enabled&&this._active&&("left"===this._MovingHDir&&(0<this.x?this.ShiftX(-this._choiceSpeed):0>this.x&&this.Move(0,this.y)),"right"===this._MovingHDir&&(this.x<
D2LAdventureEngine.gu_canDi.width?this.ShiftX(this._choiceSpeed):this.x>D2LAdventureEngine.gu_canDi.width&&this.Move(D2LAdventureEngine.gu_canDi.width,this.y)),"up"===this._MovingVDir&&(0<this.y?this.ShiftY(-this._choiceSpeed):0>this.y&&this.Move(this.x,0)),"down"===this._MovingVDir&&(this.y<D2LAdventureEngine.gu_canDi.height?this.ShiftY(this._choiceSpeed):this.y>D2LAdventureEngine.gu_canDi.height&&this.Move(this.x,D2LAdventureEngine.gu_canDi.height)),a=D2LAdventureEngine.gu_StageEventManager.stageRef.getObjectsUnderPoint(this._globalPos.x,
this._globalPos.y),this._collideComps=D2LAdventureEngine.gu_stageRef.getCompsUnderPoint({x:this._globalPos.x,y:this._globalPos.y,targets:a}),this.crosshair.Update());return c.__super__.comp_Update.apply(this,arguments)};c.prototype.NudgeCursor=function(a,b){if(this._enabled&&this._active)if("left"===a||"right"===a||"up"===a||"down"===a){this._choiceSpeed="fast"===b?this._fastSpeed:this._standardSpeed;if("left"===a||"right"===a)return"stop"===b?this._MovingHDir="none":this._MovingHDir=a;if("up"===
a||"down"===a)return"stop"===b?this._MovingVDir="none":this._MovingVDir=a}else return D2LAdventureEngine.gu_debugManager.log("ERROR!: dir "+a+" not recognized as a ACC_CUR direction")};return c}(D2LAdventureEngine.comp_Group);window.D2LAdventureEngine.comp_SpeechBubble=function(h){function c(a,b,l){this._id=a;this.location=b;this._options=l;this.BuildButtonSet=d(this.BuildButtonSet,this);this.HandleNavMouseOut=d(this.HandleNavMouseOut,this);this.HandleNextNavMouseOver=d(this.HandleNextNavMouseOver,
this);this.HandlePrevNavMouseOver=d(this.HandlePrevNavMouseOver,this);this.SetNavButtons=d(this.SetNavButtons,this);this.HandleEndWinReq=d(this.HandleEndWinReq,this);this.RequestNavigation=d(this.RequestNavigation,this);this.comp_Update=d(this.comp_Update,this);this.BuildTailImg=d(this.BuildTailImg,this);this.BuildBubbleImg=d(this.BuildBubbleImg,this);this.GetTextSampleDimentions=d(this.GetTextSampleDimentions,this);this.comp_BuildAccessContext=d(this.comp_BuildAccessContext,this);this.Repopulate=
d(this.Repopulate,this);this.Build=d(this.Build,this);this.comp_Init=d(this.comp_Init,this);this.comp_AssessDefaultOptions=d(this.comp_AssessDefaultOptions,this);this._options||(this._options={tailPos:{x:0,y:0},bubblePos:{x:void 0,y:void 0},minTextWidth:void 0,maxTextWidth:void 0,BubbleStyle:void 0,nextButton:void 0,nextButtonPosition:void 0,previousButton:void 0,previousButtonPosition:void 0,events:{nextButtonFunction:void 0,nextButtonFunctionData:void 0,previousButtonFunction:void 0,previousButtonFunctionData:void 0}});
this._options.useFade=!1;void 0===this._options.bubblePos&&(this._options.bubblePos={x:void 0,y:void 0});void 0!==this._options.initX&&void 0===this._options.bubblePos.x&&(this._options.bubblePos.x=this._options.initX,this._options.initX=0);void 0!==this._options.initY&&void 0===this._options.bubblePos.y&&(this._options.bubblePos.y=this._options.initY,this._options.initY=0);this._options.allowMouseThrough=!0;c.__super__.constructor.call(this,this._id,this.location,this._options);this._inheritanceChain.push(D2LAdventureEngine.comp_Window)}
q(c,h);c._buttonHeightOffset=void 0;c._tailShapeUnder=void 0;c._tailShapeOver=void 0;c._buttonGrouping=void 0;c.prototype.comp_AssessDefaultOptions=function(){void 0===this._options.tailPos&&(this._options.tailPos={x:0,y:0});void 0===this._options.tailPos.x&&(this._options.tailPos.x=0);void 0===this._options.tailPos.y&&(this._options.tailPos.y=0);void 0===this._options.BubbleStyle&&(this._options.BubbleStyle={});void 0===this._options.BubbleStyle.shapeType&&(this._options.BubbleStyle.shapeType="roundedRect");
void 0===this._options.BubbleStyle.color&&(this._options.BubbleStyle.color="#FFFFFF");void 0===this._options.BubbleStyle.strokeWidth&&(this._options.BubbleStyle.strokeWidth=3);void 0===this._options.BubbleStyle.strokeColor&&(this._options.BubbleStyle.strokeColor="#000000");void 0===this._options.BubbleStyle.tailFatness&&(this._options.BubbleStyle.tailFatness=5);void 0===this._options.minTextWidth&&(this._options.minTextWidth=120);void 0===this._options.maxTextWidth&&(this._options.maxTextWidth=300);
void 0===this._options.maxTextHeight&&(this._options.maxTextHeight=400);void 0===this._options.useContentPadding&&(this._options.useContentPadding=20);this._BubbleShape=this._options.BubbleStyle.shapeType;this._options.centerWinText=!0;this._options.contentAlign="center";this._options.contentOverflow="hidden";this._options.ButtonSet||(this._options.ButtonSet="BubbleNav");this._buttonHeightOffset=this._options.nextButton&&this._options.nextButton.initHeight?this._options.nextButton.initHeight+this._options.useContentPadding:
D2LAdventureEngine.gu_ResourceManager.preDetermineSpriteDimentions("DEF_BUBBLENAV_NEXT").height+this._options.useContentPadding;c.__super__.comp_AssessDefaultOptions.call(this);return this.Move(0,0)};c.prototype.comp_Init=function(){c.__super__.comp_Init.call(this);if(!this._bg)return this._bg=this.getComponetById(this._id+"_BubbleShapeContainer")};c.prototype.Build=function(a){var b;b=this.GetTextSampleDimentions(this._options.useInitPopulation);this._ContentRect={x:this._options.bubblePos.x,y:this._options.bubblePos.y,
width:b.width+2*this._options.useContentPadding,height:b.height+2*this._options.useContentPadding+5};this.BuildBubbleImg({x:this._options.bubblePos.x,y:this._options.bubblePos.y,width:b.width+2*this._options.useContentPadding,height:b.height+2*this._options.useContentPadding+this._buttonHeightOffset});this._bg&&this._bg.setChildIndex(this._bg.gcContainer,1);if(a)return a()};c.prototype.Repopulate=function(a){this._initialized&&(this._PopulationDataIndex=0,a&&(this._options.useInitPopulation=a,this.VaildatePopulationData(a)&&
(this._PopulationData=this.VaildatePopulationData(a))),this.Build());c.__super__.Repopulate.call(this,a);return this._buttonGrouping};c.prototype.comp_BuildAccessContext=function(){return D2LAdventureEngine.gu_ScreenReaderHelper.AddReadText(this._id,"","section",void 0,{SectionLable:"Speech bubble:"})};c.prototype.GetTextSampleDimentions=function(a){var b,c,e,f,g;""===a&&(a=[" "]);a.constructor===String&&(a=[a]);c=function(a){return function(b){var g,c;g=Math.round(D2LAdventureEngine.gu_DynamicTextBaseSize);
void 0!==a._options.contentTextSizeBoost&&(g+=a._options.contentTextSizeBoost);c=new createjs.Text(b,g+"px "+(a._options.contentFont?a._options.contentFont:D2LAdventureEngine.gu_CSSManager._globalDefaultFont)+" "+(a._options.contentWeight?a._options.contentWeight:""),"#FFFFFF");c.lineHeight=1.2*g;void 0===a._options.useContentRect||void 0===a._options.useContentRect.width?(c.textWidth=c.getMeasuredWidth(),c.textWidth<a._options.minTextWidth?c.textWidth=a._options.minTextWidth:c.textWidth>a._options.maxTextWidth&&
(c.textWidth=a._options.maxTextWidth)):c.textWidth=a._options.useContentRect.width;g=Math.ceil(c.getMeasuredWidth()/(c.textWidth-20))*c.lineHeight;b=b.match(/(<br>|<\/br>|<br\/>)/g)?b.match(/(<br>|<\/br>|<br\/>)/g).length:0;g+=(b+1)*c.getMeasuredLineHeight();b=c.getTransformedBounds();null===b&&(b={x:0,y:0,width:1,height:1});if(c.textWidth===a._options.maxTextWidth||b.width>c.textWidth)b.width=c.textWidth;b.width<a._options.minTextWidth&&(b.width=a._options.minTextWidth);b.height<g&&(b.height=g);
b.height>a._options.maxTextHeight&&(b.height=a._options.maxTextHeight);return b}}(this);g=[];e=[];for(f=0;f<a.length;)b=c(a[f]),g.push(b.width),e.push(b.height),f++;return{x:0,y:0,width:Math.ceil(Math.max.apply(Math,g)),height:Math.ceil(Math.max.apply(Math,e))}};c.prototype.BuildBubbleImg=function(a){var b,c,e,f,g;c=[];"cloudy"===this._BubbleShape||"Cloudy"===this._BubbleShape?(g=24,f={ID:this._id+"_mainShape",Type:"Shape",shapeType:"Rectangle",interactive:"[%false]",initX:this._options.bubblePos.x,
initY:this._options.bubblePos.y,color:this._options.BubbleStyle.color,strokeWidth:this._options.BubbleStyle.strokeWidth,strokeDash:this._options.BubbleStyle.strokeDash,strokeInside:this._options.BubbleStyle.strokeInside,strokeInside:!0,overflow:"hidden",rect:{x:15,y:15,width:a.width,height:a.height}},c.push(f),this._pdgOffset.x=15,this._pdgOffset.y=15,b=function(a){return function(b){var e,d,w,r,h,m,k,p;d=a._id+"_subShp";b&&(d=a._id+"_subShp2");k={ID:d,Type:"Shape",shapeType:"Line",initX:f.initX,
initY:f.initY,interactive:"[%false]",tabEnabled:"[%false]",color:"#F2F2F2",points:[[15,20]]};b&&(k.initY="[%num]"+(f.rect.height+15+f.initY),k.points=[[15,-5]]);m=Math.round(f.rect.width/30);for(r=0;r<m;)d=Math.round(Math.random()*(g/4-0)+0),p=k.points[k.points.length-1][0],h=Math.round(f.rect.width/m*(r+1)+15),w=Math.round((h-p)/2),e=15,b?(k.points.push([p,0]),k.points.push([h,0,h-w+d,30]),k.points.push([h,0])):(k.points.push([p,e]),k.points.push([h,e,h-w-d,-e]),k.points.push([h,e])),r++;b?k.points.push([f.rect.width+
15,-5]):k.points.push([f.rect.width+15,e+5]);return c.push(k)}}(this),e=function(a){return function(b){var e,d,h,r,t,m,k,p;d=a._id+"_subShp3";b&&(d=a._id+"_subShp4");m={ID:d,Type:"Shape",shapeType:"Line",initX:f.initX,initY:f.initY,interactive:"[%false]",tabEnabled:"[%false]",color:"#F2F2F2",points:[[20,15]]};b&&(m.initX="[%num]"+(f.rect.width+15+f.initX),m.points=[[-5,15]]);p=Math.floor(f.rect.height/30);for(r=0;r<p;)d=Math.round(Math.random()*(g/4-0)+0),e=15,k=m.points[m.points.length-1][1],t=Math.round(f.rect.height/
p*(r+1)),h=Math.round((t-k)/2),b?(m.points.push([0,k]),m.points.push([0,t+15,30,t-h+15+d]),m.points.push([0,t+15])):(m.points.push([e,k]),m.points.push([e,t+15,-e,t-h-d]),m.points.push([e,t+15])),r++;b?m.points.push([-5,f.rect.height+15]):m.points.push([e+5,f.rect.height+15]);return c.push(m)}}(this),b(),b(!0),e(),e(!0)):"spikey"===this._BubbleShape||"Spikey"===this._BubbleShape?(g=24,f={ID:this._id+"_mainShape",Type:"Shape",shapeType:"Rectangle",interactive:"[%false]",initX:this._options.bubblePos.x,
initY:this._options.bubblePos.y,color:this._options.BubbleStyle.color,strokeWidth:this._options.BubbleStyle.strokeWidth,strokeDash:this._options.BubbleStyle.strokeDash,strokeInside:this._options.BubbleStyle.strokeInside,strokeInside:!0,overflow:"hidden",rect:{x:15,y:15,width:a.width,height:a.height}},c.push(f),this._pdgOffset.x=15,this._pdgOffset.y=15,b=function(a){return function(b){var e,d,h,r,t,m,k,p;d=a._id+"_subShp";b&&(d=a._id+"_subShp2");p={ID:d,Type:"Shape",shapeType:"Line",initX:f.initX,
initY:f.initY,interactive:"[%false]",tabEnabled:"[%false]",color:"#F2F2F2",points:[[15,20]]};b&&(p.initY="[%num]"+(f.rect.height+15+f.initY),p.points=[[15,-5]]);t=Math.round(f.rect.width/15);for(r=0;r<t;)d=Math.round(Math.random()*(g/4-0)+0),e=b?0:15,k=p.points[p.points.length-1][0],m=Math.round(f.rect.width/t*r+30),h=(m-k)/2,p.points.push([k,e]),b?p.points.push([m-h,15-d]):p.points.push([m-h,d]),p.points.push([m,e]),r++;b?p.points.push([f.rect.width+15,-5]):p.points.push([f.rect.width+15,e+5]);return c.push(p)}}(this),
e=function(a){return function(b){var e,d,h,r,t,m,k,p;d=a._id+"_subShp3";b&&(d=a._id+"_subShp4");k={ID:d,Type:"Shape",shapeType:"Line",initX:f.initX,initY:f.initY,interactive:"[%false]",tabEnabled:"[%false]",color:"#F2F2F2",points:[[20,15]]};b&&(k.initX="[%num]"+(f.rect.width+15+f.initX),k.points=[[-5,15]]);p=Math.round(f.rect.height/15);for(r=0;r<p;)d=Math.round(Math.random()*(g/4-0)+0),e=b?0:15,m=k.points[k.points.length-1][1],t=Math.round(f.rect.height/p*r+30),h=(t-m)/2,k.points.push([e,m]),b?k.points.push([15-
d,t-h]):k.points.push([d,t-h]),k.points.push([e,t]),r++;b?k.points.push([-5,f.rect.height+15]):k.points.push([e+5,f.rect.height+15]);return c.push(k)}}(this),b(),b(!0),e(),e(!0)):(f={ID:this._id+"_mainShape",Type:"Shape",interactive:"[%false]",initX:this._options.bubblePos.x,initY:this._options.bubblePos.y,color:this._options.BubbleStyle.color,strokeWidth:this._options.BubbleStyle.strokeWidth,strokeDash:this._options.BubbleStyle.strokeDash,strokeInside:this._options.BubbleStyle.strokeInside,strokeInside:!0,
overflow:"hidden"},"round"===this._BubbleShape||"Circle"===this._BubbleShape?(f.shapeType="Circle",f.radius=a.width/2+this._buttonHeightOffset):"roundedRect"===this._BubbleShape||"Round Rectangle"===this._BubbleShape?(f.shapeType="Round Rectangle",f.rect={x:0,y:0,width:a.width,height:a.height,radius:30}):"rect"===this._BubbleShape||"Rectangle"===this._BubbleShape?(f.shapeType="Rectangle",f.rect={x:0,y:0,width:a.width,height:a.height}):(D2LAdventureEngine.gu_debugManager.log("buildBubbleImg received unknown style "+
this._BubbleShape+" using 'Rectangle' instead"),this._BubbleShape="Rectangle",this.BuildBubbleImg(a)),c.push(f));b={ID:this._id+"_BubbleShapeContainer",Type:"Group",initContent:c,initX:0,initY:0,overflow:"hidden",allowMouseThrough:!0,InWinLockOverride:!0,tabEnabled:"[%false]",initWidth:D2LAdventureEngine.gu_canDi.width,initHeight:D2LAdventureEngine.gu_canDi.height,zpos:"bottom"};this._bg&&(this.removeComponet(this._bg._id),this._bg=void 0);this._initialized?(this.addComponet(b),this._bg=this.getComponetById(b.ID),
this._bg.Update(),this.BuildTailImg(this._bg,{x:this._options.bubblePos.x,y:this._options.bubblePos.y,width:a.width,height:a.height}),this.BuildButtonSet(this._bg)):(this._options.initContent.push(b),this.BuildTailImg(b,{x:this._options.bubblePos.x,y:this._options.bubblePos.y,width:a.width,height:a.height}),this.BuildButtonSet(b));return this._bg};c.prototype.BuildTailImg=function(a,b){var c,e,d,g,v,n,u;c=b.x+b.width/2;e=b.y+b.height/2;g=!1;this._options.tailPos.x>b.x&&this._options.tailPos.x<b.x+
b.width&&this._options.tailPos.y>b.y&&this._options.tailPos.y<b.y+b.height&&(g=!0);if(!g)if(g=Math.sqrt(Math.pow(c-this._options.tailPos.x,2)+Math.pow(e-this._options.tailPos.y,2)),u=180/Math.PI*Math.atan2(this._options.tailPos.x-c,-(this._options.tailPos.y-e)),u-=180,d=b.width<b.height?Math.round(b.width/10*this._options.BubbleStyle.tailFatness):Math.round(b.height/10*this._options.BubbleStyle.tailFatness),40<d&&(d=40),"cloudy"===this._BubbleShape||"Cloudy"===this._BubbleShape){(v=D2LAdventureEngine.gu_StateManager.findComponent(this._id+
"_tail"))?v.ClearGroupContent():n={ID:this._id+"_tail",Type:"Group",interactive:"[%false]",tabEnabled:"[%false]",initRotationAngle:"[%num]"+u,initX:"[%num]"+c,initY:"[%num]"+e,regX:"[%num]"+Math.round(d/2),overflow:"hidden",initContent:[]};e=Math.round(g/40);3>e&&(e=3);for(c=0;c<e;)d=Math.round(2+40/c),10<d&&(d=10),d={ID:this._id+"_tail_circ_"+c,Type:"Shape",shapeType:"Circle",initX:"[%num]"+d,initY:"[%num]"+Math.round(g/e)*c,interactive:"[%false]",tabEnabled:"[%false]",color:"#F2F2F2",radius:"[%num]"+
d},v?n.addComponet(d):n.initContent.push(d),c++;a._initialized?a.addComponet(n):a.initContent.push(n)}else n={ID:this._id+"_tailShapeUnder",Type:"Shape",shapeType:"Line",interactive:"[%false]",initX:c,initY:e,color:this._options.BubbleStyle.color,initRotationAngle:u,tabEnabled:"[%false]",zpos:"bottom"},this._options.BubbleStyle.strokeWidth&&(n.strokeWidth=this._options.BubbleStyle.strokeWidth,n.strokeDash=this._options.BubbleStyle.strokeDash,n.strokeInside=this._options.BubbleStyle.strokeInside,n.strokeColor=
this._options.BubbleStyle.strokeColor),n.points=this._options.BubbleStyle.roundTail?[[d/2,0],[d/3,Math.round(g)/4*3],[-(d/3),Math.round(g)/4*3,0,Math.round(g)],[-(d/2),0]]:[[d/2,0],[0,Math.round(g)],[-(d/2),0]],this._tailShapeUnder=D2LAdventureEngine.gu_ComponentManager.BuildComponent(n,this.location),a._initialized?(a.addComponet(this._tailShapeUnder),this._tailShapeUnder.Update()):a.initContent.unshift(n),n={ID:this._id+"_tailShapeOver",Type:"Shape",shapeType:"Line",interactive:"[%false]",initX:c,
initY:e,tabEnabled:"[%false]",color:this._options.BubbleStyle.color,initRotationAngle:u},n.points=this._options.BubbleStyle.roundTail?[[d/2,0],[d/8,Math.round(g)/4*3],[-(d/8),Math.round(g)/4*3,0,Math.round(g)],[-(d/2),0]]:[[d/2,0],[0,Math.round(g)],[-(d/2),0]],this._tailShapeOver=D2LAdventureEngine.gu_ComponentManager.BuildComponent(n,this.location),a._initialized?(a.addComponet(this._tailShapeOver),this._tailShapeOver.Update(),this._tailShapeUnder.SetZPos("bottom")):a.initContent.push(n)};c.prototype.comp_Update=
function(a){this._NavPrevButton||(this._NavPrevButton=this.getComponetById(this._id+"_NavPrevButton"));this._NavNextButton||(this._NavNextButton=this.getComponetById(this._id+"_NavNextButton"));return c.__super__.comp_Update.call(this,a)};c.prototype.RequestNavigation=function(a){a.data&&("Next"===a.data[0]?(D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"nextButtonFunction"),this.HandleEndWinReq(a)):"Previous"===a.data[0]&&(D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"previousButtonFunction"),
this._currentPopContent.getComponetById(this._id+"_Content_"+this._PopulationDataIndex).Hide(),this._PopulationDataIndex-=2,this.HandleEndWinReq(a)))};c.prototype.HandleEndWinReq=function(a){this.SetNavButtons();return c.__super__.HandleEndWinReq.call(this,a)};c.prototype.SetNavButtons=function(){if(this._NavPrevButton)return 0<=this._PopulationDataIndex&&this._PopulationDataIndex!==this._PopulationDataMaxIndex-1?this._NavPrevButton.Show():this._NavPrevButton.Hide()};c.prototype.HandlePrevNavMouseOver=
function(a){if(a=this.getComponetById(this._id+"NavStateText"))return a.ChangeText(D2LAdventureEngine.gu_SpeechBubbleDefaults.langPrevButtonContext)};c.prototype.HandleNextNavMouseOver=function(a){if(a=this.getComponetById(this._id+"NavStateText"))return a.ChangeText(D2LAdventureEngine.gu_SpeechBubbleDefaults.langNextButtonContext)};c.prototype.HandleNavMouseOut=function(a){if(a=this.getComponetById(this._id+"NavStateText"))return a.ChangeText(D2LAdventureEngine.gu_SpeechBubbleDefaults.langDefaultNavText)};
c.prototype.BuildButtonSet=function(a){var b,c,e;if("BubbleNavLabled"===this._options.ButtonSet)void 0===this._options.previousButton?c={ID:this._id+"_NavPrevButton",AssetID:"DEF_BUBBLENAV_PREV",initHidden:!0,Type:"Button",InWinLockOverride:!0,events:{onClick:this.RequestNavigation,onClickData:["Previous",this._id],onOver:this.HandlePrevNavMouseOver,onOut:this.HandleNavMouseOut},useContext:D2LAdventureEngine.gu_SpeechBubbleDefaults.langPrevButtonContext,initX:0}:(c=D2LAdventureEngine.gu_DataManager.cloneDataObj(this._options.previousButton),
c.ID=this._id+"_NavPrevButton",c.InWinLockOverride=!0,void 0===c.AssetID&&(c.AssetID="DEF_BUBBLENAV_PREV"),void 0===c.Type&&(c.Type="Button"),void 0===c.events&&(c.events={}),void 0===c.events.onClick&&(c.events.onClick=this.RequestNavigation),void 0===c.events.onClickData&&(c.events.onClickData=["Previous",this._id]),void 0===c.events.onOver&&(c.events.onOver=this.HandlePrevNavMouseOver),void 0===c.events.onOut&&(c.events.onOut=this.HandleNavMouseOut),void 0===c.useContext&&(c.useContext=D2LAdventureEngine.gu_SpeechBubbleDefaults.langPrevButtonContext)),
void 0===this._options.nextButton?b={ID:this._id+"_NavNextButton",AssetID:"DEF_BUBBLENAV_NEXT",Type:"Button",InWinLockOverride:!0,events:{onClick:this.RequestNavigation,onClickData:["Next",this._id],onOver:this.HandleNextNavMouseOver,onOut:this.HandleNavMouseOut},useContext:D2LAdventureEngine.gu_SpeechBubbleDefaults.langNextButtonContext,initX:this._buttonHeightOffset/2+5}:(b=D2LAdventureEngine.gu_DataManager.cloneDataObj(this._options.previousButton),b.ID=this._id+"_NavPrevButton",b.InWinLockOverride=
!0,void 0===b.AssetID&&(b.AssetID="DEF_BUBBLENAV_PREV"),void 0===b.Type&&(b.Type="Button"),void 0===b.events&&(b.events={}),void 0===b.events.onClick&&(b.events.onClick=this.RequestNavigation),void 0===b.events.onClickData&&(b.events.onClickData=["Next",this._id]),void 0===b.events.onOver&&(b.events.onOver=this.HandleNextNavMouseOver),void 0===b.events.onOut&&(b.events.onOut=this.HandleNavMouseOut),void 0===b.useContext&&(b.useContext=D2LAdventureEngine.gu_SpeechBubbleDefaults.langNextButtonContext)),
e={ID:this._id+"NavStateText",Type:"Text","static":!0,InWinLockOverride:!0,initWidth:this._ContentRect.width,initHeight:"[%num]"+this._buttonHeightOffset,bubbleEvents:"[%true]",tabEnabled:"[%false]",align:"left",overflow:"hidden",selectionOveride:"[%true]",initX:this._buttonHeightOffset+15,initY:"[%num]2",sizeBoost:-2,InitText:D2LAdventureEngine.gu_SpeechBubbleDefaults.langDefaultNavText},void 0!==this._options.contentTextSizeBoost&&(e.sizeBoost+=this._options.contentTextSizeBoost),c={ID:this._id+
"_NavGroup",Type:"Group",tabEnabled:"[%false]",initContent:[c,b,e],initX:this._ContentRect.x+this._pdgOffset.x,initY:this._ContentRect.y+this._pdgOffset.y+this._ContentRect.height,initWidth:this._ContentRect.width,zpos:"top"};else if("BubbleNav"===this._options.ButtonSet){void 0===this._options.previousButton?c={ID:this._id+"_NavPrevButton",initHidden:!0,Type:"LabeledButton",InWinLockOverride:!0,events:{onClick:this.RequestNavigation,onClickData:["Previous",this._id]},InitText:"[%LANG GlobalSpeechBubbleOptions.langPrevButton]"}:
(c=D2LAdventureEngine.gu_DataManager.cloneDataObj(this._options.previousButton),c.ID=this._id+"_NavPrevButton",void 0===c.initHidden&&(c.initHidden=!0),c.InWinLockOverride=!0,void 0===c.Type&&(c.Type="LabeledButton"),void 0===c.textOptions&&(c.textOptions={}),void 0===c.baseOptions&&(c.baseOptions={}),void 0===c.events&&(c.events={}),void 0===c.events.onClick&&(c.events.onClick=this.RequestNavigation),void 0===c.events.onClickData&&(c.events.onClickData=["Previous",this._id]),void 0===c.InitText&&
(c.InitText="[%LANG GlobalSpeechBubbleOptions.langPrevButton]"),void 0===c.initX&&(e=this._options.useContentPadding,c.baseOptions.radius&&(e+=c.baseOptions.radius),c.baseOptions.xOffset&&(e+=c.baseOptions.xOffset),c.initX="[%num]"+e));e=0;if(a._initialized)(b=a.getComponetById(this._id+"_mainShape"))?e=b._options.rect.width+2*this._options.useContentPadding:(D2LAdventureEngine.gu_debugManager.log("warning at BuildButtonSet "+this._id+" unable to get useXpos as mainshape wasn't found"),e=0);else for(b=
0;b<a.initContent.length;)a.initContent[b].ID===this._id+"_mainShape"&&(e=a.initContent[b].rect.width+2*this._options.useContentPadding),b++;void 0===this._options.nextButton?b={ID:this._id+"_NavNextButton",Type:"LabeledButton",InWinLockOverride:!0,events:{onClick:this.RequestNavigation,onClickData:["Next",this._id]},InitText:"[%LANG GlobalSpeechBubbleOptions.langNextButton]",initX:"[%num]"+(e-130-2*this._options.useContentPadding)}:(b=D2LAdventureEngine.gu_DataManager.cloneDataObj(this._options.nextButton),
b.ID=this._id+"_NavNextButton",b.InWinLockOverride=!0,void 0===b.Type&&(b.Type="LabeledButton"),void 0===b.textOptions&&(b.textOptions={}),void 0===b.baseOptions&&(b.baseOptions={}),void 0===b.events&&(b.events={}),void 0===b.events.onClick&&(b.events.onClick=this.RequestNavigation),void 0===b.events.onClickData&&(b.events.onClickData=["Next",this._id]),void 0===b.InitText&&(b.InitText="[%LANG GlobalSpeechBubbleOptions.langNextButton]"),void 0===b.initX&&(e-=2*this._options.useContentPadding,e=void 0!==
b.initWidth?e-b.initWidth:e-130,b.baseOptions.radius&&(e-=b.baseOptions.radius),b.baseOptions.xOffset&&(e+=b.baseOptions.xOffset),b.initX="[%num]"+e));c={ID:this._id+"_NavGroup",Type:"Group",tabEnabled:"[%false]",overflow:"hidden",initContent:[c,b],initX:this._ContentRect.x+this._pdgOffset.x,initY:this._ContentRect.y+this._pdgOffset.y+this._ContentRect.height,initWidth:this._ContentRect.width,zpos:"top"}}a._initialized?(a.addComponet(c),this._buttonGrouping=this.getComponetById(this._id+"_NavGroup"),
this._buttonGrouping.Update()):a.initContent.push(c);return this._BtnsSet=!0};return c}(D2LAdventureEngine.comp_Window);window.D2LAdventureEngine.comp_Sprite=function(h){function c(a,b,l){this._id=a;this.location=b;this._options=l;this.changeSprite=d(this.changeSprite,this);this.GrabFrameAsData=d(this.GrabFrameAsData,this);this.containsAnimation=d(this.containsAnimation,this);this.play=d(this.play,this);this.stop=d(this.stop,this);this.TriggerAnimationEndEvent=d(this.TriggerAnimationEndEvent,this);
this.comp_Init=d(this.comp_Init,this);this.comp_AssessDefaultOptions=d(this.comp_AssessDefaultOptions,this);this._options||(this._options={initAnimation:void 0,initStopped:!1,useSpriteData:void 0});c.__super__.constructor.call(this,this._id,this.location,this._options)}q(c,h);c.prototype._sprite=void 0;c.prototype.comp_AssessDefaultOptions=function(){var a,b;void 0===this._options.useSpriteData?this._sprite=D2LAdventureEngine.gu_ResourceManager.get(this._options.AssetID,"sprite"):this._options.useSpriteData&&
(this._options.useSpriteData.constructor===createjs.Sprite?this._sprite=this._options.useSpriteData:this._options.useSpriteData.constructor===D2LAdventureEngine.SpriteDataObject?this._sprite=new createjs.Sprite(this._options.useSpriteData):D2LAdventureEngine.gu_debugManager.log("Error with Sprite: "+this._id+" requested bad useSpriteData option"));this._options.interactive&&void 0===this._options.useCursor?this._options.useCursor="pointer":this._options.interactive||void 0!==this._options.useCursor||
(this._options.useCursor="default");void 0===this._options.useCursorOnOut&&(this._options.useCursorOnOut="default");void 0!==this._options.initAnimation?"random"===this._options.initAnimation?(b=Math.floor(Math.random()*this._sprite.spriteSheet._animations.length)+1,this._sprite.gotoAndStop(b)):this.containsAnimation(this._options.initAnimation)?this._options.initStopped?this._sprite.gotoAndStop(this._options.initAnimation):this._sprite.gotoAndPlay(this._options.initAnimation):D2LAdventureEngine.gu_debugManager.log("Warning: sprite "+
this._id+" does not contain requested initAnimation "+this._options.initAnimation+" using default"):this.containsAnimation("default")?this._options.initStopped?this._sprite.gotoAndStop("default"):this._sprite.gotoAndPlay("default"):(D2LAdventureEngine.gu_debugManager.log("WARNING!: sprite "+this._id+" does not contain a 'default' animation"),this._options.initStopped?this._sprite.stop():this._sprite.play());void 0!==this._options.onEndAnimation&&(this._sprite.animationend=this.TriggerAnimationEndEvent);
a=function(a){return function(){void 0===a._options.initWidth&&(a._options.initWidth=a._sprite.spriteSheet.getFrameBounds(0).width);void 0===a._options.initHeight&&(a._options.initHeight=a._sprite.spriteSheet.getFrameBounds(0).height);void 0===a._options.scaleX&&void 0!==a._options.initWidth&&(a._options.scaleX=D2LAdventureEngine.gu_JsonOps.parseAllRules(a._options.initWidth,a)/(a.width=a._sprite.spriteSheet._frames[0].rect.width));void 0===a._options.scaleY&&void 0!==a._options.initHeight&&(a._options.scaleY=
D2LAdventureEngine.gu_JsonOps.parseAllRules(a._options.initHeight,a)/(a.width=a._sprite.spriteSheet._frames[0].rect.height));a.width=a._options.initWidth;a.height=a._options.initHeight;return D2LAdventureEngine.gu_EventManager.DispacthEvent(a,"onload")}}(this);if(this._sprite.spriteSheet.complete)return a(),this.PostLoadInit();this._postLoadReq=!0;return this._sprite.spriteSheet.addEventListener("complete",function(b){return function(){a();return b.PostLoadInit()}}(this))};c.prototype.comp_Init=function(){return this.addChild(this._sprite)};
c.prototype.TriggerAnimationEndEvent=function(){return D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onendanimation")};c.prototype.stop=function(a){return this._initialized?void 0===a?this._sprite.stop():this._sprite.gotoAndStop(a):this._options.initAnimation=a};c.prototype.play=function(a){return this._initialized?void 0===a?this._sprite.play():this._sprite.gotoAndPlay(a):this._options.initAnimation=a};c.prototype.containsAnimation=function(a){var b;if(!this._sprite.spriteSheet||!this._sprite.spriteSheet._animations)return!1;
for(b=0;b<this._sprite.spriteSheet._animations.length;){if(this._sprite.spriteSheet._animations[b]===a)return!0;b++}return!1};c.prototype.GrabFrameAsData=function(a){return D2LAdventureEngine.gu_DataManager.getImgData(this._image.image,this._sprite.spriteSheet._frames[a].rect)};c.prototype.changeSprite=function(a){if(this._initialized)return a.constructor===D2LAdventureEngine.SpriteDataObject?(this._options.AssetID=void 0,this._options.useSpriteData=a,this.removeChild(this._sprite),this._sprite=new createjs.Sprite(this._options.useSpriteData)):
a.constructor===String&&(this._options.useSpriteData=void 0,this._options.AssetID=a,this.removeChild(this._sprite),this._sprite=void 0!==this._options.AssetID?D2LAdventureEngine.gu_ResourceManager.get(this._options.AssetID,"button"):D2LAdventureEngine.gu_ResourceManager.get(this._id,"button")),this.addChild(this._sprite),this._sprite.gotoAndStop("norm"),this.width=this._sprite.spriteSheet._frames[0].rect.width,this.height=this._sprite.spriteSheet._frames[0].rect.height,this._options.initWidth=this.width,
this._options.initHeight=this.height,this.BufferTabOutline(),this.Update();if(a.constructor===D2LAdventureEngine.SpriteDataObject)return this._options.useSpriteData=a,this._options.AssetID=void 0;if(a.constructor===String)return this._options.useSpriteData=void 0,this._options.AssetID=a};return c}(D2LAdventureEngine.component);window.D2LAdventureEngine.comp_Text=function(d){function c(a,b,d,e){var f;this._id=a;this.location=b;this.text=d;this._options=null!=e?e:{align:"left",sizeBoost:null,forceSize:void 0,
kerning:null,color:void 0,onOverColor:void 0,onDownColor:void 0,backgroundColor:void 0,weight:void 0,italic:void 0,vCenter:!0,fontFamily:void 0,overflow:"hidden",classes:void 0,zIndex:void 0,upperCase:!1,listenToIFrames:!0,scrollBarWidth:20,allowDefault:!1,role:void 0,InitReadOrder:1,"static":!1,selectionOveride:!1,padding:void 0,cursorOveride:void 0,lineHeight:void 0,tabEnabled:!1,strokeColor:void 0,strokeWidth:void 0,interactive:!1,characterLimit:void 0,limitCapText:void 0,useMobileMode:void 0,
forceTextWidth:void 0};void 0===this._options.useMobileMode&&(this._options.useMobileMode="auto");this._mobileMode="auto"===this._options.useMobileMode?D2LAdventureEngine.gu_mobileDevice:this._options.useMobileMode?!0:!1;this.onOutContextHideOverride=!1;this.disabledTag="<span style='font-size:0px; line-height: 0px;'>(disabled button)</span>";this.assciotedAccessSection=void 0;this.built=!1;this.actveIndexPos=void 0;this.sceneAdjustedHeight=this.sceneAdjustedWidth=0;this.inWinLockHidden=!1;this.inWinTextMem=
"";this.contains_iFrame=!1;this._usingColor=void 0;this._readOrderPos=-1;this._AriaFlowTo=void 0;this._containsInteractives=this._isHTMLtext=this._initialized=this._onTabbbingList=this._inTabFocus=!1;this._textInteractives=[];this._containsLoadables=!1;this._LoadableTags=[];this.offScreen=this.contentLoaded=!1;this.scrollOffsets={left:0,top:0};this.inWinHideActive=this.inWinHideReq=!1;this.matxPos={x:0,y:0};this.LastParentCord={x:0,y:0};a=!1;for(f=0;f<D2LAdventureEngine.gu_ActiveTextCompObjects.length;)D2LAdventureEngine.gu_ActiveTextCompObjects[f]._id===
this._id&&(D2LAdventureEngine.gu_ActiveTextCompObjects[f]=this,a=!0,this.actveIndexPos=f),f++;a||(D2LAdventureEngine.gu_ActiveTextCompObjects.push(this),this.actveIndexPos=D2LAdventureEngine.gu_ActiveTextCompObjects.length-1);this.linkedAccessShape=void 0;this.comp_AssessDefaultOptions=function(a){return function(){void 0===a._options.events&&(a._options.events={});a.text=void 0===a.text?"-NULL-":D2LAdventureEngine.gu_JsonOps.parseAllRules(a.text,a);-1!==a.text.indexOf("[%js]")&&(a.text=D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(a.text));
a.width=null===a._options.initWidth?D2LAdventureEngine.gu_canDi.width:a._options.initWidth*a.scaleX;a.height=null===a._options.initHeight||void 0===a._options.initHeight?null:a._options.initHeight*a.scaleY;a._usingColor=a._options.color;(a._options.onDownColor||a._options.onOverColor)&&void 0===a._options.interactive&&(a._options.interactive=!0);void 0===a._options.align&&(a._options.align="left");void 0===a._options.sizeBoost&&(a._options.sizeBoost=0);void 0===a._options.kerning&&(a._options.kerning=
0);void 0===a._options.vCenter&&(a._options.vCenter=!1);void 0===a._options.overflow&&(a._options.overflow="hidden");void 0===a._options.allowDefault&&(a._options.allowDefault=!1);a._options.initDisabled&&a.comp_Disable();void 0===a._options.upperCase&&(a._options.upperCase=!1);void 0===a._options.selectionOveride&&(a._options.selectionOveride=!1);void 0===a._options.visibleOffCanvas&&(a._options.visibleOffCanvas=!1);if(a._options.strokeWidth||a._options.strokeColor)void 0===a._options.strokeWidth&&
(a._options.strokeWidth=1),void 0===a._options.strokeColor&&(a._options.strokeColor="#000000");void 0===a._options.tabEnabled&&(a._options.tabEnabled=!1);void 0===a._options.interactive&&(a._options.interactive=void 0!==a._options.events.onClick||void 0!==a._options.events.onOver||void 0!==a._options.events.onOut?!0:!1);void 0===a._options.scrollBarWidth&&(a._options.scrollBarWidth=20);void 0===a._options.listenToIFrames&&(a._options.listenToIFrames=!0);if(a._options.interactive&&void 0===a._options.useCursor)return a._options.useCursor=
"pointer";if(!a._options.interactive&&void 0===a._options.useCursor)return a._options.useCursor="default"}}(this);this.comp_Init=function(a){return function(){a.hidden||a._options.initHidden||(a.createDOMelm(),a.buildAccessShape());!a._options.initDisabled&&a.text&&-1!==a.text.indexOf(a.disabledTag)&&a.ChangeText(a.text.replace(a.disabledTag,""));a._isDOMObject=!0;a._initialized=!0;return a.Update()}}(this);this.comp_getHeight=function(a){return function(){var b;b=document.getElementById(a._id+"_Wrapper");
return a.built&&void 0!==b&&null!==b?b.offsetHeight:Math.round((window.D2LAdventureEngine.gu_DynamicTextBaseSize+a._options.sizeBoost)*a.scaleY*D2LAdventureEngine.gu_canDi.scaleFactor)}}(this);this.bufferAccessShape=function(a){return function(){if(a._options.tabEnabled)return D2LAdventureEngine.gu_TabManager.AddTextBufferRequest(a._id)}}(this);this.removeAccessShape=function(a){return function(){return D2LAdventureEngine.gu_TabManager.RemoveTextBufferRequest(a._id)}}(this);this.buildAccessShape=
function(a){return function(){var b;if(a.built&&!a._options.bypassAccessability)return D2LAdventureEngine.gu_TabManager.RemoveBufferRequest(a._id),a._accessShape&&(a._accessShape.Destroy(),a.topGroup&&a.topGroup.removeComponet(a._id+"_accessShape")),b={ID:a._id+"_accessShape",Type:"Shape - Rectangle",color:"#FAFAFA",initAlpha:.01,allowMouseThrough:!0,interactive:!1,tabEnabled:!1,noOutline:a._options.noOutline,isAccessLinkedTo:a._id,initX:0,initY:0,rect:{x:0,y:0,width:a.getWidth(),height:a.getHeight()}},
a._options.forceOutlineRect&&(b.rect.width=a._options.forceOutlineRect.width,b.rect.height=a._options.forceOutlineRect.height,b.initX=a._options.forceOutlineRect.x,b.initY=a._options.forceOutlineRect.y),a.topGroup?(a.topGroup._globalPos.x||a.topGroup.AssessGlobalPos(),b.initX+=a.x-a.topGroup._globalPos.x,b.initY+=a.y-a.topGroup._globalPos.y,a._accessShape=D2LAdventureEngine.gu_ComponentManager.BuildComponent(b,a.location),a._accessShape._isAccessShape=!0,a.topGroup.getComponetById(a._accessShape._id)||
a.topGroup.addComponet(a._accessShape,{inital:!0})):(b.initX=a.x,b.initY=a.y,a._accessShape=D2LAdventureEngine.gu_ComponentManager.BuildComponent(b,a.location),a.parentScene.addChild(a._accessShape)),a._accessShape.Update(),D2LAdventureEngine.gu_TabManager.AddTextShapeBufferRequest(b.ID)}}(this);this.comp_Show=function(a){return function(){a.built||a.createDOMelm();a._accessShape&&a._accessShape.Show();return a.RefreshStyles()}}(this);this.comp_Hide=function(a){return function(){a.built&&a.unbuild();
a._accessShape&&a._accessShape.Hide();return a.RefreshStyles()}}(this);this.comp_Resize=function(a){return function(b,c){a.width=b;a.height=c;a.RefreshStyles();return a.buildAccessShape()}}(this);this.comp_Update=function(a){return function(b){if(a._initialized&&null!==a.parent){if(a.parent.x!==a.LastParentCord.x||a.parent.y!==a.LastParentCord.y)a.isVisible()&&a.HandleWinScrollEvent(),a.LastParentCord={x:a.parent.x,y:a.parent.y};if(a.sceneAdjustedWidth!==a.width)return a.sceneAdjustedWidth=a.width,
a.sceneAdjustedHeight=a.height,a.RefreshStyles()}}}(this);this.comp_Move=function(a){return function(b){if(!a.built)return a._options.initX=b.newPostion.x,a._options.initY=b.newPostion.y;if(a.isVisible())return a.HandleWinScrollEvent()}}(this);this.comp_Scale=function(a){return function(b){if(a.isVisible())return a.HandleWinScrollEvent()}}(this);this.comp_SetAlpha=function(a){return function(b,c){a._options.initAlpha=b;return a.RefreshStyles()}}(this);this.SetCharLimit=function(a){return function(b){void 0!==
a._options.characterLimit&&b.length>a._options.characterLimit&&(b=void 0!==a._options.limitCapText?b.substr(0,a._options.characterLimit)+a._options.limitCapText:b.substr(0,a._options.characterLimit));return b}}(this);this.iframeScanning=function(a){return function(){var b;if(-1!==a.text.indexOf("<iframe")){if(a.contains_iFrame=!0,a._options.listenToIFrames)for(b=document.getComponetById("#"+a._id+"_text iframe"),f=0;f<b.length;)"complete"!==b.readyState&&(b.onload=function(b){b=b.target.contentDocument.body;
b.onclick="if(window.parent.D2LAdventureEngine.gu_ActiveTextCompObjects["+a.actveIndexPos+"]){window.parent.D2LAdventureEngine.gu_ActiveTextCompObjects["+a.actveIndexPos+"].HandleClickReq(event);}";b.onmousedown="if(window.parent.D2LAdventureEngine.gu_ActiveTextCompObjects["+a.actveIndexPos+"]){window.parent.D2LAdventureEngine.gu_ActiveTextCompObjects["+a.actveIndexPos+"].HandleOnDownReq(event);}";b.onmouseover="if(window.parent.D2LAdventureEngine.gu_ActiveTextCompObjects["+a.actveIndexPos+"]){window.parent.D2LAdventureEngine.gu_ActiveTextCompObjects["+
a.actveIndexPos+"].HandleOnOverReq(event);}";b.onmouseout="if(window.parent.D2LAdventureEngine.gu_ActiveTextCompObjects["+a.actveIndexPos+"]){window.parent.D2LAdventureEngine.gu_ActiveTextCompObjects["+a.actveIndexPos+"].HandleOnOutReq(event);}";return b.onmousemove="if(window.parent.D2LAdventureEngine.gu_ActiveTextCompObjects["+a.actveIndexPos+"]){window.parent.D2LAdventureEngine.gu_ActiveTextCompObjects["+a.actveIndexPos+"].HandleOnMoveReq(event);}"}),f++}else a.contains_iFrame=!1}}(this);this.ScanText=
function(a){return function(){if(-1!==a.text.indexOf("<")&&-1!==a.text.indexOf(">")){a._isHTMLtext=!0;if(-1!==a.text.indexOf("<textarea")||-1!==a.text.indexOf("<input")||-1!==a.text.indexOf("<a"))a._containsInteractives=!0,a._options.allowDefault=!0;if(-1!==a.text.indexOf("<img")||-1!==a.text.indexOf("<embed")||-1!==a.text.indexOf("<video")||-1!==a.text.indexOf("<iframe"))a._containsLoadables=!0;return a.iframeScanning()}}}(this);this.SetTextInteractives=function(a){return function(b){a._textInteractives=
[];if(a._containsInteractives)return a._textInteractives=a._textInteractives.concat(Array.prototype.slice.call(b.getElementsByTagName("textarea"))),a._textInteractives=a._textInteractives.concat(Array.prototype.slice.call(b.getElementsByTagName("input"))),a._textInteractives=a._textInteractives.concat(Array.prototype.slice.call(b.getElementsByTagName("a")))}}(this);this.SetTextLoadables=function(a){return function(b){var c,e;a._LoadableTags=[];c=!1;if(a._containsLoadables)for(a._LoadableTags=a._LoadableTags.concat(Array.prototype.slice.call(b.getElementsByTagName("img"))),
a._LoadableTags=a._LoadableTags.concat(Array.prototype.slice.call(b.getElementsByTagName("embed"))),a._LoadableTags=a._LoadableTags.concat(Array.prototype.slice.call(b.getElementsByTagName("video"))),a._LoadableTags=a._LoadableTags.concat(Array.prototype.slice.call(b.getElementsByTagName("iframe"))),e=b=0;e<a._LoadableTags.length;)null!==a._LoadableTags[e].onLoad&&void 0!==a._LoadableTags[e].onLoad||a._LoadableTags[e].complete?b++:(a._LoadableTags[e].addEventListener("load",function(b){void 0===b.target.complete&&
(b.target.complete=!0);return D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos].CheckLoadables()}),a._LoadableTags[e].addEventListener("loadeddata",function(b){void 0===b.target.complete&&(b.target.complete=!0);return D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos].CheckLoadables()})),e++,b===a._LoadableTags.length&&(c=!0,a.contentLoaded=!0);else c=!0,a.contentLoaded=!0;if(!0===c&&void 0!==a._options.onContentLoaded)return D2LAdventureEngine.gu_EventManager.DispacthEvent(a,
"oncontentloaded")}}(this);this.CheckLoadables=function(a){return function(){var b,c;c=0;for(b=[];c<a._LoadableTags.length;)a._LoadableTags[c].complete&&(a.contentLoaded=!0,void 0!==a._options.onContentLoaded&&D2LAdventureEngine.gu_EventManager.DispacthEvent(a,"oncontentloaded")),b.push(c++);return b}}(this);this.ChangeText=function(a){return function(b,c){var e;if(a.text!==b&&b)return-1!==b.indexOf("[%js]")&&(b=D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(b)),b=D2LAdventureEngine.gu_JsonOps.LangTagsCheck(b),
a._initialized?(void 0!==a.inWinTextMem&&""!==b&&(a.inWinTextMem=b),a.built&&void 0!==b?(a.text=b,a.ScanText(),e=document.getElementById(a._id+"_text"),null!==e&&(e.innerHTML=a.SetCharLimit(a.text),a.SetTextInteractives(e))):a._built||(a.text=b)):(a.text=b,a._options.InitText=a.text,void 0!==a.inWinTextMem&&(a.inWinTextMem=a.text)),c||a.buildAccessShape(),a.RefreshStyles()}}(this);this.AppendText=function(a){return function(b){if(b)return a.built&&(a.text+=b,a.ScanText(),b=document.getElementById(a._id+
"_text"),null!==b&&(b.innerHTML=a.SetCharLimit(a.text),a.SetTextInteractives(b))),a.buildAccessShape(),a.RefreshStyles()}}(this);this.comp_BuildAccessContext=function(a){return function(){return!1}}(this);this.StringFunctionCall=function(a){return function(b,c){void 0!==a.text[b]&&a.text[b].constructor===Function&&(void 0===c?c=[]:c.constructor!==Array&&(c=[c]));return a.ChangeText(a.text[b].apply(a.text,c))}}(this);this.ChangeColor=function(a){return function(b,c){c&&(void 0===c||"norm"!==c&&"normal"!==
c)?"over"===c?a._options.onOverColor=b:"down"===c?a._options.onDownColor=b:D2LAdventureEngine.gu_debugManager.log("ERROR!: ChangeColor does not recognize state "+c):a._options.color=b;a._usingColor=a._options.color;return a.RefreshStyles()}}(this);this.comp_CheckClippingRules=function(a){return function(){return a.RefreshStyles()}}(this);this.updateGlobalATCO=function(a){return function(){var b,c;b=!1;for(c=0;c<window.D2LAdventureEngine.gu_ActiveTextCompObjects.length;){if(D2LAdventureEngine.gu_ActiveTextCompObjects[c]._id===
a._id){D2LAdventureEngine.gu_ActiveTextCompObjects[c]=a;b=!0;break}c++}if(b){c=0;for(b=[];c<window.D2LAdventureEngine.gu_ActiveTextCompObjects.length;){if(D2LAdventureEngine.gu_ActiveTextCompObjects[c]._id===a._id){a.actveIndexPos=c;break}b.push(c++)}return b}D2LAdventureEngine.gu_ActiveTextCompObjects.push(a);return a.actveIndexPos=D2LAdventureEngine.gu_ActiveTextCompObjects.length-1}}(this);this.createDOMelm=function(a){return function(){var b,c,e,d,f;(null!==document.getElementById(a._id+"_Wrapper")||
a.built)&&a.unbuild();d=a._id+"_Wrapper";e=document.createElement("div");e.setAttribute("id",d);void 0!==a._options.role&&"hidden"!==a._options.role&&e.setAttribute("role",a._options.role);e.setAttribute("aria-live","assertive");D2LAdventureEngine.gu_ScreenReaderAccessible&&"hidden"!==a._options.role||(e.setAttribute("aria-hidden","true"),e.setAttribute("aria-live","off"),e.setAttribute("aria-label",""));a.updateGlobalATCO();c="";a._options.selectionOveride&&(c+="unselectable ",e.setAttribute("unselectable",
"on"));""!==c&&e.setAttribute("class",c+" AdventureText");a.WrapperStyle=a.buildWrapperStyles();e.setAttribute("style","width:"+a.WrapperStyle.width+"px; "+a.WrapperStyle.height+" visibility:hidden; position:absolute; "+a.WrapperStyle.padding+" text-align:"+a._options.align+"; "+a.WrapperStyle.clipping+" "+a.WrapperStyle.border+" "+a.WrapperStyle.useCursor+" "+a.WrapperStyle.backgroundColor+" "+a.WrapperStyle.vCent+" "+a.WrapperStyle.textTransform+" "+a.WrapperStyle.zIndex+" "+a.WrapperStyle.opacity+
" "+a.WrapperStyle.overflow+" "+a.WrapperStyle.cursor);b=a._id+"_text";f="AdventureText";void 0!==a._options.classes&&(f=f+" "+a._options.classes);a.iframeScanning();a.contains_iFrame&&(f+=" embd_iFrame");c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("class",f);b=a.buildInstStyles();c.setAttribute("style",b.size+" "+b.weight+" "+b.fontStyle+" "+b.padding+" "+b.kerning+" "+b.colorDet+" "+b.fontFamily+" "+b.vCent+" "+b.stroke);a.ScanText();c.innerHTML=a.SetCharLimit(a.text);
a.SetTextInteractives(c);a.SetTextLoadables(c);a.hasWrapper=!0;b=function(b){var c,e;void 0===a._options.useContextParent&&(a._options.useContextParent="AE_sceneSection");if(c=a._options.useContextOptions){if(void 0!==c.insertBefore)return e=document.getElementById(c.insertBefore),null!==c.insertBefore?document.getElementById(a._options.useContextParent).insertBefore(b,e):D2LAdventureEngine.gu_debugManager.log(a._id+" failed to AddReadText  insertBefore failed to get ID");if(void 0!==c.insertAfter)return e=
document.getElementById(c.insertAfter).nextSibling,null!==c.insertAfter?document.getElementById(a._options.useContextParent).insertBefore(b,e):D2LAdventureEngine.gu_debugManager.log(a._id+" failed to AddReadText  insertAfter failed to get ID")}else return document.getElementById(a._options.useContextParent).appendChild(b)};void 0!==a._options.embedInWrapperID?null!==document.getElementById(a._options.embedInWrapperID)?(document.getElementById(a._options.embedInWrapperID).appendChild(c),a.hasWrapper=
!1):(D2LAdventureEngine.gu_debugManager.log('Warning comp_Text embedInWrapperID request "'+a._options.embedInWrapperID+'" was null, using default'),e.appendChild(c),b(e)):(e.appendChild(c),b(e));"none"!==a.assoiatedSceneID&&D2LAdventureEngine.gu_StateManager.GetSceneById(a.assoiatedSceneID).setTextReadOrder();a.hasWrapper&&(document.getElementById(d),a.HandleWinScrollEvent(!0),a.addChild(a.tstPnt));a._mobileMode?(e.addEventListener("touchstart",function(b){a._options.allowDefault||b.preventDefault();
b.changedTouches?(b.x=b.changedTouches[0].pageX,b.y=b.changedTouches[0].pageY,b.rawX=b.changedTouches[0].pageX,b.rawY=b.changedTouches[0].pageY,b.clientX=b.changedTouches[0].clientX,b.clientY=b.changedTouches[0].clientY):(b.x=b.pageX,b.y=b.pageY);return D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos]?(D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos].HandleOnOverReq(b),D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos].HandleOnDownReq(b)):a.HandleClickReq(b)}),e.addEventListener("touchend",
function(b){a._options.allowDefault||b.preventDefault();b.changedTouches?(b.x=b.changedTouches[0].pageX,b.y=b.changedTouches[0].pageY,b.rawX=b.changedTouches[0].pageX,b.rawY=b.changedTouches[0].pageY,b.clientX=b.changedTouches[0].clientX,b.clientY=b.changedTouches[0].clientY):(b.x=b.pageX,b.y=b.pageY);if(D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos])return D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos].HandleClickReq(b),D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos].HandleOnOutReq(b)}),
e.addEventListener("touchmove",function(b){b.preventDefault();b.mPos={};b.changedTouches?(b.mPos.x=b.changedTouches[0].pageX,b.mPos.y=b.changedTouches[0].pageY,b.mPos.rawX=b.changedTouches[0].pageX,b.mPos.rawY=b.changedTouches[0].pageY,b.mPos.clientX=b.changedTouches[0].clientX,b.mPos.clientY=b.changedTouches[0].clientY):(b.mPos.x=b.pageX,b.mPos.y=b.pageY);b.origEvnt=b;if(D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos])return D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos].HandleOnMoveReq(b),
D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos].HandleMouseWheelReq(b)})):(a._options.interactive&&(e.addEventListener("click",function(b){a._options.allowDefault||b.preventDefault();a.updateGlobalATCO();return D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos]?D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos].HandleClickReq(b):a.HandleClickReq(b)}),e.addEventListener("mouseover",function(b){a._options.allowDefault||b.preventDefault();if(D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos])return D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos].HandleOnOverReq(b)}),
e.addEventListener("mousedown",function(b){a._options.allowDefault||b.preventDefault();if(D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos])return D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos].HandleOnDownReq(b)}),e.addEventListener("mouseout",function(b){a._options.allowDefault||b.preventDefault();if(D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos])return D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos].HandleOnOutReq(b)}),e.addEventListener("mousemove",
function(b){a._options.allowDefault||b.preventDefault();b.mPos={};b.changedTouches?(b.mPos.x=b.changedTouches[0].pageX,b.mPos.y=b.changedTouches[0].pageY,b.mPos.rawX=b.changedTouches[0].pageX,b.mPos.rawY=b.changedTouches[0].pageY,b.mPos.clientX=b.changedTouches[0].clientX,b.mPos.clientY=b.changedTouches[0].clientY):(b.mPos.x=b.pageX,b.mPos.y=b.pageY);b.origEvnt=b;if(D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos])return D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos].HandleOnMoveReq(b)})),
"Firefox"===window.D2LAdventureEngine.gu_userBrowser?e.addEventListener("DOMMouseScroll",a.HandleMouseWheelReq):e.addEventListener("mousewheel",function(b){if(D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos])return D2LAdventureEngine.gu_ActiveTextCompObjects[a.actveIndexPos].HandleMouseWheelReq(b)}));return a.built=!0}}(this);this.HandleClickReq=function(a){return function(b){a._options.interactive&&a._options.onOverColor&&(a._usingColor=a._options.onOverColor,a.RefreshStyles());D2LAdventureEngine.gu_EventManager.DispacthEvent(a,
"onclick");if(a.topGroup&&a._options.bubbleEvents)return a.topGroup.HandlePress(b)}}(this);this.HandleMouseWheelReq=function(a){return function(b){b.preventDefault();void 0===b.wheelDelta&&void 0!==b.detail&&(b.wheelDelta=-120*b.detail);a._MouseOver=!0;return a.HandleMouseWheel(b)}}(this);this.HandleOnMoveReq=function(a){return function(b){a._options.interactive&&D2LAdventureEngine.gu_StageEventManager.preHandleMouseMove(b);if(a.topGroup&&a._mobileMode)return a.topGroup.HandleMouseMove(b)}}(this);
this.HandleOnOverReq=function(a){return function(b){a._MouseOver=!0;a._options.onOverColor&&(a._usingColor=a._options.onOverColor,a.RefreshStyles());D2LAdventureEngine.gu_CSSManager.ChangeCursor(a._options.useCursor);void 0!==a.topGroup&&void 0!==a.topGroup._options.onOver&&a.topGroup.HandleMouseOver(b);if(a._options.events&&void 0!==a._options.events.onOver)return D2LAdventureEngine.gu_EventManager.DispacthEvent(a,"onover")}}(this);this.HandleOnDownReq=function(a){return function(b){a._MouseDown=
!0;if(a._options.interactive&&(a._options.onDownColor&&(a._usingColor=a._options.onDownColor,a.RefreshStyles()),a._options.events&&void 0!==a._options.events.onDown))return D2LAdventureEngine.gu_EventManager.DispacthEvent(a,"ondown")}}(this);this.HandleOnOutReq=function(a){return function(b){a._MouseOver=!1;if(a._options.interactive&&(a._usingColor!==a._options.color&&(a._usingColor=a._options.color,a.RefreshStyles()),a._options.useCursorOnOut?D2LAdventureEngine.gu_CSSManager.ChangeCursor(a._options.useCursorOnOut):
a.topGroup&&a.topGroup._options.useCursor&&D2LAdventureEngine.gu_CSSManager.ChangeCursor(a.topGroup._options.useCursor),a._options.events&&void 0!==a._options.events.onOut))return D2LAdventureEngine.gu_EventManager.DispacthEvent(a,"onout")}}(this);this.comp_HandleWheelUp=function(a){return function(b){if(void 0!==a.assignedScrollParent)return a.assignedScrollParent.comp_HandleWheelUp(b)}}(this);this.comp_HandleWheelDown=function(a){return function(b){if(void 0!==a.assignedScrollParent)return a.assignedScrollParent.comp_HandleWheelDown(b)}}(this);
this.ShowContext=function(a){return function(){if(a._options.useContext.constructor!==String)return D2LAdventureEngine.gu_GUIManager.ChangeContext(a._id);if(a._options.useContext.constructor===String)return D2LAdventureEngine.gu_GUIManager.ChangeContext(a._options.useContext)}}(this);this.HideContext=function(a){return function(){return D2LAdventureEngine.gu_GUIManager.ChangeContext("")}}(this);this.comp_HandleWindowSize=function(a){return function(b){var c;void 0===b&&(b=!1);if(a.built||b)return c=
document.getElementById(a._id+"_Wrapper"),a.hasWrapper&&null!==c&&(a.matxPos.x=Math.round(a._options.initX*D2LAdventureEngine.gu_canDi.scaleFactor+a.scrollOffsets.left),a.matxPos.y=Math.round((a._options.initY-D2LAdventureEngine.gu_canDi.height)*D2LAdventureEngine.gu_canDi.scaleFactor+a.scrollOffsets.top),a.LastParentCord=a.matxPos),a.RefreshStyles(b)}}(this);this.comp_HandleWinScrollEvent=function(a){return function(b){a.scrollOffsets.left=-D2LAdventureEngine.gu_canDi.containerScrollOffset.left;
a.scrollOffsets.top=-D2LAdventureEngine.gu_canDi.containerScrollOffset.top;a.comp_HandleWindowSize(b)}}(this);this.RefreshStyles=function(a){return function(b){var c;null==b&&(b=!1);if(a.built||b)return a.hasWrapper&&(c=a.buildWrapperStyles(),b=document.getElementById(a._id+"_Wrapper"),null!==b&&b.setAttribute("style",c.width+" "+c.height+" "+c.visibility+"text-align:"+a._options.align+"; position:absolute; "+c.padding+" "+c.clipping+" "+c.border+" "+c.backgroundColor+" "+c.textTransform+" "+c.vCent+
" "+c.overflow+" "+c.opacity+" "+c.zIndex+" "+c.cursor+" "+c.TransformMatrix)),c=a.buildInstStyles(),b=document.getElementById(a._id+"_text"),null!==b&&b.setAttribute("style",c.size+" "+c.width+" "+c.weight+" "+c.fontStyle+" "+c.visibility+" "+c.padding+" "+c.lineHeight+" "+c.kerning+" "+c.colorDet+" "+c.fontFamily+" "+c.vCent+" "+c.stroke),a.updateGlobalATCO()}}(this);this.getTrueHeight=function(a){return function(){var b;b=a.hasWrapper?document.getElementById(a._id+"_Wrapper"):document.getElementById(a._id+
"_text");return null!==b?b.offsetHeight:!1}}(this);this.getTrueWidth=function(a){return function(){var b;b=a.hasWrapper?document.getElementById(a._id+"_Wrapper"):document.getElementById(a._id+"_text");return null!==b?b.offsetWidth:!1}}(this);this.getLocalPosistion=function(a){return function(){return a.topGroup?{x:a.x-a.topGroup._globalPos.x,y:a.y-a.topGroup._globalPos.y}:{x:a.x,y:a.y}}}(this);this.buildWrapperStyles=function(a){return function(){var b,c,e,d,f;f={};void 0===a._options.overflow&&(a._options.overflow=
"hidden");-1===a._options.overflow.indexOf("scroll")&&-1===a._options.overflow.indexOf("auto")?(d=e=c=b="auto",void 0!==a.tabulatedClippingRule.top&&(b=a.tabulatedClippingRule.top+"px"),void 0!==a.tabulatedClippingRule.bottom&&(c=a.tabulatedClippingRule.bottom+"px"),void 0!==a.tabulatedClippingRule.left&&(e=a.tabulatedClippingRule.left+"px"),void 0!==a.tabulatedClippingRule.right&&(d=a.tabulatedClippingRule.right+"px"),f.clipping="clip:rect("+b+", "+d+", "+c+", "+e+");"):f.clipping="";f.width="width: "+
Math.round(a.sceneAdjustedWidth*a.scaleX*D2LAdventureEngine.gu_canDi.scaleFactor)+"px; ";f.height=null!==a.sceneAdjustedHeight?"height: "+Math.round(a.sceneAdjustedHeight*a.scaleY*D2LAdventureEngine.gu_canDi.scaleFactor)+"px; ":"";f.backgroundColor=void 0!==a._options.backgroundColor?"background-color:"+a._options.backgroundColor+"; ":"";f.useCursor=void 0!==a._options.useCursor?"cursor:"+a._options.useCursor+"; ":"cursor: "+D2LAdventureEngine.gu_CSSManager.usingDefaultCursor["default"]+"; ";f.cursor=
void 0!==a._options.cursorOveride?"cursor: "+a._options.cursorOveride+";":"cursor: "+D2LAdventureEngine.gu_CSSManager.usingDefaultCursor["default"]+"; ";f.border=void 0!==a._options.border?"border:"+a._options.border+"; ":"";f.visibility=!a.visible||a.offScreen||"out"===a.tabulatedClippingRule||a.inWinHideReq?"visibility: hidden; ":"";f.padding=a.hasWrapper?a.getPadding():"";f.vCent=a._options.vCenter?"display: table;":"";f.zIndex=a._options.zIndex?"z-index:"+a._options.zIndex+";":"";f.textTransform=
a._options.upperCase?"text-transform: uppercase;":"";a._options.initAlpha&&1!==a._options.initAlpha&&(f.opacity="-moz-opacity: "+a._options.initAlpha+"; -khtml-opacity: "+a._options.initAlpha+"; opacity: "+a._options.initAlpha+";");f.overflow="y-auto"===a._options.overflow?"overflow-y:auto; overflow-x:hidden;":"x-auto"===a._options.overflow?"overflow-x:auto; overflow-y:hidden;":"y-scroll"===a._options.overflow?"overflow-y:scroll; overflow-x:hidden;":"x-scroll"===a._options.overflow?"overflow-x:scroll; overflow-y:hidden;":
"overflow: "+a._options.overflow+";";f.TransformMatrix="IE"===D2LAdventureEngine.gu_userBrowser&&9===D2LAdventureEngine.gu_userBrowserVersion?"-ms-transform:matrix(1, 0, 0, 1, "+a.matxPos.x+", "+a.matxPos.y+");":"Chrome"!==D2LAdventureEngine.gu_userBrowser&&"Safari"!==D2LAdventureEngine.gu_userBrowser?"transform:matrix(1, 0, 0, 1, "+a.matxPos.x+", "+a.matxPos.y+");":"-webkit-transform:matrix(1, 0, 0, 1, "+a.matxPos.x+", "+a.matxPos.y+");";return f}}(this);this.buildInstStyles=function(a){return function(){var b,
c,e,d;e={};e.fontFamily=void 0!==a._options.fontFamily?"font-family:"+a._options.fontFamily+";":"";e.padding=a.hasWrapper?"":a.getPadding();b=Math.round((D2LAdventureEngine.gu_DynamicTextBaseSize+a._options.sizeBoost)*a.scaleX*D2LAdventureEngine.gu_canDi.scaleFactor);void 0===a._options.forceSize?(e.size=0!==a._options.SizeBoost?"font-size:"+b+"px;":"",e.lineHeight="line-height:"+Math.round(1.2*b)+"px;"):(e.size="font-size:"+a._options.forceSize+";",e.lineHeight="");a._options.forceTextWidth?(d=Math.round(a.sceneAdjustedWidth*
a.scaleX*D2LAdventureEngine.gu_canDi.scaleFactor),a.hasWrapper&&"hidden"!==a._options.overflow&&"visible"!==a._options.overflow&&(c=document.getElementById(a._id+"_Wrapper"),b=document.getElementById(a._id+"_text"),null!==c&&null!==b&&0!==c.offsetHeight&&b.scrollHeight>c.offsetHeight&&(d-=a._options.scrollBarWidth)),e.width="width: "+d+"px; "):e.width="";void 0!==a._options.lineHeight?e.lineHeight="line-height:"+a._options.lineHeight+";":void 0===e.lineHeight&&(e.lineHeight="");e.kerning=0!==a._options.kerning?
"letter-spacing: "+a._options.kerning/10+"em;":"";e.stroke=void 0!==a._options.strokeWidth?"-webkit-text-stroke: "+a._options.strokeWidth*a.scaleX*D2LAdventureEngine.gu_canDi.scaleFactor+"px "+a._options.strokeColor+" ;":"";e.colorDet=void 0!==a._usingColor?"color:"+a._usingColor+"; ":"";e.weight=void 0!==a._options.weight?"font-weight:"+a._options.weight+"; ":"";e.fontStyle=void 0!==a._options.italic?"font-style: italic; ":"";e.vCent=a._options.vCenter?"display: table-cell; vertical-align: middle;":
"";e.visibility=a._options.visibility?"visibility: "+a._options.visibility+"; ":"";return e}}(this);this.getPadding=function(a){return function(){var b;b="";void 0!==a._options.padding&&(a._options.padding.constructor===Number?b="padding: "+a._options.padding*a.scaleX*D2LAdventureEngine.gu_canDi.scaleFactor+"px;":a._options.padding.constructor===String?b="padding:"+a._options.padding(NaN):"object"===typeof a._options.padding&&(void 0!==a._options.padding.left?a._options.padding.left.constructor===
Number?b+="padding-left: "+a._options.padding.left*a.scaleX*D2LAdventureEngine.gu_canDi.scaleFactor+"px; ":a._options.padding.left.constructor===String&&(b+="padding-left: "+a._options.padding.left+"; "):b+="padding-left: 0px;",void 0!==a._options.padding.top?a._options.padding.top.constructor===Number?b+="padding-top: "+a._options.padding.top*a.scaleX*D2LAdventureEngine.gu_canDi.scaleFactor+"px; ":a._options.padding.top.constructor===String&&(b+="padding-top: "+a._options.padding.top+"; "):b+="padding-top: 0px;",
void 0!==a._options.padding.right?a._options.padding.right.constructor===Number?b+="padding-right: "+a._options.padding.right*a.scaleX*D2LAdventureEngine.gu_canDi.scaleFactor+"px; ":a._options.padding.right.constructor===String&&(b+="padding-right: "+a._options.padding.right+"; "):b+="padding-right: 0px;",void 0!==a._options.padding.bottom?a._options.padding.bottom.constructor===Number?b+="padding-bottom: "+a._options.padding.bottom*a.scaleX*D2LAdventureEngine.gu_canDi.scaleFactor+"px; ":a._options.padding.bottom.constructor===
String&&(b+="padding-bottom: "+a._options.padding.bottom+"; "):b+="padding-bottom: 0px;"));return b}}(this);this.isVisible=function(a){return function(){return!1===a.inWinHideActive&&a.built?!0:!1}}(this);this.inWinHide=function(a){return function(){if(!a._options.InWinLockOverride&&!a.inWinHideActive&&(void 0!==a._options.useContext&&D2LAdventureEngine.gu_GUIManager.ChangeContext(""),a._onTabbingList&&(D2LAdventureEngine.gu_TabManager.UnassignAccessObject(a),a._WinTabLocked=!0),a.inWinTextMem=a.text,
a.inWinHideReq=!0,a.inWinHideActive=!0,a._initialized&&(a.ChangeText("",!0),a.RefreshStyles()),a._accessShape))return a._accessShape.Destroy()}}(this);this.inWinUnhide=function(a){return function(b){if(!a._options.InWinLockOverride&&a.inWinHideActive||b)return a.inWinLockHidden=!1,a._onTabbingList&&a._WinTabLocked&&(D2LAdventureEngine.gu_KeyManager.AccessObject(a),a._WinTabLocked=!1),b||(a.ChangeText(a.inWinTextMem,!0),a.inWinTextMem=""),a.inWinHideReq=!1,a.inWinHideActive=!1,b&&a.RefreshStyles(),
a.HandleWinScrollEvent(!0)}}(this);this.unbuild=function(a){return function(){var b,c;a.built?(void 0!==a._options.embedInWrapperID?null!==document.getElementById(a._options.embedInWrapperID)?document.getElementById(a._options.embedInWrapperID).removeChild(insttxtElem):(b=document.getElementById(a._id+"_Wrapper"),c=document.getElementById(a._options.useContextParent),null!==c&&null!==b&&c.removeChild(b)):(b=document.getElementById(a._id+"_Wrapper"),c=document.getElementById(a._options.useContextParent),
null!==c&&null!==b&&c.removeChild(b)),"none"!==a.assoiatedSceneID&&D2LAdventureEngine.gu_StateManager.GetSceneById(a.assoiatedSceneID).setTextReadOrder()):null!==document.getElementById(a._id+"_Wrapper")&&null!==document.getElementById(a._options.useContextParent)&&document.getElementById(a._options.useContextParent).removeChild(document.getElementById(a._id+"_Wrapper"));return a.built=!1}}(this);this.comp_destroy=function(a){return function(b){var c,e,d;a.unbuild();a._onTabbbingList&&(D2LAdventureEngine.gu_TabManager.UnassignAccessObject(a),
a._onTabbbingList=!1);d=0;for(e=!1;d<D2LAdventureEngine.gu_ActiveTextCompObjects.length;)c=D2LAdventureEngine.gu_ActiveTextCompObjects[d],c._id===a._id?(D2LAdventureEngine.gu_ActiveTextCompObjects.splice(d,1),a.actveIndexPos=void 0,d=0,e=!0):e&&c.updateGlobalATCO(),d++;if(a._accessShape)return a._accessShape.Destroy(b)}}(this);this.comp_Disable=function(a){return function(){a.text&&-1===a.text.indexOf(a.disabledTag)&&a.ChangeText(a.disabledTag+a.text,!0);if(a._accessShape)return a._accessShape.Disable()}}(this);
this.comp_Enable=function(a){return function(){a.text&&-1!==a.text.indexOf(a.disabledTag)&&a.ChangeText(a.text.replace(a.disabledTag,""));if(a._accessShape)return a._accessShape.Enable()}}(this);this.comp_HandleFocus=function(a){return function(){a._accessShape&&!a._options.noOutline&&(a._accessShape._tabOutline?a._accessShape._tabOutline.visible=!0:a.buildAccessShape());if(a._containsInteractives){if(0===a._textInteractives.length&&a.SetTextInteractives(document.getElementById(a._id+"_text")),a._textInteractives[0].focus(),
a._textInteractives[0].constructor!==HTMLAnchorElement)return D2LAdventureEngine.gu_KeyManager.DeactivateKey("gDefKey_AcessMode_Activate")}else return a._containsInteractives=!1}}(this);this.comp_HandleFocusActivation=function(a){return function(){if(a._textInteractives[0].constructor===HTMLAnchorElement)return window.location="javascript:window.open(BSB_CONFIG.DocumentionLinkage, '_blank')"}}(this);this.comp_HandleUnfocus=function(a){return function(){a._accessShape&&a._accessShape._tabOutline&&
!a._options.noOutline&&(a._accessShape._tabOutline.visible=!1);if(a._containsInteractives&&(document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur(),0!==a._textInteractives.length&&a._textInteractives[0].constructor!==HTMLAnchorElement))return D2LAdventureEngine.gu_KeyManager.ActivateKey("gDefKey_AcessMode_Activate")}}(this);this.convertToStatic=function(a){return function(){var b;b=a.clone(void 0,!0);b["static"]=!0;b.initX-=a.topGroup._globalPos.x;b.initY-=a.topGroup._globalPos.y;
b.baseDataOveride&&(b.baseDataOveride.baseDataOveride=void 0);b=D2LAdventureEngine.gu_ComponentManager.BuildComponent(b,a.location);a.topGroup?(a.topGroup.removeComponet(a._id),a.topGroup.addComponet(b)):D2LAdventureEngine.gu_StateManager.GetSceneById(a.location.scene).addChild(b);return a.Destroy()}}(this);c.__super__.constructor.call(this,this._id,this.location,this._options)}q(c,d);return c}(D2LAdventureEngine.component);window.D2LAdventureEngine.comp_Shape=function(d){function c(a,b,d){this._id=
a;this.location=b;this._options=d;void 0===this._options&&(this._options={shapeType:void 0,shapeData:void 0,shapeObject:void 0,color:void 0,strokeWidth:void 0,strokeInside:void 0,capStyle:void 0,jointStyle:void 0,miterLimit:void 0,strokeColor:void 0,strokeBitmap:void 0,strokeDash:void 0});this.comp_AssessDefaultOptions=function(a){return function(){var b,c,d;void 0===a._options.color&&(a._options.color="none");void 0===a._options.strokeWidth&&(a._options.strokeWidth=0);void 0===a._options.capStyle&&
(a._options.capStyle=0);void 0===a._options.jointStyle&&(a._options.jointStyle=0);void 0===a._options.miterLimit&&(a._options.miterLimit=10);void 0===a._options.strokeInside&&(a._options.strokeInside=!0);if(void 0!==a._options.rect)return a.width=Math.abs(a._options.rect.width),a.height=Math.abs(a._options.rect.height);if(void 0!==a._options.radius)return a.width=Math.abs(2*a._options.radius),a.height=Math.abs(2*a._options.radius),a.regX=-a._options.radius,a.regY=-a._options.radius;if(void 0!==a._options.points){c=
[];d=[];for(b=0;b<a._options.points.length;)c.push(a._options.points[b].x),d.push(a._options.points[b].y),b++;a.width=Math.max.apply(Math,c)+a._options.strokeWidth;return a.height=Math.max.apply(Math,d)+a._options.strokeWidth}return D2LAdventureEngine.gu_debugManager.log("WARNING:  comp_Shape unable to define width and height")}}(this);this.comp_Init=function(a){return function(){a.DrawShape();return a.addChild(a._shape)}}(this);this.comp_getWidth=function(a){return function(){var b,c;if(void 0===
a.width||isNaN(a.width)){if(a._options.rect&&void 0!==a._options.rect.width)return a._options.rect.width;if(void 0!==a._options.radius)return 2*a._options.radius;if(void 0!==a._options.points){c=[];for(b=0;b<a._options.points.length;)void 0!==a._options.points[b].x?c.push(a._options.points[b].x):a._options.points[b].constructor===Array&&c.push(a._options.points[b][0]),b++;b=Math.min.apply(Math,c);c=Math.max.apply(Math,c);a.width=c+-1*b;return a.width}}else return a.width}}(this);this.comp_getHeight=
function(a){return function(){var b,c;if(void 0===a.height||isNaN(a.height)){if(a._options.rect&&void 0!==a._options.rect.height)return a._options.rect.height;if(void 0!==a._options.radius)return 2*a._options.radius;if(void 0!==a._options.points){c=[];for(b=0;b<a._options.points.length;)void 0!==a._options.points[b].y?c.push(a._options.points[b].y):a._options.points[b].constructor===Array&&c.push(a._options.points[b][1]),b++;b=Math.min.apply(Math,c);c=Math.max.apply(Math,c);a.height=c+-1*b;return a.height}}else return a.height}}(this);
this.DrawShape=function(a){return function(){if("Shape - Rectangle"===a._options.Type||"Rectangle"===a._options.shapeType||"Rect"===a._options.shapeType)return a.buildRectShape();if("Shape - Round Rectangle"===a._options.Type||"Round Rectangle"===a._options.shapeType||"RoundRect"===a._options.shapeType)return a.buildRoundRectShape();if("Shape - Circle"===a._options.Type||"Circle"===a._options.shapeType)return a.buildCircShape();if("Shape - Line"===a._options.Type||"Line"===a._options.shapeType)return a.buildLineShape()}}(this);
this.comp_Resize=function(a){return function(b,c){a._options.rect?(a._options.rect.width=b,a._options.rect.height=c,a.width=Math.abs(a._options.rect.width),a.height=Math.abs(a._options.rect.height)):a._options.radius&&(a._options.radius=b);return a.Rebuild()}}(this);this.comp_RequestCloneSafeData=function(a){return function(){var b,c;c={};for(b in a._options)"shapeObject"!==b&&(c[b]=a._options[b]);for(b in a._options.shapeData)void 0===c[b]&&(c[b]=a._options[b]);return c}}(this);this.Rebuild=function(a){return function(){if(a._initialized&&
(a._shape.graphics.clear(),a._shape.uncache(),a.removeChild(a._shape),a.DrawShape(),a.addChild(a._shape),a._options.initAlpha))return a._shape.alpha=a._options.initAlpha}}(this);this.DefineCJSGraphics=function(a){return function(){var b;b=new createjs.Graphics;"none"===a._options.color?b.beginFill("rgba(0,0,0,0)"):void 0!==a._options.color?b.beginFill(D2LAdventureEngine.gu_JsonOps.parseAllRules(a._options.color,a)):b.beginFill("#FF0000");void 0!==a._options.strokeWidth&&0!==a._options.strokeWidth&&
(a._options.strokeDash&&b.setStrokeDash(a._options.strokeDash).command,b.setStrokeStyle(a._options.strokeWidth,a._options.capStyle,a._options.jointStyle,a._options.miterLimit),void 0===a._options.strokeColor&&void 0===a._options.strokeBitmap&&(a._options.strokeColor="#000000"));void 0!==a._options.strokeColor&&void 0===a._options.strokeBitmap?b.beginStroke(a._options.strokeColor):void 0!==a._options.strokeBitmap&&b.beginBitmapStroke(a._options.strokeBitmap);return b}}(this);this.buildLineShape=function(a){return function(){var b,
c;c=a.DefineCJSGraphics();if(a._options.points.constructor!==Array||2>a._options.points.length)D2LAdventureEngine.gu_debugManager.log("points data for comp "+a._options.ID+" is not correct format"),a._options.points=void 0;a._options.points=void 0!==a._options.points?D2LAdventureEngine.gu_JsonOps.parseAllRules(a._options.points,a):[[0,0],[100,100]];a._options.points[0].x?c.mt(a._options.points[0].x,a._options.points[0].y):c.mt(a._options.points[0][0],a._options.points[0][1]);for(b=1;b<a._options.points.length;)a._options.points[b].x?
c.lt(a._options.points[b].x,a._options.points[b].y):a._options.points[b].constructor===Array&&(5===a._options.points[b].length?c.at(a._options.points[b][2],a._options.points[b][3],a._options.points[b][4],a._options.points[b][0],a._options.points[b][1]):4===a._options.points[b].length?c.qt(a._options.points[b][2],a._options.points[b][3],a._options.points[b][0],a._options.points[b][1]):c.lt(a._options.points[b][0],a._options.points[b][1])),b++;c.endFill();c.endStroke();a._options.shapeData=D2LAdventureEngine.gu_DataManager.cloneDataObj(a._options);
return a._shape=new createjs.Shape(c)}}(this);this.buildRectShape=function(a){return function(){var b;b=a.DefineCJSGraphics();void 0!==a._options.rect?(a._options.rect=D2LAdventureEngine.gu_JsonOps.parseAllRules(a._options.rect,a),a._options.strokeInside&&a._options.strokeWidth?b.rect(a._options.rect.x+a._options.strokeWidth/2,a._options.rect.y+a._options.strokeWidth/2,a._options.rect.width-a._options.strokeWidth,a._options.rect.height-a._options.strokeWidth):b.rect(a._options.rect.x,a._options.rect.y,
a._options.rect.width,a._options.rect.height)):a._options.strokeInside&&a._options.strokeWidth?b.rect(a._options.strokeWidth,a._options.strokeWidth,100-a._options.strokeWidth,100-a._options.strokeWidth):b.rect(0,0,100,100);b.endFill();a._options.shapeData=D2LAdventureEngine.gu_DataManager.cloneDataObj(a._options);return a._shape=new createjs.Shape(b)}}(this);this.buildRoundRectShape=function(a){return function(){var b,c;b=a.DefineCJSGraphics();void 0!==a._options.rect?(a._options.rect=D2LAdventureEngine.gu_JsonOps.parseAllRules(a._options.rect,
a),c=void 0!==a._options.rect.radius?D2LAdventureEngine.gu_DataManager.cloneDataObj(a._options.rect.radius):void 0!==a._options.radius?D2LAdventureEngine.gu_DataManager.cloneDataObj(a._options.radius):0,c.constructor===Number?a._options.strokeInside&&a._options.strokeWidth?b.drawRoundRect(a._options.rect.x+a._options.strokeWidth/2,a._options.rect.y+a._options.strokeWidth/2,a._options.rect.width-a._options.strokeWidth,a._options.rect.height-a._options.strokeWidth,c-a._options.strokeWidth/2):b.drawRoundRect(a._options.rect.x,
a._options.rect.y,a._options.rect.width,a._options.rect.height,c):c.constructor===Array&&(1===c.length&&(c[1]=c[0]),2===c.length&&(c[2]=c[0],c[3]=c[1]),3===c.length&&(c[3]=c[2]),a._options.strokeInside&&a._options.strokeWidth?(c[0]=Math.max(0,Math.round(c[0]-a._options.strokeWidth/2)),c[1]=Math.max(0,Math.round(c[1]-a._options.strokeWidth/2)),c[2]=Math.max(0,Math.round(c[2]-a._options.strokeWidth/2)),c[3]=Math.max(0,Math.round(c[3]-a._options.strokeWidth/2)),b.drawRoundRectComplex(a._options.rect.x+
a._options.strokeWidth/2,a._options.rect.y+a._options.strokeWidth/2,a._options.rect.width-a._options.strokeWidth,a._options.rect.height-a._options.strokeWidth,c[0],c[1],c[2],c[3])):b.drawRoundRectComplex(a._options.rect.x,a._options.rect.y,a._options.rect.width,a._options.rect.height,c[0],c[1],c[2],c[3]))):b.rect(0,0,100,100,10);b.endFill();a._options.shapeData=D2LAdventureEngine.gu_DataManager.cloneDataObj(a._options);return a._shape=new createjs.Shape(b)}}(this);this.buildCircShape=function(a){return function(){var b;
b=a.DefineCJSGraphics();void 0!==a._options.radius?(a._options.radius=D2LAdventureEngine.gu_JsonOps.parseAllRules(a._options.radius,a),b.drawCircle(0,0,a._options.radius)):b.drawCircle(0,0,100);b.endFill();a._options.shapeData=D2LAdventureEngine.gu_DataManager.cloneDataObj(a._options);return a._shape=new createjs.Shape(b)}}(this);c.__super__.constructor.call(this,this._id,this.location,this._options)}q(c,d);c._isAccessShape=void 0;return c}(D2LAdventureEngine.component);window.D2LAdventureEngine.comp_Timer=
function(d){function c(a,b,d){this._id=a;this.location=b;this._options=null!=d?d:{StartingSeconds:void 0,StartStopped:!0,ShowText:!0,TextFont:"bold 24px "+D2LAdventureEngine.gu_CSSManager._globalDefaultFont,TextColor:"#000000",onTick:void 0,ShowMilliseconds:!0,ShowSeconds:!0,ShowMinutes:!0,ShowHours:!1};this._text=void 0;this._inWinStopped=this._stopped=!1;this._memTime=0;this._initTime=void 0;this.MCount=0;this._timeData={};window.D2LAdventureEngine.gu_ActiveTimerCompObjects.push(this);this.actveIndexPos=
window.D2LAdventureEngine.gu_ActiveTimerCompObjects.length-1;this.comp_AssessDefaultOptions=function(a){return function(){void 0===a._options.StartingSeconds&&(a._options.StartingSeconds=0);a.MCount=60*a._options.StartingSeconds;a._options.interactive&&void 0===a._options.useCursor?a._options.useCursor="pointer":a._options.interactive||void 0!==a._options.useCursor||(a._options.useCursor="default");void 0===a._options.useCursorOnOut&&(a._options.useCursorOnOut="default");a._timeData={millisecond:Math.floor(a.MCount%
1E3),seconds:Math.floor(a.MCount/1E3)%60,minutes:Math.floor(a.MCount/1E3/60)%60,hours:Math.floor(a.MCount/1E3/60/60)%60};void 0===a._options.StartStopped&&(a._options.StartStopped=!0);a._stopped=a._options.StartStopped;void 0===a._options.ShowText&&(a._options.ShowText=!0);void 0===a._options.TextFont&&(a._options.TextFont="bold 24px "+D2LAdventureEngine.gu_CSSManager._globalDefaultFont);void 0===a._options.TextColor&&(a._options.TextColor="#000000");void 0===a._options.ShowMilliseconds&&(a._options.ShowMilliseconds=
!0);void 0===a._options.ShowSeconds&&(a._options.ShowSeconds=!0);void 0===a._options.ShowMinutes&&(a._options.ShowMinutes=!0);void 0===a._options.ShowHours&&(a._options.ShowHours=!1);return a._options.tabEnabled=!1}}(this);this.comp_Init=function(a){return function(){if(a._options.ShowText)return a._text=new createjs.Text(a.getTimeString(),a._options.TextFont,a._options.TextColor),a.addChild(a._text)}}(this);this.comp_Update=function(a){return function(b){if(a._initialized&&!a._stopped&&!a._inWinStopped&&
(void 0===a._initTime&&(a._initTime=b.time),a.MCount=Math.floor(b.time-a._initTime+a._memTime),a._timeData={millisecond:Math.floor(a.MCount%1E3),seconds:Math.floor(a.MCount/1E3)%60,minutes:Math.floor(a.MCount/1E3/60)%60,hours:Math.floor(a.MCount/1E3/60/60)%60},a._text.text=a.getTimeString(),a._options.onTickData=a.MCount,b={compRef:a,interactionType:"onTick",data:a._options.onTickData},void 0!==a._options.onTick)){if(a._options.onTick.constructor===Function)return a._options.onTick(b);if(a._options.onTick.constructor===
String)return"none"!==a.assoiatedStateID?D2LAdventureEngine.gu_StateManager.GetStateRef(a.assoiatedStateID).callCustomFunction(a._options.onTick,b):D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(a._options.onTick,b)}}}(this);this.Stop=function(a){return function(){a._stopped=!0;return a._memTime=a.MCount}}(this);this.Start=function(a){return function(){a._stopped=!1;return a._initTime=void 0}}(this);this.inWinStop=function(a){return function(){if(!a._options.InWinLockOverride)return a._inWinStopped=
!0,a._memTime=a.MCount}}(this);this.inWinStart=function(a){return function(){if(!a._options.InWinLockOverride)return a._inWinStopped=!1,a._initTime=void 0}}(this);this.Reset=function(a){return function(){a.MCount=0;a._memTime=0;return a._initTime=void 0}}(this);this.getTimeString=function(a){return function(){var b,c;c="";a._options.ShowHours&&(b=0===a._timeData.hours?"00":10>a._timeData.hours?"0"+a._timeData.hours:a._timeData.hours,c+=b+":");a._options.ShowMinutes&&(b=0===a._timeData.minutes?"00":
10>a._timeData.minutes?"0"+a._timeData.minutes:a._timeData.minutes,c+=b+":");a._options.ShowSeconds&&(b=0===a._timeData.seconds?"00":10>a._timeData.seconds?"0"+a._timeData.seconds:a._timeData.seconds,c+=b);a._options.ShowMilliseconds&&(b=0===a._timeData.millisecond?"000":100>a._timeData.millisecond&&10<=a._timeData.millisecond?"0"+a._timeData.millisecond:10>a._timeData.millisecond?"00"+a._timeData.millisecond:a._timeData.millisecond,c+="."+b);return c}}(this);c.__super__.constructor.call(this,this._id,
this.location,this._options)}q(c,d);return c}(D2LAdventureEngine.component);window.D2LAdventureEngine.comp_Toggle=function(h){function c(a,b,l){this._id=a;this.location=b;this._options=l;this.GrabToggleFrame=d(this.GrabToggleFrame,this);this.changeSprite=d(this.changeSprite,this);this.Deactivate=d(this.Deactivate,this);this.Activate=d(this.Activate,this);this.toggleShowHitmask=d(this.toggleShowHitmask,this);this.useCustomDynamicMask=d(this.useCustomDynamicMask,this);this.comp_Disable=d(this.comp_Disable,
this);this.comp_isUnderCheck=d(this.comp_isUnderCheck,this);this.comp_Enable=d(this.comp_Enable,this);this.comp_HandleMouseOver=d(this.comp_HandleMouseOver,this);this.comp_HandleMouseOut=d(this.comp_HandleMouseOut,this);this.comp_HandlePress=d(this.comp_HandlePress,this);this.ChangeAsset=d(this.ChangeAsset,this);this.InitHitmask=d(this.InitHitmask,this);this.comp_Init=d(this.comp_Init,this);this.comp_AssessDefaultOptions=d(this.comp_AssessDefaultOptions,this);this.comp_getHeight=d(this.comp_getHeight,
this);this.comp_getWidth=d(this.comp_getWidth,this);this._options||(this._options={startActive:!1,initState:"inactiveNorm",dynamicHitmask:!1,clickToggle:!0,ClusterIndex:void 0});this._showingHitmask=this._Active=!1;c.__super__.constructor.call(this,this._id,this.location,this._options)}q(c,h);c.prototype._idInCluster=void 0;c.prototype._Active=void 0;c.prototype._showingHitmask=void 0;c.prototype.comp_getWidth=function(){var a,b,c,d,f;if(this.width)return this.width;if(this._options.useSpriteData){b=
[];f=this._options.useSpriteData._frames;c=0;for(d=f.length;c<d;c++)a=f[c],b.push(a.rect.width);a=Math.max.apply(Math,b);return isNaN(a)?(D2LAdventureEngine.gu_debugManager.log("NaN frame width value found in Toggle "+this._id),!1):a}return this._options.AssetID?window.D2LAdventureEngine.gu_ResourceManager.preDetermineImageDimentions(this._options.AssetID).width:!1};c.prototype.comp_getHeight=function(){var a,b,c,d,f;if(this.height)return this.height;if(this._options.useSpriteData){b=[];f=this._options.useSpriteData._frames;
c=0;for(d=f.length;c<d;c++)a=f[c],b.push(a.rect.height);a=Math.max.apply(Math,b);return isNaN(a)?(D2LAdventureEngine.gu_debugManager.log("NaN frame height value found in Toggle "+this._id),!1):a}return this._options.AssetID?window.D2LAdventureEngine.gu_ResourceManager.preDetermineImageDimentions(this._options.AssetID).height:!1};c.prototype.comp_AssessDefaultOptions=function(){var a;void 0===this._options.useSpriteData?(void 0===this._options.AssetID&&(this._options.AssetID="defaultToggle"),this._sprite=
D2LAdventureEngine.gu_ResourceManager.get(this._options.AssetID,"toggle")):this._options.useSpriteData&&(this._options.useSpriteData.constructor===createjs.Sprite?this._sprite=this._options.useSpriteData:this._options.useSpriteData.constructor===D2LAdventureEngine.SpriteDataObject?this._sprite=new createjs.Sprite(this._options.useSpriteData):D2LAdventureEngine.gu_debugManager.log("Error with toggle: "+this._id+" requested bad useSpriteData option"));void 0===this._options.initState?this._options.initState=
"inactiveNorm":"disabled"===this._options.initState&&(this._enabled=!1);void 0===this._options.clickToggle&&(this._options.clickToggle=!0);void 0===this._options.interactive&&(this._options.interactive=!0);void 0===this._options.useCursor&&(this._options.useCursor="pointer");void 0===this._options.useCursorOnOut&&(this._options.useCursorOnOut="default");a=function(a){return function(){void 0===a._options.initWidth&&(a._options.initWidth=a._sprite.spriteSheet.getFrameBounds(0).width);void 0===a._options.initHeight&&
(a._options.initHeight=a._sprite.spriteSheet.getFrameBounds(0).height);void 0===a._options.scaleX&&void 0!==a._options.initWidth&&(a._options.scaleX=D2LAdventureEngine.gu_JsonOps.parseAllRules(a._options.initWidth,a)/(a.width=a._sprite.spriteSheet._frames[0].rect.width));void 0===a._options.scaleY&&void 0!==a._options.initHeight&&(a._options.scaleY=D2LAdventureEngine.gu_JsonOps.parseAllRules(a._options.initHeight,a)/(a.width=a._sprite.spriteSheet._frames[0].rect.height));a.width=a._options.initWidth;
a.height=a._options.initHeight;void 0===a._options.startActive&&(a._options.startActive=!1);a._options.startActive&&(a._Active=!0,a._options.initState="activeNorm");return D2LAdventureEngine.gu_EventManager.DispacthEvent(a,"onload")}}(this);if(this._sprite.spriteSheet.complete)return a(),this._postLoadReq=!1;this._postLoadReq=!0;return this._sprite.spriteSheet.addEventListener("complete",function(b){return function(){a();return b.PostLoadInit()}}(this))};c.prototype.comp_Init=function(){this.addChild(this._sprite);
this._sprite.gotoAndStop(this._options.initState);return this.InitHitmask()};c.prototype.InitHitmask=function(){var a;if(this._options.dynamicHitmask&&(a=this.GrabToggleFrame("hitMask"),this.dynamicHitmask=new createjs.Bitmap,this.dynamicHitmask.image=a.image,this.dynamicHitmask.sourceRect=a.sourceRect,this.dynamicHitmask.x=0,this.dynamicHitmask.y=0,this._sprite.hitArea=this.dynamicHitmask,this._showingHitmask))return this._sprite.hitArea.visible=this._showingHitmask,this.dynamicHitmask.alpha=.1,
this.addChild(this._sprite.hitArea)};c.prototype.ChangeAsset=function(a){this.removeChild(this._sprite);this._options.AssetID=a;this._sprite=window.D2LAdventureEngine.gu_ResourceManager.get(this._options.AssetID,"sprite");this.addChild(this._sprite);this.width=this._sprite.spriteSheet._frames[0].rect.width;this.height=this._sprite.spriteSheet._frames[0].rect.height;return this.InitHitmask()};c.prototype.comp_HandlePress=function(){if(void 0===this._options.ClusterIndex){if(this._Active)return this.Deactivate(),
this._sprite.gotoAndStop("inactiveOver");this.Activate();return this._sprite.gotoAndStop("activeOver")}};c.prototype.comp_HandleMouseOut=function(){return this._Active?this._sprite.gotoAndStop("activeNorm"):this._sprite.gotoAndStop("inactiveNorm")};c.prototype.comp_HandleMouseOver=function(){return this._Active?this._sprite.gotoAndStop("activeOver"):this._sprite.gotoAndStop("inactiveOver")};c.prototype.comp_Enable=function(){return this._Active?this._sprite.gotoAndStop("activeNorm"):this._sprite.gotoAndStop("inactiveNorm")};
c.prototype.comp_isUnderCheck=function(a,b){var c,d;return this._sprite?(c=!1,this._sprite.hitArea&&(this._sprite.hitArea.visible=!0,c=a-this.x,d=b-this.y,c=this._sprite.hitArea.hitTest(c,d),this._sprite.hitArea.visible=this._showingHitmask),c):!1};c.prototype.comp_Disable=function(){return this._sprite.gotoAndStop("disabled")};c.prototype.useCustomDynamicMask=function(a){this._sprite.hitArea=a;return this._options.dynamicHitmask=!0};c.prototype.toggleShowHitmask=function(a){};c.prototype.Activate=
function(){if(!this._Active)return this._Active=!0,this._sprite.gotoAndStop("activeNorm"),D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"onactivate")};c.prototype.Deactivate=function(){this._Active&&(this._Active=!1,this._sprite.gotoAndStop("inactiveNorm"));return D2LAdventureEngine.gu_EventManager.DispacthEvent(this,"ondeactivate")};c.prototype.changeSprite=function(a){a.constructor===D2LAdventureEngine.SpriteDataObject?(this._options.AssetID=void 0,this._options.useSpriteData=a,this.removeChild(this._sprite),
this._sprite=new createjs.Sprite(this._options.useSpriteData)):a.constructor===String&&(this._options.useSpriteData=void 0,this._options.AssetID=resourceID,this.removeChild(this._sprite),this._sprite=void 0!==this._options.AssetID?D2LAdventureEngine.gu_ResourceManager.get(this._options.AssetID,"button"):D2LAdventureEngine.gu_ResourceManager.get(this._id,"button"));this.addChild(this._sprite);this.width=this._sprite.spriteSheet._frames[0].rect.width;this.height=this._sprite.spriteSheet._frames[0].rect.height;
this._options.initWidth=this.width;this._options.initHeight=this.height;this.Update();return this._sprite.gotoAndStop(this._options.initState)};c.prototype.GrabToggleFrame=function(a,b){var c,d;void 0===b&&(b=0);c=this._sprite.spriteSheet.getAnimation(a).frames[b];d=new createjs.Bitmap(this._sprite.spriteSheet._frames[c].image);d.sourceRect=this._sprite.spriteSheet._frames[c].rect;return d};return c}(D2LAdventureEngine.component);window.D2LAdventureEngine.comp_PaintArea=function(h){function c(a,b,
l){this._id=a;this.location=b;this._options=l;this.ChangeColor=d(this.ChangeColor,this);this.EjectShape=d(this.EjectShape,this);this.comp_HandleMouseMove=d(this.comp_HandleMouseMove,this);this.comp_HandleMouseOut=d(this.comp_HandleMouseOut,this);this.comp_HandleMouseUp=d(this.comp_HandleMouseUp,this);this.comp_HandlePress=d(this.comp_HandlePress,this);this.getComponetById=d(this.getComponetById,this);this.comp_Init=d(this.comp_Init,this);this.comp_AssessDefaultOptions=d(this.comp_AssessDefaultOptions,
this);this._options||(this._options={strokeWidth:3,strokeColor:"#000000",ejectShapesTo:"parent",ejectToPos:!1,ejectToPosDynamic:!0,ejectedShapeProperties:{},ejectedShapeContainerProperties:{},ejectAsUDC:!1,drawOffsetX:0,drawOffsetY:0,ejectOffsetX:0,ejectOffsetY:0,paintWithBitmap:!1,throttle:0,onEject:void 0,onEjectData:void 0});c.__super__.constructor.call(this,this._id,this.location,this._options)}q(c,h);c.prototype.DrawingStatus=void 0;c.prototype.DrawingArea=void 0;c.prototype.CurrentDrawInstructs=
void 0;c.prototype.CurrentImage=void 0;c.prototype.ProdID=void 0;c.prototype.EjectedObjects=void 0;c.prototype.LastEjectedObject=void 0;c.prototype._trottleCount=void 0;c.prototype.comp_AssessDefaultOptions=function(){this.DrawingStatus="initializing";this.CurrentDrawInstructs=[];this.EjectedObjects=[];this._trottleCount=0;this.CurrentImage=new createjs.Shape;this.addChild(this.CurrentImage);this.ProdID=1;this._options.interactive=!0;this.width=void 0===this._options.initWidth?200:this._options.initWidth;
this.height=void 0===this._options.initHeight?200:this._options.initHeight;void 0===this._options.strokeWidth&&(this._options.strokeWidth=3);void 0===this._options.strokeColor&&(this._options.strokeColor="#000000");void 0===this._options.ejectShapesTo&&(this._options.ejectShapesTo="parent");void 0===this._options.ejectedShapeProperties&&(this._options.ejectedShapeProperties={});void 0===this._options.ejectedShapeContainerProperties&&(this._options.ejectedShapeContainerProperties={});void 0===this._options.ejectAsUDC&&
(this._options.ejectAsUDC=!1);void 0===this._options.drawOffsetX&&(this._options.drawOffsetX=0);void 0===this._options.drawOffsetY&&(this._options.drawOffsetY=0);void 0===this._options.ejectOffsetX&&(this._options.ejectOffsetX=0);void 0===this._options.ejectOffsetY&&(this._options.ejectOffsetY=0);void 0===this._options.ejectToPosDynamic&&(this._options.ejectToPosDynamic=!0);void 0===this._options.useCursor&&(this._options.useCursor="pointer");return!1};c.prototype.comp_Init=function(){var a;a=new createjs.Graphics;
a.beginFill("rgba(255,255,255,0.01 )");a.rect(0,0,this.width,this.height);a.endFill();this.DrawingArea=new createjs.Shape(a);this.addChild(this.DrawingArea);return this.DrawingStatus="ready"};c.prototype.getComponetById=function(a){return a===this._id+"_DrawingArea"?this.DrawingArea:!1};c.prototype.comp_HandlePress=function(a){var b,c;if("ready"===this.DrawingStatus)return this.CurrentImage.visible=!0,a.clientX?(b=a.clientX,c=a.clientY):a.x&&(b=a.x,c=a.y),D2LAdventureEngine.gu_GUIManager.AccessCur._active?
this.CurrentDrawInstructs.push([b-this._globalPos.x+this._options.drawOffsetX,c-this._globalPos.y+this._options.drawOffsetY+20]):this.CurrentDrawInstructs.push([b-this._globalPos.x+this._options.drawOffsetX,c-this._globalPos.y+this._options.drawOffsetY]),this.DrawingStatus="drawing"};c.prototype.comp_HandleMouseUp=function(a){if("drawing"===this.DrawingStatus)return this.EjectShape(),this.DrawingStatus="ready"};c.prototype.comp_HandleMouseOut=function(a){"drawing"===this.DrawingStatus&&(this.EjectShape(),
this.DrawingStatus="ready");return D2LAdventureEngine.gu_CSSManager.ChangeCursor("default")};c.prototype.comp_HandleMouseMove=function(a){var b;D2LAdventureEngine.gu_GUIManager.AccessCur._active?(b=a.mPos.x-this._globalPos.x,a=a.mPos.y-this._globalPos.y+20):(b=a.mPos.x-this._globalPos.x+this._options.drawOffsetX,a=a.mPos.y-this._globalPos.y+this._options.drawOffsetY);this._trottleCount++;if("drawing"===this.DrawingStatus&&(D2LAdventureEngine.gu_CSSManager.ChangeCursor("crosshair"),this._trottleCount>=
this._options.throttle)){this._trottleCount=0;if(0>b||b>this.width-this._options.strokeWidth/2||a<this.y+this._options.strokeWidth/2||a>this.height-this._options.strokeWidth/2)return this.comp_HandleMouseOut();this.CurrentDrawInstructs.push([b,a]);if(1<this.CurrentDrawInstructs.length){b=new createjs.Graphics;b.setStrokeStyle(this._options.strokeWidth,"round","round",100);this._options.paintWithBitmap?b.beginBitmapStroke(this._options.paintWithBitmap):b.beginStroke(this._options.strokeColor);b.moveTo(this.CurrentDrawInstructs[0][0],
this.CurrentDrawInstructs[0][1]);for(a=1;a<this.CurrentDrawInstructs.length;)b.lineTo(this.CurrentDrawInstructs[a][0],this.CurrentDrawInstructs[a][1]),a++;b.endStroke();return this.CurrentImage.graphics=b}}};c.prototype.EjectShape=function(){var a,b,c,d,f,g,h;g=[];if(1===this.CurrentDrawInstructs.length){if(this.CurrentDrawInstructs[0][0]<this.x+this._options.strokeWidth/2||this.CurrentDrawInstructs[0][0]>this.width-this._options.strokeWidth/2||this.CurrentDrawInstructs[0][1]<this.y+this._options.strokeWidth/
2||this.CurrentDrawInstructs[0][1]+1>this.height-this._options.strokeWidth/2){this.CurrentDrawInstructs=[];this.CurrentImage.graphics.clear();this.CurrentImage.visible=!1;return}d=[this.CurrentDrawInstructs[0][0],this.CurrentDrawInstructs[0][1]+1];this.CurrentDrawInstructs.push(d)}for(d=0;d<this.CurrentDrawInstructs.length;)g.push({x:this.CurrentDrawInstructs[d][0],y:this.CurrentDrawInstructs[d][1]}),d++;d=g[0].x;f=g[0].y;for(a=0;a<g.length;)d=Math.min(d,g[a].x),f=Math.min(f,g[a].y),a++;for(a=0;a<
g.length;)g[a].x-=Math.round(d-this._options.strokeWidth/2),g[a].y-=Math.round(f-this._options.strokeWidth/2),a++;a=this._options.ejectedShapeProperties;a.ID=this._id+"_Shape_"+this.ProdID;a.Type="Shape - Line";a.strokeWidth=this._options.strokeWidth;this._options.paintWithBitmap?a.strokeBitmap=this._options.strokeColor:a.strokeColor=this._options.strokeColor;!0===this._options.ejectAsUDC?(a.initX=0,a.initY=0,a.interactive=!1,a.allowMouseThrough=!0):(a.initX=Math.round(d-this._options.strokeWidth/
2)+this._options.ejectOffsetX,a.initY=Math.round(f-this._options.strokeWidth/2)+this._options.ejectOffsetY);a.capStyle="round";a.jointStyle="round";a.miterLimit=100;a.points=g;!0===this._options.ejectAsUDC&&(c=this._options.ejectedShapeContainerProperties,c.ID=this._id+"_ShapeUDC_"+this.ProdID,c.Type="UDC",c.initX=Math.round(d-this._options.strokeWidth/2)+this._options.ejectOffsetX,c.initY=Math.round(f-this._options.strokeWidth/2)+this._options.ejectOffsetY,c.outlineSettings={showOutline:!0,showLabel:!1},
c.initContent=[a]);"parent"===this._options.ejectShapesTo?this.topGroup?(!0===this._options.ejectAsUDC?(c.deselectComp=this.topGroup._id,b=D2LAdventureEngine.gu_ComponentManager.BuildComponent(c,this.topGroup.location)):b=D2LAdventureEngine.gu_ComponentManager.BuildComponent(a,this.topGroup.location),void 0!==this._options.ejectToPos?!0===this._options.ejectToPosDynamic?this.topGroup.addComponet(b,{addAt:this._options.ejectToPos+this.EjectedObjects.length}):this.topGroup.addComponet(b,{addAt:this._options.ejectToPos}):
this.topGroup.addComponet(b)):D2LAdventureEngine.gu_StateManager.GetSceneById(this.location.scene).addChild(D2LAdventureEngine.gu_ComponentManager.BuildComponent(a,this.location)):this._options.ejectShapesTo.constructor===String?(h=D2LAdventureEngine.gu_StateManager.findComponent(this._options.ejectShapesTo),!1!==h&&void 0!==h.addComponet?(!0===this._options.ejectAsUDC?(c.deselectComp=h._id,b=D2LAdventureEngine.gu_ComponentManager.BuildComponent(c,h.location)):b=D2LAdventureEngine.gu_ComponentManager.BuildComponent(a,
h.location),h.addComponet(b)):D2LAdventureEngine.gu_debugManager.log("Attempt to eject shape from "+this._id+" to target has failed, target is not a group comp")):this._options.ejectShapesTo.constructor===Object&&void 0!==this._options.ejectShapesTo.addComponet?(!0===this._options.ejectAsUDC?(c.deselectComp=h._id,b=D2LAdventureEngine.gu_ComponentManager.BuildComponent(c,h.location)):b=D2LAdventureEngine.gu_ComponentManager.BuildComponent(a,h.location),this._options.ejectShapesTo.addComponet(b)):D2LAdventureEngine.gu_debugManager.log("Attempt to eject shape from "+
this._id+" to target has failed, target is not a group comp");this.ProdID++;this.CurrentDrawInstructs=[];this.CurrentImage.graphics.clear();this.CurrentImage.visible=!1;b&&(this.EjectedObjects.push(b),this.LastEjectedObject=b);b={interactionType:"onEject",compRef:this.LastEjectedObject,data:this._options.onEjectData};if(void 0!==this._options.onEject){if(this._options.onEject.constructor===Function)return this._options.onEject(b);if(this._options.onEject.constructor===String)return D2LAdventureEngine.gu_CustomFunctionsManager.CallGlobalFunc(this._options.onEject,
b)}};c.prototype.ChangeColor=function(a){return this._options.strokeColor=a};return c}(D2LAdventureEngine.component);window.D2LAdventureEngine.comp_Button=function(h){function c(a,b,h){this._id=a;this.location=b;this._options=h;this.comp_BuildAccessContext=d(this.comp_BuildAccessContext,this);this.GrabButtonFrame=d(this.GrabButtonFrame,this);this.changeSprite=d(this.changeSprite,this);this.toggleShowHitmask=d(this.toggleShowHitmask,this);this.useCustomDynamicMask=d(this.useCustomDynamicMask,this);
this.comp_isUnderCheck=d(this.comp_isUnderCheck,this);this.comp_Disable=d(this.comp_Disable,this);this.comp_Enable=d(this.comp_Enable,this);this.comp_HandleMouseOver=d(this.comp_HandleMouseOver,this);this.comp_HandleMouseOut=d(this.comp_HandleMouseOut,this);this.comp_HandlePress=d(this.comp_HandlePress,this);this.comp_Update=d(this.comp_Update,this);this.comp_getHeight=d(this.comp_getHeight,this);this.comp_getWidth=d(this.comp_getWidth,this);this.comp_Init=d(this.comp_Init,this);this.comp_AssessDefaultOptions=
d(this.comp_AssessDefaultOptions,this);this._options||(this._options={initState:"norm",dynamicHitmask:!1,overideAnimations:!1,useSpriteData:void 0,onLoad:void 0,onLoadData:void 0});c.__super__.constructor.call(this,this._id,this.location,this._options)}q(c,h);c.prototype._showingHitmask=!1;c.prototype._sprite=void 0;c.prototype.comp_AssessDefaultOptions=function(){var a;void 0===this._options.useSpriteData?this._sprite=D2LAdventureEngine.gu_ResourceManager.get(this._options.AssetID,"button"):this._options.useSpriteData&&
(this._options.useSpriteData.constructor===createjs.Sprite?this._sprite=this._options.useSpriteData:this._options.useSpriteData.constructor===D2LAdventureEngine.SpriteDataObject?this._sprite=new createjs.Sprite(this._options.useSpriteData):D2LAdventureEngine.gu_debugManager.log("Error with Button: "+this._id+" requested bad useSpriteData option"));this._sprite||D2LAdventureEngine.gu_debugManager.log("Error with Button: "+this._id+" no sprite data set");this._enabled||(this._options.initState="disabled");
void 0===this._options.initState?this._options.initState="norm":"disabled"===this._options.initState&&(this._enabled=!1);void 0===this._options.overideAnimations||!1===this._options.overideAnimations?this._stopAnimations=!1:!0===this._options.overideAnimations&&(this._stopAnimations=!0);void 0===this._options.interactive&&(this._options.interactive=!0);void 0===this._options.useCursor&&(this._options.useCursor="pointer");void 0===this._options.useCursorOnOut&&(this._options.useCursorOnOut="default");
a=function(a){return function(){void 0===a._options.initWidth&&(a._options.initWidth=a._sprite.spriteSheet.getFrameBounds(0).width);void 0===a._options.initHeight&&(a._options.initHeight=a._sprite.spriteSheet.getFrameBounds(0).height);void 0===a._options.scaleX&&void 0!==a._options.initWidth&&(a._options.scaleX=D2LAdventureEngine.gu_JsonOps.parseAllRules(a._options.initWidth,a)/(a.width=a._sprite.spriteSheet._frames[0].rect.width));void 0===a._options.scaleY&&void 0!==a._options.initHeight&&(a._options.scaleY=
D2LAdventureEngine.gu_JsonOps.parseAllRules(a._options.initHeight,a)/(a.width=a._sprite.spriteSheet._frames[0].rect.height));a.width=a._options.initWidth;a.height=a._options.initHeight;return D2LAdventureEngine.gu_EventManager.DispacthEvent(a,"onload")}}(this);if(this._sprite.spriteSheet.complete)return a(),this._postLoadReq=!1;this._postLoadReq=!0;return this._sprite.spriteSheet.addEventListener("complete",function(b){return function(){a();return b.PostLoadInit()}}(this))};c.prototype.comp_Init=
function(){var a;this._stopAnimations?this._sprite.gotoAndStop(this._options.initState):this._sprite.gotoAndPlay(this._options.initState);this.addChild(this._sprite);if(this._options.dynamicHitmask)return a=this.GrabButtonFrame("hitMask"),this.dynamicHitmask=new createjs.Bitmap,this.dynamicHitmask.image=a.image,this.dynamicHitmask.sourceRect=a.sourceRect,this.dynamicHitmask.x=0,this.dynamicHitmask.y=0};c.prototype.comp_getWidth=function(){var a,b,c,d,f;if(this.width)return this.width*this.scaleX;
if(this._options.useSpriteData){b=[];f=this._options.useSpriteData._frames;c=0;for(d=f.length;c<d;c++)a=f[c],b.push(a.rect.width);a=Math.max.apply(Math,b);return isNaN(a)?(D2LAdventureEngine.gu_debugManager.log("NaN frame width value found in Button "+this._id),!1):a}return D2LAdventureEngine.gu_ResourceManager.preDetermineSpriteDimentions(this._options.AssetID).width};c.prototype.comp_getHeight=function(){var a,b,c,d,f;if(this.height)return this.height*this.scaleY;if(this._options.useSpriteData){b=
[];f=this._options.useSpriteData._frames;c=0;for(d=f.length;c<d;c++)a=f[c],b.push(a.rect.height);a=Math.max.apply(Math,b);return isNaN(a)?(D2LAdventureEngine.gu_debugManager.log("NaN frame height value found in Button "+this._id),!1):a}return D2LAdventureEngine.gu_ResourceManager.preDetermineSpriteDimentions(this._options.AssetID).height};c.prototype.comp_Update=function(){if(this._initialized&&!this._options.bypassParentDefine&&"none"!==this.assoiatedStateID&&D2LAdventureEngine.gu_StateManager.GetCurrStateRef().CurrentScene!==
this.parentScene&&"over"===this._sprite.currentAnimation)return this._stopAnimations?this._sprite.gotoAndStop("norm"):this._sprite.gotoAndPlay("norm")};c.prototype.comp_HandlePress=function(){return this._options.outOnClick?this._stopAnimations?this._sprite.gotoAndStop("norm"):this._sprite.gotoAndPlay("norm"):this._stopAnimations?this._sprite.gotoAndStop("down"):this._sprite.gotoAndPlay("down")};c.prototype.comp_HandleMouseOut=function(a){if(this._enabled)return this._stopAnimations?this._sprite.gotoAndStop("norm"):
this._sprite.gotoAndPlay("norm")};c.prototype.comp_HandleMouseOver=function(a){if(!this._MouseDown)return this._stopAnimations?this._sprite.gotoAndStop("over"):this._sprite.gotoAndPlay("over")};c.prototype.comp_Enable=function(){return this._stopAnimations?this._sprite.gotoAndStop("norm"):this._sprite.gotoAndPlay("norm")};c.prototype.comp_Disable=function(){return this._stopAnimations?this._sprite.gotoAndStop("disabled"):this._sprite.gotoAndPlay("disabled")};c.prototype.comp_isUnderCheck=function(a,
b){var c,d;return this._sprite?(c=!1,this._sprite.hitArea&&(this._sprite.hitArea.visible=!0,c=a-this.x,d=b-this.y,c=this._sprite.hitArea.hitTest(c,d),this._sprite.hitArea.visible=this._showingHitmask),c):!1};c.prototype.useCustomDynamicMask=function(a){this.removeChild(this._sprite.hitArea);this._sprite.hitArea=a;this._sprite.hitArea.visible=this._showingHitmask;this._sprite.hitArea.x=0;this._sprite.hitArea.y=0;this.addChild(this._sprite.hitArea);return this._options.dynamicHitmask=!0};c.prototype.toggleShowHitmask=
function(a){this._showingHitmask=!this._showingHitmask;return this._sprite.hitArea.visible=this._showingHitmask};c.prototype.changeSprite=function(a){a.constructor===D2LAdventureEngine.SpriteDataObject?(this._options.AssetID=void 0,this._options.useSpriteData=a,this.removeChild(this._sprite),this._sprite=new createjs.Sprite(this._options.useSpriteData)):a.constructor===String&&(this._options.useSpriteData=void 0,this._options.AssetID=a,this.removeChild(this._sprite),this._sprite=void 0!==this._options.AssetID?
D2LAdventureEngine.gu_ResourceManager.get(this._options.AssetID,"button"):D2LAdventureEngine.gu_ResourceManager.get(this._id,"button"));this.addChild(this._sprite);this._sprite.gotoAndStop("norm");this.width=this._sprite.spriteSheet._frames[0].rect.width;this.height=this._sprite.spriteSheet._frames[0].rect.height;this._options.initWidth=this.width;this._options.initHeight=this.height;this._sprite.gotoAndStop(this._options.initState);return this.Update()};c.prototype.GrabButtonFrame=function(a,b){var c,
d;void 0===b&&(b=0);c=this._sprite.spriteSheet.getAnimation(a).frames[b];d=new createjs.Bitmap(this._sprite.spriteSheet._frames[c].image);d.sourceRect=this._sprite.spriteSheet._frames[c].rect;return d};c.prototype.comp_BuildAccessContext=function(){D2LAdventureEngine.gu_ScreenReaderHelper.AddReadText(this._id,this._options.useContext,"button",this._options.useContextParent,{onclick:"D2LAdventureEngine.gu_ComponentManager.FindExistingComp('"+this._id+"').HandlePress()"});if(this._options.initHidden||
this._options.initDisabled)return D2LAdventureEngine.gu_ScreenReaderHelper.HideReadText(this._id)};return c}(D2LAdventureEngine.component);window.D2LAdventureEngine.comp_Bitmap=function(h){function c(a,b,h){this._id=a;this.location=b;this._options=h;this.getAsData=d(this.getAsData,this);this.ScaleToFit=d(this.ScaleToFit,this);this.comp_getHeight=d(this.comp_getHeight,this);this.comp_getWidth=d(this.comp_getWidth,this);this.comp_CheckClippingRules=d(this.comp_CheckClippingRules,this);this.changeImageSrc=
d(this.changeImageSrc,this);this.comp_destroy=d(this.comp_destroy,this);this.comp_Init=d(this.comp_Init,this);this.comp_AssessDefaultOptions=d(this.comp_AssessDefaultOptions,this);this._options||(this._options={useSrc:void 0,useSecondarySource:void 0,scaleToSize:!1,scaleToSizeWithRatio:!1,useB64Data:void 0});c.__super__.constructor.call(this,this._id,this.location,this._options)}q(c,h);c.prototype._image=void 0;c.prototype.comp_AssessDefaultOptions=function(){var a,b,c;void 0===this._options.useSrc&&
void 0!==this._options.filename&&(this._options.useSrc=this._options.filename);""===this._options.useB64Data&&(this._options.useB64Data=void 0);this._options.interactive&&void 0===this._options.useCursor?this._options.useCursor="pointer":this._options.interactive||void 0!==this._options.useCursor||(this._options.useCursor="default");void 0===this._options.useCursorOnOut&&(this._options.useCursorOnOut="default");void 0===this._options.useB64Data?(void 0!==this._options.useSrc?(a="IE"===window.D2LAdventureEngine.gu_userBrowser?
this._options.useSrc+"?_="+(new Date).getTime():this._options.useSrc,c=(new createjs.LoadItem).set({src:a,crossOrigin:this._options.crossOrigin}),this._postLoadReq=!0):this._image=void 0===this._options.AssetID?window.D2LAdventureEngine.gu_ResourceManager.get(this._id,"bitmap"):window.D2LAdventureEngine.gu_ResourceManager.get(this._options.AssetID,"bitmap"),this._image&&"errorImage"===this._image.name&&void 0!==this._options.useSecondarySource&&(this._image=window.D2LAdventureEngine.gu_ResourceManager.get(this._options.useSecondarySource,
"bitmap"))):this._image=new createjs.Bitmap(this._options.useB64Data);b=function(a){return function(){a._image.width||(a._image.width=a._image.image.naturalWidth);a._image.height||(a._image.height=a._image.image.naturalHeight);!0===a._options.scaleToSize||!0===a._options.scaleToSizeWithRatio?a.ScaleToFit(a._options.initWidth,a._options.initHeight,a._options.scaleToSizeWithRatio):(void 0===a._options.initWidth&&(a._options.initWidth=a._image.width),void 0===a._options.initHeight&&(a._options.initHeight=
a._image.height));return D2LAdventureEngine.gu_EventManager.DispacthEvent(a,"onLoad")}}(this);a=function(a){return function(c){c.item.type===createjs.Types.IMAGE?(a._image=new createjs.Bitmap(c.result),a._image.width||(a._image.width=c.result.naturalWidth),a._image.height||(a._image.height=c.result.naturalHeight),a._image.image.complete?(b(),a.PostLoadInit()):(a._postLoadReq=!0,a._image.image.addEventListener("load",b(),a.PostLoadInit(),!1))):D2LAdventureEngine.gu_debugManager.log("handleLoadNewImg recived non image")}}(this);
c?(c.callback=a,D2LAdventureEngine._masterLoadQueue.loadManifest([c])):this._image.image.complete?(this._image.image.crossOrigin=this._options.crossOrigin,b(),this.PostLoadInit()):(this._postLoadReq=!0,void 0!==this._options.useB64Data?this._image=new createjs.Bitmap(this._options.useB64Data):void 0!==this._options.useSrc&&(this._image=new createjs.Bitmap(this._image.image.src)),this._image.image.addEventListener("load",function(a){return function(){b();return a.PostLoadInit()}}(this),!1))};c.prototype.comp_Init=
function(){if(this._image)return this.addChild(this._image),this._options.scaleToSize?this.ScaleToFit(this._options.initWidth,this._options.initHeight,!1):(this.width=this._image.width,this.height=this._image.height),this._initialized=!0};c.prototype.comp_destroy=function(){return this.removeChild(this._image)};c.prototype.changeImageSrc=function(a){this.removeChild(this._image);this._image=void 0;this._options.AssetID=void 0;this._options.useSrc=void 0;this._options.useB64Data=void 0;this._initialized=
!1;D2LAdventureEngine.gu_EventManager.RemoveEventsByOwner(this,!0);this._defined=!1;a&&(-1!==a.indexOf("data:image/")?this._options.useB64Data=a:-1!==a.indexOf(".")?this._options.useSrc=a:(this._options.AssetID=a,this._image=window.D2LAdventureEngine.gu_ResourceManager.get(this._options.AssetID,"bitmap")))};c.prototype.comp_CheckClippingRules=function(){if(this._initalized)return this._image.x=-(this.tabulatedClippingRule.left|0),this._image.y=-(this.tabulatedClippingRule.top|0),{x:-this._image.x,
y:-this._image.y,width:this.width-(this.tabulatedClippingRule.left|0)-(this.tabulatedClippingRule.right|0),height:this.height-(this.tabulatedClippingRule.top|0)-(this.tabulatedClippingRule.bottom|0)}};c.prototype.comp_getWidth=function(){var a;if(void 0!==this.width)return this.width*this._options.scaleX;if(this._image&&this._image.width)return this._image.width*this._options.scaleX;if(!this._initialized&&void 0!==this._options.initWidth)return this._options.initWidth;if(this._options.AssetID)return a=
D2LAdventureEngine.gu_ResourceManager.preDetermineImageDimentions(this._options.AssetID),a.width};c.prototype.comp_getHeight=function(){var a;if(void 0!==this.height)return this.height*this._options.scaleY;if(this._image&&this._image.height)return this._image.height*this._options.scaleY;if(this._initialized||void 0===this._options.initHeight){if(this._options.AssetID)return a=D2LAdventureEngine.gu_ResourceManager.preDetermineImageDimentions(this._options.AssetID),a.height;if(this._options.useSrc)return a=
D2LAdventureEngine.gu_ResourceManager.preDetermineImageDimentions(this._options.useSrc),a.height}else return this._options.initHeight};c.prototype.ScaleToFit=function(a,b,c){this._image&&(this._image.scaleX=1,this._image.scaleY=1,0===this._image.image.width&&0===this._image.image.height?(a/=this._image.width,b/=this._image.height):(a/=this._image.image.width,b/=this._image.image.height),c&&(b=a=c=Math.min(a,b)),this._initialized?(this.scaleX=a,this.scaleY=b):(this._image.scaleX=a,this._image.scaleY=
b))};c.prototype.getAsData=function(){return D2LAdventureEngine.gu_DataManager.getImgData(this._image.image)};return c}(D2LAdventureEngine.component)}).call(this);
